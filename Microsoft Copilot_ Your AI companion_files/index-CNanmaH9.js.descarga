const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Index-LRgWj45i.js","assets/vendor-BoLDEgyJ.js","assets/sentry-D3-uqDEW.js","assets/index-DLqVI8Dc.js","assets/deferred-eWVhfL6i.js","assets/math.scalar.functions-C0i4R8fp.js","assets/animationGroup-ChLmvHX4.js","assets/skeleton-DtD8Wn2F.js","assets/rawTexture-xvbpY2To.js","assets/easing-48dQ93Br.js","assets/weightedsound-dxikVb77.js","assets/audioEngine-D1_P8dQX.js","assets/babylonFileParser.function-CWsVgwsY.js","assets/assetContainer-DqFUcoNX.js","assets/asyncLock-D0Otwrf6.js","assets/ray-7rVV2Shh.js","assets/webgpuEngine-Ckkh3LX-.js","assets/bakedVertexAnimation-BTc_Zrkq.js","assets/helperFunctions-BywUxD5N.js","assets/fresnelFunction-uJRyZzL1.js","assets/meshUboDeclaration-CXdyott-.js","assets/sceneUboDeclaration-D0mr-rvu.js","assets/decalFragment-B6fYu-_3.js","assets/dataReader-CZEbfB8-.js","assets/standardMaterial-PFuawnpy.js","assets/shaderMaterial-lz1OKd5m.js","assets/bakedVertexAnimation-CFFb5zP1.js","assets/morphTargetsVertex-BEGjerxF.js","assets/shadowsVertex--Nw4F8SJ.js","assets/vertexColorMixing-CJYxB6La.js","assets/discBuilder-BVGX4HKH.js","assets/abstractEngine.cubeTexture-_CsMj17K.js","assets/engine.multiRender-BULubLbQ.js","assets/environmentTextureTools-CBXyNS-H.js","assets/dumpTools-Ba0yYuXJ.js","assets/engine.multiRender-Bu-jr7QN.js","assets/flowGraphParser-BdyVTgQG.js","assets/flowGraphRichTypes-TpDno6aV.js","assets/flowGraphJsonPointerParserBlock-CuHY1kEh.js","assets/flowGraphCachedOperationBlock-BMN9d8_z.js","assets/flowGraphConsoleLogBlock-Db0JgwNI.js","assets/flowGraphBranchBlock-Bux66orP.js","assets/flowGraphDoNBlock-BK3UaXbq.js","assets/flowGraphForLoopBlock-CAswn3z-.js","assets/flowGraphThrottleBlock-C0Z25081.js","assets/flowGraphMultiGateBlock-DsNYlhp6.js","assets/flowGraphSwitchBlock-rvoM_wci.js","assets/flowGraphWaitAllBlock-DqXWKJXq.js","assets/flowGraphCounterBlock-D8OPg6tO.js","assets/flowGraphWhileLoopBlock-BYoDCw8G.js","assets/flowGraphDebounceBlock-CwOIhZGt.js","assets/flowGraphFlipFlopBlock-j3-G5trt.js","assets/flowGraphSequenceBlock-CAOeAx9o.js","assets/flowGraphSetDelayBlock-BT6_qhep.js","assets/flowGraphCancelDelayBlock-Cde7FSQ2.js","assets/flowGraphPlayAnimationBlock-DKCnVQD4.js","assets/flowGraphStopAnimationBlock-nkXWXmZ2.js","assets/flowGraphPauseAnimationBlock-D75Q85HW.js","assets/flowGraphInterpolationBlock-B9pzf3Fu.js","assets/flowGraphEasingBlock-iu1JL0NY.js","assets/flowGraphBezierCurveEasingBlock-B7QTrrXx.js","assets/flowGraphConditionalDataBlock-BmJk7mfM.js","assets/flowGraphGetVariableBlock-C5FtYQev.js","assets/flowGraphSetVariableBlock-D63vkXEu.js","assets/flowGraphTransformCoordinatesSystemBlock-xS0I21Fy.js","assets/flowGraphGetPropertyBlock-Cip87Iwl.js","assets/flowGraphSetPropertyBlock-85qSzKVH.js","assets/flowGraphConstantBlock-Ce2Iugsy.js","assets/flowGraphGetAssetBlock-1khHntU3.js","assets/flowGraphDataSwitchBlock-ndlV6jKO.js","assets/flowGraphMathBlocks-1NBv3giO.js","assets/flowGraphBinaryOperationBlock-CJHEkYCq.js","assets/flowGraphUnaryOperationBlock-BmPDIMGo.js","assets/flowGraphMathCombineExtractBlocks-DNzD5xmY.js","assets/flowGraphMatrixMathBlocks-Py_hWOOG.js","assets/flowGraphVectorMathBlocks-CX2v1qeh.js","assets/flowGraphTypeToTypeBlocks-Ce51Q_iZ.js","assets/flowGraphContextBlock-BiuiOvMC.js","assets/flowGraphArrayIndexBlock-DyyUxOc-.js","assets/flowGraphCodeExecutionBlock-KvhmmxJ0.js","assets/flowGraphIndexOfBlock-Y4QuXl6G.js","assets/flowGraphFunctionReferenceBlock-jwRQ5W91.js","assets/flowGraphMeshPickEventBlock-BPWlc8Ro.js","assets/flowGraphSceneReadyEventBlock-DZVOeXaB.js","assets/flowGraphReceiveCustomEventBlock-597st1aU.js","assets/flowGraphSendCustomEventBlock-DEs-2AWb.js","assets/flowGraphSceneTickEventBlock-BIJaxIL-.js","assets/flowGraphPointerOutEventBlock-HNNIGqAd.js","assets/flowGraphPointerOverEventBlock-BZQnzDsd.js","assets/shadowGeneratorSceneComponent-D4GyqIuY.js","assets/shadowGenerator-B1qv-aSO.js","assets/clipPlaneFragment-CaXMDxIi.js","assets/clipPlaneVertex-BTIDtDVs.js","assets/pointCloudVertex-BSBrX8Bz.js","assets/pointLight-CuRfsQ7s.js","assets/cubeTexture-FUDoMvtS.js","assets/dds-DgVa7R4P.js","assets/ktxTextureLoader-CnntHXeX.js","assets/workerPool-H9Ji3mCo.js","assets/iblCdfGenerator-BvL_m9d9.js","assets/helperFunctions-DcyqqQGH.js","assets/fogFragment-HAse9ivh.js","assets/logDepthVertex-Dg64PH2d.js","assets/sceneUboDeclaration-BrfyIRX9.js","assets/meshUboDeclaration-BD1p7ysn.js","assets/iesTextureLoader-jaYDMBUn.js","assets/hdrCubeTexture-h7CKOYUu.js","assets/hdr-BOJN0jFO.js","assets/background.vertex-KJPTVu-e.js","assets/backgroundUboDeclaration-CPpzKN5w.js","assets/logDepthDeclaration-jcgd6IpD.js","assets/background.fragment-CFQe7s4O.js","assets/lightFragment-CsN6qItZ.js","assets/lightsFragmentFunctions-D4rNVxhw.js","assets/background.vertex-Ba11JsbQ.js","assets/backgroundUboDeclaration-ddIiZMvX.js","assets/logDepthVertex-rGEBjSuU.js","assets/shadowsVertex-BRU9QQBF.js","assets/logDepthDeclaration-uGxlF0Re.js","assets/background.fragment-B78ReoOx.js","assets/lightFragment-Dj0HwIIk.js","assets/lightsFragmentFunctions-gVOlfKS5.js","assets/fogFragmentDeclaration-CQn1UEcA.js","assets/samplerVertexImplementation-3kMXTXzF.js","assets/pbr.vertex-DHTTMlci.js","assets/harmonicsFunctions-gJ4kHLD2.js","assets/mainUVVaryingDeclaration-25MRaNXZ.js","assets/pbr.fragment-Bdo5gFuN.js","assets/oitFragment-DeIQjEiO.js","assets/pbr.vertex-CsBSndqP.js","assets/harmonicsFunctions-Y-tzSAMU.js","assets/mainUVVaryingDeclaration-Cfu75LJ-.js","assets/bumpVertex-DjMG05Qv.js","assets/pbr.fragment-CP66XIeQ.js","assets/oitFragment-BCvc18PJ.js","assets/bumpFragment-CxASDiMv.js","assets/shaderLanguage-BjwqUAVi.js","assets/ddsTextureLoader-BEHJG6dq.js","assets/envTextureLoader-CwtLwRzT.js","assets/tgaTextureLoader-BdfOvFys.js","assets/hdrTextureLoader-DqmMXC6e.js","assets/basisTextureLoader-D5U9O57M.js","assets/exrTextureLoader-egicPUo_.js","assets/iblShadowsRenderPipeline-6_ZlpHE-.js","assets/rawCubeTexture-DxFSlotY.js","assets/pointsCloudSystem-BXPHkQaJ.js","assets/thinInstanceMesh-QLRQvZhO.js","assets/default.fragment-CvBMO2Vz.js","assets/defaultUboDeclaration-De7q_Ckj.js","assets/default.vertex-DXuAwpXm.js","assets/default.fragment-Om4RFVZD.js","assets/defaultUboDeclaration-Cx6-VLvf.js","assets/default.vertex-DudNQYDT.js","assets/dracoDecoder-CZ9LTXXq.js","assets/meshoptCompression-ymIwWdlW.js","assets/mesh.vertexData.functions-BXkNVxNr.js","assets/lodCube.fragment-BJEhu1mk.js","assets/lod.fragment-B8Doh1Ec.js","assets/lodCube.fragment-DKdaGPRJ.js","assets/lod.fragment-q-e8r7fo.js","assets/rgbdDecode.fragment-BIEP-VYC.js","assets/rgbdEncode.fragment-C_Ikk7Ob.js","assets/rgbdDecode.fragment-BBJV2-3P.js","assets/rgbdEncode.fragment-CXt1lku3.js","assets/postProcessRenderPipelineManagerSceneComponent-CUTk9DNX.js","assets/postprocess.vertex-Bl7owsrl.js","assets/pass.fragment-CZMZksYz.js","assets/passCube.fragment-k6B8CG2s.js","assets/pass.fragment-B7jMW-vv.js","assets/passCube.fragment-CczWSR__.js","assets/index-xcMIO94s.js","assets/glTFLoader-MC7T7ZUa.js","assets/glTFLoaderExtensionRegistry-CgGMT4A2.js","assets/objectModelMapping-v2S8r9Qa.js","assets/KHR_animation_pointer-DQv-Xhl3.js","assets/EXT_lights_image_based-DhOKc7v1.js","assets/EXT_mesh_gpu_instancing-CfP7peh3.js","assets/EXT_meshopt_compression-Dpkshk2O.js","assets/EXT_texture_webp-BvpupXB_.js","assets/EXT_texture_avif-hZFdrZbh.js","assets/EXT_lights_ies-Cy0X0ERN.js","assets/KHR_draco_mesh_compression-IkRConwo.js","assets/KHR_lights_punctual-DxQapXrW.js","assets/KHR_materials_pbrSpecularGlossiness-TsZ0PoxM.js","assets/KHR_materials_unlit-AGIV4Suo.js","assets/KHR_materials_clearcoat-C5BWOACh.js","assets/KHR_materials_iridescence-CPzFiq5l.js","assets/KHR_materials_anisotropy-DPCtkSdp.js","assets/KHR_materials_emissive_strength-CD8SbYx-.js","assets/KHR_materials_sheen-BOv8131i.js","assets/KHR_materials_specular-B-TFUQ8E.js","assets/KHR_materials_ior-CKc_vL3Z.js","assets/KHR_materials_variants-Cb73gV2G.js","assets/KHR_materials_transmission-DGP3RPfD.js","assets/KHR_materials_diffuse_transmission-Bc_uWIfK.js","assets/KHR_materials_volume-Bp2i1nhV.js","assets/KHR_materials_dispersion-CkpRT40J.js","assets/EXT_materials_diffuse_roughness-BT8cYxfT.js","assets/KHR_mesh_quantization-Cgdc5qtL.js","assets/KHR_texture_basisu-BprvVHNG.js","assets/KHR_texture_transform-B_hPZ_9p.js","assets/KHR_xmp_json_ld-RQtV-EJa.js","assets/MSFT_audio_emitter-WIAOZ2Ss.js","assets/MSFT_lod-Dw7vJjEQ.js","assets/MSFT_minecraftMesh-B6L-Cqhz.js","assets/MSFT_sRGBFactors-qtV8aWO-.js","assets/KHR_interactivity--gtDzqsL.js","assets/declarationMapper-DKSP9WIw.js","assets/KHR_node_visibility-B-nC-h93.js","assets/KHR_node_selectability-1zxHoAHz.js","assets/KHR_node_hoverability-DPsOaeBo.js","assets/ExtrasAsMetadata-CY0neXQD.js","assets/index-C7HE8YkO.js","assets/stlFileLoader.metadata-D34mcJg2.js","assets/babylon.inspector.bundle-BUT6bMSw.js","assets/objFileLoader-q2OTC82_.js","assets/stlFileLoader-C8vjjMUC.js","assets/splatFileLoader-DCieFk1R.js","assets/index-CCeFp6kA.js","assets/index.es-BjL6LrIc.js","assets/code-DRCDwlgv.js","assets/copy-udSeYEHl.js","assets/core-BiIOkrJH.js","assets/language-loader-BzJv311v.js","assets/index-6yUf1rwO.js","assets/index-Chjiymov.js","assets/sender-share-conversation-modal-Dof54Ynh.js","assets/alert-DP86glzZ.js","assets/error-CNc-wLo4.js","assets/character-DZ-LFNRh.js","assets/use-set-up-babylon-Cp1lRx9Z.js","assets/product-purchase-Dw9Fr_Y7.js","assets/constants-DTaIYwjd.js","assets/utils--e6Ij0yE.js","assets/wallet-element-factory-CLMbwG5L.js","assets/pidl-pages-CFOZdOlj.js","assets/constants-BnxRz7co.js","assets/payment-methods-management-D6TdStEP.js","assets/v4-CtRu48qb.js","assets/index-DmSGk4sl.js","assets/upsell-block-CmjWxp_8.js","assets/cross-selling-strip-Bs85W8W4.js","assets/price-tracking-block-Cbv5fZls.js","assets/use-price-tracking-FvDB_WWk.js","assets/use-shopping-telemetry-vOR2_J61.js","assets/shopping-telemetry-DsvfLQvl.js","assets/chevron-bolded-BcTwd_Yd.js","assets/format-money-5coY0IJJ.js","assets/composer-auto-complete-DgwCoUa1.js","assets/composer-actions-prompt-suggestions-DZDg2TZh.js","assets/booking-CW-ywcP5.js","assets/expedia-DtkGfWL9.js","assets/flower-LnQzD_0P.js","assets/hotels-fH-e2Za5.js","assets/kayak-Dp2vcM-_.js","assets/open-table-CbcOFkHx.js","assets/priceline-DWVSGW4G.js","assets/sky-scanner-DecV3GDD.js","assets/trip-advisor--wrxSgL9.js","assets/viator-BMKm1VP7.js","assets/voice-options-zbmcQvIZ.js","assets/think-deeper-pro-subscription-CBfV_NU2.js","assets/over-task-quota-Dq-ErrIj.js","assets/composer-action-CuhF44zF.js","assets/computer-use-task-closed-Coi9kqz3.js","assets/export-CUOztmlH.js","assets/import-Cs6MmZwy.js","assets/settings-Cg4Qc9yz.js","assets/speed-DGfhs9k6.js","assets/audio-controls-mX97kFhI.js","assets/next-bb4dCTXL.js","assets/pause-NFYB2imw.js","assets/play-C41q3_Fp.js","assets/progress-bar-DzulRBYv.js","assets/close-button-Dnbvn3ZV.js","assets/replay-Dnlohul1.js","assets/safety-risk-card-B0QqGJzi.js","assets/use-send-action-command-DXSz4Es3.js","assets/add-to-page-MvDCa9tI.js","assets/cross-selling-strip-consumer-CJgF9276.js","assets/composer-prompt-review-Biq_aJR6.js","assets/use-ocv-feedback-xEHWrpn_.js","assets/biometric-consent-vHESJBBe.js","assets/daily-briefing-chat-2Ad-3BKC.js","assets/contract-down-left-BB3WNDWj.js","assets/dailly-briefing-composer-input-BFDUiptk.js","assets/composer-sign-in-Cnx-1jcx.js","assets/merge-conversation-checkbox-CF4uJ07x.js","assets/daily-briefing-composer-player-Djs_8BAA.js","assets/sidebar-pages-DwHNepil.js","assets/use-supports-hover-CnxPpzed.js","assets/conversations-BH4ZIfCj.js","assets/delete-B9wJqdAy.js","assets/dots-horizontal-B2yIubjl.js","assets/use-share-message-Q6x4oonc.js","assets/use-list-key-down-Dbcm50n5.js","assets/settings-wrapper-CbHEKPR7.js","assets/media-viewer-BmhEDv3R.js","assets/image-wrapper-DUeiwX0V.js","assets/image-off-C3LkqhyX.js","assets/utils-Iy9KUAc3.js","assets/picture-in-picture-22eL3ANe.js","assets/video-player-B-kdUBIx.js","assets/native-player-wmlUXM5P.js","assets/card-carousel-DTpkaxhQ.js","assets/use-carousel-DGHANtBo.js","assets/utils-ifQmq0fb.js","assets/composer-large-screen-D6QYra2T.js","assets/link-BpUgRFGK.js","assets/types-S47nI6MK.js","assets/discover-BUTbVgmA.js","assets/use-discover-feed-DyUhKb6m.js","assets/podcast-schemas-D3WXYPcN.js","assets/block-DnYQMi7s.js","assets/thumbs-up-filled-D23ffX0d.js","assets/document-one-page-sparkle-Ni8Kov7-.js","assets/food-apple-C3Q3AXvv.js","assets/lightbulb-DIpO-18T.js","assets/location-ripple-DXEstuON.js","assets/podcast-BeTe3FHx.js","assets/scales-7_Gc6uvB.js","assets/tag-CEKdgtwk.js","assets/play-outline-D7Qj_3to.js","assets/weather-states-categories-CmeEET4X.js","assets/parseISO-B04CydMg.js","assets/watchlist-bridge-B3DzsM1C.js","assets/widget-player-DnU-xdUB.js","assets/generateCategoricalChart-Br40IuFs.js","assets/headphones-D3kYEMVY.js","assets/use-podcasts-navigation-CdfSlk8L.js","assets/audio-recorder-DAnrddnT.js","assets/actions-chat-detail-CcsGdhrY.js","assets/expand-pane-DcZlYxUv.js","assets/save-action-BQn3cnPp.js","assets/external-link-Z6nbNcpX.js","assets/new-tab-Bmn3F-cK.js","assets/pause-outline-By4-CndZ.js","assets/showroom-chat-detail-Bzfwk2fZ.js","assets/contextual-shopping-card-B1RilgJe.js","assets/product-rating-luh5i9VT.js","assets/buy-button-3-PTy7qD.js","assets/use-shopping-visibility-telemetry-CYudOuUg.js","assets/shopping-utils-BNdVsGYO.js","assets/citation-chips-row-GFYV9iYT.js","assets/bell-alert-Cmv9SeUp.js","assets/bell-D5dxtLRu.js","assets/star-DbXjDeIA.js","assets/arrow-trending-down-DsSyL7H6.js","assets/price-history-chart-yISpuBOs.js","assets/appearance-chat-C6hHNiiL.js","assets/ai-message-PPiQ1Ful.js","assets/copy-filled-CZEmLZHN.js","assets/use-page-BvIPRAbp.js","assets/use-ads-card-operations-CDG0ina1.js","assets/dev-mode-state-D-HMVXW5.js","assets/use-podcast-share-CnHO9Ca5.js","assets/topic-selection.lazy-BcEsgx3l.js","assets/login.lazy-NW0M4Wp5.js","assets/library.lazy-CfgvEpL9.js","assets/gaming.lazy-BNyM96te.js","assets/gallery.lazy-DA5XLI0f.js","assets/gallery-schemas-Elgt87FN.js","assets/daily.lazy-CDudydWu.js","assets/daily-briefing-DHBFmnfR.js","assets/formatDistanceToNow-BoMg5hMG.js","assets/constructNow-BGxivX_B.js","assets/use-scroll-element-into-view-R8HT6QU3.js","assets/arrow-maximize-Ksd5dKU7.js","assets/arrow-minimize-BDvU4RY7.js","assets/use-is-portrait-DEYTxOwz.js","assets/wand-BLgpVDko.js","assets/agents.lazy-DH-oy6sa.js","assets/index.lazy-BRD9pJwy.js","assets/utils-BPgloEUB.js","assets/use-finger-printing-Be5rqO0p.js","assets/rewards-link-CMMi8seB.js","assets/arrow-referral-Bk_uBhNV.js","assets/copliot-referral-BY6-yxRT.js","assets/four-leaf-clover-CjhvsRf5.js","assets/hexagon-CfZSkeeB.js","assets/message-referral-DdXQB1VN.js","assets/rewards-DgOLycq3.js","assets/index.lazy-PEOE9gco.js","assets/use-labs-telemetry-DCPP1ONN.js","assets/index-BX4p-gj8.js","assets/labs-social-icon-discord-to4LC-CM.js","assets/labs-social-icon-instagram-C9g0NrpK.js","assets/labs-social-icon-x-DlNPUOaL.js","assets/labs-social-icon-youtube-B3N643DI.js","assets/labs-logo-CyTEsBIR.js","assets/subscription.start.lazy-DUVBmlXN.js","assets/subscription.manage.lazy-Cz5uCTdX.js","assets/shares._conversationId.lazy-DnWHRYws.js","assets/rules.lazy-0Rya6oqK.js","assets/gift-DdosfAVk.js","assets/link-multiple-W3oTrjze.js","assets/pro.subscribe.lazy-BOhhqmaw.js","assets/checkout-wrapper-B9XphA9H.js","assets/paywall-container-ultFmSlz.js","assets/add-address-DI2c1UvZ.js","assets/address-DsOxvxaN.js","assets/pidl-element-factory-0bCS0NDI.js","assets/workflow-pi-dropdown-disabler-D6tzMRho.js","assets/visa-DNBWtMre.js","assets/atoms-CrzHwXqY.js","assets/react-number-format.es-CmWmdBNC.js","assets/wallet-dropdown-Y1McQIZl.js","assets/wallet-icon-button-CuIJkr9Y.js","assets/wallet-list-Da2H0Iwk.js","assets/current-BqtR0Yio.js","assets/plus-wfRrWbQ8.js","assets/pidl-element-factory-DikK38DI.css","assets/add-address-view-Du09oSq6.js","assets/form-field-skeleton-B2j8QHw_.js","assets/add-payment-instrument-CDzxVCQ6.js","assets/add-payment-instrument-view-C9pSLw44.js","assets/add-ewallet-skeleton-BUsm6L8K.js","assets/select-payment-instrument-BKeBePE0.js","assets/start-line-DLylJUkf.js","assets/credit-card-gOcOt0QF.js","assets/pro.subscribe-DU9qjcuZ.css","assets/pages._pageId.lazy-CJ6tKie1.js","assets/use-clean-history-state-C6HcZ2Ou.js","assets/text-bold-WMttTm77.js","assets/text-bullet-list-CcJFrg-9.js","assets/text-code-8xPf2byR.js","assets/text-italic-BVtv3zTq.js","assets/text-numbered-list-By3zC7m7.js","assets/text-paragraph-DUCs7C2c.js","assets/pages-welcome-dark-r64A2mUI.js","assets/pages-welcome-light-DDUDcHxX.js","assets/arrow-enter-up-hWBEhtQc.js","assets/use-clean-history-state-VM7_CLIT.css","assets/copy-add-BulEiykE.js","assets/memory.narrative.lazy-D2ftwklV.js","assets/mask-wrapper-B_oNJ3gg.js","assets/gallery._galleryItemId.lazy-Bkf6NQLD.js","assets/like-filled-DRvJ5Hn4.js","assets/like-DRtDX8zt.js","assets/edit-DOLgSCD_.js","assets/chats.private.lazy-DqrosmEZ.js","assets/campaigns._campaignId.lazy--FFdyuh5.js","assets/shares.podcasts._shareId.lazy-CYypAaGY.js","assets/shares.pages._shareId.lazy-DxGa496K.js","assets/eye-vlKiglMG.js","assets/pro.redeem._redeemCode.lazy-Iv_B82GV.js","assets/pro.ewallet.return.lazy-C-o4s2ne.js","assets/podcasts._podcastType._podcastId.lazy-C2hwbejd.js","assets/experiments._experimentAlias.lazy-DEE2vvxE.js","assets/chats_._conversationId.talk.lazy-BtBSPNZ_.js","assets/audio-call-ybBgZwOY.js","assets/timer-DK_2GYXp.js","assets/voicemail-dark-BtARQIb1.js","assets/voicemail-light-DeMSWjpH.js","assets/index.lazy-CMjzYEhb.js","assets/my-creations.lazy-CnL7LJc0.js","assets/my-creations-DV8PrLMj.css","assets/talk.lazy-BHDMzjfO.js","assets/shares._shareId.lazy-BaZ-EmHY.js"])))=>i.map(i=>d[i]);
var WF=Object.defineProperty;var ik=t=>{throw TypeError(t)};var YF=(t,e,n)=>e in t?WF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var W=(t,e,n)=>YF(t,typeof e!="symbol"?e+"":e,n),sC=(t,e,n)=>e.has(t)||ik("Cannot "+n);var he=(t,e,n)=>(sC(t,e,"read from private field"),n?n.call(t):e.get(t)),ln=(t,e,n)=>e.has(t)?ik("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Bt=(t,e,n,r)=>(sC(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),ze=(t,e,n)=>(sC(t,e,"access private method"),n);import{r as m,a as D,n as st,b as L,j as d,U as QF,R as Yc,u as Ee,q as IM,z as l,v as aI,x as Zv,Z as vg,V as TM,e as it,f as cI,A as Pn,m as Re,N as _M,k as ep,y as tp,W as wM,l as fd,C as lI,D as uI,E as dI,X as JF,Y as ZF,G as hI,F as Xv,_ as eb,s as AM,H as kM,o as pd,B as md,$ as xM,Q as RM,a0 as zu,a1 as XF,a2 as eB,a3 as NM,p as tB,d as fI,a4 as nB,M as PM,a5 as rB,a6 as MM,a7 as oB,a8 as iB,a9 as sB,aa as aB,O as cB,ab as lB,ac as uB,g as wt,ad as dB,ae as OM,h as hB,af as fB,ag as pB,ah as mB}from"./vendor-BoLDEgyJ.js";import{g as LM}from"./sentry-D3-uqDEW.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const gB="modulepreload",vB=function(t){return"https://studiostaticassetsprod.azureedge.net/bundle-cmc/"+t},sk={},H=function(e,n,r){let o=Promise.resolve();if(n&&n.length>0){let s=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));o=s(n.map(u=>{if(u=vB(u),u in sk)return;sk[u]=!0;const h=u.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const f=document.createElement("link");if(f.rel=h?"stylesheet":gB,h||(f.as="script"),f.crossOrigin="",f.href=u,c&&f.setAttribute("nonce",c),document.head.appendChild(f),h)return new Promise((g,v)=>{f.addEventListener("load",g),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return o.then(s=>{for(const a of s||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},bB=t=>{const e="input"in t?t.input:"input",n="output"in t?t.output:"output",r="schema"in t?t.schema._input:t._input,o="schema"in t?t.schema._output:t._output;return{types:{input:e==="output"?o:r,output:n==="input"?r:o},parse:i=>"schema"in t?t.schema.parse(i):t.parse(i)}},DM=m.createContext(null),aC={didCatch:!1,error:null};class jM extends m.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=aC}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var n,r,o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];(n=(r=this.props).onReset)===null||n===void 0||n.call(r,{args:i,reason:"imperative-api"}),this.setState(aC)}}componentDidCatch(e,n){var r,o;(r=(o=this.props).onError)===null||r===void 0||r.call(o,e,n)}componentDidUpdate(e,n){const{didCatch:r}=this.state,{resetKeys:o}=this.props;if(r&&n.error!==null&&yB(e.resetKeys,o)){var i,s;(i=(s=this.props).onReset)===null||i===void 0||i.call(s,{next:o,prev:e.resetKeys,reason:"keys"}),this.setState(aC)}}render(){const{children:e,fallbackRender:n,FallbackComponent:r,fallback:o}=this.props,{didCatch:i,error:s}=this.state;let a=e;if(i){const c={error:s,resetErrorBoundary:this.resetErrorBoundary};if(typeof n=="function")a=n(c);else if(r)a=m.createElement(r,c);else if(o!==void 0)a=o;else throw s}return m.createElement(DM.Provider,{value:{didCatch:i,error:s,resetErrorBoundary:this.resetErrorBoundary}},a)}}function yB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.length!==e.length||t.some((n,r)=>!Object.is(n,e[r]))}function CB(t){if(t==null||typeof t.didCatch!="boolean"||typeof t.resetErrorBoundary!="function")throw new Error("ErrorBoundaryContext not found")}function UM(){const t=m.useContext(DM);CB(t);const[e,n]=m.useState({error:null,hasError:!1}),r=m.useMemo(()=>({resetBoundary:()=>{t.resetErrorBoundary(),n({error:null,hasError:!1})},showBoundary:o=>n({error:o,hasError:!0})}),[t.resetErrorBoundary]);if(e.hasError)throw e.error;return r}var cC,ak;function SB(){return ak||(ak=1,cC={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),cC}var EB=SB();const IB=LM(EB);var TB=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function ck(t){var e={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},n=t.match(/<\/?([^\s]+?)[/\s>]/);if(n&&(e.name=n[1],(IB[n[1]]||t.charAt(t.length-2)==="/")&&(e.voidElement=!0),e.name.startsWith("!--"))){var r=t.indexOf("-->");return{type:"comment",comment:r!==-1?t.slice(4,r):""}}for(var o=new RegExp(TB),i=null;(i=o.exec(t))!==null;)if(i[0].trim())if(i[1]){var s=i[1].trim(),a=[s,""];s.indexOf("=")>-1&&(a=s.split("=")),e.attrs[a[0]]=a[1],o.lastIndex--}else i[2]&&(e.attrs[i[2]]=i[3].trim().substring(1,i[3].length-1));return e}var _B=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,wB=/^\s*$/,AB=Object.create(null);function FM(t,e){switch(e.type){case"text":return t+e.content;case"tag":return t+="<"+e.name+(e.attrs?function(n){var r=[];for(var o in n)r.push(o+'="'+n[o]+'"');return r.length?" "+r.join(" "):""}(e.attrs):"")+(e.voidElement?"/>":">"),e.voidElement?t:t+e.children.reduce(FM,"")+"</"+e.name+">";case"comment":return t+"<!--"+e.comment+"-->"}}var kB={parse:function(t,e){e||(e={}),e.components||(e.components=AB);var n,r=[],o=[],i=-1,s=!1;if(t.indexOf("<")!==0){var a=t.indexOf("<");r.push({type:"text",content:a===-1?t:t.substring(0,a)})}return t.replace(_B,function(c,u){if(s){if(c!=="</"+n.name+">")return;s=!1}var h,p=c.charAt(1)!=="/",f=c.startsWith("<!--"),g=u+c.length,v=t.charAt(g);if(f){var y=ck(c);return i<0?(r.push(y),r):((h=o[i]).children.push(y),r)}if(p&&(i++,(n=ck(c)).type==="tag"&&e.components[n.name]&&(n.type="component",s=!0),n.voidElement||s||!v||v==="<"||n.children.push({type:"text",content:t.slice(g,t.indexOf("<",g))}),i===0&&r.push(n),(h=o[i-1])&&h.children.push(n),o[i]=n),(!p||n.voidElement)&&(i>-1&&(n.voidElement||n.name===c.slice(2,-1))&&(i--,n=i===-1?r:o[i]),!s&&v!=="<"&&v)){h=i===-1?r:o[i].children;var b=t.indexOf("<",g),C=t.slice(g,b===-1?void 0:b);wB.test(C)&&(C=" "),(b>-1&&i+h.length>=0||C!==" ")&&h.push({type:"text",content:C})}}),r},stringify:function(t){return t.reduce(function(e,n){return e+FM("",n)},"")}};function Vm(){if(console&&console.warn){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Po(e[0])&&(e[0]=`react-i18next:: ${e[0]}`),console.warn(...e)}}const lk={};function bg(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Po(e[0])&&lk[e[0]]||(Po(e[0])&&(lk[e[0]]=new Date),Vm(...e))}const BM=(t,e)=>()=>{if(t.isInitialized)e();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),e()};t.on("initialized",n)}},uk=(t,e,n)=>{t.loadNamespaces(e,BM(t,n))},dk=(t,e,n,r)=>{Po(n)&&(n=[n]),n.forEach(o=>{t.options.ns.indexOf(o)<0&&t.options.ns.push(o)}),t.loadLanguages(e,BM(t,r))},xB=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=e.languages[0],o=e.options?e.options.fallbackLng:!1,i=e.languages[e.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const s=(a,c)=>{const u=e.services.backendConnector.state[`${a}|${c}`];return u===-1||u===2};return n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&e.services.backendConnector.backend&&e.isLanguageChangingTo&&!s(e.isLanguageChangingTo,t)?!1:!!(e.hasResourceBundle(r,t)||!e.services.backendConnector.backend||e.options.resources&&!e.options.partialBundledLanguages||s(r,t)&&(!o||s(i,t)))},RB=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return!e.languages||!e.languages.length?(bg("i18n.languages were undefined or empty",e.languages),!0):e.options.ignoreJSONStructure!==void 0?e.hasLoadedNamespace(t,{lng:n.lng,precheck:(o,i)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&o.services.backendConnector.backend&&o.isLanguageChangingTo&&!i(o.isLanguageChangingTo,t))return!1}}):xB(t,e,n)},Po=t=>typeof t=="string",su=t=>typeof t=="object"&&t!==null,NB=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,PB={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},MB=t=>PB[t],OB=t=>t.replace(NB,MB);let M0={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:OB};const LB=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};M0={...M0,...t}},HM=()=>M0;let zM;const DB=t=>{zM=t},pI=()=>zM,lC=(t,e)=>{if(!t)return!1;const n=t.props?t.props.children:t.children;return e?n.length>0:!!n},uC=t=>{if(!t)return[];const e=t.props?t.props.children:t.children;return t.props&&t.props.i18nIsDynamicList?au(e):e},jB=t=>Array.isArray(t)&&t.every(m.isValidElement),au=t=>Array.isArray(t)?t:[t],UB=(t,e)=>{const n={...e};return n.props=Object.assign(t.props,e.props),n},VM=(t,e)=>{if(!t)return"";let n="";const r=au(t),o=e.transSupportBasicHtmlNodes&&e.transKeepBasicHtmlNodesFor?e.transKeepBasicHtmlNodesFor:[];return r.forEach((i,s)=>{if(Po(i))n+=`${i}`;else if(m.isValidElement(i)){const{props:a,type:c}=i,u=Object.keys(a).length,h=o.indexOf(c)>-1,p=a.children;if(!p&&h&&!u)n+=`<${c}/>`;else if(!p&&(!h||u)||a.i18nIsDynamicList)n+=`<${s}></${s}>`;else if(h&&u===1&&Po(p))n+=`<${c}>${p}</${c}>`;else{const f=VM(p,e);n+=`<${s}>${f}</${s}>`}}else if(i===null)Vm("Trans: the passed in value is invalid - seems you passed in a null child.");else if(su(i)){const{format:a,...c}=i,u=Object.keys(c);if(u.length===1){const h=a?`${u[0]}, ${a}`:u[0];n+=`{{${h}}}`}else Vm("react-i18next: the passed in object contained more than one variable - the object should look like {{ value, format }} where format is optional.",i)}else Vm("Trans: the passed in value is invalid - seems you passed in a variable like {number} - please pass in variables for interpolation as full objects like {{number}}.",i)}),n},FB=(t,e,n,r,o,i)=>{if(e==="")return[];const s=r.transKeepBasicHtmlNodesFor||[],a=e&&new RegExp(s.map(b=>`<${b}`).join("|")).test(e);if(!t&&!a&&!i)return[e];const c={},u=b=>{au(b).forEach(S=>{Po(S)||(lC(S)?u(uC(S)):su(S)&&!m.isValidElement(S)&&Object.assign(c,S))})};u(t);const h=kB.parse(`<0>${e}</0>`),p={...c,...o},f=(b,C,S)=>{const E=uC(b),I=v(E,C.children,S);return jB(E)&&I.length===0||b.props&&b.props.i18nIsDynamicList?E:I},g=(b,C,S,E,I)=>{b.dummy?(b.children=C,S.push(m.cloneElement(b,{key:E},I?void 0:C))):S.push(...m.Children.map([b],T=>{const _={...T.props};return delete _.i18nIsDynamicList,m.createElement(T.type,{..._,key:E,ref:T.ref},I?null:C)}))},v=(b,C,S)=>{const E=au(b);return au(C).reduce((T,_,w)=>{const A=_.children&&_.children[0]&&_.children[0].content&&n.services.interpolator.interpolate(_.children[0].content,p,n.language);if(_.type==="tag"){let M=E[parseInt(_.name,10)];S.length===1&&!M&&(M=S[0][_.name]),M||(M={});const R=Object.keys(_.attrs).length!==0?UB({props:_.attrs},M):M,$=m.isValidElement(R),V=$&&lC(_,!0)&&!_.voidElement,ie=a&&su(R)&&R.dummy&&!$,N=su(t)&&Object.hasOwnProperty.call(t,_.name);if(Po(R)){const Y=n.services.interpolator.interpolate(R,p,n.language);T.push(Y)}else if(lC(R)||V){const Y=f(R,_,S);g(R,Y,T,w)}else if(ie){const Y=v(E,_.children,S);g(R,Y,T,w)}else if(Number.isNaN(parseFloat(_.name)))if(N){const Y=f(R,_,S);g(R,Y,T,w,_.voidElement)}else if(r.transSupportBasicHtmlNodes&&s.indexOf(_.name)>-1)if(_.voidElement)T.push(m.createElement(_.name,{key:`${_.name}-${w}`}));else{const Y=v(E,_.children,S);T.push(m.createElement(_.name,{key:`${_.name}-${w}`},Y))}else if(_.voidElement)T.push(`<${_.name} />`);else{const Y=v(E,_.children,S);T.push(`<${_.name}>${Y}</${_.name}>`)}else if(su(R)&&!$){const Y=_.children[0]?A:null;Y&&T.push(Y)}else g(R,A,T,w,_.children.length!==1||!A)}else if(_.type==="text"){const M=r.transWrapTextNodes,R=i?r.unescape(n.services.interpolator.interpolate(_.content,p,n.language)):n.services.interpolator.interpolate(_.content,p,n.language);M?T.push(m.createElement(M,{key:`${_.name}-${w}`},R)):T.push(R)}return T},[])},y=v([{dummy:!0,children:t||[]}],h,au(t||[]));return uC(y[0])};function BB(t){let{children:e,count:n,parent:r,i18nKey:o,context:i,tOptions:s={},values:a,defaults:c,components:u,ns:h,i18n:p,t:f,shouldUnescape:g,...v}=t;const y=p||pI();if(!y)return bg("You will need to pass in an i18next instance by using i18nextReactModule"),e;const b=f||y.t.bind(y)||(V=>V),C={...HM(),...y.options&&y.options.react};let S=h||b.ns||y.options&&y.options.defaultNS;S=Po(S)?[S]:S||["translation"];const E=VM(e,C),I=c||E||C.transEmptyNodeValue||o,{hashTransKey:T}=C,_=o||(T?T(E||I):E||I);y.options&&y.options.interpolation&&y.options.interpolation.defaultVariables&&(a=a&&Object.keys(a).length>0?{...a,...y.options.interpolation.defaultVariables}:{...y.options.interpolation.defaultVariables});const w=a||n!==void 0||!e?s.interpolation:{interpolation:{...s.interpolation,prefix:"#$?",suffix:"?$#"}},A={...s,context:i||s.context,count:n,...a,...w,defaultValue:I,ns:S},M=_?b(_,A):I;u&&Object.keys(u).forEach(V=>{const ie=u[V];if(typeof ie.type=="function"||!ie.props||!ie.props.children||M.indexOf(`${V}/>`)<0&&M.indexOf(`${V} />`)<0)return;function N(){return m.createElement(m.Fragment,null,ie)}u[V]=m.createElement(N)});const R=FB(u||e,M,y,C,A,g),$=r!==void 0?r:C.defaultTransParent;return $?m.createElement($,v,R):R}const HB={type:"3rdParty",init(t){LB(t.options.react),DB(t)}},$M=m.createContext();class zB{constructor(){W(this,"getUsedNamespaces",()=>Object.keys(this.usedNamespaces));this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}}function oo(t){let{children:e,count:n,parent:r,i18nKey:o,context:i,tOptions:s={},values:a,defaults:c,components:u,ns:h,i18n:p,t:f,shouldUnescape:g,...v}=t;const{i18n:y,defaultNS:b}=m.useContext($M)||{},C=p||y||pI(),S=f||C&&C.t.bind(C);return BB({children:e,count:n,parent:r,i18nKey:o,context:i,tOptions:s,values:a,defaults:c,components:u,ns:h||S&&S.ns||b||C&&C.options&&C.options.defaultNS,i18n:C,t:f,shouldUnescape:g,...v})}const VB=(t,e)=>{const n=m.useRef();return m.useEffect(()=>{n.current=t},[t,e]),n.current},GM=(t,e,n,r)=>t.getFixedT(e,n,r),$B=(t,e,n,r)=>m.useCallback(GM(t,e,n,r),[t,e,n,r]),Oe=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{i18n:n}=e,{i18n:r,defaultNS:o}=m.useContext($M)||{},i=n||r||pI();if(i&&!i.reportNamespaces&&(i.reportNamespaces=new zB),!i){bg("You will need to pass in an i18next instance by using initReactI18next");const I=(_,w)=>Po(w)?w:su(w)&&Po(w.defaultValue)?w.defaultValue:Array.isArray(_)?_[_.length-1]:_,T=[I,{},!1];return T.t=I,T.i18n={},T.ready=!1,T}i.options.react&&i.options.react.wait!==void 0&&bg("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const s={...HM(),...i.options.react,...e},{useSuspense:a,keyPrefix:c}=s;let u=t||o||i.options&&i.options.defaultNS;u=Po(u)?[u]:u||["translation"],i.reportNamespaces.addUsedNamespaces&&i.reportNamespaces.addUsedNamespaces(u);const h=(i.isInitialized||i.initializedStoreOnce)&&u.every(I=>RB(I,i,s)),p=$B(i,e.lng||null,s.nsMode==="fallback"?u:u[0],c),f=()=>p,g=()=>GM(i,e.lng||null,s.nsMode==="fallback"?u:u[0],c),[v,y]=m.useState(f);let b=u.join();e.lng&&(b=`${e.lng}${b}`);const C=VB(b),S=m.useRef(!0);m.useEffect(()=>{const{bindI18n:I,bindI18nStore:T}=s;S.current=!0,!h&&!a&&(e.lng?dk(i,e.lng,u,()=>{S.current&&y(g)}):uk(i,u,()=>{S.current&&y(g)})),h&&C&&C!==b&&S.current&&y(g);const _=()=>{S.current&&y(g)};return I&&i&&i.on(I,_),T&&i&&i.store.on(T,_),()=>{S.current=!1,I&&i&&I.split(" ").forEach(w=>i.off(w,_)),T&&i&&T.split(" ").forEach(w=>i.store.off(w,_))}},[i,b]),m.useEffect(()=>{S.current&&h&&y(f)},[i,c,h]);const E=[v,i,h];if(E.t=v,E.i18n=i,E.ready=h,h||!h&&!a)return E;throw new Promise(I=>{e.lng?dk(i,e.lng,u,()=>I()):uk(i,u,()=>I())})},KM=D([]),hk=new Map,Aa=t=>{let e=hk.get(t);return e||(e=D(n=>n(KM).includes(t)),hk.set(t,e),e)};function le(t){return L(Aa(t))}function We(t){return st().get(Aa(t))}function Fo(t){return L(Aa(t))}function zi(t){return st().get(Aa(t))}function mI(){return Fo("kill-domain-referrer")?"noopener noreferrer":"noopener"}function sa(t){const e=t.split("://");return e.length===1?`https://${t}`:e[0]==="http"?`https://${e[1]}`:t}function GB(t){return t==="."||t==="!"||t==="?"}function KB(t){return t===" "||t===`
`||t==="	"}function qB(t){let e=t.length-1;for(;e>=0&&KB(t[e]);)e-=1;return[t.slice(0,e+1),t.slice(e+1)]}function WB(t,e,n){return t.slice(0,n)+e+t.slice(n)}const YB="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-banner-Dtr5ysxQ.webp",QB="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-copied-popup-BRVm_KWU.webp",JB="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-engaging-popup-YSBImXns.webp",ZB="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-secondday-popup--nxha975.webp",XB="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-setting-TTFEOcbN.webp",eH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-think-deeper-popup-FHodYGgC.webp",tH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-thumbsup-card-DH3zTT3T.webp",nH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-thumbsup-popup-D7hBD_1Q.webp",rH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-desktop-discover-strip-DnlsnV3g.webp",oH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-desktop-setting-banner-CqsoJ8gk.webp",iH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-desktop-setting-menu-item-C25mGU_p.webp",sH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-banner-CKv2a8_f.webp",aH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-copied-popup-M4nhJM3H.webp",cH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-engaging-popup-B-vXLUhP.webp",lH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-secondday-popup-DBikSjcg.webp",uH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-setting-D2OBsvlS.webp",dH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-think-deeper-popup-D5tA7N2r.webp",hH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-thumbsup-card-CwLVOvcv.webp",fH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-thumbsup-popup-DM6aMFdv.webp",pH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-desktop-discover-strip-flsYDh7H.webp",mH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-desktop-setting-banner-C2lNCEe_.webp",gH="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-desktop-setting-menu-item-BzBe-XWV.webp",fk="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-shopping-Dm2se5Rq.png",vH={appLayout:{showSettings:!0,showCookieBanner:!0,showSettingsRelyOnChatDetailLayout:!0,showMobileCrossSelling:!0},surfaceQueryParam:null,showScrollbarOnHover:!1,dailyBriefingOcid:"cp_web_daily",persistThemeChoice:!0,entraRedirectModalBehaviour:"replace",redirectBackEnabled:!0,crossPromotion:{discoverStrip:{dark:rH,light:pH,fontSize:"m"},settingMenuItem:{dark:iH,light:gH},settingBanner:{dark:oH,light:mH},aggressive:{banner:{dark:YB,light:sH},setting:{dark:XB,light:uH},card:{thumbsUp:{dark:tH,light:hH}},popup:{secondDay:{dark:ZB,light:lH},thumbsUp:{dark:nH,light:fH},copied:{dark:QB,light:aH},engaging:{dark:JB,light:cH},thinkDeeper:{dark:eH,light:dH}}}},proSubscription:{enabled:!0,manageRefId:"cmc",urlParams:{client:"cmc",ocids:{ActionsLimit:{freeTrial:"cmmmcpyae96",buy:"cmm46gj0qnu"},VoiceLimit:{freeTrial:"cmm0ghcr8ka",buy:"cmmxki6wg02"},Settings:{freeTrial:"cmma4vbm2dq",buy:"cmmugsiwg58"},ChatReasoningLimit:{freeTrial:"cmmtjssvrv9",buy:"cmmzn5kdy9p"},MarketSelect:{freeTrial:"cmmxe0nad8b",buy:"cmmtbwi4652",market:"none"},RedirectFromAuth0Account:{freeTrial:"cmmxe0nad8b",buy:"cmmtbwi4652"},PodcastLimit:{buy:"cmmtzkwxk60"},ResearchReportLimit:{buy:"cmmoe57pdco"}}},upsellFromAuth0:{navigateToProSubPageAfterLogin:!0}},referralEnabled:!0,adsEnabled:!0,adsShowroomEnabled:!0,thinkDeeperFreemiumEnabled:!0,monitorAccountChangesAcrossTabs:!0,shopping:{upsell:{banner:{light:fk,dark:fk}}},sidebarNavigation:!0,showChatDetail:!0,enableAuth0:!0,settingsOverrides:{shouldShowActivityHistory:!0,shouldShowMemoryDelete:!0},enableCustom1DS:!0,actions:{enableActions:()=>Promise.resolve(!0)},landingPage:{enableLandingRoute:!0,enableCentralComposer:!0,enableStarterPrompts:!0,enableAutoSuggest:!0,enableWidgets:!0,enablePromptedGreetings:!0,shouldFetchWidgetsData:!0,regexForAutoSuggest:/\S+\s+/},supportsYouTubeVideos:!0,useMSALPwBApp:!0},tc=class tc{constructor(){W(this,"cfg",vH)}static instance(){return tc.singleton||(tc.singleton=new tc),tc.singleton}config(){return this.cfg}setConfig(e){this.cfg=e}};W(tc,"singleton",null);let be=tc;const bH=/^(?:(?:https?):\/\/)?(?:(?:[A-Za-z0-9](?:[A-Za-z0-9-]*[A-Za-z0-9])?\.))+[a-z]{2,}(?:\/[\w.-]*)*\/?(?:\?[^\s#]*)?(?:#[^\s]*)?$/,yH=/\b((https?:\/\/|www\.)?([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,})([/?#][\w\-._~:/?#@!$&'()*+,;=%]*)?(?=[\s<>()"'.,!?)}\]“”‘’《》「」『』【】]|$)/gi;function qM(t){return bH.test(t)}function CH(t){const[e,n]=qB(t),r=GB(e[e.length-1]),o=r?e.slice(0,-1):e;if(qM(o)){const i=r?e[e.length-1]:"";return{url:sa(o),word:o,suffix:`${i}${n}`}}return{word:t}}function Vu(t){let e="";try{e=new URL(t).hostname}catch{}return e}function SH(t,e,n){const{overwrite:r}=n??{};try{const o=new URL(t);for(const[i,s]of Object.entries(e))r&&o.searchParams.delete(i),o.searchParams.append(i,s);return o.toString()}catch{}return t}function $u(t){const{formCodeParamOnLinks:e}=be.instance().config();return e?SH(t,{form:e}):t}function EH(t){return t.replace(/[.,!?]+$/,"")}function IH(t,e){return!t||e<=0?!1:t[e-1]==="@"||/[\w.-]+@/.test(t.slice(Math.max(0,e-20),e+1))}function Ike(t){const e=[];if(!t)return e;for(const n of t.matchAll(yH)){const r=n[0],{index:o}=n;if(o<0||IH(t,o))continue;const i=EH(r),s=sa(i),a=o+i.length;e.push({url:s,from:o,to:a})}return e}const aa=m.forwardRef((t,e)=>{const{children:n,href:r,className:o,title:i,"aria-controls":s,"aria-expanded":a,"aria-haspopup":c,"aria-label":u,id:h,target:p,onClick:f,onPointerDown:g,onFocus:v}=t,y=mI();return d.jsx("a",{id:h,ref:e,"aria-controls":s,"aria-expanded":a,"aria-haspopup":c,"aria-label":u,className:o,title:i,href:r&&$u(r),target:p??"_blank",rel:y,onClick:f,onPointerDown:g,onFocus:v,children:n})});aa.displayName="Link";const TH="SN:ROOT",_H=m.createContext(null);function wH(){return m.useContext(_H)}const gI=m.createContext(TH);gI.displayName="FocusContext";function AH(){return m.useContext(gI)}function oh(){}function kH({focusable:t=!0,saveLastFocusedChild:e=!0,trackChildren:n=!1,autoRestoreFocus:r=!0,forceFocus:o=!1,isFocusBoundary:i=!1,focusBoundaryDirections:s,focusKey:a,preferredChildFocusKey:c,onEnterPress:u=oh,onEnterRelease:h=oh,onArrowPress:p=()=>!0,onArrowRelease:f=oh,onFocus:g=oh,onBlur:v=oh}){const y=wH(),b=m.useCallback(N=>{N&&u(N)},[u]),C=m.useCallback(()=>{h()},[h]),S=m.useCallback((N,Y)=>p(N,Y),[p]),E=m.useCallback(N=>{f(N)},[f]),I=m.useCallback((N,Y)=>{g(N,Y)},[g]),T=m.useCallback((N,Y)=>{v(N,Y)},[v]),_=m.useRef(null),[w,A]=m.useState(!1),[M,R]=m.useState(!1),$=AH(),V=m.useMemo(()=>y?a??crypto.randomUUID():void 0,[a,y]),ie=m.useCallback((N={})=>{V&&(y==null||y.setFocus(V,N))},[V,y]);return m.useEffect(()=>{const N=_.current;return N&&V&&(y==null||y.addFocusable({focusKey:V,node:N,parentFocusKey:$,preferredChildFocusKey:c,onEnterPress:b,onEnterRelease:C,onArrowPress:S,onArrowRelease:E,onFocus:I,onBlur:T,onUpdateFocus:(Y=!1)=>A(Y),onUpdateHasFocusedChild:(Y=!1)=>R(Y),saveLastFocusedChild:e,trackChildren:n,isFocusBoundary:i,focusBoundaryDirections:s,autoRestoreFocus:r,forceFocus:o,focusable:t})),()=>{V&&(y==null||y.removeFocusable({focusKey:V}))}},[]),m.useEffect(()=>{const N=_.current;N&&V&&(y==null||y.updateFocusable(V,{node:N,preferredChildFocusKey:c,focusable:t,isFocusBoundary:i,focusBoundaryDirections:s,onEnterPress:b,onEnterRelease:C,onArrowPress:S,onArrowRelease:E,onFocus:I,onBlur:T}))},[V,c,t,i,s,b,C,S,E,I,T,y]),{ref:_,focusSelf:ie,focused:w,hasFocusedChild:M,focusKey:V}}function gd(t,...e){const n=kH({onEnterPress:()=>{var o;(o=n.ref.current)==null||o.click()},onFocus:()=>{var o,i;(o=n.ref.current)==null||o.focus(),t.scrollIntoViewOnFocus&&((i=n.ref.current)==null||i.scrollIntoView({block:"nearest"}))},onBlur:()=>{var o;(o=n.ref.current)==null||o.blur()},...t}),r=xH(...e,n.ref);return{focusable:n,refCallback:r}}function xH(...t){return e=>{for(const n of t)n&&(typeof n=="function"?n(e):n.current=e)}}function WM(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(n=WM(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function q(){for(var t,e,n=0,r="",o=arguments.length;n<o;n++)(t=arguments[n])&&(e=WM(t))&&(r&&(r+=" "),r+=e);return r}const vI="-",RH=t=>{const e=PH(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:s=>{const a=s.split(vI);return a[0]===""&&a.length!==1&&a.shift(),YM(a,e)||NH(s)},getConflictingClassGroupIds:(s,a)=>{const c=n[s]||[];return a&&r[s]?[...c,...r[s]]:c}}},YM=(t,e)=>{var s;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),o=r?YM(t.slice(1),r):void 0;if(o)return o;if(e.validators.length===0)return;const i=t.join(vI);return(s=e.validators.find(({validator:a})=>a(i)))==null?void 0:s.classGroupId},pk=/^\[(.+)\]$/,NH=t=>{if(pk.test(t)){const e=pk.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},PH=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return OH(Object.entries(t.classGroups),n).forEach(([i,s])=>{O0(s,r,i,e)}),r},O0=(t,e,n,r)=>{t.forEach(o=>{if(typeof o=="string"){const i=o===""?e:mk(e,o);i.classGroupId=n;return}if(typeof o=="function"){if(MH(o)){O0(o(r),e,n,r);return}e.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([i,s])=>{O0(s,mk(e,i),n,r)})})},mk=(t,e)=>{let n=t;return e.split(vI).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},MH=t=>t.isThemeGetter,OH=(t,e)=>e?t.map(([n,r])=>{const o=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([s,a])=>[e+s,a])):i);return[n,o]}):t,LH=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const o=(i,s)=>{n.set(i,s),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let s=n.get(i);if(s!==void 0)return s;if((s=r.get(i))!==void 0)return o(i,s),s},set(i,s){n.has(i)?n.set(i,s):o(i,s)}}},QM="!",DH=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,o=e[0],i=e.length,s=a=>{const c=[];let u=0,h=0,p;for(let b=0;b<a.length;b++){let C=a[b];if(u===0){if(C===o&&(r||a.slice(b,b+i)===e)){c.push(a.slice(h,b)),h=b+i;continue}if(C==="/"){p=b;continue}}C==="["?u++:C==="]"&&u--}const f=c.length===0?a:a.substring(h),g=f.startsWith(QM),v=g?f.substring(1):f,y=p&&p>h?p-h:void 0;return{modifiers:c,hasImportantModifier:g,baseClassName:v,maybePostfixModifierPosition:y}};return n?a=>n({className:a,parseClassName:s}):s},jH=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},UH=t=>({cache:LH(t.cacheSize),parseClassName:DH(t),...RH(t)}),FH=/\s+/,BH=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o}=e,i=[],s=t.trim().split(FH);let a="";for(let c=s.length-1;c>=0;c-=1){const u=s[c],{modifiers:h,hasImportantModifier:p,baseClassName:f,maybePostfixModifierPosition:g}=n(u);let v=!!g,y=r(v?f.substring(0,g):f);if(!y){if(!v){a=u+(a.length>0?" "+a:a);continue}if(y=r(f),!y){a=u+(a.length>0?" "+a:a);continue}v=!1}const b=jH(h).join(":"),C=p?b+QM:b,S=C+y;if(i.includes(S))continue;i.push(S);const E=o(y,v);for(let I=0;I<E.length;++I){const T=E[I];i.push(C+T)}a=u+(a.length>0?" "+a:a)}return a};function HH(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=JM(e))&&(r&&(r+=" "),r+=n);return r}const JM=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=JM(t[r]))&&(n&&(n+=" "),n+=e);return n};function zH(t,...e){let n,r,o,i=s;function s(c){const u=e.reduce((h,p)=>p(h),t());return n=UH(u),r=n.cache.get,o=n.cache.set,i=a,a(c)}function a(c){const u=r(c);if(u)return u;const h=BH(c,n);return o(c,h),h}return function(){return i(HH.apply(null,arguments))}}const un=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},ZM=/^\[(?:([a-z-]+):)?(.+)\]$/i,VH=/^\d+\/\d+$/,$H=new Set(["px","full","screen"]),GH=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,KH=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,qH=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,WH=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,YH=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,rs=t=>Su(t)||$H.has(t)||VH.test(t),Us=t=>vd(t,"length",rz),Su=t=>!!t&&!Number.isNaN(Number(t)),dC=t=>vd(t,"number",Su),ih=t=>!!t&&Number.isInteger(Number(t)),QH=t=>t.endsWith("%")&&Su(t.slice(0,-1)),bt=t=>ZM.test(t),Fs=t=>GH.test(t),JH=new Set(["length","size","percentage"]),ZH=t=>vd(t,JH,XM),XH=t=>vd(t,"position",XM),ez=new Set(["image","url"]),tz=t=>vd(t,ez,iz),nz=t=>vd(t,"",oz),sh=()=>!0,vd=(t,e,n)=>{const r=ZM.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},rz=t=>KH.test(t)&&!qH.test(t),XM=()=>!1,oz=t=>WH.test(t),iz=t=>YH.test(t),sz=()=>{const t=un("colors"),e=un("spacing"),n=un("blur"),r=un("brightness"),o=un("borderColor"),i=un("borderRadius"),s=un("borderSpacing"),a=un("borderWidth"),c=un("contrast"),u=un("grayscale"),h=un("hueRotate"),p=un("invert"),f=un("gap"),g=un("gradientColorStops"),v=un("gradientColorStopPositions"),y=un("inset"),b=un("margin"),C=un("opacity"),S=un("padding"),E=un("saturate"),I=un("scale"),T=un("sepia"),_=un("skew"),w=un("space"),A=un("translate"),M=()=>["auto","contain","none"],R=()=>["auto","hidden","clip","visible","scroll"],$=()=>["auto",bt,e],V=()=>[bt,e],ie=()=>["",rs,Us],N=()=>["auto",Su,bt],Y=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ue=()=>["solid","dashed","dotted","double","none"],j=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],U=()=>["start","end","center","between","around","evenly","stretch"],te=()=>["","0",bt],Q=()=>["auto","avoid","all","avoid-page","page","left","right","column"],re=()=>[Su,bt];return{cacheSize:500,separator:":",theme:{colors:[sh],spacing:[rs,Us],blur:["none","",Fs,bt],brightness:re(),borderColor:[t],borderRadius:["none","","full",Fs,bt],borderSpacing:V(),borderWidth:ie(),contrast:re(),grayscale:te(),hueRotate:re(),invert:te(),gap:V(),gradientColorStops:[t],gradientColorStopPositions:[QH,Us],inset:$(),margin:$(),opacity:re(),padding:V(),saturate:re(),scale:re(),sepia:te(),skew:re(),space:V(),translate:V()},classGroups:{aspect:[{aspect:["auto","square","video",bt]}],container:["container"],columns:[{columns:[Fs]}],"break-after":[{"break-after":Q()}],"break-before":[{"break-before":Q()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Y(),bt]}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:M()}],"overscroll-x":[{"overscroll-x":M()}],"overscroll-y":[{"overscroll-y":M()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ih,bt]}],basis:[{basis:$()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",bt]}],grow:[{grow:te()}],shrink:[{shrink:te()}],order:[{order:["first","last","none",ih,bt]}],"grid-cols":[{"grid-cols":[sh]}],"col-start-end":[{col:["auto",{span:["full",ih,bt]},bt]}],"col-start":[{"col-start":N()}],"col-end":[{"col-end":N()}],"grid-rows":[{"grid-rows":[sh]}],"row-start-end":[{row:["auto",{span:[ih,bt]},bt]}],"row-start":[{"row-start":N()}],"row-end":[{"row-end":N()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",bt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",bt]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...U()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...U(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...U(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[S]}],px:[{px:[S]}],py:[{py:[S]}],ps:[{ps:[S]}],pe:[{pe:[S]}],pt:[{pt:[S]}],pr:[{pr:[S]}],pb:[{pb:[S]}],pl:[{pl:[S]}],m:[{m:[b]}],mx:[{mx:[b]}],my:[{my:[b]}],ms:[{ms:[b]}],me:[{me:[b]}],mt:[{mt:[b]}],mr:[{mr:[b]}],mb:[{mb:[b]}],ml:[{ml:[b]}],"space-x":[{"space-x":[w]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[w]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",bt,e]}],"min-w":[{"min-w":[bt,e,"min","max","fit"]}],"max-w":[{"max-w":[bt,e,"none","full","min","max","fit","prose",{screen:[Fs]},Fs]}],h:[{h:[bt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[bt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[bt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[bt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Fs,Us]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",dC]}],"font-family":[{font:[sh]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",bt]}],"line-clamp":[{"line-clamp":["none",Su,dC]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",rs,bt]}],"list-image":[{"list-image":["none",bt]}],"list-style-type":[{list:["none","disc","decimal",bt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[C]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[C]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ue(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",rs,Us]}],"underline-offset":[{"underline-offset":["auto",rs,bt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:V()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",bt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",bt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[C]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Y(),XH]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ZH]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},tz]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[g]}],"gradient-via":[{via:[g]}],"gradient-to":[{to:[g]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[C]}],"border-style":[{border:[...ue(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[C]}],"divide-style":[{divide:ue()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...ue()]}],"outline-offset":[{"outline-offset":[rs,bt]}],"outline-w":[{outline:[rs,Us]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:ie()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[C]}],"ring-offset-w":[{"ring-offset":[rs,Us]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Fs,nz]}],"shadow-color":[{shadow:[sh]}],opacity:[{opacity:[C]}],"mix-blend":[{"mix-blend":[...j(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":j()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Fs,bt]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[p]}],saturate:[{saturate:[E]}],sepia:[{sepia:[T]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[p]}],"backdrop-opacity":[{"backdrop-opacity":[C]}],"backdrop-saturate":[{"backdrop-saturate":[E]}],"backdrop-sepia":[{"backdrop-sepia":[T]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",bt]}],duration:[{duration:re()}],ease:[{ease:["linear","in","out","in-out",bt]}],delay:[{delay:re()}],animate:[{animate:["none","spin","ping","pulse","bounce",bt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[I]}],"scale-x":[{"scale-x":[I]}],"scale-y":[{"scale-y":[I]}],rotate:[{rotate:[ih,bt]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",bt]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",bt]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":V()}],"scroll-mx":[{"scroll-mx":V()}],"scroll-my":[{"scroll-my":V()}],"scroll-ms":[{"scroll-ms":V()}],"scroll-me":[{"scroll-me":V()}],"scroll-mt":[{"scroll-mt":V()}],"scroll-mr":[{"scroll-mr":V()}],"scroll-mb":[{"scroll-mb":V()}],"scroll-ml":[{"scroll-ml":V()}],"scroll-p":[{"scroll-p":V()}],"scroll-px":[{"scroll-px":V()}],"scroll-py":[{"scroll-py":V()}],"scroll-ps":[{"scroll-ps":V()}],"scroll-pe":[{"scroll-pe":V()}],"scroll-pt":[{"scroll-pt":V()}],"scroll-pr":[{"scroll-pr":V()}],"scroll-pb":[{"scroll-pb":V()}],"scroll-pl":[{"scroll-pl":V()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",bt]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[rs,Us,dC]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},az=zH(sz);function nt(...t){return az(q(t))}const np="overflow-hidden",Rs="backdrop-blur-2xl backdrop-saturate-200",bI="bg-white/70 dark:bg-slate-800/70",Ji=q(np,Rs,bI),cz=q(np,Rs),lz=q(Rs,bI),uz="bg-acrylic-default-fallback-light/[98] dark:bg-acrylic-default-fallback-dark/[98]",dz="dark:bg-white/70  bg-slate-800/70",hz=q(np,Rs,dz);q(Rs,bI);const eO="bg-accent-100/60 dark:bg-slate-800/50",fz=q(Rs,eO),ra=q(np,Rs,eO),pz="bg-acrylic-thin-fallback-light/95 dark:bg-acrylic-thin-fallback-dark/[92]",tO="dark:bg-accent-900/60 bg-slate-800/50";q(Rs,tO);const mz=q(np,Rs,tO),mf="relative flex items-center",qo="text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650",gk="text-slate-200 fill-slate-200 active:text-slate-300 active:fill-slate-300 dark:text-stone-800 dark:fill-stone-800 dark:active:text-stone-600 dark:active:fill-stone-600",gz="text-foreground-250 fill-foreground-250 active:text-foreground-350 active:fill-foreground-350 dark:text-foreground-750 dark:fill-foreground-750 dark:active:text-foreground-650 dark:active:fill-foreground-650",vz="text-accent-550 fill-accent-550 active:text-accent-450/80 active:fill-accent-450/80 dark:text-accent-850 dark:fill-accent-850 dark:active:text-accent-700 dark:active:fill-accent-700",Wp="shadow-button-light dark:shadow-button-dark",vk="dark:shadow-button-light shadow-button-dark",bz="shadow-button-strong-light dark:shadow-button-dark",yz="text-cocoa-550 safe-hover:text-caramel-450 dark:text-slate-300 dark:active:text-slate-200",Cz="bg-white/70 safe-hover:bg-caramel-200 active:bg-caramel-200/20 dark:bg-slate-450/30 dark:safe-hover:bg-midnight-800 dark:active:bg-midnight-800/20",Sz="border-[0.5px] border-transparent safe-hover:border-caramel-400 dark:safe-hover:border-midnight-350",Ez="text-caramel-600 fill-caramel-600 active:text-caramel-400 active:fill-caramel-400 dark:text-slate-200 dark:fill-text-slate-200 dark:active:text-slate-100 dark:active:fill-slate-100",Iz="bg-caramel-200 safe-hover:bg-caramel-300 active:bg-caramel-300 dark:bg-slate-650 dark:safe-hover:bg-slate-400 dark:active:bg-slate-400",hC="bg-transparent safe-hover:bg-white/50 active:bg-white/35 dark:safe-hover:bg-black/30 dark:active:bg-black/20",Ic={default:`${qo} ${Wp} bg-white/70 safe-hover:bg-white active:bg-white/60 dark:bg-slate-450/30 dark:safe-hover:bg-slate-450/40 dark:active:bg-slate-450/20`,strong:`${gz} ${bz} bg-stone-800 safe-hover:bg-black active:bg-stone-750 dark:bg-slate-600 dark:safe-hover:bg-slate-550 dark:active:bg-slate-600/80`,accent:`${vz} bg-accent-250 safe-hover:bg-accent-300 active:bg-accent-200 dark:bg-accent-550 dark:safe-hover:bg-accent-450 dark:active:bg-accent-600/80`,"overlay-bright":`${qo} bg-white/40 safe-hover:bg-white/70 active:bg-white/30 dark:bg-white/8 dark:safe-hover:bg-white/10 dark:active:bg-white/5`,"overlay-bright-inverted":`${qo} bg-white/40 safe-hover:bg-white/70 active:bg-white/30 dark:bg-black/35 dark:safe-hover:bg-black/60 dark:active:bg-black/25`,"overlay-dimmed":`${qo} bg-black/8 safe-hover:bg-black/10 active:bg-black/5 dark:bg-black/35 dark:safe-hover:bg-black/60 dark:active:bg-black/25`,"overlay-dimmed-inverted":`${qo} bg-black/8 safe-hover:bg-black/10 active:bg-black/5 dark:bg-white/8 dark:safe-hover:bg-white/10 dark:active:bg-white/5`,"subtle-bright":`${qo} bg-transparent safe-hover:bg-white/50 active:bg-white/35 dark:safe-hover:bg-white/8 dark:active:bg-white/5`,"subtle-bright-inverted":`${qo} ${hC}`,"subtle-dimmed":`${qo} bg-transparent safe-hover:bg-black/5 active:bg-black/3 dark:safe-hover:bg-black/30 dark:active:bg-black/20`,"subtle-dimmed-inverted":`${qo} bg-transparent safe-hover:bg-black/5 active:bg-black/3 dark:safe-hover:bg-white/8 dark:active:bg-white/5`,acrylic:`${qo} ${Wp} ${hC}`,"acrylic-inverted":`${gk} ${vk} bg-transparent dark:safe-hover:bg-white/50 dark:active:bg-white/35 safe-hover:bg-black/30 active:bg-black/20`,"acrylic-thin":`${qo} ${Wp} ${hC}`,"acrylic-thin-inverted":`${gk} ${vk} bg-transparent dark:safe-hover:bg-white/50 dark:active:bg-white/35 safe-hover:bg-black/30 active:bg-black/20`,chip:`${yz} ${Cz} ${Wp} ${Sz}`,alert:"bg-system-red-600 safe-hover:bg-system-red-650 active:bg-system-red-550","composer-selected":`${Ez} ${Iz}`},nO={acrylic:`${Ji}`,"acrylic-inverted":`${hz}`,"acrylic-thin":`${ra}`,"acrylic-thin-inverted":`${mz}`};function Tz(t){return t in nO}const _z={start:"justify-start",center:"justify-center",end:"justify-end"},yI={"28-xxs":"text-xs","32-xs":"text-xs","36-sm":"text-xs","40-base":"text-sm","48-lg":"text-base","56-xl":"text-base","64-xxl":"text-base"},Ws={"28-xxs":"gap-x-1.5","32-xs":"gap-x-1.5","36-sm":"gap-x-1.5","40-base":"gap-x-2","48-lg":"gap-x-3","56-xl":"gap-x-3","64-xxl":"gap-x-3"},CI={"28-xxs":`min-h-7 min-w-8 px-3 py-1 ${Ws["28-xxs"]}`,"32-xs":`min-h-8 min-w-8 px-2.5 py-1 ${Ws["32-xs"]}`,"36-sm":`min-h-9 min-w-9 px-2.5 py-1 ${Ws["36-sm"]}`,"40-base":`min-h-10 min-w-10 px-3 py-2 ${Ws["40-base"]}`,"48-lg":`min-h-12 min-w-12 px-3 py-2.5 ${Ws["48-lg"]}`,"56-xl":`min-h-14 min-w-14 px-4 py-3.5 ${Ws["56-xl"]}`,"64-xxl":`min-h-16 min-w-16 p-4 ${Ws["64-xxl"]}`},wz={"28-xxs":"size-7","32-xs":"size-8","36-sm":"size-9","40-base":"size-10","48-lg":"size-12","56-xl":"size-14","64-xxl":"size-16"},L0={"28-xxs":"rounded-lg before:rounded-lg","32-xs":"rounded-lg before:rounded-lg","36-sm":"rounded-xl before:rounded-xl","40-base":"rounded-xl before:rounded-xl","48-lg":"rounded-3xl before:rounded-3xl","56-xl":"rounded-4xl before:rounded-4xl","64-xxl":"rounded-4xl before:rounded-4xl"},Az={none:"",regular:"border border-solid border-stone-350 dark:border-slate-600",strong:"border border-solid border-2 border-stroke-750"},bk="rounded-full before:rounded-full",kz="opacity-40 pointer-events-none",tb="before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900",Me=m.forwardRef((t,e)=>{const{children:n,onClick:r,onFocus:o,onBlur:i,onKeyDown:s,onKeyUp:a,onMouseEnter:c,onMouseLeave:u,href:h,className:p,title:f,variant:g="rect",alignment:v="center",color:y="default",outline:b="none",size:C="40-base",disabled:S,id:E,role:I,testId:T,spatialNavigationAutofocus:_=!1,"aria-controls":w,"aria-expanded":A,"aria-haspopup":M,"aria-pressed":R,"aria-label":$,"aria-selected":V,onPointerDown:ie}=t,N=g==="circle"||g==="square",Y=g==="circle"||g==="pill",ue=nt(mf,Ic[y],yI[C],_z[v],N?wz[C]:CI[C],Y?bk:L0[C],tb,S&&kz,Az[b],p);let j=n;if(Tz(y)){const Q=nt(nO[y],Y?bk:L0[C]);j=d.jsxs(d.Fragment,{children:[d.jsx("div",{className:nt("absolute inset-0",Q)}),d.jsx("div",{className:`relative ${mf} ${Ws[C]}`,children:n})]})}const{refCallback:U,focusable:te}=gd({autoRestoreFocus:!0,forceFocus:!0},e);return h!==void 0?d.jsx(aa,{id:E,onPointerDown:ie,"aria-controls":w,"aria-expanded":A,"aria-haspopup":M,href:h,ref:te.ref,onClick:r,title:f,className:ue,"data-testid":T,"aria-label":$,"aria-selected":V,children:j}):d.jsx("button",{onPointerDown:ie,ref:U,id:E,"aria-controls":w,"aria-expanded":A,"aria-haspopup":M,"aria-pressed":R,"aria-selected":V,type:"button",className:ue,title:f,role:I,disabled:S,onClick:r,onFocus:o,onBlur:i,onKeyDown:s,onKeyUp:a,onMouseEnter:c,onMouseLeave:u,"data-testid":T,"data-spatial-navigation-autofocus":_,"aria-label":$,"data-spatial-focus-key":te.focusKey,children:j})});Me.displayName="Button";function xz({reason:t,onReload:e}){const{t:n}=Oe();return d.jsxs(d.Fragment,{children:[d.jsx("h1",{className:"pb-3 text-lg",children:n("authentication.accountChanged")}),d.jsx("p",{className:"pb-7",children:n(t==="login"?"authentication.signedInOtherTab":"authentication.signedOutOtherTab")}),d.jsx(Me,{onClick:e,title:n("authentication.reloadToContinue"),variant:"pill",size:"48-lg",className:"w-full",children:n("authentication.reloadToContinue")})]})}const SI=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",...t},m.createElement("path",{fill:"currentColor",d:"M15.144 5.885c.62-.777 1.042-1.82.931-2.885-.909.045-2.018.6-2.66 1.377-.576.665-1.087 1.752-.954 2.772 1.02.089 2.04-.51 2.683-1.264ZM16.064 7.349c-1.482-.089-2.742.84-3.45.84-.707 0-1.79-.796-2.963-.774-1.525.022-2.94.884-3.714 2.256-1.592 2.744-.42 6.814 1.128 9.049.752 1.105 1.658 2.323 2.852 2.279 1.128-.044 1.57-.73 2.94-.73 1.371 0 1.77.73 2.963.708 1.238-.022 2.013-1.106 2.764-2.213.863-1.26 1.216-2.477 1.238-2.544-.022-.022-2.388-.93-2.41-3.65-.022-2.28 1.858-3.363 1.946-3.43-1.061-1.57-2.72-1.747-3.294-1.791Z"})),Tke=Object.freeze(Object.defineProperty({__proto__:null,default:SI},Symbol.toStringTag,{value:"Module"})),EI=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 25 24",...t},m.createElement("g",{clipPath:"url(#a)"},m.createElement("path",{fill:"#4285F4",d:"M20.5 12.2a8 8 0 0 0-.2-1.8h-8.1v3.3H17c-.1.8-.7 2-1.8 3l2.5 2 .2.1a9 9 0 0 0 2.6-6.6Z"}),m.createElement("path",{fill:"#34A853",d:"M12.2 21c2.3 0 4.3-.8 5.7-2.2l-2.7-2.2a5.2 5.2 0 0 1-8-2.8l-2.7 2.1v.1c1.4 3 4.3 5 7.7 5Z"}),m.createElement("path",{fill:"#FBBC05",d:"M7.2 13.8a5.7 5.7 0 0 1 0-3.6L4.5 7.8a9.2 9.2 0 0 0 0 8.1l2.7-2.2Z"}),m.createElement("path",{fill:"#EB4335",d:"M12.2 6.5c1.6 0 2.7.7 3.3 1.3L18 5.4A8.2 8.2 0 0 0 12.2 3C8.8 3 5.9 5 4.4 8l2.8 2.2a5.3 5.3 0 0 1 5-3.7Z"})),m.createElement("defs",null,m.createElement("clipPath",{id:"a"},m.createElement("path",{fill:"#fff",d:"M3.5 3h17v18h-17z"})))),_ke=Object.freeze(Object.defineProperty({__proto__:null,default:EI},Symbol.toStringTag,{value:"Module"})),nb=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 25 24",...t},m.createElement("path",{fill:"#F25022",d:"M12.05 3H3.5v8.55h8.55V3Z"}),m.createElement("path",{fill:"#7FBA00",d:"M21.5 3h-8.55v8.55h8.55V3Z"}),m.createElement("path",{fill:"#00A4EF",d:"M12.05 12.45H3.5V21h8.55v-8.55Z"}),m.createElement("path",{fill:"#FFB900",d:"M21.5 12.45h-8.55V21h8.55v-8.55Z"})),wke=Object.freeze(Object.defineProperty({__proto__:null,default:nb},Symbol.toStringTag,{value:"Module"})),rO="140e65af-45d1-4427-bf08-3e7295db6836/ChatAI.ReadWrite",yk={auth:{clientId:"14638111-3389-403d-b206-a6a71d9f8f16",authority:"https://login.microsoftonline.com/common",navigateToLoginRequestUrl:!1},system:{allowNativeBroker:!1},cache:{cacheLocation:"localStorage"}},II={scopes:[rO],extraQueryParameters:{lw:"1",coa:"1",nopa:"2",fl:"easi2_nowld",cobrandid:"8c0b039e-5a73-4399-9b56-7e237be2cd06"},prompt:"select_account",redirectUri:typeof window<"u"?window.location.origin:void 0},Rz={scopes:[rO],prompt:"none",authority:"https://login.microsoftonline.com/consumers",redirectUri:typeof window<"u"?window.location.origin:void 0},Ck={scopes:["User.Read"]},Nz={scopes:["OneDrive.ReadWrite"],authority:"https://login.microsoftonline.com/consumers"},TI={graphMeApiSuffix:"/me",graphMeImageApiSuffix:"/me/photo/$value",graphMeLicenseDetails:"/me/licenseDetails"},Sk={appName:"copilot_studio",enableMATS:!0,appVersion:"0.0.0"},Pz="IalDS3vRtEI5X0zvsmGG7zJP9UrHTcei",Mz="auth.copilot.microsoft.com",oO="https://copilot.microsoft.com",Oz={clientId:Pz,domain:Mz,cacheLocation:"localstorage",useRefreshTokens:!0,useRefreshTokensFallback:!0},iO="openid profile email offline_access ChatAI.ReadWrite",sO=typeof window<"u"?window.location.origin:void 0,gf={authorizationParams:{audience:oO,scope:iO,redirect_uri:sO}},Lz={authorizationParams:{audience:oO,scope:iO,redirect_uri:sO,prompt:"select_account"}},D0="cp-pro";function Dz(t){switch(t){case"login":return II;case"graph":return Ck;case"oneDrive":return Nz;default:return Ck}}const jz={actAsBroker:!0,preferredInteractionType:"redirect"};function Qc(){return!!be.instance().config().enableAuth0}var rb=QF();const oa=()=>{},mn=oa(),fC=Object,Fe=t=>t===mn,Tr=t=>typeof t=="function",ho=(t,e)=>({...t,...e}),Uz=t=>Tr(t.then),Yp=new WeakMap;let Fz=0;const vf=t=>{const e=typeof t,n=t&&t.constructor,r=n==Date;let o,i;if(fC(t)===t&&!r&&n!=RegExp){if(o=Yp.get(t),o)return o;if(o=++Fz+"~",Yp.set(t,o),n==Array){for(o="@",i=0;i<t.length;i++)o+=vf(t[i])+",";Yp.set(t,o)}if(n==fC){o="#";const s=fC.keys(t).sort();for(;!Fe(i=s.pop());)Fe(t[i])||(o+=i+":"+vf(t[i])+",");Yp.set(t,o)}}else o=r?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return o},ko=new WeakMap,pC={},Qp={},_I="undefined",ob=typeof window!=_I,j0=typeof document!=_I,Bz=()=>ob&&typeof window.requestAnimationFrame!=_I,xi=(t,e)=>{const n=ko.get(t);return[()=>!Fe(e)&&t.get(e)||pC,r=>{if(!Fe(e)){const o=t.get(e);e in Qp||(Qp[e]=o),n[5](e,ho(o,r),o||pC)}},n[6],()=>!Fe(e)&&e in Qp?Qp[e]:!Fe(e)&&t.get(e)||pC]};let U0=!0;const Hz=()=>U0,[F0,B0]=ob&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[oa,oa],zz=()=>{const t=j0&&document.visibilityState;return Fe(t)||t!=="hidden"},Vz=t=>(j0&&document.addEventListener("visibilitychange",t),F0("focus",t),()=>{j0&&document.removeEventListener("visibilitychange",t),B0("focus",t)}),$z=t=>{const e=()=>{U0=!0,t()},n=()=>{U0=!1};return F0("online",e),F0("offline",n),()=>{B0("online",e),B0("offline",n)}},Gz={isOnline:Hz,isVisible:zz},Kz={initFocus:Vz,initReconnect:$z},Tc=!Yc.useId,Ss=!ob||"Deno"in window,wI=t=>Bz()?window.requestAnimationFrame(t):setTimeout(t,1),Mo=Ss?m.useEffect:m.useLayoutEffect,mC=typeof navigator<"u"&&navigator.connection,Ek=!Ss&&mC&&(["slow-2g","2g"].includes(mC.effectiveType)||mC.saveData),Es=t=>{if(Tr(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?vf(t):"",[t,e]};let qz=0;const _c=()=>++qz,aO=0,cO=1,lO=2,Wz=3;var _r={__proto__:null,ERROR_REVALIDATE_EVENT:Wz,FOCUS_EVENT:aO,MUTATE_EVENT:lO,RECONNECT_EVENT:cO};async function ib(...t){const[e,n,r,o]=t,i=ho({populateCache:!0,throwOnError:!0},typeof o=="boolean"?{revalidate:o}:o||{});let s=i.populateCache;const a=i.rollbackOnError;let c=i.optimisticData;const u=f=>typeof a=="function"?a(f):a!==!1,h=i.throwOnError;if(Tr(n)){const f=n,g=[],v=e.keys();for(const y of v)!/^\$(inf|sub)\$/.test(y)&&f(e.get(y)._k)&&g.push(y);return Promise.all(g.map(p))}return p(n);async function p(f){const[g]=Es(f);if(!g)return;const[v,y]=xi(e,g),[b,C,S,E]=ko.get(e),I=()=>{const ie=b[g];return(Tr(i.revalidate)?i.revalidate(v().data,f):i.revalidate!==!1)&&(delete S[g],delete E[g],ie&&ie[0])?ie[0](lO).then(()=>v().data):v().data};if(t.length<3)return I();let T=r,_;const w=_c();C[g]=[w,0];const A=!Fe(c),M=v(),R=M.data,$=M._c,V=Fe($)?R:$;if(A&&(c=Tr(c)?c(V,R):c,y({data:c,_c:V})),Tr(T))try{T=T(V)}catch(ie){_=ie}if(T&&Uz(T))if(T=await T.catch(ie=>{_=ie}),w!==C[g][0]){if(_)throw _;return T}else _&&A&&u(_)&&(s=!0,y({data:V,_c:mn}));if(s&&!_)if(Tr(s)){const ie=s(T,V);y({data:ie,error:mn,_c:mn})}else y({data:T,error:mn,_c:mn});if(C[g][1]=_c(),Promise.resolve(I()).then(()=>{y({_c:mn})}),_){if(h)throw _;return}return T}}const Ik=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},Yz=(t,e)=>{if(!ko.has(t)){const n=ho(Kz,e),r={},o=ib.bind(mn,t);let i=oa;const s={},a=(h,p)=>{const f=s[h]||[];return s[h]=f,f.push(p),()=>f.splice(f.indexOf(p),1)},c=(h,p,f)=>{t.set(h,p);const g=s[h];if(g)for(const v of g)v(p,f)},u=()=>{if(!ko.has(t)&&(ko.set(t,[r,{},{},{},o,c,a]),!Ss)){const h=n.initFocus(setTimeout.bind(mn,Ik.bind(mn,r,aO))),p=n.initReconnect(setTimeout.bind(mn,Ik.bind(mn,r,cO)));i=()=>{h&&h(),p&&p(),ko.delete(t)}}};return u(),[t,o,u,i]}return[t,ko.get(t)[4]]},Qz=(t,e,n,r,o)=>{const i=n.errorRetryCount,s=o.retryCount,a=~~((Math.random()+.5)*(1<<(s<8?s:8)))*n.errorRetryInterval;!Fe(i)&&s>i||setTimeout(r,a,o)},Jz=(t,e)=>vf(t)==vf(e),[AI,Zz]=Yz(new Map),Xz=ho({onLoadingSlow:oa,onSuccess:oa,onError:oa,onErrorRetry:Qz,onDiscarded:oa,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Ek?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Ek?5e3:3e3,compare:Jz,isPaused:()=>!1,cache:AI,mutate:Zz,fallback:{}},Gz),eV=(t,e)=>{const n=ho(t,e);if(e){const{use:r,fallback:o}=t,{use:i,fallback:s}=e;r&&i&&(n.use=r.concat(i)),o&&s&&(n.fallback=ho(o,s))}return n},tV=m.createContext({}),uO="$inf$",dO=ob&&window.__SWR_DEVTOOLS_USE__,nV=dO?window.__SWR_DEVTOOLS_USE__:[],rV=()=>{dO&&(window.__SWR_DEVTOOLS_REACT__=Yc)},hO=t=>Tr(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],kI=()=>ho(Xz,m.useContext(tV)),oV=t=>(e,n,r)=>t(e,n&&((...i)=>{const[s]=Es(e),[,,,a]=ko.get(AI);if(s.startsWith(uO))return n(...i);const c=a[s];return Fe(c)?n(...i):(delete a[s],c)}),r),iV=nV.concat(oV),xI=t=>function(...n){const r=kI(),[o,i,s]=hO(n),a=eV(r,s);let c=t;const{use:u}=a,h=(u||[]).concat(iV);for(let p=h.length;p--;)c=h[p](c);return c(o,i||a.fetcher||null,a)},RI=(t,e,n)=>{const r=e[t]||(e[t]=[]);return r.push(n),()=>{const o=r.indexOf(n);o>=0&&(r[o]=r[r.length-1],r.pop())}},fO=(t,e)=>(...n)=>{const[r,o,i]=hO(n),s=(i.use||[]).concat(e);return t(r,o,{...i,use:s})};rV();const Tk=Yc.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)}),gC={dedupe:!0},sV=(t,e,n)=>{const{cache:r,compare:o,suspense:i,fallbackData:s,revalidateOnMount:a,revalidateIfStale:c,refreshInterval:u,refreshWhenHidden:h,refreshWhenOffline:p,keepPreviousData:f}=n,[g,v,y,b]=ko.get(r),[C,S]=Es(t),E=m.useRef(!1),I=m.useRef(!1),T=m.useRef(C),_=m.useRef(e),w=m.useRef(n),A=()=>w.current,M=()=>A().isVisible()&&A().isOnline(),[R,$,V,ie]=xi(r,C),N=m.useRef({}).current,Y=Fe(s)?n.fallback[C]:s,ue=(P,J)=>{for(const Te in N){const O=Te;if(O==="data"){if(!o(P[O],J[O])&&(!Fe(P[O])||!o(Se,J[O])))return!1}else if(J[O]!==P[O])return!1}return!0},j=m.useMemo(()=>{const P=!C||!e?!1:Fe(a)?A().isPaused()||i?!1:Fe(c)?!0:c:a,J=K=>{const pe=ho(K);return delete pe._k,P?{isValidating:!0,isLoading:!0,...pe}:pe},Te=R(),O=ie(),ce=J(Te),se=Te===O?ce:J(O);let ne=ce;return[()=>{const K=J(R());return ue(K,ne)?(ne.data=K.data,ne.isLoading=K.isLoading,ne.isValidating=K.isValidating,ne.error=K.error,ne):(ne=K,K)},()=>se]},[r,C]),U=rb.useSyncExternalStore(m.useCallback(P=>V(C,(J,Te)=>{ue(Te,J)||P()}),[r,C]),j[0],j[1]),te=!E.current,Q=g[C]&&g[C].length>0,re=U.data,Z=Fe(re)?Y:re,_e=U.error,ye=m.useRef(Z),Se=f?Fe(re)?ye.current:re:Z,Ne=Q&&!Fe(_e)?!1:te&&!Fe(a)?a:A().isPaused()?!1:i?Fe(Z)?!1:c:Fe(Z)||c,we=!!(C&&e&&te&&Ne),Ke=Fe(U.isValidating)?we:U.isValidating,de=Fe(U.isLoading)?we:U.isLoading,ge=m.useCallback(async P=>{const J=_.current;if(!C||!J||I.current||A().isPaused())return!1;let Te,O,ce=!0;const se=P||{},ne=!y[C]||!se.dedupe,K=()=>Tc?!I.current&&C===T.current&&E.current:C===T.current,pe={isValidating:!1,isLoading:!1},He=()=>{$(pe)},at=()=>{const Le=y[C];Le&&Le[1]===O&&delete y[C]},ut={isValidating:!0};Fe(R().data)&&(ut.isLoading=!0);try{if(ne&&($(ut),n.loadingTimeout&&Fe(R().data)&&setTimeout(()=>{ce&&K()&&A().onLoadingSlow(C,n)},n.loadingTimeout),y[C]=[J(S),_c()]),[Te,O]=y[C],Te=await Te,ne&&setTimeout(at,n.dedupingInterval),!y[C]||y[C][1]!==O)return ne&&K()&&A().onDiscarded(C),!1;pe.error=mn;const Le=v[C];if(!Fe(Le)&&(O<=Le[0]||O<=Le[1]||Le[1]===0))return He(),ne&&K()&&A().onDiscarded(C),!1;const Xe=R().data;pe.data=o(Xe,Te)?Xe:Te,ne&&K()&&A().onSuccess(Te,C,n)}catch(Le){at();const Xe=A(),{shouldRetryOnError:St}=Xe;Xe.isPaused()||(pe.error=Le,ne&&K()&&(Xe.onError(Le,C,Xe),(St===!0||Tr(St)&&St(Le))&&(!A().revalidateOnFocus||!A().revalidateOnReconnect||M())&&Xe.onErrorRetry(Le,C,Xe,Ut=>{const Gt=g[C];Gt&&Gt[0]&&Gt[0](_r.ERROR_REVALIDATE_EVENT,Ut)},{retryCount:(se.retryCount||0)+1,dedupe:!0})))}return ce=!1,He(),!0},[C,r]),$e=m.useCallback((...P)=>ib(r,T.current,...P),[]);if(Mo(()=>{_.current=e,w.current=n,Fe(re)||(ye.current=re)}),Mo(()=>{if(!C)return;const P=ge.bind(mn,gC);let J=0;const O=RI(C,g,(ce,se={})=>{if(ce==_r.FOCUS_EVENT){const ne=Date.now();A().revalidateOnFocus&&ne>J&&M()&&(J=ne+A().focusThrottleInterval,P())}else if(ce==_r.RECONNECT_EVENT)A().revalidateOnReconnect&&M()&&P();else{if(ce==_r.MUTATE_EVENT)return ge();if(ce==_r.ERROR_REVALIDATE_EVENT)return ge(se)}});return I.current=!1,T.current=C,E.current=!0,$({_k:S}),Ne&&(Fe(Z)||Ss?P():wI(P)),()=>{I.current=!0,O()}},[C]),Mo(()=>{let P;function J(){const O=Tr(u)?u(R().data):u;O&&P!==-1&&(P=setTimeout(Te,O))}function Te(){!R().error&&(h||A().isVisible())&&(p||A().isOnline())?ge(gC).then(J):J()}return J(),()=>{P&&(clearTimeout(P),P=-1)}},[u,h,p,C]),m.useDebugValue(Se),i&&Fe(Z)&&C){if(!Tc&&Ss)throw new Error("Fallback data is required when using suspense in SSR.");_.current=e,w.current=n,I.current=!1;const P=b[C];if(!Fe(P)){const J=$e(P);Tk(J)}if(Fe(_e)){const J=ge(gC);Fe(Se)||(J.status="fulfilled",J.value=!0),Tk(J)}else throw _e}return{mutate:$e,get data(){return N.data=!0,Se},get error(){return N.error=!0,_e},get isValidating(){return N.isValidating=!0,Ke},get isLoading(){return N.isLoading=!0,de}}},aV=xI(sV),_k=Tc?t=>{t()}:Yc.startTransition,cV=t=>{const[,e]=m.useState({}),n=m.useRef(!1),r=m.useRef(t),o=m.useRef({data:!1,error:!1,isValidating:!1}),i=m.useCallback(s=>{let a=!1;const c=r.current;for(const u in s){const h=u;c[h]!==s[h]&&(c[h]=s[h],o.current[h]&&(a=!0))}a&&!n.current&&e({})},[]);return Mo(()=>(n.current=!1,()=>{n.current=!0})),[r,o.current,i]},lV=()=>(t,e,n={})=>{const{mutate:r}=kI(),o=m.useRef(t),i=m.useRef(e),s=m.useRef(n),a=m.useRef(0),[c,u,h]=cV({data:mn,error:mn,isMutating:!1}),p=c.current,f=m.useCallback(async(v,y)=>{const[b,C]=Es(o.current);if(!i.current)throw new Error("Can’t trigger the mutation: missing fetcher.");if(!b)throw new Error("Can’t trigger the mutation: missing key.");const S=ho(ho({populateCache:!1,throwOnError:!0},s.current),y),E=_c();a.current=E,h({isMutating:!0});try{const I=await r(b,i.current(C,{arg:v}),ho(S,{throwOnError:!0}));return a.current<=E&&(_k(()=>h({data:I,isMutating:!1,error:void 0})),S.onSuccess==null||S.onSuccess.call(S,I,b,S)),I}catch(I){if(a.current<=E&&(_k(()=>h({error:I,isMutating:!1})),S.onError==null||S.onError.call(S,I,b,S),S.throwOnError))throw I}},[]),g=m.useCallback(()=>{a.current=_c(),h({data:mn,error:mn,isMutating:!1})},[]);return Mo(()=>{o.current=t,i.current=e,s.current=n}),{trigger:f,reset:g,get data(){return u.data=!0,p.data},get error(){return u.error=!0,p.error},get isMutating(){return u.isMutating=!0,p.isMutating}}},NI=fO(aV,lV);var pO=Symbol.for("immer-nothing"),wk=Symbol.for("immer-draftable"),zt=Symbol.for("immer-state");function xo(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Gu=Object.getPrototypeOf;function Ku(t){return!!t&&!!t[zt]}function Is(t){var e;return t?mO(t)||Array.isArray(t)||!!t[wk]||!!((e=t.constructor)!=null&&e[wk])||ab(t)||cb(t):!1}var uV=Object.prototype.constructor.toString();function mO(t){if(!t||typeof t!="object")return!1;const e=Gu(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===uV}function bf(t,e){sb(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,r)=>e(r,n,t))}function sb(t){const e=t[zt];return e?e.type_:Array.isArray(t)?1:ab(t)?2:cb(t)?3:0}function H0(t,e){return sb(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function gO(t,e,n){const r=sb(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function dV(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function ab(t){return t instanceof Map}function cb(t){return t instanceof Set}function er(t){return t.copy_||t.base_}function z0(t,e){if(ab(t))return new Map(t);if(cb(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=mO(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[zt];let o=Reflect.ownKeys(r);for(let i=0;i<o.length;i++){const s=o[i],a=r[s];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[s]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[s]})}return Object.create(Gu(t),r)}else{const r=Gu(t);if(r!==null&&n)return{...t};const o=Object.create(r);return Object.assign(o,t)}}function PI(t,e=!1){return lb(t)||Ku(t)||!Is(t)||(sb(t)>1&&(t.set=t.add=t.clear=t.delete=hV),Object.freeze(t),e&&Object.entries(t).forEach(([n,r])=>PI(r,!0))),t}function hV(){xo(2)}function lb(t){return Object.isFrozen(t)}var V0={};function wc(t){const e=V0[t];return e||xo(0,t),e}function fV(t,e){V0[t]||(V0[t]=e)}var yf;function yg(){return yf}function pV(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ak(t,e){e&&(wc("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function $0(t){G0(t),t.drafts_.forEach(mV),t.drafts_=null}function G0(t){t===yf&&(yf=t.parent_)}function kk(t){return yf=pV(yf,t)}function mV(t){const e=t[zt];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function xk(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[zt].modified_&&($0(e),xo(4)),Is(t)&&(t=Cg(e,t),e.parent_||Sg(e,t)),e.patches_&&wc("Patches").generateReplacementPatches_(n[zt].base_,t,e.patches_,e.inversePatches_)):t=Cg(e,n,[]),$0(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==pO?t:void 0}function Cg(t,e,n){if(lb(e))return e;const r=e[zt];if(!r)return bf(e,(o,i)=>Rk(t,r,e,o,i,n)),e;if(r.scope_!==t)return e;if(!r.modified_)return Sg(t,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const o=r.copy_;let i=o,s=!1;r.type_===3&&(i=new Set(o),o.clear(),s=!0),bf(i,(a,c)=>Rk(t,r,o,a,c,n,s)),Sg(t,o,!1),n&&t.patches_&&wc("Patches").generatePatches_(r,n,t.patches_,t.inversePatches_)}return r.copy_}function Rk(t,e,n,r,o,i,s){if(Ku(o)){const a=i&&e&&e.type_!==3&&!H0(e.assigned_,r)?i.concat(r):void 0,c=Cg(t,o,a);if(gO(n,r,c),Ku(c))t.canAutoFreeze_=!1;else return}else s&&n.add(o);if(Is(o)&&!lb(o)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Cg(t,o),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&Sg(t,o)}}function Sg(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&PI(e,n)}function gV(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:yg(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let o=r,i=MI;n&&(o=[r],i=Cf);const{revoke:s,proxy:a}=Proxy.revocable(o,i);return r.draft_=a,r.revoke_=s,a}var MI={get(t,e){if(e===zt)return t;const n=er(t);if(!H0(n,e))return vV(t,n,e);const r=n[e];return t.finalized_||!Is(r)?r:r===vC(t.base_,e)?(bC(t),t.copy_[e]=Sf(r,t)):r},has(t,e){return e in er(t)},ownKeys(t){return Reflect.ownKeys(er(t))},set(t,e,n){const r=vO(er(t),e);if(r!=null&&r.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const o=vC(er(t),e),i=o==null?void 0:o[zt];if(i&&i.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(dV(n,o)&&(n!==void 0||H0(t.base_,e)))return!0;bC(t),us(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return vC(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,bC(t),us(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=er(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){xo(11)},getPrototypeOf(t){return Gu(t.base_)},setPrototypeOf(){xo(12)}},Cf={};bf(MI,(t,e)=>{Cf[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Cf.deleteProperty=function(t,e){return Cf.set.call(this,t,e,void 0)};Cf.set=function(t,e,n){return MI.set.call(this,t[0],e,n,t[0])};function vC(t,e){const n=t[zt];return(n?er(n):t)[e]}function vV(t,e,n){var o;const r=vO(e,n);return r?"value"in r?r.value:(o=r.get)==null?void 0:o.call(t.draft_):void 0}function vO(t,e){if(!(e in t))return;let n=Gu(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=Gu(n)}}function us(t){t.modified_||(t.modified_=!0,t.parent_&&us(t.parent_))}function bC(t){t.copy_||(t.copy_=z0(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var bV=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const i=n;n=e;const s=this;return function(c=i,...u){return s.produce(c,h=>n.call(this,h,...u))}}typeof n!="function"&&xo(6),r!==void 0&&typeof r!="function"&&xo(7);let o;if(Is(e)){const i=kk(this),s=Sf(e,void 0);let a=!0;try{o=n(s),a=!1}finally{a?$0(i):G0(i)}return Ak(i,r),xk(o,i)}else if(!e||typeof e!="object"){if(o=n(e),o===void 0&&(o=e),o===pO&&(o=void 0),this.autoFreeze_&&PI(o,!0),r){const i=[],s=[];wc("Patches").generateReplacementPatches_(e,o,i,s),r(i,s)}return o}else xo(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(s,...a)=>this.produceWithPatches(s,c=>e(c,...a));let r,o;return[this.produce(e,n,(s,a)=>{r=s,o=a}),r,o]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Is(t)||xo(8),Ku(t)&&(t=yV(t));const e=kk(this),n=Sf(t,void 0);return n[zt].isManual_=!0,G0(e),n}finishDraft(t,e){const n=t&&t[zt];(!n||!n.isManual_)&&xo(9);const{scope_:r}=n;return Ak(r,e),xk(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const o=e[n];if(o.path.length===0&&o.op==="replace"){t=o.value;break}}n>-1&&(e=e.slice(n+1));const r=wc("Patches").applyPatches_;return Ku(t)?r(t,e):this.produce(t,o=>r(o,e))}};function Sf(t,e){const n=ab(t)?wc("MapSet").proxyMap_(t,e):cb(t)?wc("MapSet").proxySet_(t,e):gV(t,e);return(e?e.scope_:yg()).drafts_.push(n),n}function yV(t){return Ku(t)||xo(10,t),bO(t)}function bO(t){if(!Is(t)||lb(t))return t;const e=t[zt];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=z0(t,e.scope_.immer_.useStrictShallowCopy_)}else n=z0(t,!0);return bf(n,(r,o)=>{gO(n,r,bO(o))}),e&&(e.finalized_=!1),n}function CV(){class t extends Map{constructor(c,u){super(),this[zt]={type_:2,parent_:u,scope_:u?u.scope_:yg(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:c,draft_:this,isManual_:!1,revoked_:!1}}get size(){return er(this[zt]).size}has(c){return er(this[zt]).has(c)}set(c,u){const h=this[zt];return s(h),(!er(h).has(c)||er(h).get(c)!==u)&&(n(h),us(h),h.assigned_.set(c,!0),h.copy_.set(c,u),h.assigned_.set(c,!0)),this}delete(c){if(!this.has(c))return!1;const u=this[zt];return s(u),n(u),us(u),u.base_.has(c)?u.assigned_.set(c,!1):u.assigned_.delete(c),u.copy_.delete(c),!0}clear(){const c=this[zt];s(c),er(c).size&&(n(c),us(c),c.assigned_=new Map,bf(c.base_,u=>{c.assigned_.set(u,!1)}),c.copy_.clear())}forEach(c,u){const h=this[zt];er(h).forEach((p,f,g)=>{c.call(u,this.get(f),f,this)})}get(c){const u=this[zt];s(u);const h=er(u).get(c);if(u.finalized_||!Is(h)||h!==u.base_.get(c))return h;const p=Sf(h,u);return n(u),u.copy_.set(c,p),p}keys(){return er(this[zt]).keys()}values(){const c=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const u=c.next();return u.done?u:{done:!1,value:this.get(u.value)}}}}entries(){const c=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const u=c.next();if(u.done)return u;const h=this.get(u.value);return{done:!1,value:[u.value,h]}}}}[Symbol.iterator](){return this.entries()}}function e(a,c){return new t(a,c)}function n(a){a.copy_||(a.assigned_=new Map,a.copy_=new Map(a.base_))}class r extends Set{constructor(c,u){super(),this[zt]={type_:3,parent_:u,scope_:u?u.scope_:yg(),modified_:!1,finalized_:!1,copy_:void 0,base_:c,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return er(this[zt]).size}has(c){const u=this[zt];return s(u),u.copy_?!!(u.copy_.has(c)||u.drafts_.has(c)&&u.copy_.has(u.drafts_.get(c))):u.base_.has(c)}add(c){const u=this[zt];return s(u),this.has(c)||(i(u),us(u),u.copy_.add(c)),this}delete(c){if(!this.has(c))return!1;const u=this[zt];return s(u),i(u),us(u),u.copy_.delete(c)||(u.drafts_.has(c)?u.copy_.delete(u.drafts_.get(c)):!1)}clear(){const c=this[zt];s(c),er(c).size&&(i(c),us(c),c.copy_.clear())}values(){const c=this[zt];return s(c),i(c),c.copy_.values()}entries(){const c=this[zt];return s(c),i(c),c.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(c,u){const h=this.values();let p=h.next();for(;!p.done;)c.call(u,p.value,p.value,this),p=h.next()}}function o(a,c){return new r(a,c)}function i(a){a.copy_||(a.copy_=new Set,a.base_.forEach(c=>{if(Is(c)){const u=Sf(c,a);a.drafts_.set(c,u),a.copy_.add(u)}else a.copy_.add(c)}))}function s(a){a.revoked_&&xo(3,JSON.stringify(er(a)))}fV("MapSet",{proxyMap_:e,proxySet_:o})}var po=new bV,Ar=po.produce;po.produceWithPatches.bind(po);po.setAutoFreeze.bind(po);po.setUseStrictShallowCopy.bind(po);po.applyPatches.bind(po);po.createDraft.bind(po);po.finishDraft.bind(po);function ub(t){const e=D(t,(n,r,o)=>r(e,Ar(n(e),typeof o=="function"?o:()=>o)));return e}function rp(t,e){const n=Ee(t);return m.useCallback(r=>n(Ar(r)),[n])}const op={Namibia:"NA","South Africa":"ZA",Cameroon:"CM",Japan:"JP",Ghana:"GH",Ethiopia:"ET","United States":"US","United Arab Emirates":"AE",Bahrain:"BH",Djibouti:"DJ",Algeria:"DZ",Egypt:"EG","Western Sahara":"EH",Eritrea:"ER",Israel:"IL",Iraq:"IQ",Jordan:"JO",Comoros:"KM",Kuwait:"KW",Lebanon:"LB",Libya:"LY",Morocco:"MA",Mauritania:"MR",Oman:"OM","Palestinian Territories":"PS",Qatar:"QA","Saudi Arabia":"SA",Sudan:"SD",Somalia:"SO","South Sudan":"SS",Syria:"SY",Chad:"TD",Tunisia:"TN",Yemen:"YE",Chile:"CL",India:"IN",Tanzania:"TZ",Spain:"ES",Azerbaijan:"AZ",Russia:"RU",Belarus:"BY",Zambia:"ZM",Bulgaria:"BG",Mali:"ML",Bangladesh:"BD","China mainland":"CN",France:"FR","Bosnia & Herzegovina":"BA",Andorra:"AD",Italy:"IT",Philippines:"PH",Uganda:"UG",Iran:"IR",Czechia:"CZ","United Kingdom":"GB",Denmark:"DK",Greenland:"GL",Kenya:"KE",Austria:"AT",Belgium:"BE",Switzerland:"CH",Germany:"DE",Liechtenstein:"LI",Luxembourg:"LU",Niger:"NE",Maldives:"MV",Senegal:"SN",Bhutan:"BT",Togo:"TG",Cyprus:"CY",Greece:"GR","Antigua & Barbuda":"AG",Anguilla:"AI",Albania:"AL",Argentina:"AR","American Samoa":"AS",Australia:"AU",Barbados:"BB",Burundi:"BI",Bermuda:"BM",Brunei:"BN",Brazil:"BR",Bahamas:"BS",Botswana:"BW",Belize:"BZ",Canada:"CA","Cocos (Keeling) Islands":"CC","Cook Islands":"CK",Colombia:"CO","Cape Verde":"CV","Christmas Island":"CX","Diego Garcia":"DG",Dominica:"DM",Estonia:"EE",Finland:"FI",Fiji:"FJ","Falkland Islands":"FK",Micronesia:"FM",Grenada:"GD",Guernsey:"GG",Gibraltar:"GI",Gambia:"GM",Guam:"GU",Guyana:"GY","Hong Kong":"HK",Hungary:"HU",Indonesia:"ID",Ireland:"IE","Isle of Man":"IM","Chagos Archipelago":"IO",Jersey:"JE",Jamaica:"JM",Kiribati:"KI","St. Kitts & Nevis":"KN","South Korea":"KR","Cayman Islands":"KY","St. Lucia":"LC",Liberia:"LR",Lesotho:"LS",Lithuania:"LT",Latvia:"LV",Madagascar:"MG","Marshall Islands":"MH","Myanmar (Burma)":"MM",Macao:"MO","Northern Mariana Islands":"MP",Montserrat:"MS",Malta:"MT",Mauritius:"MU",Malawi:"MW",Mexico:"MX",Malaysia:"MY","Norfolk Island":"NF",Nigeria:"NG",Netherlands:"NL",Norway:"NO",Nauru:"NR",Niue:"NU","New Zealand":"NZ","Papua New Guinea":"PG",Pakistan:"PK",Poland:"PL","Pitcairn Islands":"PN","Puerto Rico":"PR",Portugal:"PT",Palau:"PW",Rwanda:"RW","Solomon Islands":"SB",Seychelles:"SC",Sweden:"SE",Singapore:"SG","St. Helena":"SH",Slovenia:"SI",Slovakia:"SK","Sierra Leone":"SL","Sint Maarten":"SX",Eswatini:"SZ","Turks & Caicos Islands":"TC",Thailand:"TH",Tokelau:"TK",Tonga:"TO",Türkiye:"TR","Trinidad & Tobago":"TT",Tuvalu:"TV",Taiwan:"TW",Ukraine:"UA","U.S. Outlying Islands":"UM","St. Vincent & Grenadines":"VC","British Virgin Islands":"VG","U.S. Virgin Islands":"VI",Vanuatu:"VU",Samoa:"WS",Zimbabwe:"ZW",Bolivia:"BO","Caribbean Netherlands":"BQ","Costa Rica":"CR",Cuba:"CU",Curaçao:"CW","Dominican Republic":"DO","Ceuta & Melilla":"EA",Ecuador:"EC","Equatorial Guinea":"GQ",Guatemala:"GT",Honduras:"HN",Haiti:"HT","Canary Islands":"IC",Nicaragua:"NI",Panama:"PA",Peru:"PE",Paraguay:"PY","El Salvador":"SV",Uruguay:"UY",Venezuela:"VE",Afghanistan:"AF","Burkina Faso":"BF",Guinea:"GN","Guinea-Bissau":"GW","Faroe Islands":"FO",Benin:"BJ","St. Barthélemy":"BL","Congo - Kinshasa":"CD","Central African Republic":"CF","Congo - Brazzaville":"CG","Côte d'Ivoire":"CI",Gabon:"GA","French Guiana":"GF",Guadeloupe:"GP",Monaco:"MC","St. Martin":"MF",Martinique:"MQ","New Caledonia":"NC","French Polynesia":"PF","St. Pierre & Miquelon":"PM",Réunion:"RE","Wallis & Futuna":"WF",Mayotte:"YT",Croatia:"HR",Armenia:"AM",Iceland:"IS","San Marino":"SM","Vatican City":"VA",Georgia:"GE",Kazakhstan:"KZ",Cambodia:"KH","North Korea":"KP",Kyrgyzstan:"KG",Angola:"AO",Laos:"LA",Mozambique:"MZ","North Macedonia":"MK",Mongolia:"MN","Svalbard & Jan Mayen":"SJ",Nepal:"NP",Aruba:"AW",Suriname:"SR","São Tomé & Príncipe":"ST","Timor-Leste":"TL",Moldova:"MD",Romania:"RO","Sri Lanka":"LK",Kosovo:"XK",Montenegro:"ME",Serbia:"RS","Åland Islands":"AX",Tajikistan:"TJ",Turkmenistan:"TM",Uzbekistan:"UZ",Vietnam:"VN"},yO=["blowing-dust","blowing-sand","blowing-snow","clear","clear-occasional-rain-or-thunderstorms","clear-then-cloudy","clear-then-occasional-rain","clear-then-occasional-snow","clear-then-rain","clear-then-rain-or-snow","clear-then-rain-or-thunderstorms","clear-then-snow","clear-then-snow-or-rain","clear-then-thunderstorms","clear-with-isolated-snow","clear-with-isolated-thunderstorms","clear-with-occasional-clouds","clear-with-occasional-rain","clear-with-occasional-rain-or-snow","clear-with-occasional-snow","clear-with-occasional-snow-or-rain","cloudy","cloudy-and-occasionally-clear","cloudy-occasional-rain-or-thunderstorms","cloudy-then-clear","cloudy-then-occasional-rain","cloudy-then-occasional-snow","cloudy-then-occasionally-clear","cloudy-then-rain","cloudy-then-rain-or-snow","cloudy-then-rain-or-thunderstorms","cloudy-then-snow","cloudy-then-snow-or-rain","cloudy-with-isolated-rain","cloudy-with-occasional-rain","cloudy-with-occasional-rain-or-snow","cloudy-with-occasional-snow","cloudy-with-occasional-snow-or-rain","cloudy-with-thundersnow-at-times","drifting-sand","drifting-snow","drizzle","duststorm","fair","fog","freezing-drizzle","freezing-fog","freezing-rain","hail","haze","heavy-drizzle","heavy-rain","heavy-snow","heavy-thunderstorms","ice-pellets","light-drizzle","light-fog","light-freezing-drizzle","light-freezing-rain","light-hail","light-rain","light-rain-and-snow","light-rain-and-snow-shower","light-rain-shower","light-snow","light-snow-shower","mostly-clear","mostly-cloudy","mostly-sunny","partly-cloudy","partly-sunny","patchy-fog","rain","rain-and-occasionally-clear","rain-and-occasionally-cloudy","rain-and-snow","rain-and-snow-shower","rain-or-snow","rain-or-snow-then-clear","rain-or-snow-then-cloudy","rain-showers","rain-then-clear","rain-then-cloudy","rain-then-occasional-snow","rain-turning-to-snow","rain-with-occasional-snow","severe-duststorm","sleet","smoke","snow","snow-and-occasionally-clear","snow-and-occasionally-cloudy","snow-or-rain","snow-or-rain-then-clear","snow-or-rain-then-cloudy","snow-showers","snow-then-clear","snow-then-cloudy","snow-then-rain","squalls","sunny","thundersnow","thunderstorms","unknown","windy-rainstorm","windy-with-heavy-snow"],SV=["adult","teen"],EV=["twenty-four-hours","one-day","five-days","one-week","one-month","one-year","five-years","max"],IV=["pro","m365-basic","m365-personal-classic","m365-family-classic-admin","m365-family-classic-guest","m365-personal","m365-family-admin","m365-family-guest","m365-premium-admin","m365-premium-guest"],TV=["direct","apple","google","retail"],_V=["guest","free","m365-personal","pro","m365-premium"],wV=["python"],AV=5,kV=10240,Ake=100,xV=15e3,Si=8,Xt={mediaViewer:"z-10",composer:"z-10",composerBottomSlot:"z-20",coachmark:"z-30",chatScrollToBottomButton:"z-10",babylonCharacter:"z-10",citations:"z-20",settings:"z-30",audioBase:"z-10",audioDisplayContent:"z-40",modalBackground:"z-30",modal:"z-40",sidebar:"z-40",toastNotification:"z-50",dropdownMenuOverModal:"z-50",pages:{warning:"z-10",chat:"z-20"},shopping:{navigation:"z-10"},headerIcon:"z-30",default:"z-0"},Oo={default:.15,slow:.5,composerButton:.2,settings:.1,audio:{available:.5,unavailable:2,deepLinkLanding:.5},suggestions:.2,dailyBriefing:{background:.5,sourcePopoverScale:.2,sourcePopoverOpacity:.15}},kke=.25,xke=2,Rke=0,RV=1.5,CO=2e3,NV=.25,dt={opacity:0},Ot={opacity:1},PV=.2,MV=.025,Nke={initial:dt,animate:{...Ot,transition:{delayChildren:PV,staggerChildren:MV}}},Pke={initial:dt,animate:Ot},OI={willChange:"auto"},Eg="9188040d-6c67-4c5b-b112-36a304b66dad",yC="copilot.cloud.microsoft",Mke=q("mt-px text-end uppercase text-foreground-450 text-2xs dark:text-foreground-600"),Oke="flex items-center justify-between text-start",OV=["Austria","Belgium","Brazil","Bulgaria","Canada","Croatia","Cyprus","Czechia","Denmark","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","Ireland","Italy","Latvia","Liechtenstein","Lithuania","Luxembourg","Malta","Netherlands","Norway","China mainland","Poland","Portugal","Romania","Slovakia","Slovenia","Spain","Sweden","Switzerland","Türkiye","United Kingdom"],db=OV.map(t=>op[t]),LV=["Austria","Belgium","Bulgaria","Croatia","Cyprus","Czechia","Denmark","Estonia","Finland","France","Germany","Greece","Hungary","Ireland","Italy","Latvia","Lithuania","Luxembourg","Malta","Netherlands","Poland","Portugal","Romania","Slovakia","Slovenia","Spain","Sweden"],DV=LV.map(t=>op[t]),jV=["Belarus","China mainland","Lebanon","Macao","Russia","Venezuela","North Korea","Cuba","Syria","Iran"],UV=jV.map(t=>op[t]),FV="https://account.live.com/ep",BV="Think Deeper",Lke=1500,Ig=24*60*60*1e3,HV=5,LI=451,SO="Not allowed child account",DI="LEGALLY_UNAVAILABLE_STATUS",K0=3,CC=[80,100,110,125,150],hb=100,zV=1e3,EO=!1,Dke=!1,IO="/chats/private";async function VV(t){return new Promise(e=>{let n=!1;t.catch(r=>{r instanceof Error?(n=!0,e(`Type: ${r.name}, Message: ${r.message}, Stack: ${r.stack}`)):(n=!0,e(`Type: ${typeof r}, Value: ${JSON.stringify(r)}`))}),setTimeout(()=>{n||e("Promise.catch wasn't called. The Promise is not rejected.")},1e3)})}class $V{constructor(){W(this,"latestClientExperimentationAssignmentRequestId",null);W(this,"latestApiExperimentationAssignmentRequestId",null)}getTraceIdAnalytics(){return{TraceId_LastClientAssignment:this.latestClientExperimentationAssignmentRequestId,TraceId_Latest:this.latestApiExperimentationAssignmentRequestId}}trackClientExperimentationAssignment(e){const n=this.getTraceIdFromResponseHeaders(e);n&&(this.latestClientExperimentationAssignmentRequestId=n)}trackLatestApiAssignment(e){const n=this.getTraceIdFromResponseHeaders(e.headers);n&&(this.latestApiExperimentationAssignmentRequestId=n)}trackLatestChatConnectedAssignment(e){const{requestId:n}=e;this.latestApiExperimentationAssignmentRequestId=n}getTraceIdFromResponseHeaders(e){return(e.get("x-ceto-ref")??"").split("|")[0]??null}}const fb=new $V;function jI(){return"d4568c6"}function GV(){return`mscmc@${jI().substring(0,7)}`}function cn(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function q0(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function UI(t,e){const n=cn(t);return isNaN(e)?q0(t,NaN):(e&&n.setDate(n.getDate()+e),n)}function KV(t){return document.cookie.split(";").find(e=>e.trim().startsWith(`${t}=`))}function Ef(t){const e=KV(t),n=e==null?void 0:e.split("=")[1];if(n)return decodeURIComponent(n)}function Nk(t,e,n={}){const{expireDays:r,path:o="/",domain:i,secure:s=!0,host:a}=n;let c=t;s&&!i&&o==="/"&&a&&(c=`__Host-${t}`);let u=`${c}=${encodeURIComponent(e)}; path=${o}`;if(r){const h=UI(new Date,r);u+=`; expires=${h.toUTCString()}`}i&&(u+=`; domain=${i}`),s&&(u+="; secure"),document.cookie=u}const ql={name:"CMCCP",expirationDays:365},pb={name:"BCP"},qV="3PAdsOptOut";function FI(){return Ef(ql.name)??Ef(pb.name)}function Pk(t,e){const{analytics:n,advertising:r,socialMedia:o}=t,i=new URLSearchParams;i.set("AD",r?"1":"0"),i.set("AL",n?"1":"0"),i.set("SM",o?"1":"0");const s=UI(new Date,e);return i.set("expires",s.getTime().toString()),i.toString()}function WV(t){Nk(ql.name,Pk(t,ql.expirationDays),{expireDays:ql.expirationDays}),Nk(pb.name,Pk(t,ql.expirationDays),{expireDays:ql.expirationDays})}function bd(){const t=Ef(pb.name);if(!t)return{advertising:!1,analytics:!1,socialMedia:!1};const e=new URLSearchParams(t),n=e.get("AD")==="1",r=e.get("AL")==="1",o=e.get("SM")==="1";return{advertising:n,analytics:r,socialMedia:o}}function TO(){const t=Ef(qV)!=="1";return navigator.globalPrivacyControl?!1:t}const nc=class nc{constructor(){W(this,"listeners",new Map)}static getInstance(){return nc.instance||(nc.instance=new nc),nc.instance}on(e,n){var r;this.listeners.has(e)||this.listeners.set(e,[]),(r=this.listeners.get(e))==null||r.push(n)}emit(e,n){const r=this.listeners.get(e);if(r)for(const o of r)o(n)}off(e,n){const r=this.listeners.get(e);r&&this.listeners.set(e,r.filter(o=>o!==n))}};W(nc,"instance",null);let W0=nc;const Mt=W0.getInstance();function YV(t){let e="unknown";try{const n=/(?:CopilotNative|BingNative|MicrosoftLauncher)\/([0-9]+(?:\.[0-9]+)*(?:-[a-zA-Z0-9]+)?)/,r=t==null?void 0:t.match(n);if(r!=null&&r[1]){const[,o]=r;e=o}return e}catch{return e}}function pa(t,e){sessionStorage.setItem(t,e)}function ci(t){return sessionStorage.getItem(t)}function QV(t){return ci(t)==="true"}function _O(t){sessionStorage.removeItem(t)}function yn(t){return new URLSearchParams(window.location.search).get(t)}function Vr(t){const e=new URL(window.location.href);e.searchParams.delete(t),window.history.replaceState(null,"",e)}function JV(){const t=yn("ocid")??yn("OCID"),e=yn("msclkid"),n=yn("gclid"),r={};return t&&(r.OCID=t),e&&(r.msclkid=e),n&&(r.gclid=n),r}function wO(){Vr("ocid"),Vr("OCID"),Vr("msclkid"),Vr("gclid")}function ZV(){const t=yn("form");if(t)return Vr("form"),t;const e=yn("FORM");return e&&Vr("FORM"),e}function XV(){return yn("alias")}function e$(){const t=yn("chat-mode");return t&&Vr("chat-mode"),t}function t$(){const t=yn("q");return t&&Vr("q"),t}function n$(){const t=yn("prompt");return t&&Vr("prompt"),t}function r$(){const t=yn("sandbox");return t&&Vr("sandbox"),t==="1"}function o$(){if(typeof window>"u")return!1;const t=yn("disable-all-features");return t!==null&&t!=="0"&&t!=="false"}function jke(){return yn("payflow-correlationId")}const i$=["ActionsLimit","VoiceLimit","Settings","ChatReasoningLimit","MarketSelect","RedirectFromAuth0Account","ResearchReportLimit","PodcastLimit","ProfileUpdateRequired","Settings-FromWinNative","VisionLimit-FromWinNative","Subscriptions"];function s$(t){return i$.some(e=>e===t)}function Uke(){const t=yn("entry-point")??"";return s$(t)?t:"Unknown"}function Fke(){const t=yn("campaign");return t?(pa("campaignId",t),t):null}function Bke(){const t=yn("referral-code");return t?(pa("referralCode",t),t):null}function a$(){return yn("charid")}function Hke(){const t=yn("pff");return t&&Vr("pff"),t}function zke(){const t=yn("pfah");return t&&Vr("pfah"),t}function Vke(){const t=yn("pfcid");return t&&Vr("pfcid"),t}function c$(){return yn("intent")}const l$=["text","queryParam"];function u$(t){return l$.includes(t)}function d$(){const t=yn("input-method");return t?(Vr("input-method"),u$(t)?t:"queryParam"):"queryParam"}function $ke(){return[]}function ip(t){const e=typeof navigator<"u"?navigator.userAgent:null;return e?t.test(e):!1}function AO(){return ip(/BingSapphire/gi)}function h$(){return ip(/NewsSapphire/gi)}function kO(){return!!(navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Macintosh/i.test(navigator.userAgent)&&"ontouchend"in document)}function xO(){return kO()||ip(/iPad|iPhone|Android|iPod/gi)}function f$(){return ip(/Android/gi)}function p$(){return kO()||ip(/iPhone|iPad|iPod/gi)}const Mk="mobileCrossSellingLastClosed",SC="mobilePromoCountClose",Tg="hasBeenAuthenticated",_g="colorTheme",BI="newConversationsStarted",If="timeOfNewConversationThreshold",Ok="hasCorrectedPersonalizationSettings",Y0="banAppealSubmitted",m$="hideDeleteConversationModal",g$="hasBeenPromptedForLocation",v$="hasSeenCharacter",Lk="voiceAppearanceId",b$="disableAppearanceOnHomeScreen",y$="hasSeenAppearance",C$="hasSeenAppearanceOnVoiceCall",S$="hasDismissedAppearanceModal",Q0="crossPromoFirstVisit",HI="crossPromoDiscoverStripLastClosed",wg="crossPromoDiscoverStripCountClose",Gke="crossPromoStripGetAppIsClicked",Dk="reviewActiveDays",J0="reviewPromptResponse",RO="userSidebarOpen",Kke="referralEligibilityStatus",qke="referralHasSeenEntryNewBadge",E$="coachmark",Z0="isEagerMSALEnabled",NO="isMsalSilentSsoEnabled",PO="user.UserFirstName",X0="loginStartTime",e1="reauthLoginFlag",Wke="subscription.m365SubscriberFRE",jk="userConversationVoiceSpeed",Uk="authModuleRefactor",t1="authRfInitAuthAccount",n1="authRfMsalEventRemoval",I$="copilotBeta",T$="copilotBetaAnnouncementRequired";function ar(t,e){typeof window<"u"&&localStorage.setItem(t,e)}function Sn(t){return typeof window<"u"?localStorage.getItem(t):null}function $r(t){typeof window<"u"&&localStorage.removeItem(t)}function Bo(t,e){const n=Sn(t);if(!n)return null;try{const r=JSON.parse(n);return e.parse(r)}catch{return null}}function ei(t,e,n){try{e.parse(n),ar(t,JSON.stringify(n))}catch{}}function yd(t){const{key:e,schema:n,initialValue:r}=t;return IM(e,r,{getItem:()=>Bo(e,n)??r,setItem:(i,s)=>{s===void 0?$r(e):ei(e,n,s)},removeItem:()=>$r(e)},{getOnInit:!0})}const zI=D(!1),_$=l.boolean().optional(),qu=yd({key:I$,schema:_$,initialValue:void 0}),w$=l.boolean().optional(),EC=yd({key:T$,schema:w$,initialValue:void 0});function Ge(t){return st().get(t)}function A$(){return Ge(zI)&&!!Ge(qu)}const k$={"thumbs-up":"thumbsUp","thumbs-down":"thumbsDown",report:"reportMessage"},Fk="homepage";class x${constructor(e={}){W(this,"analytics",null);W(this,"features");W(this,"picassoId",null);W(this,"anid",null);W(this,"formCode",null);W(this,"landingPage",Fk);W(this,"trafficAlias",null);W(this,"settings",null);W(this,"isAADUser",null);W(this,"isNewUser",null);W(this,"isCopilotMode",null);W(this,"accountType",null);W(this,"referrer",null);W(this,"deviceInfo",null);W(this,"isInitializing",!1);W(this,"pendingEvents",[]);W(this,"initRetryCount",0);W(this,"maxRetries");W(this,"maxPendingEvents");W(this,"delay");W(this,"onInitializeError");this.maxRetries=e.maxRetries??3,this.maxPendingEvents=e.maxPendingEvents??1e3,this.delay=e.delay??0,this.onInitializeError=e.onInitializeError}ensureInitialized(){!this.isInitialized&&!this.isInitializing&&(this.isInitializing=!0,this.initialize())}get isInitialized(){return this.analytics!==null&&this.analytics.isInitialized()}get currentEnv(){return"prod"}get initializationFailed(){return this.initRetryCount>=this.maxRetries}setFeatures(e){this.features=e.join(",")}setAnid(e){this.anid=e}setIsNewUser(e){this.isNewUser===null&&(this.isNewUser=e)}setIsAad(e){this.isAADUser=e}setCopilotMode(e){this.isCopilotMode=e}setSettings(e){this.settings={...this.settings,...e}}getPicassoId(){return this.picassoId}setPicassoId(e){this.picassoId=e}setFormCode(e){this.formCode=e}getFormCode(){return this.formCode}setDeviceInfo(e){this.deviceInfo=e}setLandingPage(e){this.landingPage===Fk&&(this.landingPage=e)}getLandingPage(){return this.landingPage}isValidLowercaseUserAccountType(e){return["msa","aad","apple","google"].includes(e)}setUserAccountType(e){if(!e){this.accountType=null;return}const n=e.toLowerCase();this.isValidLowercaseUserAccountType(n)?this.accountType=n:this.accountType=null}processFormCode(){const e=ZV();this.formCode=e}processAlias(){const e=XV();e&&(this.trafficAlias=e)}processReferrer(){this.referrer===null&&typeof document<"u"&&(this.referrer=document.referrer)}initialize(){this.isInitialized||(this.processFormCode(),this.processAlias(),this.processReferrer(),this.dynamicInitialization().catch(()=>{}))}async dynamicInitialization(){var n,r;this.delay>0&&await new Promise(o=>{setTimeout(o,this.delay)});const e=await H(()=>import("./Index-LRgWj45i.js"),__vite__mapDeps([0,1,2])).catch(o=>o instanceof Error?o:new Error(`Failed to load @microsoft/1ds-analytics-js: ${o}`));if(e instanceof Error)(n=this.onInitializeError)==null||n.call(this,e),this.initRetryCount+=1,this.initRetryCount>=this.maxRetries&&((r=this.onInitializeError)==null||r.call(this,new Error("ApplicationInsights initialization: Max retries reached")),this.pendingEvents.length=0);else{const{ApplicationInsights:o}=e;this.analytics=new o;const i={instrumentationKey:"be6e4c19699f4fdf9f8c0ec9f9b398ef-25d58bb9-9926-4df7-8e36-bc7afb4b2c34-7563",channelConfiguration:{eventsLimitInMem:5e3},propertyConfiguration:{populateBrowserInfo:!0},disableCookiesUsage:!0};this.analytics.initialize(i,[]),this.flushPendingEvents()}this.isInitializing=!1}flushPendingEvents(){for(let e=0,n=this.pendingEvents.length;e<n;e+=1){const r=this.pendingEvents[e];r&&this.trackEventInternal(r)}this.pendingEvents.length=0}getPlatformSurface(e){if(e==="pageseditor"){if(f$())return"android";if(p$())return"ios"}return e}getAppFlavor(){return A$()?{eventInfo_appFlavor:"beta"}:null}getFixEventProperties(){const e=this.getPlatformSurface("cmc");return{appName:`CopilotN-${this.currentEnv}-web-${e}`,appVersion:jI(),surface:e,surfaceVersion:YV(navigator.userAgent),accountType:this.accountType,userMuid:Ef("MUID"),userAnid:this.anid,userPicassoId:this.picassoId,userFlightIds:this.features,trafficAlias:this.trafficAlias,eventInfo_entryPoint:this.formCode,eventInfo_surfaceVisible:document.visibilityState==="visible",eventInfo_isCopilotMode:this.isCopilotMode,isAADUser:this.isAADUser,isNewUser:this.isNewUser,pathname:window.location.pathname,referrer:this.referrer,"UserInfo.Id":this.picassoId,...fb.getTraceIdAnalytics(),...this.settings,...this.deviceInfo,...this.getAppFlavor()}}trackEvent(e){if(!this.initializationFailed){if(this.pendingEvents.length>=this.maxPendingEvents){console.warn(`Analytics pending events queue is full (${this.maxPendingEvents}). Dropping event: ${JSON.stringify(e)}`);return}if(this.ensureInitialized(),this.isInitializing||!this.isInitialized){this.pendingEvents.push(e);return}this.trackEventInternal(e)}}trackEventInternal(e){const n=this.getFixEventProperties(),r=bd(),o=TO();if(!this.analytics){console.error("Failed to initialize AnalyticsService.");return}const i={name:e.name,data:{...n,...e.data},ext:{web:{consentDetails:JSON.stringify({Required:!0,Analytics:r.analytics,SocialMedia:r.socialMedia,Advertising:r.advertising,GPC_DataSharingOptIn:o})}}};(e.data.eventName==="copilotCompose"||e.data.eventName==="copilotAudioInput")&&Mt.emit("composer:send-query",{isNewUser:this.isNewUser,event:e.data}),this.analytics.track(i)}}const z=new x$({maxRetries:3,maxPendingEvents:1e3,delay:200,onInitializeError:t=>{console.error("AnalyticsService initialization error:",t)}});function MO(t,e){z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"ErrorBoundary",eventInfo_errorName:t.name,eventInfo_errorMessage:t.message,eventInfo_errorStack:t.stack??"",eventInfo_componentStack:e.componentStack??""}}),H(async()=>{const{captureReactException:n}=await import("./vendor-BoLDEgyJ.js").then(r=>r.ai);return{captureReactException:n}},__vite__mapDeps([1,2])).then(({captureReactException:n})=>n(t,e))}function Tf(t,e,n=!1){z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"APIResponseParseError",eventInfo_apiUrl:e,eventInfo_errors:JSON.stringify(t.format()),eventInfo_safe:n}})}async function Bk(t){const e=await VV(t.promise);z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"UnhandledRejection",eventInfo_reason:`${t.reason}`,eventInfo_customData:e}})}function R$(t,e,n){try{new URL(sa(t)).hostname}catch(r){z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"invalidCitationURL",eventInfo_url:t,eventInfo_errorMessage:r instanceof Error?r.message:"",eventInfo_conversationId:e,eventInfo_messageId:n}})}}function OO(t){z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"PlaybackApiError",eventInfo_errorMessage:t instanceof Error?t.message:"",eventInfo_details:"An error occurred during media playback tracking api call."}})}function N$(t,e,n=void 0){z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"InvalidJsonResponse",eventInfo_apiUrl:n,eventInfo_errorMessage:t.message,eventInfo_errorCode:e.statusText,eventInfo_details:JSON.stringify(Object.fromEntries(e.headers.entries()))}})}const LO=25,DO=25,P$=1e3,M$=6e3,O$=2500,L$=5,D$=250,j$=25,Yke=3,U$=["mica","aqua","erin"];function jO(t){switch(t){case"mica":case"aqua":case"erin":return t;default:return null}}function F$(t,e){switch(t){case"mica":return e("characterAnimation.characterNameMica");case"aqua":return e("characterAnimation.characterNameAqua");case"erin":return e("characterAnimation.characterNameErin");default:return""}}function B$(t,e){return(n,r)=>{z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"CharacterError",eventInfo_details:`animatingMessageId: ${t}, characterId: ${e}, name: ${n.name}, info: ${r.componentStack}`,eventInfo_errorMessage:n.message}}),MO(n,r)}}CV();const Jc=D(!1),mb=D(void 0),_n=D("chat"),En=D(new Map),pt=D(void 0),Ag=D(null),IC=D(void 0),VI=D(t=>t(IC),(t,e,n)=>{const r=t(IC);r!==n&&(e(En,o=>{const i=new Map(o);return r&&i.delete(r),i}),e(IC,n))}),UO=D(null),go=D(t=>{const e=t(pt);if(e)return t(En).get(e)}),H$=aI(go,t=>(t==null?void 0:t.streamingState)==="streaming",(t,e)=>t===e),Qke=t=>aI(En,e=>{var n;return((n=e.get(t))==null?void 0:n.streamingState)==="streaming"},(e,n)=>e===n),Eu=D(!1),li=D(new Map),Jke=D([]);D([]);const Zke=t=>D(e=>e(li).get(t)),Zi=D(t=>{var e;return((e=t(go))==null?void 0:e.history)??[]}),$I=D(t=>{const e=t(En);for(const n of e.values())if(!n.title&&!n.history.length&&n.isNew)return n.id}),GI=D(new Map),Nh=D(void 0),gb=D([]),FO=D(!1),KI=D(t=>{var e;return jO((e=t(go))==null?void 0:e.characterId)}),fc=D("idle"),BO=D(!1),Ns=D(null),z$=D("idle"),Vh=D("checking-availability"),V$=D(null),HO=D([]),Ac=D(null),qI=D(null),WI=D([]),$$=D([]),zO=D(null),G$=D(t=>t(Ac)===0),YI=D(null),VO=D(null),K$=D(null),$h=D(!1),$O=D(!1),GO=D(kV),_f=D(void 0),q$=D(!0),KO=D(null),W$=D(t=>!!t(KO));D(null);const Cd=D(!1);D(null);const vb=D(void 0),Y$=D(void 0),Q$=D(void 0),J$=D(t=>{const e=t(go);return e==null?void 0:e.suggestedFollowup}),Xke=D(void 0),qO=D(null),exe=D(!1),Z$=D(!1),QI=D(void 0),txe=D(!1),nxe=D(void 0),WO=D(null),X$=D(null),JI=D(!1),Zc=D(void 0),rxe=ub({}),bb=D(void 0),kr=D("chat-only"),oxe=D(null),ixe=D(null),sxe=D(null),eG=D(null),YO=D({}),ZI=D(!1),fs=D(null),QO=D({data:void 0,isLoading:!1}),tG=D(t=>t(QO).data),JO=D(t=>t(QO).isLoading),$m=D(!1),ZO=D(null);D(t=>{const e=t(ZO);return(e==null?void 0:e.lcp)??null});const XO=D(null),nG=IM("coachmark",{},void 0,{getOnInit:!0}),rG="App Store",oG="Google Play",iG=["m365-personal","m365-family-admin"],e5=["m365-family-guest","m365-premium-guest","m365-premium-admin"],sG=["m365-personal","m365-family-admin"],Hk=["pro","m365-premium-admin","m365-family-admin","m365-personal","m365-personal-classic","m365-premium-guest","m365-family-guest","m365-family-classic-admin","m365-family-classic-guest","m365-basic"];function aG(t,e=!1){return t.length===0?e?"buypremium":"buym365":t.some(n=>n.tier==="pro")?"buypremium":t.some(n=>e5.includes(n.tier))?null:t.some(n=>sG.includes(n.tier))||e?"upgradepremium":"upgradem365"}function axe(t){return t.length>0&&!t.some(e=>e.tier==="pro")}function cxe(t){return t.some(e=>iG.includes(e.tier))&&!t.some(e=>e5.includes(e.tier))}function cG(t){return t.slice().sort((e,n)=>Hk.indexOf(e.tier)-Hk.indexOf(n.tier))}function lxe(t){const e=t.find(n=>n.tier==="pro");return(e==null?void 0:e.isAutoRenew)??!1}function lG(t){const e=t==null?void 0:t.tier,n=t==null?void 0:t.channel,r=e!==void 0&&["pro","m365-personal","m365-family-admin","m365-premium-admin"].includes(e)&&(n==="apple"||n==="google");return{shouldRedirectMobile:r,redirectMobileSource:r?n:null}}const XI="ellie",t5=[XI],zk=l.union([l.enum(t5),l.undefined()]),uG=l.object({model:l.literal("vasa"),eyesOpenRatio:l.array(l.number()).min(1),eyesPose:l.array(l.number()).min(6),jawPose:l.array(l.number()).length(3),neckPose:l.array(l.number()).length(3),rotation:l.array(l.number()).length(3),translation:l.array(l.number()).length(3),viseme:l.array(l.number()).min(10)}),dG=l.object({model:l.literal("spda2e"),poseDiffusion:l.array(l.number())}),vo=l.object({partId:l.string()}),eT=l.object({event:l.literal("invokeAction"),actionId:l.string()}),hG=l.enum(wV),fG=l.object({type:l.literal("code"),language:hG,content:l.string()}),pG=l.object({type:l.literal("file"),url:l.string().refine(t=>t.startsWith("/")||l.string().url().safeParse(t).success,{message:"Must be a valid URL or relative path"}),name:l.string(),contentType:l.string()}),mG=l.discriminatedUnion("type",[fG,pG]),n5=l.union([l.literal("running"),l.literal("completed"),l.literal("failed")]),gG=l.object({title:l.string(),status:n5}),kg=l.object({status:n5,title:l.string(),steps:l.array(gG),artifacts:l.array(mG)}),vG=vo.extend({type:l.literal("activity"),activity:kg,activities:l.array(kg).nonempty().optional()}),Kr=l.object({amount:l.number(),currency:l.string().nullable(),currencySymbol:l.string().nullable()}),bG=l.enum(["current-search-term","recent-searches","age","gender","website-visits","interests","custom-audience","similar-audience","profile-targeting"]);l.enum(["multimedia","product","tourActivity","propertyPromotion","text","miniShowroom","mainShowroom","showroom","organic"]);const yG=l.enum(["top","bottom","left","right"]),CG=l.object({adDomain:l.string(),advertiser:l.object({name:l.string(),country:l.string()}),isVerified:l.boolean(),selectionReasons:l.array(bG)}),Xc=l.object({url:l.string(),urlPingSuffix:l.string()}),Ps=l.object({url:l.string(),width:l.number().nullish(),height:l.number().nullish(),link:Xc.nullish(),impressionToken:l.string().nullish()}),SG=l.object({downPayment:l.string(),description:l.string()}),EG=l.object({rating:l.number(),link:Xc,impressionToken:l.string()}),sp=l.object({businessName:l.string(),image:Ps,impressionToken:l.string().nullish()}),r5=l.object({text:l.string(),url:l.string(),urlPingSuffix:l.string()}),IG=l.object({title:l.string(),text:l.string(),url:l.string(),layout:l.enum(["inline","overlay"])}),el=l.object({impressionToken:l.string(),selectionCriteria:CG}),yb=l.object({rowIndex:l.number().int(),columnIndex:l.number().int(),textPosition:yG,imagesPerRow:l.number().int()}),o5=el.extend({type:l.literal("multimedia"),description:l.string(),title:l.string(),displayUrl:l.string(),link:Xc,image:Ps.nullish(),logo:sp.nullish(),action:r5.nullish(),layout:yb.nullish()});el.extend({type:l.literal("organic"),description:l.string(),title:l.string(),link:l.string(),image:Ps,layout:yb});const Cb=l.object({category:l.string(),value:l.string()}),tT=el.extend({type:l.literal("product"),offer:l.object({seller:l.string(),link:Xc,price:Kr,lowPrice:Kr.nullish(),item:l.object({name:l.string(),image:Ps})}),tags:l.array(Cb).nullish(),shipping:l.object({isFree:l.boolean(),description:l.string()}).nullish(),productRating:EG.nullish(),installment:SG.nullish(),pricePerUnit:l.string().nullish(),energyRating:l.string().nullish(),layout:yb.nullish()}),i5=el.extend({type:l.literal("tourActivity"),title:l.string(),domain:l.string(),startingPrice:Kr,image:Ps,link:Xc,tags:l.array(Cb).nullish()}),s5=el.extend({type:l.literal("propertyPromotion"),title:l.string(),domain:l.string(),price:Kr,image:Ps,link:Xc,tags:l.array(Cb).nullish()}),TG=el.extend({type:l.literal("text"),title:l.string(),description:l.string(),displayUrl:l.string(),link:Xc,image:Ps.nullish(),logo:sp.nullish(),disclaimer:IG.nullish()}),_G=el.extend({type:l.literal("miniShowroom"),title:l.string(),description:l.string(),displayUrl:l.string(),image:Ps,logo:sp.nullish(),brandId:l.string().nullish()}),wG=l.object({ad:l.union([tT,o5]),adId:l.string().nullish()}),AG=l.object({isLoading:l.boolean().nullish()}),a5=AG.extend({type:l.literal("mainShowroom"),id:l.string(),brandId:l.string(),title:l.string().nullish(),description:l.string().nullish(),backgroundColor:l.number().int().nullish(),images:l.array(Ps).nullish(),logo:sp.nullish(),slotAds:l.array(wG).nullish(),action:r5.nullish(),layout:yb.nullish()}),kG=l.union([o5,tT,i5,s5,TG,_G,a5]);l.union([tT,i5,s5]);const c5=l.object({pageLoadPingUrl:l.string(),visibilityPingUrlBase:l.string(),clickPingUrlBase:l.string()}),TC=l.object({tagsSupported:l.boolean()});l.object({supportedTypes:l.array(l.enum(["multimedia","product","tourActivity","propertyPromotion","text","showroom","miniShowroom","mainShowroom"])),product:TC.nullish(),propertyPromotion:TC.nullish(),tourActivity:TC.nullish(),optOutOfPersonalization:l.boolean().nullish()});l.object({showroom:l.object({brandId:l.string(),brandName:l.string().nullish(),adId:l.string().nullish()})});const xG=l.object({brandBackground:l.number().int().nullish(),brandLogo:sp,conversationId:l.string(),theme:l.enum(["light","dark"]).nullish(),viewMode:l.enum(["cardView","extendedView"]),rguid:l.string().nullish(),rlink:l.string().nullish(),messageId:l.string(),triggerAt:l.number(),mainShowroomAdId:l.string().nullish()});xG.extend({brandId:l.string(),adId:l.string().nullish()});l.object({brandId:l.string(),brandName:l.string().nullish(),messageId:l.string(),conversationId:l.string(),visible:l.boolean()});const RG=l.object({requestId:l.string(),ads:l.array(a5),instrumentation:c5}),NG=l.object({selectedTag:Cb.nullish(),collapsed:l.boolean().nullish(),showroomData:l.array(l.object({requestUrl:l.string(),response:RG})).nullish()}),PG=NG.extend({type:l.literal("ads"),requestId:l.string(),summary:l.string(),ads:l.array(kG).nullish(),instrumentation:c5}),MG=l.object({type:l.literal("computerUseFeedback")}),tl=l.union([l.literal("startTask"),l.literal("pauseTask"),l.literal("resumeTask"),l.literal("cancelTask"),l.literal("takeTaskControl"),l.literal("releaseTaskControl")]),OG=l.union([l.literal("bringAgentTabsToForeground"),l.literal("failedTask"),l.literal("completedTask"),l.literal("moveAgentTabsToBackground"),l.literal("showConsentDialog")]);l.union([tl,OG]);const LG=l.union([l.literal("allSessionInfo"),l.literal("activeSessionInfo"),l.literal("failedTask"),l.literal("completedTask")]);l.union([tl,LG]);const DG=l.union([l.literal("allSessionInfo"),l.literal("activeSessionInfo"),l.literal("failedTask"),l.literal("completedTask")]);l.union([tl,DG]);const l5=l.union([l.literal("askUserInput"),l.literal("safetyRiskDetected"),l.literal("userTakeControl"),l.literal("giveBackControl"),l.literal("resumeFromInput"),l.literal("resumeFromRisk"),l.literal("pauseByClick"),l.literal("resumeByClick"),l.literal("taskCompleted")]),jG=l.object({reason:l5,title:l.string().optional(),text:l.string().optional()}),Sd=l.object({taskId:l.string()}),UG=Sd.extend({type:l.literal("startTask")}),FG=Sd.extend({type:l.literal("pauseTask")}),BG=Sd.extend({type:l.literal("resumeTask")}),HG=Sd.extend({type:l.literal("cancelTask")}),zG=Sd.extend({type:l.literal("takeTaskControl")}),VG=Sd.extend({type:l.literal("releaseTaskControl")}),u5=l.object({title:l.string(),instruction:l.object({text:l.string(),websites:l.array(l.object({url:l.string().url(),iconUrl:l.string().url().optional()}))})}),uxe=u5.extend({id:l.string()});u5.extend({isActive:l.boolean()});const $G=l.enum(["choose","replay"]),GG=l.enum(["2","1","0.5"]),KG=l.object({isRunning:l.boolean().nullish(),speed:GG.nullish()}),qG=l.object({name:l.string(),url:l.string().nullish(),description:l.string().nullish(),phoneNumber:l.string().nullish(),smsNumber:l.string().nullish(),chatUrl:l.string().nullish(),whatsAppUrl:l.string().nullish()}),WG=l.object({type:l.literal("safetyHelpline"),countryEmergencyNumber:l.string().nullable(),helplines:l.array(qG)}),YG=l.object({type:l.literal("document"),attachmentId:l.string(),fileName:l.string(),contentType:l.string()}),QG=l.object({type:l.literal("file"),url:l.string().url(),name:l.string(),contentType:l.string()}),JG=l.object({name:l.string(),disclaimerUrl:l.string(),url:l.string()}),d5=l.object({price:l.number().nullish(),changeInPercentage:l.number().nullish(),changeInAmount:l.number().nullish()}),h5=l.object({id:l.string(),symbol:l.string(),displayName:l.string(),price:l.number(),previousClosePrice:l.number(),changeInPercentage:l.number(),changeInAmount:l.number(),updatedAt:l.string(),iconUrl:l.string(),provider:JG,isFollowed:l.boolean().nullish()}),ZG=l.object({priceOpen:l.number().nullish(),priceHigh:l.number().nullish(),priceLow:l.number().nullish(),price52wHigh:l.number().nullish(),price52wLow:l.number().nullish()}),ap=h5.extend({intradayPricing:ZG,isMarketLastSale:l.boolean(),exchangeTimeZoneId:l.string().nullish(),isMarketRegularHours:l.boolean().optional(),lastUpdatedAt:l.string(),tradingDayEndAt:l.string(),accumulatedVolume:l.number().nullish()}),XG=ap.extend({securityType:l.literal("stock"),marketCap:l.number().nullish(),marketCapCurrency:l.string().nullish(),averageVolume:l.number().nullish(),peRatio:l.number().nullish(),postMarket:d5.nullish()}),eK=ap.extend({securityType:l.literal("etf"),netAssets:l.number().nullish(),expenseRatio:l.number().nullish(),yieldPercent:l.number().nullish(),postMarket:d5.nullish()}),tK=ap.extend({securityType:l.literal("index")}),nK=h5.extend({securityType:l.literal("fund"),price52wHigh:l.number().nullish(),price52wLow:l.number().nullish(),netAssets:l.number().nullish(),expenseRatio:l.number().nullish(),yieldPercent:l.number().nullish(),oneYearReturn:l.number().nullish()}),f5=l.object({amount:l.number().nullish(),currency:l.string().nullish(),currencySymbol:l.string().nullish()}),Vk=l.object({value:f5,fullName:l.string().nullish()}),rK=l.object({oneMonth:l.number().nullish(),sixMonths:l.number().nullish(),oneYear:l.number().nullish()}),oK=ap.extend({securityType:l.literal("currencyExchange"),fromCurrency:Vk,toCurrency:Vk,percentageReturns:rK}),iK=ap.extend({securityType:l.literal("cryptocurrency"),marketDominancePercentage:l.number().nullish(),circulatingSupply:l.number().nullish(),maxSupply:l.number().nullish(),oneYearReturn:l.number().nullish(),marketCap:f5,marketCapCurrency:l.string().nullish()}),sK=l.enum(EV),aK=l.object({price:l.number(),volume:l.number(),at:l.string()}),$k=l.array(aK),cK=l.object({afterHoursSeries:$k,series:$k,chartType:sK}),lK=l.discriminatedUnion("securityType",[XG,eK,tK,nK,oK,iK]),uK=l.object({currency:l.string(),instrument:lK,chart:cK.optional()}),dK=uK.extend({type:l.literal("financeChart")}),hK=l.discriminatedUnion("type",[dK]),fK=l.object({id:l.string()}),pK=l.array(fK),dxe=l.object({entities:pK}),mK=l.object({type:l.literal("generativeUI"),markup:l.string(),data:l.record(l.string(),l.any())}),p5=l.object({image:l.object({url:l.string(),thumbnailUrl:l.string(),altText:l.string(),width:l.number(),height:l.number()}),source:l.object({title:l.string(),url:l.string(),iconUrl:l.string().nullable()})}),gK=l.object({type:l.literal("image"),images:l.array(p5)}),vK=l.object({type:l.literal("inlineImage"),title:l.string(),description:l.string()}).merge(p5),bK=l.object({type:l.literal("inlineVideo"),title:l.string(),description:l.string(),video:l.object({url:l.string(),thumbnailUrl:l.string(),title:l.string(),isShort:l.boolean()}),source:l.object({url:l.string(),iconUrl:l.string().optional()})}),yK=l.object({name:l.string(),logoUrl:l.string().nullable(),postUrl:l.string()}),CK=l.object({title:l.string(),companyName:l.string(),companyLogoUrl:l.string().nullable(),postedAt:l.string(),location:l.string(),providers:l.array(yK),description:l.string(),salary:l.string().nullable(),type:l.string().nullable(),locationType:l.string().nullable(),tags:l.array(l.string()).nullable()}),SK=l.object({type:l.literal("job"),jobs:l.array(CK)}),EK=l.object({type:l.literal("localEntity"),entities:l.array(l.object({name:l.string(),phoneNumber:l.string().nullish(),url:l.string().nullish(),reviews:l.array(l.object({count:l.number(),rating:l.number(),providerName:l.string(),providerIconUrl:l.string().nullish(),url:l.string()})),location:l.object({address:l.string().nullish(),latitude:l.number(),longitude:l.number()}),photos:l.array(l.object({url:l.string(),altText:l.string().nullish(),providerName:l.string().nullish(),providerUrl:l.string()})),category:l.string().nullish(),price:l.string().nullish()}))}),IK=l.object({providerName:l.string(),url:l.string().nullish(),thumbnailUrl:l.string(),providerOptions:l.array(l.string()).nullish(),source:l.object({url:l.string(),name:l.string()}).nullish()}),TK=l.object({sourceName:l.string(),maxRating:l.number(),rating:l.number(),url:l.string()}),_K=l.object({url:l.string(),source:l.object({url:l.string(),name:l.string()}).nullish()}),r1=l.object({url:l.string().nullish(),name:l.string().nullish()}),wK={thumbnail:l.object({url:l.string(),source:r1.nullish()}),source:r1.nullish()},AK=l.object({type:l.literal("mediaSpotlight"),title:l.string(),label:l.string().nullish(),description:l.string(),thumbnail:_K,facts:l.record(l.string(),l.string()).nullish(),criticRatings:l.array(TK).nullish(),watchLinks:l.array(IK).nullish(),featuredVideo:l.object(wK).nullish(),sources:l.array(r1).nullish()}),kK=l.object({id:l.string(),type:l.literal("oneDrive"),name:l.string(),lastModifiedAt:l.string(),url:l.string(),webDavUrl:l.string().optional(),contentType:l.string(),size:l.number()}),xK=l.object({type:l.literal("m365"),items:l.array(kK)}),RK=l.object({name:l.string(),url:l.string(),width:l.number().optional(),height:l.number().optional(),thumbnailUrl:l.string().optional()}),NK=l.object({images:l.array(RK)}),PK=NK.extend({type:l.literal("phoneImages")}),MK=l.object({qrCodeUrl:l.string(),linkDeviceUrl:l.string()}),OK=MK.extend({type:l.literal("phoneLinking")}),LK=l.union([l.literal("executing"),l.literal("completed"),l.literal("failed")]),nT=l.object({deviceName:l.string().optional(),state:LK.optional(),disabled:l.boolean().optional(),completedAt:l.string().optional()}),DK=l.enum(["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]),jK=nT.extend({triggerAt:l.string(),repeatDays:l.array(DK).optional().nullable()}),UK=jK.extend({type:l.literal("phoneAlarm")}),FK=nT.extend({seconds:l.number()}),BK=FK.extend({type:l.literal("phoneTimer")}),HK=nT.extend({actionId:l.string(),text:l.string(),phoneNumber:l.string().nullable().optional(),contactName:l.string().nullable().optional(),deviceName:l.string().optional()}),zK=HK.extend({type:l.literal("phoneSendMessage")}),VK=eT.extend({actionName:l.literal("phone_send_message"),parameters:l.object({text:l.string(),phoneNumber:l.string().nullable().optional(),contactName:l.string().nullable().optional()})}),$K=l.discriminatedUnion("type",[OK,PK,UK,BK,zK]),GK=l.object({type:l.literal("quiz"),title:l.string(),quiz:l.array(l.object({type:l.literal("singleSelect"),question:l.string(),options:l.array(l.string()),answer:l.number(),topics:l.array(l.string()).nullable(),explanation:l.string()}))}),KK=l.object({value:l.number(),count:l.number().nullish(),maxRating:l.number().nullish()}),qK=l.object({hours:l.number(),minutes:l.number()}),m5=l.object({name:l.string(),quantity:l.number().nullish(),unit:l.string().nullish()}),WK=l.object({title:l.string(),url:l.string().url(),source:l.string(),imageUrl:l.string().url().nullish(),rating:KK.nullish(),serving:l.number().nullish(),calories:l.number().nullish(),cookingTime:qK.nullish(),instructions:l.array(l.string()).nullish(),ingredients:l.array(m5).nullish()}),YK=l.object({type:l.literal("recipe"),recipes:l.array(WK)});l.object({title:l.string(),url:l.string().url(),ingredients:l.array(m5),instructions:l.array(l.string()).nullish(),imageUrl:l.string().url().nullish(),messageId:l.string().nullish()});const g5=l.object({url:l.string(),name:l.string(),imageUrl:l.string().nullish(),images:l.array(l.string()).nullish(),price:Kr,seller:l.string().nullish()}),v5=l.object({value:l.number(),count:l.number()}).nullish(),QK=g5.extend({type:l.literal("shopping"),id:l.string(),rating:v5}),JK=g5.extend({isNotificationEnabled:l.boolean().nullish(),offerId:l.string(),currentPrice:Kr.nullish(),percentageDrop:l.number(),durationInWeeks:l.number()}),b5=l.object({title:l.string().nullish(),url:l.string()}),ZK=l.enum(["textual","visual"]),XK=l.object({displayName:l.string(),value:l.string(),isActive:l.boolean(),isSelected:l.boolean(),thumbnailImage:b5.nullish()}),eq=l.object({id:l.string(),displayName:l.string(),filterValues:l.array(XK),filterType:ZK}),tq=l.object({id:l.string().nullish(),groupId:l.string().nullish(),brandGroupId:l.string().nullish()}),nq=l.object({displayName:l.string(),values:l.array(l.string())}),y5=l.object({offerUrl:l.string(),domain:l.string()}),rq=l.object({summary:l.string(),attributions:l.array(y5)}),oq=l.object({pros:l.array(l.string()).nullish(),cons:l.array(l.string()).nullish(),attributions:l.array(y5)}),iq=l.discriminatedUnion("type",[l.object({type:l.literal("buyWithMerchant"),checkoutUrl:l.string().nullish(),merchant:l.string().nullish()}),l.object({type:l.literal("buyWithCopilot"),merchantProvider:l.string().nullish(),storeId:l.string().nullish()})]),rT=l.object({product:tq,offerId:l.string(),url:l.string(),name:l.string(),description:l.string().nullish(),images:l.array(b5).nullish(),filters:l.array(eq).nullish(),specifications:l.array(nq).nullish(),review:rq.nullish(),prosAndCons:oq.nullish(),price:Kr,discountPrice:Kr.nullish(),seller:l.string(),sellerLogoUrl:l.string().nullish(),brandName:l.string().nullish(),rating:v5.nullish(),checkoutOption:iq.nullish(),curation:l.string().nullish(),canTrackPrice:l.boolean()}),sq=l.object({type:l.literal("shoppingProducts"),products:l.array(rT)}),C5=l.union([l.literal("lowest-price"),l.literal("free-shipping")]),aq=l.object({offerName:l.string(),offerId:l.string(),url:l.string(),price:Kr,discountPrice:Kr.nullish(),seller:l.string(),sellerLogoUrl:l.string().nullish(),tags:l.array(C5).nullish(),canTrackPrice:l.boolean()}),hxe=l.object({error:l.string(),message:l.string()}),cq=l.object({minPrice:Kr,maxPrice:Kr,averagePrice:Kr,timePeriodInDays:l.number()}),S5=l.object({date:l.coerce.date(),price:Kr}),lq=l.object({daily:S5.array()}),uq=l.object({label:l.string(),prompt:l.string()}),dq=l.object({scenario:l.literal("priceHistory"),priceHistory:l.object({dailyPrices:S5.array(),type:l.union([l.literal("increase"),l.literal("decrease")]),percentage:l.number()})}),hq=l.discriminatedUnion("scenario",[dq]),fxe=rT.extend({otherBuyingOptions:l.array(aq).nullish(),priceInsight:cq.nullish(),tags:l.array(C5).nullish(),priceHistory:lq.nullish(),conversationStarters:l.array(uq).nullish(),nudge:hq.nullish()}),pxe=l.object({products:JK.array()}),fq=l.object({category:l.string(),curationGroupId:l.string(),position:l.union([l.literal("top"),l.literal("middle"),l.literal("bottom")]).nullish()}),Gm=rT.extend({curationInfo:fq.nullish()});l.object({product:Gm,messageId:l.string(),allProducts:l.array(Gm).nullish(),accessories:l.array(Gm).nullish()});const pq=l.object({type:l.literal("shoppingCurated"),title:l.string().optional(),products:l.array(Gm),groupType:l.string().nullish()}),mq=l.discriminatedUnion("type",[QK,sq,pq]),mxe=l.object({emailNotificationEnabled:l.boolean()}),gq=l.object({name:l.string(),url:l.string(),offerId:l.string()}),vq=l.object({url:l.string(),source:l.string()}),bq=l.object({reason:l.string(),references:l.array(vq)}),yq=l.enum(["buy-now","buy-later"]),gxe=l.object({whenToBuy:yq,seller:gq,supportingReasons:l.array(bq)});l.object({isPDP:l.boolean(),name:l.string().nullish(),image:l.string().url().nullish(),base64_image:l.string().nullish(),price_currency:l.string().nullish(),price_value:l.coerce.number().nullish(),"aggregateRating/ratingValue":l.union([l.string(),l.nan()]).nullish(),"aggregateRating/reviewCount":l.union([l.string(),l.nan()]).nullish()});l.object({name:l.string().optional(),rating:l.object({value:l.number(),count:l.number()}).optional(),images:l.array(l.object({url:l.string()})).optional(),price:l.object({amount:l.number(),currency:l.string().nullable(),currencySymbol:l.string().nullable()}).optional()});const Cq=l.enum(["%","$"]),E5=l.object({category:l.string(),commissionType:Cq,commissionValue:l.number(),priority:l.number()}),Sq=E5.extend({maxRebateValue:l.number().nullish(),minPurchaseValue:l.number().nullish()});l.object({highestCashbackCategory:Sq,merchantName:l.string(),merchantId:l.string(),merchantFullName:l.string(),merchantUri:l.string(),affiliateNetwork:l.string(),categories:l.array(E5),exclusions:l.string(),isSignedinWithMSA:l.boolean(),isCashbackActivated:l.boolean(),isDealDaysOffer:l.boolean().nullish()});const Eq=l.enum(["home","away"]),ui=l.enum(["win","loss","tie","no-game"]),I5=l.enum(["pre-game","in-progress","final","postponed","delayed","abandoned","cancelled"]),Iq=l.enum(["test","odi","t20"]),Tq=l.enum(["test","limited-overs","super-over"]),_q=l.enum([...I5.options,"drinks","dinner","tea","lunch","innings-break","super-over","toss","stumps","strategic-timeout","forfeited"]),wq=l.enum([...I5.options,"bye","retired","forfeited","unscheduled","suspended"]),Aq=l.enum(["men-singles","men-doubles","women-singles","women-doubles","mixed-doubles"]),kq=l.enum(["round-of256","round-of128","round-of64","round-of32","round-of16","quarter-final","semi-final","final"]),T5=l.object({name:l.string(),city:l.string().nullish()}),xq=l.object({name:l.string(),thumbnailUrl:l.string().nullish(),seasonPhase:l.string().nullish(),seasonStartsAt:l.string().nullish(),seasonEndsAt:l.string().nullish(),leagueId:l.string()}),Rq=l.object({type:l.literal("league"),league:xq}),xg=l.object({name:l.string(),thumbnailUrl:l.string().nullish()}),Nq=l.object({type:l.literal("team"),team:xg}),Pq=l.object({type:l.literal("matchup"),matchup:l.object({teamA:xg,teamB:xg})}),cp=l.discriminatedUnion("type",[Rq,Nq,Pq]),Mq=l.object({name:l.string(),alias:l.string().nullish(),thumbnailUrl:l.string().nullish()}),Mr=Mq.extend({primaryColorHex:l.string().nullish(),venueType:Eq.nullish(),previousGameOutcomes:l.array(ui).nullish(),seed:l.number().nullish(),gameOutcome:ui.nullish(),score:l.string().nullish()}),oT=Mr.extend({winProbability:l.number().nullish()}),iT=l.object({wins:l.number(),losses:l.number(),overtimeLosses:l.number().nullish()}),Oq=l.object({playerName:l.string(),clock:l.object({minutes:l.number(),seconds:l.number()})}),Lq=l.object({ballPossessionPercentage:l.number().nullish(),goals:l.array(Oq).nullish()}),_5=Mr.extend({gameStats:Lq,score:l.string()}),Dq=_5.extend({gameOutcome:ui}),jq=l.object({wins:l.number(),participantName:l.string()}),Uq=l.enum(["final","not-started","in-progress"]),Fq=l.enum(["national-championship","first-four","first-round","second-round","conference-semifinal","conference-final","sweet16","elite-eight","final-four","final"]),Bq=l.object({state:Uq,winsInfo:l.array(jq).nullish(),gameNumber:l.number().nullish(),conference:l.string().nullish()}),w5=Bq.extend({phase:Fq}),sT=l.object({name:l.string(),score:l.string()}),Hq=l.object({current:l.number(),total:l.number(),aggregatedScores:l.array(sT).nullish()}),aT=l.object({startsAt:l.string(),status:l.string(),leagueName:l.string(),legInfo:Hq.nullish(),leagueId:l.string().nullish(),gameId:l.string().nullish(),startTimeToBeAnnounced:l.boolean().nullish()}),Ed=l.object({minutes:l.number(),seconds:l.number()}),zq=l.enum(["quarter","half","extra","penalties","shoot-out","overtime","inning","period"]),Vq=l.enum(["top","bottom"]),ka=l.object({type:zq,period:l.number(),division:Vq.nullish()}),Sb=l.object({playingPeriod:ka,score:l.string()}),$q=oT.extend({record:iT.nullish(),gameOutcome:ui.nullish(),score:l.string().nullish(),playingPeriodScores:l.array(Sb).nullish(),gameStats:l.null().nullish()}),nl=aT.extend({week:l.number().nullish()}),rl=aT.extend({name:l.string().nullish(),seasonPhase:l.string().nullish(),bracket:w5.nullish(),week:l.number().nullish(),clock:Ed.nullish(),currentPlayingPeriod:ka.nullish()}),Gq=nl.extend({status:l.literal("pre-game"),participants:l.array(oT)}),cT=l.object({clock:Ed,description:l.string(),team:xg,participantScores:l.array(sT).nullish()}),Kq=cT.extend({type:l.enum(["score-change","yellow-card","red-card"])}),lT=cT.extend({type:l.enum(["three-point-made","two-point-made","touchdown","field-goal","extra-point","safety","two-point-conversion","blocked-punt-safety","blocked-field-goal-safety","fumble-safety"])}),Id=l.object({url:l.string(),thumbnailUrl:l.string(),title:l.string(),durationInSeconds:l.number().nullish()}),qq=rl.extend({status:l.literal("pre-game"),participants:l.array($q),timeline:l.object({events:l.array(lT)}).nullish(),videos:l.array(Id).nullish()}),Wq=nl.extend({status:l.literal("in-progress"),participants:l.array(_5),clock:Ed,currentPlayingPeriod:ka,timeline:l.object({events:l.array(Kq)}).nullish()}),Yq=nl.extend({status:l.literal("final"),participants:l.array(Dq),videos:l.array(Id).nullish()}),Qq=nl.extend({status:l.literal("postponed"),participants:l.array(Mr)}),Jq=nl.extend({status:l.literal("delayed"),participants:l.array(Mr)}),Zq=nl.extend({status:l.literal("abandoned"),participants:l.array(Mr)}),Xq=nl.extend({status:l.literal("cancelled"),participants:l.array(Mr)}),o1=l.discriminatedUnion("status",[Gq,Wq,Yq,Zq,Xq,Jq,Qq]),A5=Mr.extend({playingPeriodScores:l.array(Sb).nullish(),score:l.string(),record:iT.nullish(),gameOutcome:ui.nullish(),winProbability:l.number().nullish(),gameStats:l.null().nullish()}),eW=A5.extend({gameOutcome:ui}),tW=rl.extend({status:l.literal("in-progress"),participants:l.array(A5),clock:Ed,currentPlayingPeriod:ka,timeline:l.object({events:l.array(lT)}).nullish(),videos:l.array(Id).nullish()}),nW=rl.extend({status:l.literal("final"),participants:l.array(eW),videos:l.array(Id).nullish(),clock:Ed.nullish(),currentPlayingPeriod:ka.nullish(),timeline:l.object({events:l.array(lT)}).nullish()}),rW=rl.extend({status:l.literal("postponed"),participants:l.array(Mr)}),oW=rl.extend({status:l.literal("delayed"),participants:l.array(Mr)}),iW=rl.extend({status:l.literal("abandoned"),participants:l.array(Mr)}),sW=rl.extend({status:l.literal("cancelled"),participants:l.array(Mr)}),i1=l.discriminatedUnion("status",[qq,tW,nW,iW,sW,oW,rW]),aW=l.object({type:l.literal("sportsSchedule"),sport:l.enum(["basketball","ice-hockey","football"]),games:l.array(i1),header:cp.nullish(),heroGame:i1.nullish()}),cW=l.object({type:l.literal("sportsSchedule"),sport:l.literal("soccer"),games:l.array(o1),header:cp.nullish(),heroGame:o1.nullish()}),lW=l.object({type:l.literal("sportsGame"),sport:l.enum(["basketball","ice-hockey","football"]),game:i1}),uW=l.object({type:l.literal("sportsGame"),sport:l.literal("soccer"),game:o1}),ol=aT.extend({name:l.string().nullish(),seasonPhase:l.string(),week:l.number().nullish(),videos:l.array(Id).nullish(),bracket:w5.nullish(),clock:Ed.nullish(),currentPlayingPeriod:ka.nullish()}),k5=l.object({hits:l.number(),errors:l.number(),runs:l.number()}),uT=cT.extend({type:l.enum(["conversion","bat"]),playingPeriod:ka,participantScores:l.array(sT)}),x5=oT.extend({record:iT.nullish(),gameOutcome:ui.nullish(),score:l.string().nullish(),playingPeriodScores:l.array(Sb).nullish(),gameStats:k5.nullish()}),R5=x5.extend({playingPeriodScores:l.array(Sb).nullish(),score:l.string(),gameStats:k5.nullish()}),dW=R5.extend({gameOutcome:ui}),hW=ol.extend({status:l.literal("pre-game"),participants:l.array(x5),timeline:l.object({events:l.array(uT)}).nullish()}),fW=ol.extend({status:l.literal("in-progress"),participants:l.array(R5),currentPlayingPeriod:ka,timeline:l.object({events:l.array(uT)}).nullish()}),pW=ol.extend({status:l.literal("final"),participants:l.array(dW),videos:l.array(Id).nullish(),timeline:l.object({events:l.array(uT)}).nullish()}),mW=ol.extend({status:l.literal("postponed"),participants:l.array(Mr)}),gW=ol.extend({status:l.literal("delayed"),participants:l.array(Mr)}),vW=ol.extend({status:l.literal("abandoned"),participants:l.array(Mr)}),bW=ol.extend({status:l.literal("cancelled"),participants:l.array(Mr)}),s1=l.discriminatedUnion("status",[hW,fW,pW,mW,gW,vW,bW]),yW=l.object({type:l.literal("sportsSchedule"),sport:l.literal("baseball"),games:l.array(s1),header:cp.nullish(),heroGame:s1.nullish()}),CW=l.object({type:l.literal("sportsGame"),sport:l.literal("baseball"),game:s1}),SW=l.object({ballsFaced:l.number(),runsScored:l.number(),isBatting:l.boolean()}),EW=l.object({oversBowled:l.string(),wicketsTaken:l.number(),runsConceded:l.number(),isBowling:l.boolean()}),IW=SW.extend({type:l.literal("batting")}),TW=EW.extend({type:l.literal("bowling")}),N5=l.discriminatedUnion("type",[IW,TW]),_W=l.object({name:l.string(),stats:N5}),wW=l.object({playerName:l.string(),teamName:l.string(),gameStats:l.array(N5).nullish()}),AW=l.object({current:l.number(),required:l.number().nullish()}),kW=l.object({name:l.string(),currentMatch:l.number(),totalMatches:l.number(),roundName:l.string().nullish(),equation:l.string().nullish()}),P5=l.object({type:Tq,runs:l.number(),wickets:l.number(),oversPlayed:l.string(),isFollowedOn:l.boolean(),isDeclared:l.boolean(),duckworthLewisEquation:l.object({target:l.number(),revisedOvers:l.string()}).nullish()}),dT=l.object({name:l.string(),alias:l.string().nullish(),thumbnailUrl:l.string().nullish()}),xW=dT.extend({previousGameOutcomes:l.array(ui).nullish()}),RW=dT.extend({inningScores:l.array(P5).nullish(),playersStats:l.array(_W).nullish(),yetToBat:l.boolean()}),NW=dT.extend({gameOutcome:ui,didNotBat:l.boolean(),inningScores:l.array(P5).nullish()}),PW=l.object({startsAt:l.string(),startTimeToBeAnnounced:l.boolean(),tossInfo:l.string().nullish(),participants:l.array(xW),type:l.literal("pre")}),MW=l.object({gameSummary:l.string(),runRate:AW.nullish(),participants:l.array(RW),type:l.literal("live")}),OW=l.object({startsAt:l.string(),gameSummary:l.string(),playerOfTheMatch:wW.nullish(),participants:l.array(NW),type:l.literal("final")}),LW=l.discriminatedUnion("type",[PW,MW,OW]),a1=l.object({gameId:l.string(),leagueId:l.string(),venue:T5.nullish(),format:Iq,status:_q,seriesInfo:kW,phase:LW}),DW=l.object({type:l.literal("sportsGame"),sport:l.literal("cricket"),game:a1}),jW=l.object({type:l.literal("sportsSchedule"),sport:l.literal("cricket"),games:l.array(a1),header:cp.nullish(),heroGame:a1.nullable()}),UW=l.object({name:l.string(),countryFlagThumbnailUrl:l.string().nullish(),seed:l.number().nullish()}),FW=l.object({points:l.number(),isServing:l.boolean(),tieBreakerPoints:l.number().nullish(),currentGamePoints:l.string().nullish(),setWon:l.boolean().nullish()}),M5=l.object({players:l.array(UW)}),BW=M5,O5=M5.extend({setPoints:l.array(FW)}),HW=O5.extend({gameOutcome:ui}),zW=l.object({type:l.literal("pre"),participants:l.array(BW)}),VW=l.object({type:l.literal("live"),participants:l.array(O5)}),$W=l.object({type:l.literal("final"),participants:l.array(HW)}),GW=l.discriminatedUnion("type",[zW,VW,$W]),Gk=l.object({gameId:l.string(),leagueId:l.string(),status:wq,startsAt:l.string().nullish(),startTimeToBeAnnounced:l.boolean(),venue:T5.nullish(),matchType:Aq,round:kq.nullish(),phase:GW}),KW=l.object({type:l.literal("sportsSchedule"),sport:l.literal("tennis"),games:l.array(Gk),header:cp.nullish(),heroGame:Gk.nullish()}),qW=l.union([aW,cW,yW,jW,KW]),WW=l.discriminatedUnion("sport",[uW,lW,CW,DW]),YW=l.union([qW,WW]),QW=l.object({title:l.string(),description:l.string(),startTime:l.number(),endTime:l.number()}),JW=l.object({video:l.object({url:l.string(),thumbnailUrl:l.string(),duration:l.number(),title:l.string(),isShort:l.boolean()}),source:l.object({url:l.string(),iconUrl:l.string().optional()}),bestMomentIndex:l.number().optional(),moments:l.array(QW).optional()}),ZW=l.object({type:l.literal("video"),videos:l.array(JW)}),XW=l.enum(["c","f"]),eY=l.enum(["mm","cm","in"]),tY=l.enum(["hPa","inHg","mb","mmHg"]),nY=l.enum(["bft","kph","mph","ms"]),rY=l.enum(["m","km","mi"]),oY=l.object({temperature:XW,height:eY,pressure:tY.optional(),speed:nY.optional(),distance:rY.optional()}),hT=l.enum(yO),iY=l.enum(["rain","snow"]),fT=l.object({type:iY,amount:l.number(),chance:l.number()}),sY=l.object({current:l.number(),high:l.number().optional(),low:l.number().optional()}),aY=l.object({at:l.string(),state:hT,summary:l.string(),description:l.string().optional(),temperature:sY,precipitation:fT.optional()}),L5=l.object({high:l.number(),low:l.number()}),cY=l.object({date:l.string(),state:hT,temperature:L5,precipitation:fT.optional()}),lY=l.object({at:l.string(),state:hT,temperature:L5,precipitation:fT.optional()}),uY=l.object({daily:l.array(cY),hourly:l.array(lY).optional()}),dY=l.object({type:l.literal("weather"),location:l.string(),units:oY,spotlight:aY.optional(),forecast:uY}),wf=l.enum(yO),hY=l.object({type:l.literal("weatherTemperatureHourly"),location:l.string(),unit:l.union([l.literal("f"),l.literal("c")]),spotlight:l.object({date:l.string(),state:wf,summary:l.string(),temperature:l.number().optional(),high:l.number(),low:l.number()}),forecast:l.array(l.object({at:l.string(),state:wf,temperature:l.number(),precipitationChance:l.number()}))}),fY=l.object({type:l.literal("weatherTemperatureDaily"),location:l.string(),unit:l.union([l.literal("f"),l.literal("c")]),forecast:l.array(l.object({date:l.string(),state:wf,high:l.number(),low:l.number(),precipitationChance:l.number()}))}),D5=l.union([l.literal("rain"),l.literal("snow")]),j5=l.union([l.literal("in"),l.literal("mm")]),pY=l.object({type:l.literal("weatherPrecipitationHourly"),location:l.string(),unit:j5,precipitationType:D5,spotlight:l.object({date:l.string(),summary:l.string(),amount:l.number(),chance:l.number()}),forecast:l.array(l.object({at:l.string(),state:wf,amount:l.number(),chance:l.number()}))}),mY=l.object({type:l.literal("weatherPrecipitationDaily"),location:l.string(),unit:j5,precipitationType:D5,forecast:l.array(l.object({date:l.string(),state:wf,amount:l.number(),chance:l.number()}))}),gY=l.union([dY,hY,fY,pY,mY]),U5=l.union([PG,hK,mK,gK,vK,SK,EK,xK,AK,$K,GK,QG,WG,mq,bK,YW,ZW,gY,YK,MG,YG]),vY=l.object({id:l.string(),imageUrl:l.string(),voiceId:l.string()}),Bs=l.object({light:l.string(),dark:l.string()}),bY=l.object({foreground1:Bs,foreground2:Bs,accent:Bs,shape:Bs,shapeInverse:Bs,background1:Bs,background2:Bs,background3:Bs}),Kk=l.object({name:l.enum(["ginto-copilot-nord-bold","ginto-copilot-nord-medium-italic","ginto-copilot-480","kari-regular"]),url:l.string().url()}),yY=l.object({name:l.string(),url:l.string().url()}),Wu=l.object({url:l.string().url()}),Yu=l.object({urlLight:l.string().url(),urlDark:l.string().url()}),c1=l.object({url:l.string().url()}),Td=l.object({type:l.string(),title:l.string()}),CY=Td.extend({type:l.literal("coverPage"),content:l.string(),template:l.enum(["image-background","fuzzy-image"]),image0:Wu,sticker0:Yu.nullish(),sticker1:Yu.nullish()}),SY=Td.extend({type:l.literal("heroImage"),content:l.string(),template:l.enum(["noisy-circle","macaron","wavy-shape"]),image0:Wu}),EY=Td.extend({type:l.literal("stickerSheet"),content:l.string(),template:l.enum(["sticker1","sticker2"]),sticker0:Yu,sticker1:Yu,accent0:c1,accent1:c1}),IY=Td.extend({type:l.literal("simpleText"),content:l.string(),template:l.string().nullish()}),TY=Td.extend({type:l.literal("photoJournal"),content:l.string().nullish(),template:l.enum(["shapes-only","shapes-accents"]),variation:l.enum(["shape-group1","shape-group2"]),label0:l.string(),label1:l.string(),image0:Wu,image1:Wu,sticker0:Yu.nullish(),accent0:c1.nullish()}),_Y=Td.extend({type:l.literal("endPage"),content:l.string(),template:l.enum(["wide-cards","tall-cards"]),variation:l.enum(["shape-group1","shape-group2"]),questions:l.array(l.string()),image0:Wu,image1:Wu.nullish(),sticker0:Yu}),wY=l.object({type:l.literal("shareDefault"),template:l.string().nullish()}),AY=l.discriminatedUnion("type",[CY,SY,EY,IY,TY,_Y,wY]),kY=l.object({id:l.string(),modifiedAt:l.string(),theme:bY,font:Kk,fontHandwriting:Kk.nullish(),masks:l.array(yY),sections:l.array(AY)}),xY=l.object({type:l.literal("chatAboutNarrative"),narrativeId:l.string(),messageIndex:l.number()}),RY=l.object({type:l.literal("provideImageFeedback"),messageId:l.string(),feedbackTypes:l.array(l.string())}),NY=l.object({type:l.literal("createPage"),messageId:l.string()}),PY=l.object({type:l.literal("appendToPage"),messageId:l.string(),pageId:l.string()}),MY=l.object({id:l.string(),conversationId:l.string()}),vxe=l.object({title:l.string().nullish(),content:l.string().nullish(),conversationId:l.string()}),OY=vo.extend({type:l.literal("page"),page:l.object({id:l.string(),conversationId:l.string(),title:l.string().nullish()})}),LY=l.object({id:l.string(),title:l.string().nullish(),updatedAt:l.string(),conversationId:l.string().optional(),type:l.enum(["page","sharedPage"]).optional()}),DY=l.object({results:l.array(LY),next:l.string().nullish()}),bxe=l.object({title:l.string().nullish(),content:l.string().nullish(),page:l.object({id:l.string()}).nullable()}),yxe=l.object({id:l.string(),url:l.string()}),jY=l.enum(["page-count-exceeded","page-content-length-exceeded"]),UY=l.object({errorCode:jY}),FY=l.object({prompt:l.string()}),pT=l.literal("executeTask"),BY=l.object({type:pT,taskId:l.string(),context:FY.optional()}),HY=l.string(),zY=l.object({currentConversationId:l.string().nullable(),isNewUser:l.boolean(),banExpiresAt:l.string().nullable(),remainingTurns:l.number().nullable(),features:l.array(HY),allowBeta:l.boolean().nullish()}),VY=l.object({id:l.string(),name:l.string(),previewUrl:l.string(),voicemails:l.array(l.string())}),$Y=l.object({id:l.string(),backgroundImageUrl:l.string()}),GY=l.object({id:l.string(),name:l.string(),location:$Y.nullish()}),ti=l.object({type:l.string(),label:l.string()}),KY=l.array(ti),qY=l.object({positive:l.array(ti),negative:l.array(ti)}),vi=l.union([KY,qY]),Da=l.object({type:l.string(),label:l.string(),subOptions:l.array(ti).nullish()}),F5=l.object({local:vi,ads:vi,video:vi,image:vi,sports:vi,job:vi,shopping:vi,finance:vi,quiz:vi,weather:vi}),WY=l.object({positive:l.array(ti).nullish(),negative:l.array(ti)});F5.keyof();const B5=l.object({newsArticle:l.array(Da),newsVideo:l.array(Da),newsGem:l.array(Da),chat:l.array(Da),dailyBriefing:l.array(Da),podcast:l.array(Da),default:l.array(Da)});B5.keyof();const YY=l.object({computerUse:l.array(ti)}),QY=l.object({text:l.array(ti),image:l.array(ti),call:l.array(ti),appearance:l.array(ti),card:F5,showroom:WY.nullish(),discover:B5.nullish(),task:YY.nullish()}),JY=l.object({maxFilesPerMessage:l.number(),maxFileNameLength:l.number(),image:l.object({mimeTypes:l.array(l.string()),maxBytes:l.number()}),document:l.object({mimeTypes:l.array(l.string()),maxBytes:l.number()}),binary:l.object({mimeTypes:l.array(l.string()),maxBytes:l.number()})}),ZY=l.object({minTextLength:l.number().min(0),textDeltaPercent:l.number().min(0).max(100),debounceInMilliseconds:l.number().min(0)}),XY=l.object({signInPrompts:l.array(l.number()),voices:l.array(VY),maxTextMessageLength:l.number(),feedbackOptions:QY,characters:l.array(GY).nullish(),pageLimit:l.number(),maxPageContentLength:l.number(),maxPageTitleLength:l.number(),messagePreview:ZY,attachments:JY,portraits:l.array(vY).nullish()});l.object({hasVisionAccess:l.boolean(),allowedDomains:l.array(l.string()).nullable(),allowedDomainSuffixes:l.array(l.string()).nullable(),blockedDomains:l.array(l.string()).nullable(),blockedDomainSuffixes:l.array(l.string()).nullable()});const eQ=l.object({startTime:l.number(),endTime:l.number(),text:l.string()}),qk=l.object({url:l.string(),duration:l.number(),transcript:l.array(eQ).nullish()}),tQ=l.object({title:l.string(),image:l.string(),url:l.string(),createdAt:l.string()}),nQ=l.object({publisherName:l.string(),publisherIcon:l.string(),articles:l.array(tQ)}),Wk=l.object({url:l.string(),foregroundColor:l.string(),backgroundColor:l.string()}),Yk=l.object({name:l.string(),foregroundColor:l.string(),backgroundColor:l.string(),altText:l.string().nullish(),url:l.string()}),rQ=l.object({landscape:Yk,portrait:Yk}),oQ=l.object({id:l.string(),title:l.string(),image:l.object({landscape:Wk,portrait:Wk}),audio:l.record(l.string(),qk),transitionMusic:qk.nullable(),sources:l.array(nQ)}),H5=l.object({topics:l.array(l.object({id:l.string(),label:l.string(),imageUrl:l.string(),isFollowed:l.boolean()}))}),iQ=l.object({position:l.number(),chapterId:l.string()}),z5=l.object({isAvailable:l.boolean(),podcastId:l.string(),chapters:l.array(oQ),topics:H5.optional(),playback:iQ}),sQ=l.object({positionInSeconds:l.number(),chapterId:l.string()}),aQ=l.object({id:l.string(),title:l.string(),topic:l.string().nullable().optional(),image:rQ,audio:l.object({name:l.string(),duration:l.number()})}),Rg=l.object({isAvailable:l.boolean(),podcastId:l.string(),chapters:l.array(aQ),playback:sQ}),cQ=l.enum(_V),lQ=l.enum(IV),uQ=l.enum(TV),dQ=l.object({channel:uQ,tier:lQ,isAutoRenew:l.boolean()}),V5=l.object({id:l.string(),firstName:l.string().nullable(),anid:l.string().nullable(),isPro:l.boolean(),isDeprecated:l.boolean().nullish(),inEeaPlusRegion:l.boolean(),regionCode:l.enum(Object.values(op)),isHistoryMigrationPending:l.boolean(),isEligibleForFreeTrial:l.boolean().optional(),phoneLink:l.object({deviceName:l.string().nullable()}).nullable(),ageGroup:l.enum(SV).nullable(),allowedToggles:l.object({textTraining:l.boolean(),voiceTraining:l.boolean(),personalization:l.boolean()}),remainingCalls:l.object({reasoning:l.number(),podcastGeneration:l.number(),research:l.number()}).nullish(),accountTier:cQ.nullish(),subscriptions:l.array(dQ).nullish()}),hQ=l.object({preferredVoice:l.string().nullable(),preferredCharacter:l.string().nullable().optional(),optOutOfTraining:l.boolean(),optInToVoiceTraining:l.boolean(),optOutOfPersonalization:l.boolean(),optOutOfPhoneConnection:l.boolean(),optInToGenerativeUI:l.boolean().optional(),allowBiometricDataUse:l.boolean().optional(),allowOneDriveAccess:l.boolean().optional(),features:l.object({suggestedFollowups:l.boolean().optional()}).nullish()}),$5=l.object({errorCode:l.union([l.literal("attachment-too-large"),l.literal("unsupported-content-type"),l.literal("empty-attachment"),l.literal("content-blocked"),l.literal("rate-limit-exceeded"),l.literal("not-signed-in")])}),fQ=l.union([l.object({url:l.string()}),$5]),G5=l.union([l.object({id:l.string()}),$5]),pQ=l.object({id:l.string(),title:l.string().optional(),updatedAt:l.string(),characterId:l.string().nullable().optional(),continuedAt:l.string().nullable()}),mQ=l.object({results:l.array(pQ),next:l.string().nullable()}),gQ=l.object({id:l.string()}),K5=l.union([l.literal("thumbs-down"),l.literal("thumbs-up"),l.null()]),Eb=l.union([l.literal("running"),l.literal("completed"),l.literal("failed"),l.literal("cancelled"),l.literal("pending"),l.literal("paused")]),vQ=l.union([l.literal("research"),l.literal("computerUse"),l.literal("podcast")]),bQ=l.object({type:l.literal("chainOfThought"),text:l.string()}),yQ=l.object({type:l.literal("query"),text:l.string()}),CQ=l.object({type:l.literal("citation"),title:l.string(),url:l.string()}),SQ=l.discriminatedUnion("type",[bQ,yQ,CQ]),q5=l.object({title:l.string(),url:l.string(),position:l.number(),iconUrl:l.string().nullish(),publisher:l.string().nullish()}),EQ=l.object({id:l.string(),title:l.string().nullish(),contents:l.array(SQ).nullish(),inlineCitations:l.array(q5).nullish(),partialOutput:l.array(l.string()).nullish(),finalResponse:l.string().nullish(),type:l.literal("research"),status:Eb,prompt:l.string().optional()}),W5=l.object({url:l.string(),createdAt:l.string()}),IQ=l.object({type:l.literal("computerUse"),title:l.string().nullish(),conversationId:l.string().nullish(),id:l.string(),status:Eb,lastScreenshot:W5.nullish(),updatedAt:l.string().nullish()}),Y5=l.object({id:l.string(),title:l.string().nullish(),thumbnail:l.object({name:l.string().nullish()}).nullish()}),TQ=l.object({type:l.literal("podcast"),id:l.string(),podcast:Y5.nullish(),status:Eb,updatedAt:l.string().nullish()}),Q5=l.discriminatedUnion("type",[EQ,IQ,TQ]),mT=l.object({id:l.string(),title:l.string().optional(),conversationId:l.string().optional(),updatedAt:l.string(),status:Eb,type:vQ}),_Q=mT.extend({type:l.literal("research")}),wQ=mT.extend({type:l.literal("computerUse"),screenshot:l.string().nullish(),lastScreenshot:W5.nullish(),chainOfThought:l.array(l.string()).nullish(),computerAction:l.string().nullish(),statusChange:jG.optional(),lastUserCommand:tl.optional(),reaction:K5.optional(),activeTabFaviconUrl:l.string().nullish(),activeTabTitle:l.string().nullish(),viewMode:$G.nullish(),replay:KG.nullish()}),AQ=mT.extend({type:l.literal("podcast"),podcast:Y5.nullish()}),kQ=l.discriminatedUnion("type",[_Q,wQ,AQ]),Cxe=l.object({results:l.array(kQ),next:l.string().nullable()}),_d=l.union([l.literal("report"),...K5.options]),xQ=l.union([l.literal("generating"),l.literal("generated"),l.literal("failed"),l.literal("non-complete")]),J5=l.object({id:l.string(),createdAt:l.string()}),RQ=l.object({index:l.string(),title:l.string(),url:l.string(),iconUrl:l.string().nullable(),publisher:l.string().nullable()}),NQ=vo.extend({type:l.literal("image"),url:l.string().optional(),prompt:l.string().optional().nullable(),isPartiallyLoading:l.boolean().optional(),reaction:_d.optional(),partialGenerationStep:l.number().optional(),status:xQ.optional(),progressionText:l.string().nullable().optional()}),PQ=vo.extend({type:l.literal("citation"),...q5.shape}),MQ=vo.extend({type:l.literal("text"),text:l.string(),citations:l.array(RQ).optional(),reaction:_d.optional()}),OQ=vo.extend({type:l.literal("task"),task:Q5.nullish(),reaction:_d.optional()}),LQ=vo.extend({type:l.literal("card"),card:U5,reaction:_d.optional()}),DQ=vo.extend({type:l.literal("document"),attachmentId:l.string(),fileName:l.string(),contentType:l.string(),reaction:_d.optional()}),jQ=vo.extend({type:l.literal("deleted"),partType:l.enum(["page","task"])}),UQ=vo.extend({type:l.literal("error"),text:l.string()}),FQ=l.object({text:l.string(),title:l.string().optional(),lastSubActionScreenshotUrl:l.string().nullish()}),BQ=vo.extend({type:l.literal("chainOfThought"),text:l.string(),title:l.string().optional(),screenshotUrl:l.string().nullish(),reaction:_d.optional(),partId:l.string()}),HQ=vo.extend({type:l.literal("chainOfThoughtGroup"),items:l.array(FQ).optional(),subAction:l.string().optional(),activities:l.array(kg).optional(),isComplete:l.boolean()}),zQ=vo.extend({type:l.literal("memorySignal"),text:l.string(),signalType:l.union([l.literal("remember"),l.literal("forget")]).nullish()}),VQ=l.object({position:l.union([l.literal("left"),l.literal("right")]),isDefault:l.boolean()}),$Q=l.discriminatedUnion("type",[MQ,NQ,OY,PQ,UQ,LQ,DQ,OQ,jQ,BQ,HQ,vG,zQ]),GQ=l.object({type:l.literal("text"),text:l.string()}),KQ=l.object({type:l.literal("browserTabs"),tabs:l.array(l.object({title:l.string().optional(),url:l.string().optional(),id:l.number().optional(),favIconUrl:l.string().optional(),windowId:l.number()}))}),qQ=l.object({type:l.literal("image"),url:l.string()}),WQ=l.object({type:l.literal("document"),partId:l.string(),fileName:l.string(),contentType:l.string()});l.object({type:l.literal("document"),attachmentId:l.string()});l.union([tl,pT]);l.union([l.literal("provideImageFeedback"),l.literal("createPage"),l.literal("appendToPage"),l.literal("promptCharacterSpeech"),tl,l.literal("chatAboutNarrative"),pT]);const YQ=l.object({type:l.literal("promptCharacterSpeech")}),QQ=l.discriminatedUnion("type",[RY,NY,PY,UG,FG,BG,HG,zG,VG,YQ,xY,BY]),JQ=l.object({type:l.literal("command"),command:QQ}),ZQ=l.object({type:l.literal("dailyBriefing"),chapterId:l.string()}),XQ=l.object({type:l.literal("greeting"),greetingMessage:l.string()}),eJ=l.object({type:l.literal("news"),articleId:l.string()}),tJ=l.object({type:l.literal("newsGem"),gemId:l.string(),snapshotKey:l.string()}),nJ=l.discriminatedUnion("type",[ZQ,XQ,eJ,tJ]);l.object({type:l.literal("reference"),reference:nJ});const rJ=l.discriminatedUnion("type",[GQ,qQ,WQ,JQ,KQ]),oJ=l.union([l.literal("chat"),l.literal("smart"),l.literal("reasoning"),l.literal("research"),l.literal("computerUse")]),iJ=J5.extend({author:l.literal("ai"),content:l.array($Q),mode:oJ.optional(),sideBySideConfig:VQ.optional()}),sJ=J5.extend({author:l.literal("human"),content:l.array(rJ)}),Z5=l.discriminatedUnion("author",[iJ,sJ]),X5=l.object({results:l.array(Z5),next:l.string().nullable()}),aJ=l.object({messages:l.array(Z5),conversationTitle:l.string()}),Sxe=l.object({url:l.string()}),cJ=l.object({conversation:l.object({id:l.string(),title:l.string()})});l.object({qc:l.object({q:l.string(),gt:l.string(),sc:l.string()}),s:l.array(l.object({st:l.string(),t:l.string()}))});const gT=l.union([l.literal("active"),l.literal("banned"),l.literal("ineligible")]),vT=l.union([l.literal("active"),l.literal("not-started"),l.literal("expired"),l.literal("paused")]),lJ=l.union([l.literal("not-started"),l.literal("completed"),l.literal("ineligible")]),uJ=l.object({id:l.string(),type:l.string(),points:l.number()}),dJ=l.object({redeemableCount:l.number(),redeemedCount:l.number(),skus:l.array(uJ)}),Exe=l.object({userStatus:gT,status:vT,startAt:l.string(),endAt:l.string(),referralCode:l.string().nullish(),referralTaskStatus:lJ.nullish(),rewards:dJ.nullish()}),Ixe=l.object({userStatus:gT.nullish(),programStatus:vT}),Txe=l.object({userStatus:gT.nullish(),programStatus:vT,lastRequestTime:l.string(),userId:l.string()}),_C=l.enum(["prefillComposer","sendMessage","deepLink"]),bT=l.discriminatedUnion("type",[l.object({type:l.literal(_C.enum.prefillComposer),prompt:l.string()}),l.object({type:l.literal(_C.enum.sendMessage),prompt:l.string()}),l.object({type:l.literal(_C.enum.deepLink),uri:l.string()})]),eL=l.object({id:l.string(),text:l.string(),action:bT}),hJ=l.object({id:l.string(),text:l.string(),thumbnail:l.object({url:l.string(),altText:l.string()}),action:bT}),fJ=l.object({id:l.string(),text:l.string(),action:bT}),pJ=l.object({id:l.string(),category:l.string(),greeting:l.string(),items:l.array(eL)}),mJ=l.discriminatedUnion("type",[l.object({type:l.literal("text"),id:l.literal("conversation-starter"),title:l.string().nullish(),items:l.array(eL)}),l.object({type:l.literal("textAndImage"),id:l.union([l.literal("feature-discovery"),l.literal("kickstarter"),l.literal("image-generation")]),title:l.string().nullish(),items:l.array(hJ)}),l.object({type:l.literal("textAndGreeting"),id:l.string(),title:l.string().nullish(),greeting:l.string().nullish(),items:l.array(fJ)}),l.object({type:l.literal("textAndCategory"),id:l.literal("categorized-conversation-starter"),title:l.string().nullish(),items:l.array(pJ)})]),gJ=l.object({widgets:l.array(mJ)}),vJ=l.object({dPPRank:l.string()}),bJ=l.object({query:l.string(),source:l.string(),metadata:vJ});l.object({suggestedQueries:l.array(bJ),url:l.string()});const yJ=l.object({type:l.literal("topicList"),id:l.string(),topics:l.array(l.object({text:l.string()})).nullable(),selectedIndex:l.number().nullable()}),CJ=yJ.nullable(),SJ=l.union([l.string(),l.number(),l.boolean(),l.null()]),Af=l.lazy(()=>l.union([SJ,l.array(Af),l.record(Af)])),EJ=l.object({op:l.literal("add"),path:l.string(),value:Af}),IJ=l.object({op:l.literal("remove"),path:l.string()}),TJ=l.object({op:l.literal("replace"),path:l.string(),value:Af}),_J=l.object({op:l.literal("move"),from:l.string(),path:l.string()}),wJ=l.object({op:l.literal("copy"),from:l.string(),path:l.string()}),AJ=l.object({op:l.literal("test"),path:l.string(),value:Af}),kJ=l.discriminatedUnion("op",[EJ,IJ,TJ,_J,wJ,AJ]),Qk=l.array(kJ),xJ=l.union([l.literal("event-not-recognized"),l.literal("over-turn-limit"),l.literal("unknown-error"),l.literal("message-too-large"),l.literal("invalid-event"),l.literal("empty-message"),l.literal("empty-text"),l.literal("text-too-long"),l.literal("multiple-text-parts"),l.literal("multiple-image-parts"),l.literal("too-many-messages"),l.literal("over-reasoning-quota"),l.literal("over-lifetime-task-quota"),l.literal("over-task-quota"),l.literal("page-content-length-exceeded"),l.literal("page-count-exceeded"),l.literal("character-out-of-capacity"),l.string()]),RJ=l.union([l.literal("blocked"),l.literal("not-signed-in"),l.literal("failed"),l.string()]),tL=l.union([l.literal("quiz"),l.literal("generative-ui")]),nL=l.union([l.literal("throttled"),l.literal("throttled-non-pro"),l.literal("time-expired"),l.literal("time-expired-non-pro"),l.literal("not-in-flight"),l.literal("error"),l.literal("signed-out"),l.literal("region-not-available"),l.literal("time-expired-month"),l.literal("time-expired-month-non-pro")]),NJ=l.object({voice:l.string().optional(),speed:l.number().min(50).max(200).optional()}).partial(),Jk=l.number().min(0).max(200).default(100),Zk=l.union([l.literal("standard"),l.literal("character")]),Xk=l.discriminatedUnion("event",[eT,l.object({event:l.literal("pong"),id:l.string()}),l.object({event:l.literal("connected"),id:l.string(),requestId:l.string()}),l.object({event:l.literal("received"),conversationId:l.string(),messageId:l.string(),createdAt:l.string()}),l.object({event:l.literal("emojiReaction"),messageId:l.string(),emoji:l.string()}),l.object({event:l.literal("startMessage"),conversationId:l.string(),messageId:l.string(),createdAt:l.string()}),l.object({event:l.literal("appendText"),messageId:l.string(),text:l.string(),partId:l.string()}),l.object({event:l.literal("replaceText"),messageId:l.string(),text:l.string(),partId:l.string()}),l.object({event:l.literal("titleUpdate"),conversationId:l.string(),title:l.string()}),l.object({event:l.literal("generatingImage"),messageId:l.string(),prompt:l.string(),partId:l.string(),progressionText:l.string().nullable().optional()}),l.object({id:l.string(),event:l.literal("generatingImages"),messageId:l.string(),partIds:l.array(l.string()),prompt:l.string()}),l.object({event:l.literal("imageGenerated"),messageId:l.string(),url:l.string(),partId:l.string()}),l.object({event:l.literal("partialImageGenerated"),messageId:l.string(),url:l.string(),partId:l.string(),content:l.string()}),l.object({event:l.literal("page"),messageId:l.string(),partId:l.string(),page:l.object({id:l.string(),conversationId:l.string(),title:l.string().nullish()})}),l.object({event:l.literal("challenge")}),l.object({event:l.literal("imageGenerationFailed"),messageId:l.string(),errorCode:RJ,partId:l.string()}),l.object({id:l.string(),event:l.literal("generatingCard"),messageId:l.string(),partId:l.string(),type:tL}),l.object({id:l.string(),event:l.literal("cardGenerationFailed"),messageId:l.string(),partId:l.string()}),l.object({event:l.literal("transcriptEvent")}),l.object({event:l.literal("audioStart"),conversationId:l.string()}),l.object({event:l.literal("audio"),audio:l.string()}),l.object({event:l.literal("audioStartFailed"),reason:nL}),l.object({event:l.literal("audioTimeRemaining"),seconds:l.number()}),l.object({event:l.literal("callTerminated"),reason:l.string().optional()}),l.object({event:l.literal("audioEnd")}),l.object({event:l.literal("callEnded"),id:l.string()}),l.object({event:l.literal("audioConfig"),options:NJ}),l.object({event:l.literal("interruptAudio")}),l.object({event:l.literal("speechEndDetected")}),l.object({event:l.literal("citation"),messageId:l.string(),url:l.string(),title:l.string(),partId:l.string(),iconUrl:l.string().nullable(),publisher:l.string().nullable()}),l.object({event:l.literal("chainOfThought"),messageId:l.string(),partId:l.string(),text:l.string()}),l.object({event:l.literal("turnLimitReached"),id:l.string()}),l.object({event:l.literal("done"),messageId:l.string()}),l.object({event:l.literal("error"),errorCode:xJ}),l.object({event:l.literal("card"),messageId:l.string(),partId:l.string(),card:U5}),l.object({event:l.literal("document"),messageId:l.string(),partId:l.string(),attachmentId:l.string(),fileName:l.string(),contentType:l.string()}),l.object({event:l.literal("callUI"),id:l.string(),callUI:CJ}),l.object({event:l.literal("banned"),expiresAt:l.string()}),l.object({id:l.string(),event:l.literal("suggestedFollowups"),messageId:l.string(),suggestions:l.array(l.string())}),l.object({event:l.literal("taskStart"),id:l.string(),messageId:l.string(),partId:l.string(),task:Q5}),l.object({event:l.literal("taskUpdate"),id:l.string().nullish(),taskId:l.string(),update:Qk}),l.object({event:l.literal("startSuggestion"),id:l.string(),pageId:l.string(),suggestionId:l.string(),editTargets:l.array(l.object({startIndex:l.number(),endIndex:l.number()}))}),l.object({event:l.literal("appendSuggestion"),id:l.string(),pageId:l.string(),suggestionId:l.string(),text:l.string()}),l.object({event:l.literal("characterAnimation"),id:l.string(),offsetInMilliseconds:l.number().nullable().optional(),frame:l.discriminatedUnion("model",[uG,dG]).nullable().optional()}),l.object({event:l.literal("setCallType"),callType:Zk}),l.object({event:l.literal("callTypeChanged"),callType:Zk}),l.object({event:l.literal("activityStart"),activity:kg,id:l.string(),messageId:l.string(),partId:l.string()}),l.object({event:l.literal("activityUpdate"),id:l.string(),messageId:l.string(),partId:l.string(),update:Qk}),l.object({event:l.literal("memorySignal"),messageId:l.string(),partId:l.string(),text:l.string(),signalType:l.union([l.literal("remember"),l.literal("forget")]).nullish()}),l.object({event:l.literal("sideBySideComparison"),id:l.string(),conversationId:l.string(),sideBySideComparisonId:l.string(),defaultMessageId:l.string(),options:l.array(l.object({messageId:l.string(),position:l.union([l.literal("left"),l.literal("right")])}))}),l.object({event:l.literal("characterEmotion"),emotion:l.string(),bodyReaction:l.string()}),l.object({event:l.literal("modeSelected"),id:l.string(),messageId:l.string(),mode:l.union([l.literal("chat"),l.literal("reasoning")])})]),rL={kNotPresent:0};function _xe(t){return typeof t=="object"&&t!==null&&"eventName"in t&&"requestId"in t&&(!("isOutgoing"in t)||!t.isOutgoing)&&"args"in t}const gr=D(void 0),Ib=D(t=>t(gr)!==void 0),oL=yd({key:PO,schema:l.string().optional(),initialValue:void 0}),iL=D(t=>{const e=t(gr),n=t(oL);return e===void 0?n:e.firstName??e.givenName}),sL=D(t=>{var e;return(e=t(gr))==null?void 0:e.id}),lp=D(void 0),wxe=D(t=>t(gb).find(e=>e.id===t(lp))),Axe=D(t=>{var r,o;const e=t(gb),n=t(lp)??((r=e[0])==null?void 0:r.id);return(o=e.find(i=>i.id===n))==null?void 0:o.voicemails}),aL=yd({key:jk,schema:Jk,initialValue:Bo(jk,Jk)??hb}),Qu=yd({key:Lk,schema:zk,initialValue:Bo(Lk,zk)??void 0}),PJ=yd({key:b$,schema:l.boolean().optional(),initialValue:void 0}),cL=D(null),up=D(null),lL=D(t=>t(WI).find(e=>e.id===t(up))),kxe=D(!1),xxe=D(rL.kNotPresent),Rxe=D(rL.kNotPresent),uL=D(void 0),yT=D(!1),CT=D(void 0),MJ=D(!1),dL=D(void 0),OJ=D(!1),ST=D(null),Tb=D(null),LJ=D(!0),Nxe=D(!1),Pxe=D(!1),wd=D(t=>{const e=t(gr),n=t(Aa("cmc-m365-sku")),r=!!(e!=null&&e.isPro),o=(e==null?void 0:e.subscriptions)??[];return n&&o.some(i=>i.tier==="pro")||r}),DJ=D(t=>{var e;return(e=t(gr))==null?void 0:e.isStudent});D(t=>{var e;return(e=t(gr))==null?void 0:e.inEeaPlusRegion});const Or=D(void 0),jJ=D(!1);D(t=>{const e=t(Or);return e&&DV.includes(e)});const hL=D(void 0),_b=D(t=>{var e;return((e=t(gr))==null?void 0:e.isEligibleForFreeTrial)??!1}),fL=D(void 0),wb=D(t=>{var e;return((e=t(gr))==null?void 0:e.ageGroup)==="teen"}),UJ=D(t=>{var e;return(e=t(gr))==null?void 0:e.allowedToggles.personalization}),FJ=D(t=>{var e;return(e=t(gr))==null?void 0:e.allowedToggles.textTraining}),BJ=D(t=>{var e;return(e=t(gr))==null?void 0:e.allowedToggles.voiceTraining}),pL=D(!1),mL=D(null),gL=D(t=>{var e;return((e=t(gr))==null?void 0:e.subscriptions)??[]}),HJ=D(t=>{const e=t(gL);return cG(e)[0]}),l1=D(0),vL=D(void 0),Ab=D(!1),ET=D(t=>{const e=t(tG),n=t(JO),r=t(vL),o=t(Ab);if(!(n||o))return e||r}),Ad=D(t=>{const e=t(ET),n=t(l1);if(!e||e.length===0)return;const r=Math.max(0,Math.min(n,e.length-1));return e[r]}),IT=D(t=>{const e=t(Ad),n=t(Ab),r=t(ET);return n||!r?null:(e==null?void 0:e.type)==="textAndGreeting"?e.greeting??null:null}),bL=D(!1),zJ=D(t=>{const e=t(Ad);return e==null?void 0:e.title}),VJ=D(t=>{const e=t(Ad);return e==null?void 0:e.id}),$J=D(t=>{const e=t(Ad),n=e==null?void 0:e.id;return n==="feature-discovery"||n==="image-generation"||n==="kickstarter"}),GJ=D(null,(t,e)=>{const n=t(ET),r=t(l1);if(!n||n.length<=1)return;const o=(r+1)%n.length;e(l1,o)}),KJ=D(void 0),qJ=D(void 0),TT=D(!1);D(void 0);const Mxe=ub(new Map);D(void 0);const Oxe=D(null),Lxe=ub(void 0);function dp(){const t=L(Zi),e=L(go);return t.length===0&&!!(e!=null&&e.isNew)}function kb(){const t=L(TT),e=L(qJ),r=dp()&&!!e,o=r&&!!(e!=null&&e.nudge);return{isContextualShoppingCardExpanded:t,showShoppingCardInNewChat:r,shoppingProductMetadata:e,isCopilotOpenedViaNudge:o}}function WJ(t){if(!t.length)return;const e=ci("greetingIndex"),n=t.length,r=e?(parseInt(e,10)+1)%n:0;return pa("greetingIndex",r.toString()),t[r]}const _T=D(!1),YJ=D(!1),yL=st(),QJ=["chat.launchMessage.authenticatedV3Type1","chat.launchMessage.authenticatedV3Type2","chat.launchMessage.authenticatedV3Type3"],JJ=["chat.launchMessage.unauthenticatedV3Type1","chat.launchMessage.unauthenticatedV3Type2","chat.launchMessage.unauthenticatedV3Type3"],ZJ=["chat.launchMessage.authenticatedV4Type1","chat.launchMessage.authenticatedV4Type2","chat.launchMessage.authenticatedV4Type3","chat.launchMessage.authenticatedV4Type4","chat.launchMessage.authenticatedV4Type5","chat.launchMessage.authenticatedV4Type6","chat.launchMessage.authenticatedV4Type7","chat.launchMessage.authenticatedV4Type8","chat.launchMessage.authenticatedV4Type9","chat.launchMessage.authenticatedV4Type10"],XJ=["chat.launchMessage.unauthenticatedV4Type1","chat.launchMessage.unauthenticatedV4Type2","chat.launchMessage.unauthenticatedV4Type3","chat.launchMessage.unauthenticatedV4Type4","chat.launchMessage.unauthenticatedV4Type5","chat.launchMessage.unauthenticatedV4Type6","chat.launchMessage.unauthenticatedV4Type7","chat.launchMessage.unauthenticatedV4Type8","chat.launchMessage.unauthenticatedV4Type9","chat.launchMessage.unauthenticatedV4Type10"];function eZ(){yL.set(_T,!0)}function tZ(){yL.set(_T,!1)}function CL(){const{t}=Oe(),e=L(_T),n=L(iL),r=L(VJ),o=L(IT),i=L(zJ),s=le("landing-rotating-greeting"),{showShoppingCardInNewChat:a}=kb(),u=m.useCallback(()=>a?n?["chat.launchMessage.authenticatedShoppingType1"]:["chat.launchMessage.unauthenticatedShoppingType1"]:r&&r==="image-generation"?["chat.launchMessage.unauthenticatedImageWidgets"]:r&&r==="feature-discovery"?n?["chat.launchMessage.authenticatedWidgets"]:["chat.launchMessage.unauthenticatedWidgets"]:n?s?ZJ:QJ:s?XJ:JJ,[n,s,a,r])(),h=m.useMemo(()=>WJ(u),[u]),p=Number(ci("greetingIndex"))||0,f=m.useCallback(()=>i||(r==="feature-discovery"?t("chat.launchMessage.subheadingFeatureDiscoveryWidget"):r==="image-generation"?t("chat.launchMessage.subheadingImageGenWidget"):null),[i,r,t]);return{launchGreetingShown:e,greetingKey:h,widgetGreeting:o,widgetSubheading:f(),greetingIndex:p}}async function xb({from:t,to:e,params:n,search:r,state:o}){var s;e.startsWith("/chats/")||st().set(Ag,null);let i=e;e==="/"&&((s=be.instance().config().landingPage)!=null&&s.enableLandingRoute)&&(i="/discover"),await El.navigate({to:i,params:n,state:a=>({...a,from:t,...o}),search:r})}function pi(){return xb}async function SL(t){const{conversationId:e=Ge(pt),talk:n=!1,location:r}=t;e&&await xb({to:`/chats/$conversationId${n?"/talk":""}`,params:{conversationId:e},from:r.pathname,search:r.search?Object.fromEntries(new URLSearchParams(r.search)):{}})}async function nZ(t={}){await SL({conversationId:t.conversationId,talk:t.talk,location:El.state.location})}function EL(){const t=Zv(),{location:e}=t.state;return m.useCallback(async(n={})=>SL({conversationId:n.conversationId,talk:n.talk,location:{pathname:e.pathname,search:e.search}}),[e.search,e.pathname])}function fn(t,e){st().set(t,e)}function IL(t){const{tasks:e,conversationId:n,taskType:r}=t;for(const o of e.values())if(o.conversationId===n){if(r&&o.type!==r)continue;return o.id}return""}function TL(t,e){return IL({tasks:t,conversationId:e,taskType:"computerUse"})!==""}function rZ(t,e){if(!e)return t;const[n,r,o]=t.slice(-3);if(!(ma(o)&&ma(r)&&(n==null?void 0:n.author)==="human"))return t;const s={left:o.sideBySideConfig.position==="left"?o:r,right:o.sideBySideConfig.position==="right"?o:r,createdAt:o.createdAt,id:e};return[n,s]}function oZ(t){return _L(t)||ma(t)}function _L(t){return"left"in t&&"right"in t}function ma(t){return!t||t.author!=="ai"?!1:!!t.sideBySideConfig}const Ng=["completed","failed","cancelled"];function iZ(t){return t.content.find(e=>{var r;if(e.type!=="task")return!1;const n=(r=e.task)==null?void 0:r.status;return n&&!Ng.includes(n)})}function sZ(t){for(let e=t.length-1;e>=0;e-=1){const n=t[e];if(n&&n.type==="task")return n}}function wT(t){for(const e of t){const n=iZ(e);if(n)return{message:e,part:n}}return null}const aZ=aI(Zi,t=>{if(!Pg()||t.length===0)return!1;const e=t[t.length-1];return(e==null?void 0:e.author)==="ai"&&e.content.some(n=>n.type==="activity"&&n.activity.status==="running")}),cZ=["ceo-thinkdeeper","ceo-smart-mode","ceo","webretrieval"];function Pg(){return cZ.some(We)}const kd=st();function Dn(t,e,n=!1){const r=t.at(-1),o=t.find(({id:i})=>i===e);if((n||(r==null?void 0:r.id)===(o==null?void 0:o.id)||ma(o))&&(o==null?void 0:o.author)==="ai")return o}function lZ(t,e){const n=t.find(({author:r})=>r==="human");if((n==null?void 0:n.id)===e&&n.author==="human")return n}function wL(t){const e=t.at(-1);if((e==null?void 0:e.author)==="ai")return e}function ja(t,e){return t.find(n=>n.partId===e)}function uZ(t){for(let e=t.length-1;e>=0;e-=1){const n=t[e];if(n&&n.type==="text")return n}}function Dxe(t,e,n){const r=t.find(o=>o.id===e);if(!(!r||r.author!=="ai")){for(const o of r.content)if("partId"in o&&o.partId===n)return o}}function AL(t){if(!t)return null;const e=kd.get(En).get(t);if(!e)return null;const{history:n}=e;return wT(n)}function Ht(t,e){kd.set(En,n=>Ar(n,r=>{const o=r.get(t);o&&e(o.history)}))}function AT(t,e){kd.set(li,n=>Ar(n,r=>{const o=r.get(t);o&&e(o)}))}function _i(t,e){kd.set(En,n=>Ar(n,r=>{const o=r.get(t);o&&e(o)}))}function Wl(t,e){kd.set(GI,n=>Ar(n,r=>{if(!e)return;const o=r.get(t);o?o.add(e):r.set(t,new Set([e]))}))}function kL(t){kd.set(_n,t)}function Ph(t,e){const n={type:"error",text:t,partId:"0"},r=Math.random().toString(),o={id:r,createdAt:new Date().toISOString(),author:"ai",content:[n],mode:"chat"};Wl(e,r),Ht(e,i=>{i.push(o)}),_i(e,i=>{i.streamingState="idle"})}function dZ(t){if(Pg())for(const e of t.content)e.type==="activity"&&e.activity.status==="running"&&(e.activity.status="completed")}function xL(t){_i(t,e=>{e.sideBySideComparisonId=void 0})}function RL(t,e){const n=!e;Ht(t,r=>{const[o,i]=r.slice(-2);if(!(ma(i)&&ma(o)))return;const a=n?!i.sideBySideConfig.isDefault:i.id!==e,c=n?!o.sideBySideConfig.isDefault:o.id!==e;a?r.splice(r.length-1,1):c&&r.splice(r.length-2,1)})}function hZ(t,e){RL(t,e),xL(t)}function NL(t){RL(t,void 0),xL(t)}function PL(t){var a,c;const{id:e,shouldNavigateToChat:n=!0,shouldClearParentConversation:r=!0}=t;r&&Ge(pt)!==Ge(Ag)&&fn(Ag,null),fn(pt,e),fn(Cd,!1),fn(En,u=>Ar(u,h=>{const p=h.get(e);if(p!=null&&p.history.length&&(p.isNew=!1),p!=null&&p.history.some(f=>f.content.some(g=>g.type==="card"&&g.card.type==="ads"))){for(const f of p.history)if(f.author==="ai"&&f.content.some(g=>g.type==="card"&&g.card.type==="ads")){const g=f.content.filter(v=>v.type!=="card"||v.card.type!=="ads");f.content=g}}}));const o=Ge($I);o&&o!==e&&fn(En,u=>Ar(u,h=>{h.delete(o)})),((c=(a=AL(e))==null?void 0:a.part.task)==null?void 0:c.type)==="research"?fn(_n,"research"):fn(_n,"chat");const s=Ge(li);TL(s,e)?fn(kr,"side-by-side"):fn(kr,"chat-only"),n&&nZ({conversationId:e})}function fZ(){return t=>PL(t)}const gt=t=>typeof t=="string",ah=()=>{let t,e;const n=new Promise((r,o)=>{t=r,e=o});return n.resolve=t,n.reject=e,n},ex=t=>t==null?"":""+t,pZ=(t,e,n)=>{t.forEach(r=>{e[r]&&(n[r]=e[r])})},mZ=/###/g,tx=t=>t&&t.indexOf("###")>-1?t.replace(mZ,"."):t,nx=t=>!t||gt(t),Gh=(t,e,n)=>{const r=gt(e)?e.split("."):e;let o=0;for(;o<r.length-1;){if(nx(t))return{};const i=tx(r[o]);!t[i]&&n&&(t[i]=new n),Object.prototype.hasOwnProperty.call(t,i)?t=t[i]:t={},++o}return nx(t)?{}:{obj:t,k:tx(r[o])}},rx=(t,e,n)=>{const{obj:r,k:o}=Gh(t,e,Object);if(r!==void 0||e.length===1){r[o]=n;return}let i=e[e.length-1],s=e.slice(0,e.length-1),a=Gh(t,s,Object);for(;a.obj===void 0&&s.length;)i=`${s[s.length-1]}.${i}`,s=s.slice(0,s.length-1),a=Gh(t,s,Object),a&&a.obj&&typeof a.obj[`${a.k}.${i}`]<"u"&&(a.obj=void 0);a.obj[`${a.k}.${i}`]=n},gZ=(t,e,n,r)=>{const{obj:o,k:i}=Gh(t,e,Object);o[i]=o[i]||[],o[i].push(n)},Mg=(t,e)=>{const{obj:n,k:r}=Gh(t,e);if(n)return n[r]},vZ=(t,e,n)=>{const r=Mg(t,n);return r!==void 0?r:Mg(e,n)},ML=(t,e,n)=>{for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in t?gt(t[r])||t[r]instanceof String||gt(e[r])||e[r]instanceof String?n&&(t[r]=e[r]):ML(t[r],e[r],n):t[r]=e[r]);return t},Rl=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var bZ={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const yZ=t=>gt(t)?t.replace(/[&<>"'\/]/g,e=>bZ[e]):t;class CZ{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const n=this.regExpMap.get(e);if(n!==void 0)return n;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}const SZ=[" ",",","?","!",";"],EZ=new CZ(20),IZ=(t,e,n)=>{e=e||"",n=n||"";const r=SZ.filter(s=>e.indexOf(s)<0&&n.indexOf(s)<0);if(r.length===0)return!0;const o=EZ.getRegExp(`(${r.map(s=>s==="?"?"\\?":s).join("|")})`);let i=!o.test(t);if(!i){const s=t.indexOf(n);s>0&&!o.test(t.substring(0,s))&&(i=!0)}return i},u1=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!t)return;if(t[e])return t[e];const r=e.split(n);let o=t;for(let i=0;i<r.length;){if(!o||typeof o!="object")return;let s,a="";for(let c=i;c<r.length;++c)if(c!==i&&(a+=n),a+=r[c],s=o[a],s!==void 0){if(["string","number","boolean"].indexOf(typeof s)>-1&&c<r.length-1)continue;i+=c-i+1;break}o=s}return o},Og=t=>t&&t.replace("_","-"),TZ={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console&&console[t]&&console[t].apply(console,e)}};let _Z=class d1{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,n)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=n.prefix||"i18next:",this.logger=e||TZ,this.options=n,this.debug=n.debug}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"log","",!0)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"warn","",!0)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"error","")}deprecate(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"warn","WARNING DEPRECATED: ",!0)}forward(e,n,r,o){return o&&!this.debug?null:(gt(e[0])&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[n](e))}create(e){return new d1(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new d1(this.logger,e)}};var Ui=new _Z;class Rb{constructor(){this.observers={}}on(e,n){return e.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const o=this.observers[r].get(n)||0;this.observers[r].set(n,o+1)}),this}off(e,n){if(this.observers[e]){if(!n){delete this.observers[e];return}this.observers[e].delete(n)}}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(s=>{let[a,c]=s;for(let u=0;u<c;u++)a(...r)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(s=>{let[a,c]=s;for(let u=0;u<c;u++)a.apply(a,[e,...r])})}}class ox extends Rb{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const n=this.options.ns.indexOf(e);n>-1&&this.options.ns.splice(n,1)}getResource(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator,s=o.ignoreJSONStructure!==void 0?o.ignoreJSONStructure:this.options.ignoreJSONStructure;let a;e.indexOf(".")>-1?a=e.split("."):(a=[e,n],r&&(Array.isArray(r)?a.push(...r):gt(r)&&i?a.push(...r.split(i)):a.push(r)));const c=Mg(this.data,a);return!c&&!n&&!r&&e.indexOf(".")>-1&&(e=a[0],n=a[1],r=a.slice(2).join(".")),c||!s||!gt(r)?c:u1(this.data&&this.data[e]&&this.data[e][n],r,i)}addResource(e,n,r,o){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const s=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let a=[e,n];r&&(a=a.concat(s?r.split(s):r)),e.indexOf(".")>-1&&(a=e.split("."),o=n,n=a[1]),this.addNamespaces(n),rx(this.data,a,o),i.silent||this.emit("added",e,n,r,o)}addResources(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const i in r)(gt(r[i])||Array.isArray(r[i]))&&this.addResource(e,n,i,r[i],{silent:!0});o.silent||this.emit("added",e,n,r)}addResourceBundle(e,n,r,o,i){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},a=[e,n];e.indexOf(".")>-1&&(a=e.split("."),o=r,r=n,n=a[1]),this.addNamespaces(n);let c=Mg(this.data,a)||{};s.skipCopy||(r=JSON.parse(JSON.stringify(r))),o?ML(c,r,i):c={...c,...r},rx(this.data,a,c),s.silent||this.emit("added",e,n,r)}removeResourceBundle(e,n){this.hasResourceBundle(e,n)&&delete this.data[e][n],this.removeNamespaces(n),this.emit("removed",e,n)}hasResourceBundle(e,n){return this.getResource(e,n)!==void 0}getResourceBundle(e,n){return n||(n=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(e,n)}:this.getResource(e,n)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const n=this.getDataByLanguage(e);return!!(n&&Object.keys(n)||[]).find(o=>n[o]&&Object.keys(n[o]).length>0)}toJSON(){return this.data}}var OL={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,r,o){return t.forEach(i=>{this.processors[i]&&(e=this.processors[i].process(e,n,r,o))}),e}};const ix={};class Lg extends Rb{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),pZ(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Ui.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const r=this.resolve(e,n);return r&&r.res!==void 0}extractFromKey(e,n){let r=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const o=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let i=n.ns||this.options.defaultNS||[];const s=r&&e.indexOf(r)>-1,a=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!IZ(e,r,o);if(s&&!a){const c=e.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:e,namespaces:i};const u=e.split(r);(r!==o||r===o&&this.options.ns.indexOf(u[0])>-1)&&(i=u.shift()),e=u.join(o)}return gt(i)&&(i=[i]),{key:e,namespaces:i}}translate(e,n,r){if(typeof n!="object"&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),typeof n=="object"&&(n={...n}),n||(n={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const o=n.returnDetails!==void 0?n.returnDetails:this.options.returnDetails,i=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,{key:s,namespaces:a}=this.extractFromKey(e[e.length-1],n),c=a[a.length-1],u=n.lng||this.language,h=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&u.toLowerCase()==="cimode"){if(h){const I=n.nsSeparator||this.options.nsSeparator;return o?{res:`${c}${I}${s}`,usedKey:s,exactUsedKey:s,usedLng:u,usedNS:c,usedParams:this.getUsedParamsDetails(n)}:`${c}${I}${s}`}return o?{res:s,usedKey:s,exactUsedKey:s,usedLng:u,usedNS:c,usedParams:this.getUsedParamsDetails(n)}:s}const p=this.resolve(e,n);let f=p&&p.res;const g=p&&p.usedKey||s,v=p&&p.exactUsedKey||s,y=Object.prototype.toString.apply(f),b=["[object Number]","[object Function]","[object RegExp]"],C=n.joinArrays!==void 0?n.joinArrays:this.options.joinArrays,S=!this.i18nFormat||this.i18nFormat.handleAsObject,E=!gt(f)&&typeof f!="boolean"&&typeof f!="number";if(S&&f&&E&&b.indexOf(y)<0&&!(gt(C)&&Array.isArray(f))){if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const I=this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,f,{...n,ns:a}):`key '${s} (${this.language})' returned an object instead of string.`;return o?(p.res=I,p.usedParams=this.getUsedParamsDetails(n),p):I}if(i){const I=Array.isArray(f),T=I?[]:{},_=I?v:g;for(const w in f)if(Object.prototype.hasOwnProperty.call(f,w)){const A=`${_}${i}${w}`;T[w]=this.translate(A,{...n,joinArrays:!1,ns:a}),T[w]===A&&(T[w]=f[w])}f=T}}else if(S&&gt(C)&&Array.isArray(f))f=f.join(C),f&&(f=this.extendTranslation(f,e,n,r));else{let I=!1,T=!1;const _=n.count!==void 0&&!gt(n.count),w=Lg.hasDefaultValue(n),A=_?this.pluralResolver.getSuffix(u,n.count,n):"",M=n.ordinal&&_?this.pluralResolver.getSuffix(u,n.count,{ordinal:!1}):"",R=_&&!n.ordinal&&n.count===0&&this.pluralResolver.shouldUseIntlApi(),$=R&&n[`defaultValue${this.options.pluralSeparator}zero`]||n[`defaultValue${A}`]||n[`defaultValue${M}`]||n.defaultValue;!this.isValidLookup(f)&&w&&(I=!0,f=$),this.isValidLookup(f)||(T=!0,f=s);const ie=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&T?void 0:f,N=w&&$!==f&&this.options.updateMissing;if(T||I||N){if(this.logger.log(N?"updateKey":"missingKey",u,c,s,N?$:f),i){const U=this.resolve(s,{...n,keySeparator:!1});U&&U.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let Y=[];const ue=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if(this.options.saveMissingTo==="fallback"&&ue&&ue[0])for(let U=0;U<ue.length;U++)Y.push(ue[U]);else this.options.saveMissingTo==="all"?Y=this.languageUtils.toResolveHierarchy(n.lng||this.language):Y.push(n.lng||this.language);const j=(U,te,Q)=>{const re=w&&Q!==f?Q:ie;this.options.missingKeyHandler?this.options.missingKeyHandler(U,c,te,re,N,n):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(U,c,te,re,N,n),this.emit("missingKey",U,c,te,f)};this.options.saveMissing&&(this.options.saveMissingPlurals&&_?Y.forEach(U=>{const te=this.pluralResolver.getSuffixes(U,n);R&&n[`defaultValue${this.options.pluralSeparator}zero`]&&te.indexOf(`${this.options.pluralSeparator}zero`)<0&&te.push(`${this.options.pluralSeparator}zero`),te.forEach(Q=>{j([U],s+Q,n[`defaultValue${Q}`]||$)})}):j(Y,s,$))}f=this.extendTranslation(f,e,n,p,r),T&&f===s&&this.options.appendNamespaceToMissingKey&&(f=`${c}:${s}`),(T||I)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?f=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}:${s}`:s,I?f:void 0):f=this.options.parseMissingKeyHandler(f))}return o?(p.res=f,p.usedParams=this.getUsedParamsDetails(n),p):f}extendTranslation(e,n,r,o,i){var s=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||o.usedLng,o.usedNS,o.usedKey,{resolved:o});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const u=gt(e)&&(r&&r.interpolation&&r.interpolation.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let h;if(u){const f=e.match(this.interpolator.nestingRegexp);h=f&&f.length}let p=r.replace&&!gt(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(p={...this.options.interpolation.defaultVariables,...p}),e=this.interpolator.interpolate(e,p,r.lng||this.language||o.usedLng,r),u){const f=e.match(this.interpolator.nestingRegexp),g=f&&f.length;h<g&&(r.nest=!1)}!r.lng&&this.options.compatibilityAPI!=="v1"&&o&&o.res&&(r.lng=this.language||o.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var f=arguments.length,g=new Array(f),v=0;v<f;v++)g[v]=arguments[v];return i&&i[0]===g[0]&&!r.context?(s.logger.warn(`It seems you are nesting recursively key: ${g[0]} in key: ${n[0]}`),null):s.translate(...g,n)},r)),r.interpolation&&this.interpolator.reset()}const a=r.postProcess||this.options.postProcess,c=gt(a)?[a]:a;return e!=null&&c&&c.length&&r.applyPostProcessor!==!1&&(e=OL.handle(c,e,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...o,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r,o,i,s,a;return gt(e)&&(e=[e]),e.forEach(c=>{if(this.isValidLookup(r))return;const u=this.extractFromKey(c,n),h=u.key;o=h;let p=u.namespaces;this.options.fallbackNS&&(p=p.concat(this.options.fallbackNS));const f=n.count!==void 0&&!gt(n.count),g=f&&!n.ordinal&&n.count===0&&this.pluralResolver.shouldUseIntlApi(),v=n.context!==void 0&&(gt(n.context)||typeof n.context=="number")&&n.context!=="",y=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);p.forEach(b=>{this.isValidLookup(r)||(a=b,!ix[`${y[0]}-${b}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(a)&&(ix[`${y[0]}-${b}`]=!0,this.logger.warn(`key "${o}" for languages "${y.join(", ")}" won't get resolved as namespace "${a}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),y.forEach(C=>{if(this.isValidLookup(r))return;s=C;const S=[h];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(S,h,C,b,n);else{let I;f&&(I=this.pluralResolver.getSuffix(C,n.count,n));const T=`${this.options.pluralSeparator}zero`,_=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(f&&(S.push(h+I),n.ordinal&&I.indexOf(_)===0&&S.push(h+I.replace(_,this.options.pluralSeparator)),g&&S.push(h+T)),v){const w=`${h}${this.options.contextSeparator}${n.context}`;S.push(w),f&&(S.push(w+I),n.ordinal&&I.indexOf(_)===0&&S.push(w+I.replace(_,this.options.pluralSeparator)),g&&S.push(w+T))}}let E;for(;E=S.pop();)this.isValidLookup(r)||(i=E,r=this.getResource(C,b,E,n))}))})}),{res:r,usedKey:o,exactUsedKey:i,usedLng:s,usedNS:a}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,n,r,o):this.resourceStore.getResource(e,n,r,o)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&!gt(e.replace);let o=r?e.replace:e;if(r&&typeof e.count<"u"&&(o.count=e.count),this.options.interpolation.defaultVariables&&(o={...this.options.interpolation.defaultVariables,...o}),!r){o={...o};for(const i of n)delete o[i]}return o}static hasDefaultValue(e){const n="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&n===r.substring(0,n.length)&&e[r]!==void 0)return!0;return!1}}const wC=t=>t.charAt(0).toUpperCase()+t.slice(1);class sx{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Ui.create("languageUtils")}getScriptPartFromCode(e){if(e=Og(e),!e||e.indexOf("-")<0)return null;const n=e.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(e){if(e=Og(e),!e||e.indexOf("-")<0)return e;const n=e.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(e){if(gt(e)&&e.indexOf("-")>-1){if(typeof Intl<"u"&&typeof Intl.getCanonicalLocales<"u")try{let o=Intl.getCanonicalLocales(e)[0];if(o&&this.options.lowerCaseLng&&(o=o.toLowerCase()),o)return o}catch{}const n=["hans","hant","latn","cyrl","cans","mong","arab"];let r=e.split("-");return this.options.lowerCaseLng?r=r.map(o=>o.toLowerCase()):r.length===2?(r[0]=r[0].toLowerCase(),r[1]=r[1].toUpperCase(),n.indexOf(r[1].toLowerCase())>-1&&(r[1]=wC(r[1].toLowerCase()))):r.length===3&&(r[0]=r[0].toLowerCase(),r[1].length===2&&(r[1]=r[1].toUpperCase()),r[0]!=="sgn"&&r[2].length===2&&(r[2]=r[2].toUpperCase()),n.indexOf(r[1].toLowerCase())>-1&&(r[1]=wC(r[1].toLowerCase())),n.indexOf(r[2].toLowerCase())>-1&&(r[2]=wC(r[2].toLowerCase()))),r.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let n;return e.forEach(r=>{if(n)return;const o=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(o))&&(n=o)}),!n&&this.options.supportedLngs&&e.forEach(r=>{if(n)return;const o=this.getLanguagePartFromCode(r);if(this.isSupportedCode(o))return n=o;n=this.options.supportedLngs.find(i=>{if(i===o)return i;if(!(i.indexOf("-")<0&&o.indexOf("-")<0)&&(i.indexOf("-")>0&&o.indexOf("-")<0&&i.substring(0,i.indexOf("-"))===o||i.indexOf(o)===0&&o.length>1))return i})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(e,n){if(!e)return[];if(typeof e=="function"&&(e=e(n)),gt(e)&&(e=[e]),Array.isArray(e))return e;if(!n)return e.default||[];let r=e[n];return r||(r=e[this.getScriptPartFromCode(n)]),r||(r=e[this.formatLanguageCode(n)]),r||(r=e[this.getLanguagePartFromCode(n)]),r||(r=e.default),r||[]}toResolveHierarchy(e,n){const r=this.getFallbackCodes(n||this.options.fallbackLng||[],e),o=[],i=s=>{s&&(this.isSupportedCode(s)?o.push(s):this.logger.warn(`rejecting language code not found in supportedLngs: ${s}`))};return gt(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(e))):gt(e)&&i(this.formatLanguageCode(e)),r.forEach(s=>{o.indexOf(s)<0&&i(this.formatLanguageCode(s))}),o}}let wZ=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],AZ={1:t=>+(t>1),2:t=>+(t!=1),3:t=>0,4:t=>t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2,5:t=>t==0?0:t==1?1:t==2?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5,6:t=>t==1?0:t>=2&&t<=4?1:2,7:t=>t==1?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2,8:t=>t==1?0:t==2?1:t!=8&&t!=11?2:3,9:t=>+(t>=2),10:t=>t==1?0:t==2?1:t<7?2:t<11?3:4,11:t=>t==1||t==11?0:t==2||t==12?1:t>2&&t<20?2:3,12:t=>+(t%10!=1||t%100==11),13:t=>+(t!==0),14:t=>t==1?0:t==2?1:t==3?2:3,15:t=>t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2,16:t=>t%10==1&&t%100!=11?0:t!==0?1:2,17:t=>t==1||t%10==1&&t%100!=11?0:1,18:t=>t==0?0:t==1?1:2,19:t=>t==1?0:t==0||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3,20:t=>t==1?0:t==0||t%100>0&&t%100<20?1:2,21:t=>t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0,22:t=>t==1?0:t==2?1:(t<0||t>10)&&t%10==0?2:3};const kZ=["v1","v2","v3"],xZ=["v4"],ax={zero:0,one:1,two:2,few:3,many:4,other:5},RZ=()=>{const t={};return wZ.forEach(e=>{e.lngs.forEach(n=>{t[n]={numbers:e.nr,plurals:AZ[e.fc]}})}),t};class NZ{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=n,this.logger=Ui.create("pluralResolver"),(!this.options.compatibilityJSON||xZ.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=RZ(),this.pluralRulesCache={}}addRule(e,n){this.rules[e]=n}clearCache(){this.pluralRulesCache={}}getRule(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{const r=Og(e==="dev"?"en":e),o=n.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:r,type:o});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];const s=new Intl.PluralRules(r,{type:o});return this.pluralRulesCache[i]=s,s}catch{return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.getRule(e,n);return this.shouldUseIntlApi()?r&&r.resolvedOptions().pluralCategories.length>1:r&&r.numbers.length>1}getPluralFormsOfKey(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,r).map(o=>`${n}${o}`)}getSuffixes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.getRule(e,n);return r?this.shouldUseIntlApi()?r.resolvedOptions().pluralCategories.sort((o,i)=>ax[o]-ax[i]).map(o=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${o}`):r.numbers.map(o=>this.getSuffix(e,o,n)):[]}getSuffix(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.getRule(e,r);return o?this.shouldUseIntlApi()?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${o.select(n)}`:this.getSuffixRetroCompatible(o,n):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,n){const r=e.noAbs?e.plurals(n):e.plurals(Math.abs(n));let o=e.numbers[r];this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1&&(o===2?o="plural":o===1&&(o=""));const i=()=>this.options.prepend&&o.toString()?this.options.prepend+o.toString():o.toString();return this.options.compatibilityJSON==="v1"?o===1?"":typeof o=="number"?`_plural_${o.toString()}`:i():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1?i():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}shouldUseIntlApi(){return!kZ.includes(this.options.compatibilityJSON)}}const cx=function(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,i=vZ(t,e,n);return!i&&o&&gt(n)&&(i=u1(t,n,r),i===void 0&&(i=u1(e,n,r))),i},AC=t=>t.replace(/\$/g,"$$$$");class PZ{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Ui.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(n=>n),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:n,escapeValue:r,useRawValueToEscape:o,prefix:i,prefixEscaped:s,suffix:a,suffixEscaped:c,formatSeparator:u,unescapeSuffix:h,unescapePrefix:p,nestingPrefix:f,nestingPrefixEscaped:g,nestingSuffix:v,nestingSuffixEscaped:y,nestingOptionsSeparator:b,maxReplaces:C,alwaysFormat:S}=e.interpolation;this.escape=n!==void 0?n:yZ,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=o!==void 0?o:!1,this.prefix=i?Rl(i):s||"{{",this.suffix=a?Rl(a):c||"}}",this.formatSeparator=u||",",this.unescapePrefix=h?"":p||"-",this.unescapeSuffix=this.unescapePrefix?"":h||"",this.nestingPrefix=f?Rl(f):g||Rl("$t("),this.nestingSuffix=v?Rl(v):y||Rl(")"),this.nestingOptionsSeparator=b||",",this.maxReplaces=C||1e3,this.alwaysFormat=S!==void 0?S:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(n,r)=>n&&n.source===r?(n.lastIndex=0,n):new RegExp(r,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,n,r,o){let i,s,a;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=g=>{if(g.indexOf(this.formatSeparator)<0){const C=cx(n,c,g,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(C,void 0,r,{...o,...n,interpolationkey:g}):C}const v=g.split(this.formatSeparator),y=v.shift().trim(),b=v.join(this.formatSeparator).trim();return this.format(cx(n,c,y,this.options.keySeparator,this.options.ignoreJSONStructure),b,r,{...o,...n,interpolationkey:y})};this.resetRegExp();const h=o&&o.missingInterpolationHandler||this.options.missingInterpolationHandler,p=o&&o.interpolation&&o.interpolation.skipOnVariables!==void 0?o.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:g=>AC(g)},{regex:this.regexp,safeValue:g=>this.escapeValue?AC(this.escape(g)):AC(g)}].forEach(g=>{for(a=0;i=g.regex.exec(e);){const v=i[1].trim();if(s=u(v),s===void 0)if(typeof h=="function"){const b=h(e,i,o);s=gt(b)?b:""}else if(o&&Object.prototype.hasOwnProperty.call(o,v))s="";else if(p){s=i[0];continue}else this.logger.warn(`missed to pass in variable ${v} for interpolating ${e}`),s="";else!gt(s)&&!this.useRawValueToEscape&&(s=ex(s));const y=g.safeValue(s);if(e=e.replace(i[0],y),p?(g.regex.lastIndex+=s.length,g.regex.lastIndex-=i[0].length):g.regex.lastIndex=0,a++,a>=this.maxReplaces)break}}),e}nest(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o,i,s;const a=(c,u)=>{const h=this.nestingOptionsSeparator;if(c.indexOf(h)<0)return c;const p=c.split(new RegExp(`${h}[ ]*{`));let f=`{${p[1]}`;c=p[0],f=this.interpolate(f,s);const g=f.match(/'/g),v=f.match(/"/g);(g&&g.length%2===0&&!v||v.length%2!==0)&&(f=f.replace(/'/g,'"'));try{s=JSON.parse(f),u&&(s={...u,...s})}catch(y){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,y),`${c}${h}${f}`}return s.defaultValue&&s.defaultValue.indexOf(this.prefix)>-1&&delete s.defaultValue,c};for(;o=this.nestingRegexp.exec(e);){let c=[];s={...r},s=s.replace&&!gt(s.replace)?s.replace:s,s.applyPostProcessor=!1,delete s.defaultValue;let u=!1;if(o[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(o[1])){const h=o[1].split(this.formatSeparator).map(p=>p.trim());o[1]=h.shift(),c=h,u=!0}if(i=n(a.call(this,o[1].trim(),s),s),i&&o[0]===e&&!gt(i))return i;gt(i)||(i=ex(i)),i||(this.logger.warn(`missed to resolve ${o[1]} for nesting ${e}`),i=""),u&&(i=c.reduce((h,p)=>this.format(h,p,r.lng,{...r,interpolationkey:o[1].trim()}),i.trim())),e=e.replace(o[0],i),this.regexp.lastIndex=0}return e}}const MZ=t=>{let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const r=t.split("(");e=r[0].toLowerCase().trim();const o=r[1].substring(0,r[1].length-1);e==="currency"&&o.indexOf(":")<0?n.currency||(n.currency=o.trim()):e==="relativetime"&&o.indexOf(":")<0?n.range||(n.range=o.trim()):o.split(";").forEach(s=>{if(s){const[a,...c]=s.split(":"),u=c.join(":").trim().replace(/^'+|'+$/g,""),h=a.trim();n[h]||(n[h]=u),u==="false"&&(n[h]=!1),u==="true"&&(n[h]=!0),isNaN(u)||(n[h]=parseInt(u,10))}})}return{formatName:e,formatOptions:n}},Nl=t=>{const e={};return(n,r,o)=>{let i=o;o&&o.interpolationkey&&o.formatParams&&o.formatParams[o.interpolationkey]&&o[o.interpolationkey]&&(i={...i,[o.interpolationkey]:void 0});const s=r+JSON.stringify(i);let a=e[s];return a||(a=t(Og(r),o),e[s]=a),a(n)}};class OZ{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Ui.create("formatter"),this.options=e,this.formats={number:Nl((n,r)=>o=>new Intl.NumberFormat(n,{...r}).format(o)),currency:Nl((n,r)=>o=>new Intl.NumberFormat(n,{...r,style:"currency"}).format(o)),datetime:Nl((n,r)=>o=>new Intl.DateTimeFormat(n,{...r}).format(o)),relativetime:Nl((n,r)=>o=>new Intl.RelativeTimeFormat(n,{...r}).format(o,r.range||"day")),list:Nl((n,r)=>o=>new Intl.ListFormat(n,{...r}).format(o))},this.init(e)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=n.interpolation.formatSeparator||","}add(e,n){this.formats[e.toLowerCase().trim()]=n}addCached(e,n){this.formats[e.toLowerCase().trim()]=Nl(n)}format(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=n.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(a=>a.indexOf(")")>-1)){const a=i.findIndex(c=>c.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,a)].join(this.formatSeparator)}return i.reduce((a,c)=>{const{formatName:u,formatOptions:h}=MZ(c);if(this.formats[u]){let p=a;try{const f=o&&o.formatParams&&o.formatParams[o.interpolationkey]||{},g=f.locale||f.lng||o.locale||o.lng||r;p=this.formats[u](a,g,{...h,...o,...f})}catch(f){this.logger.warn(f)}return p}else this.logger.warn(`there was no format function for ${u}`);return a},e)}}const LZ=(t,e)=>{t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)};class DZ extends Rb{constructor(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=n,this.services=r,this.languageUtils=r.languageUtils,this.options=o,this.logger=Ui.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=o.maxParallelReads||10,this.readingCalls=0,this.maxRetries=o.maxRetries>=0?o.maxRetries:5,this.retryTimeout=o.retryTimeout>=1?o.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(r,o.backend,o)}queueLoad(e,n,r,o){const i={},s={},a={},c={};return e.forEach(u=>{let h=!0;n.forEach(p=>{const f=`${u}|${p}`;!r.reload&&this.store.hasResourceBundle(u,p)?this.state[f]=2:this.state[f]<0||(this.state[f]===1?s[f]===void 0&&(s[f]=!0):(this.state[f]=1,h=!1,s[f]===void 0&&(s[f]=!0),i[f]===void 0&&(i[f]=!0),c[p]===void 0&&(c[p]=!0)))}),h||(a[u]=!0)}),(Object.keys(i).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:o}),{toLoad:Object.keys(i),pending:Object.keys(s),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(c)}}loaded(e,n,r){const o=e.split("|"),i=o[0],s=o[1];n&&this.emit("failedLoading",i,s,n),!n&&r&&this.store.addResourceBundle(i,s,r,void 0,void 0,{skipCopy:!0}),this.state[e]=n?-1:2,n&&r&&(this.state[e]=0);const a={};this.queue.forEach(c=>{gZ(c.loaded,[i],s),LZ(c,e),n&&c.errors.push(n),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(u=>{a[u]||(a[u]={});const h=c.loaded[u];h.length&&h.forEach(p=>{a[u][p]===void 0&&(a[u][p]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(c=>!c.done)}read(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,s=arguments.length>5?arguments[5]:void 0;if(!e.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:n,fcName:r,tried:o,wait:i,callback:s});return}this.readingCalls++;const a=(u,h)=>{if(this.readingCalls--,this.waitingReads.length>0){const p=this.waitingReads.shift();this.read(p.lng,p.ns,p.fcName,p.tried,p.wait,p.callback)}if(u&&h&&o<this.maxRetries){setTimeout(()=>{this.read.call(this,e,n,r,o+1,i*2,s)},i);return}s(u,h)},c=this.backend[r].bind(this.backend);if(c.length===2){try{const u=c(e,n);u&&typeof u.then=="function"?u.then(h=>a(null,h)).catch(a):a(null,u)}catch(u){a(u)}return}return c(e,n,a)}prepareLoading(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),o&&o();gt(e)&&(e=this.languageUtils.toResolveHierarchy(e)),gt(n)&&(n=[n]);const i=this.queueLoad(e,n,r,o);if(!i.toLoad.length)return i.pending.length||o(),null;i.toLoad.forEach(s=>{this.loadOne(s)})}load(e,n,r){this.prepareLoading(e,n,{},r)}reload(e,n,r){this.prepareLoading(e,n,{reload:!0},r)}loadOne(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=e.split("|"),o=r[0],i=r[1];this.read(o,i,"read",void 0,void 0,(s,a)=>{s&&this.logger.warn(`${n}loading namespace ${i} for language ${o} failed`,s),!s&&a&&this.logger.log(`${n}loaded namespace ${i} for language ${o}`,a),this.loaded(e,s,a)})}saveMissing(e,n,r,o,i){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(n)){this.logger.warn(`did not save key "${r}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if(this.backend&&this.backend.create){const c={...s,isUpdate:i},u=this.backend.create.bind(this.backend);if(u.length<6)try{let h;u.length===5?h=u(e,n,r,o,c):h=u(e,n,r,o),h&&typeof h.then=="function"?h.then(p=>a(null,p)).catch(a):a(null,h)}catch(h){a(h)}else u(e,n,r,o,a,c)}!e||!e[0]||this.store.addResource(e[0],n,r,o)}}}const lx=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if(typeof t[1]=="object"&&(e=t[1]),gt(t[1])&&(e.defaultValue=t[1]),gt(t[2])&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(r=>{e[r]=n[r]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),ux=t=>(gt(t.ns)&&(t.ns=[t.ns]),gt(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),gt(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t),Jp=()=>{},jZ=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(n=>{typeof t[n]=="function"&&(t[n]=t[n].bind(t))})};class kf extends Rb{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(super(),this.options=ux(e),this.services={},this.logger=Ui,this.modules={external:[]},jZ(this),n&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,n),this;setTimeout(()=>{this.init(e,n)},0)}}init(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof n=="function"&&(r=n,n={}),!n.defaultNS&&n.defaultNS!==!1&&n.ns&&(gt(n.ns)?n.defaultNS=n.ns:n.ns.indexOf("translation")<0&&(n.defaultNS=n.ns[0]));const o=lx();this.options={...o,...this.options,...ux(n)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...o.interpolation,...this.options.interpolation}),n.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=n.keySeparator),n.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=n.nsSeparator);const i=h=>h?typeof h=="function"?new h:h:null;if(!this.options.isClone){this.modules.logger?Ui.init(i(this.modules.logger),this.options):Ui.init(null,this.options);let h;this.modules.formatter?h=this.modules.formatter:typeof Intl<"u"&&(h=OZ);const p=new sx(this.options);this.store=new ox(this.options.resources,this.options);const f=this.services;f.logger=Ui,f.resourceStore=this.store,f.languageUtils=p,f.pluralResolver=new NZ(p,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),h&&(!this.options.interpolation.format||this.options.interpolation.format===o.interpolation.format)&&(f.formatter=i(h),f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new PZ(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new DZ(i(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",function(g){for(var v=arguments.length,y=new Array(v>1?v-1:0),b=1;b<v;b++)y[b-1]=arguments[b];e.emit(g,...y)}),this.modules.languageDetector&&(f.languageDetector=i(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=i(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new Lg(this.services,this.options),this.translator.on("*",function(g){for(var v=arguments.length,y=new Array(v>1?v-1:0),b=1;b<v;b++)y[b-1]=arguments[b];e.emit(g,...y)}),this.modules.external.forEach(g=>{g.init&&g.init(this)})}if(this.format=this.options.interpolation.format,r||(r=Jp),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const h=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);h.length>0&&h[0]!=="dev"&&(this.options.lng=h[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(h=>{this[h]=function(){return e.store[h](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(h=>{this[h]=function(){return e.store[h](...arguments),e}});const c=ah(),u=()=>{const h=(p,f)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),c.resolve(f),r(p,f)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return h(null,this.t.bind(this));this.changeLanguage(this.options.lng,h)};return this.options.resources||!this.options.initImmediate?u():setTimeout(u,0),c}loadResources(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jp;const o=gt(e)?e:this.language;if(typeof e=="function"&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if(o&&o.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const i=[],s=a=>{if(!a||a==="cimode")return;this.services.languageUtils.toResolveHierarchy(a).forEach(u=>{u!=="cimode"&&i.indexOf(u)<0&&i.push(u)})};o?s(o):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(c=>s(c)),this.options.preload&&this.options.preload.forEach(a=>s(a)),this.services.backendConnector.load(i,this.options.ns,a=>{!a&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(a)})}else r(null)}reloadResources(e,n,r){const o=ah();return typeof e=="function"&&(r=e,e=void 0),typeof n=="function"&&(r=n,n=void 0),e||(e=this.languages),n||(n=this.options.ns),r||(r=Jp),this.services.backendConnector.reload(e,n,i=>{o.resolve(),r(i)}),o}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&OL.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let n=0;n<this.languages.length;n++){const r=this.languages[n];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}}changeLanguage(e,n){var r=this;this.isLanguageChangingTo=e;const o=ah();this.emit("languageChanging",e);const i=c=>{this.language=c,this.languages=this.services.languageUtils.toResolveHierarchy(c),this.resolvedLanguage=void 0,this.setResolvedLanguage(c)},s=(c,u)=>{u?(i(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,o.resolve(function(){return r.t(...arguments)}),n&&n(c,function(){return r.t(...arguments)})},a=c=>{!e&&!c&&this.services.languageDetector&&(c=[]);const u=gt(c)?c:this.services.languageUtils.getBestMatchFromCodes(c);u&&(this.language||i(u),this.translator.language||this.translator.changeLanguage(u),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(u)),this.loadResources(u,h=>{s(h,u)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?a(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e),o}getFixedT(e,n,r){var o=this;const i=function(s,a){let c;if(typeof a!="object"){for(var u=arguments.length,h=new Array(u>2?u-2:0),p=2;p<u;p++)h[p-2]=arguments[p];c=o.options.overloadTranslationOptionHandler([s,a].concat(h))}else c={...a};c.lng=c.lng||i.lng,c.lngs=c.lngs||i.lngs,c.ns=c.ns||i.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||r||i.keyPrefix);const f=o.options.keySeparator||".";let g;return c.keyPrefix&&Array.isArray(s)?g=s.map(v=>`${c.keyPrefix}${f}${v}`):g=c.keyPrefix?`${c.keyPrefix}${f}${s}`:s,o.t(g,c)};return gt(e)?i.lng=e:i.lngs=e,i.ns=n,i.keyPrefix=r,i}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=n.lng||this.resolvedLanguage||this.languages[0],o=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const s=(a,c)=>{const u=this.services.backendConnector.state[`${a}|${c}`];return u===-1||u===0||u===2};if(n.precheck){const a=n.precheck(this,s);if(a!==void 0)return a}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||s(r,e)&&(!o||s(i,e)))}loadNamespaces(e,n){const r=ah();return this.options.ns?(gt(e)&&(e=[e]),e.forEach(o=>{this.options.ns.indexOf(o)<0&&this.options.ns.push(o)}),this.loadResources(o=>{r.resolve(),n&&n(o)}),r):(n&&n(),Promise.resolve())}loadLanguages(e,n){const r=ah();gt(e)&&(e=[e]);const o=this.options.preload||[],i=e.filter(s=>o.indexOf(s)<0&&this.services.languageUtils.isSupportedCode(s));return i.length?(this.options.preload=o.concat(i),this.loadResources(s=>{r.resolve(),n&&n(s)}),r):(n&&n(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=this.services&&this.services.languageUtils||new sx(lx());return n.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new kf(e,n)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jp;const r=e.forkResourceStore;r&&delete e.forkResourceStore;const o={...this.options,...e,isClone:!0},i=new kf(o);return(e.debug!==void 0||e.prefix!==void 0)&&(i.logger=i.logger.clone(e)),["store","services","language"].forEach(a=>{i[a]=this[a]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},r&&(i.store=new ox(this.store.data,o),i.services.resourceStore=i.store),i.translator=new Lg(i.services,o),i.translator.on("*",function(a){for(var c=arguments.length,u=new Array(c>1?c-1:0),h=1;h<c;h++)u[h-1]=arguments[h];i.emit(a,...u)}),i.init(o,n),i.translator.options=o,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Nt=kf.createInstance();Nt.createInstance=kf.createInstance;Nt.createInstance;Nt.dir;Nt.init;Nt.loadResources;Nt.reloadResources;Nt.use;Nt.changeLanguage;Nt.getFixedT;const X=Nt.t,jxe=Nt.exists;Nt.setDefaultNamespace;Nt.hasLoadedNamespace;Nt.loadNamespaces;Nt.loadLanguages;const Za={UNDEFINED:"0",CHILD:"1",ADULT:"3",NOT_ADULT:"4",CHILD_NO_PARENTAL_CONSENT_REQUIRED:"5"},UZ=l.object({name:l.string(),email:l.string(),ageGroup:l.enum([Za.UNDEFINED,Za.CHILD,Za.ADULT,Za.NOT_ADULT,Za.CHILD_NO_PARENTAL_CONSENT_REQUIRED]),sub:l.string()}),io={LOGIN_START:"auth0:loginStart",LOGIN_SUCCESS:"auth0:loginSuccess",LOGIN_FAILURE:"auth0:loginFailure",LOGOUT_SUCCESS:"auth0:logoutSuccess",LOGOUT_FAILURE:"auth0:logoutFailure",ACQUIRE_TOKEN_FAILURE:"auth0:acquireTokenFailure",REAUTH_START:"auth0:reauthStart",REAUTH_SUCCESS:"auth0:reauthSuccess",INITIALIZE_START:"auth0:initializeStart",INITIALIZE_END:"auth0:initializeEnd",ACQUIRE_TOKEN_OVERALL_SUCCESS:"auth0:acquireTokenOverallSuccess",ACQUIRE_TOKEN_OVERALL_FAILURE:"auth0:acquireTokenOverallFailure"},LL={ACQUIRE_TOKEN_OVERALL_SUCCESS:"msal:acquireTokenOverallSuccess",ACQUIRE_TOKEN_OVERALL_FAILURE:"msal:acquireTokenOverallFailure"};function Ri(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}var Xa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function xT(t,e){return t(e={exports:{}},e.exports),e.exports}var qa=xT(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function r(){var o=this;this.locked=new Map,this.addToLocked=function(i,s){var a=o.locked.get(i);a===void 0?s===void 0?o.locked.set(i,[]):o.locked.set(i,[s]):s!==void 0&&(a.unshift(s),o.locked.set(i,a))},this.isLocked=function(i){return o.locked.has(i)},this.lock=function(i){return new Promise(function(s,a){o.isLocked(i)?o.addToLocked(i,s):(o.addToLocked(i),s())})},this.unlock=function(i){var s=o.locked.get(i);if(s!==void 0&&s.length!==0){var a=s.pop();o.locked.set(i,s),a!==void 0&&setTimeout(a,0)}else o.locked.delete(i)}}return r.getInstance=function(){return r.instance===void 0&&(r.instance=new r),r.instance},r}();e.default=function(){return n.getInstance()}});kT(qa);var FZ=kT(xT(function(t,e){var n=Xa&&Xa.__awaiter||function(h,p,f,g){return new(f||(f=Promise))(function(v,y){function b(E){try{S(g.next(E))}catch(I){y(I)}}function C(E){try{S(g.throw(E))}catch(I){y(I)}}function S(E){E.done?v(E.value):new f(function(I){I(E.value)}).then(b,C)}S((g=g.apply(h,p||[])).next())})},r=Xa&&Xa.__generator||function(h,p){var f,g,v,y,b={label:0,sent:function(){if(1&v[0])throw v[1];return v[1]},trys:[],ops:[]};return y={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function C(S){return function(E){return function(I){if(f)throw new TypeError("Generator is already executing.");for(;b;)try{if(f=1,g&&(v=2&I[0]?g.return:I[0]?g.throw||((v=g.return)&&v.call(g),0):g.next)&&!(v=v.call(g,I[1])).done)return v;switch(g=0,v&&(I=[2&I[0],v.value]),I[0]){case 0:case 1:v=I;break;case 4:return b.label++,{value:I[1],done:!1};case 5:b.label++,g=I[1],I=[0];continue;case 7:I=b.ops.pop(),b.trys.pop();continue;default:if(v=b.trys,!((v=v.length>0&&v[v.length-1])||I[0]!==6&&I[0]!==2)){b=0;continue}if(I[0]===3&&(!v||I[1]>v[0]&&I[1]<v[3])){b.label=I[1];break}if(I[0]===6&&b.label<v[1]){b.label=v[1],v=I;break}if(v&&b.label<v[2]){b.label=v[2],b.ops.push(I);break}v[2]&&b.ops.pop(),b.trys.pop();continue}I=p.call(h,b)}catch(T){I=[6,T],g=0}finally{f=v=0}if(5&I[0])throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}([S,E])}}},o=Xa;Object.defineProperty(e,"__esModule",{value:!0});var i="browser-tabs-lock-key",s={key:function(h){return n(o,void 0,void 0,function(){return r(this,function(p){throw new Error("Unsupported")})})},getItem:function(h){return n(o,void 0,void 0,function(){return r(this,function(p){throw new Error("Unsupported")})})},clear:function(){return n(o,void 0,void 0,function(){return r(this,function(h){return[2,window.localStorage.clear()]})})},removeItem:function(h){return n(o,void 0,void 0,function(){return r(this,function(p){throw new Error("Unsupported")})})},setItem:function(h,p){return n(o,void 0,void 0,function(){return r(this,function(f){throw new Error("Unsupported")})})},keySync:function(h){return window.localStorage.key(h)},getItemSync:function(h){return window.localStorage.getItem(h)},clearSync:function(){return window.localStorage.clear()},removeItemSync:function(h){return window.localStorage.removeItem(h)},setItemSync:function(h,p){return window.localStorage.setItem(h,p)}};function a(h){return new Promise(function(p){return setTimeout(p,h)})}function c(h){for(var p="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",f="",g=0;g<h;g++)f+=p[Math.floor(Math.random()*p.length)];return f}var u=function(){function h(p){this.acquiredIatSet=new Set,this.storageHandler=void 0,this.id=Date.now().toString()+c(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),this.storageHandler=p,h.waiters===void 0&&(h.waiters=[])}return h.prototype.acquireLock=function(p,f){return f===void 0&&(f=5e3),n(this,void 0,void 0,function(){var g,v,y,b,C,S,E;return r(this,function(I){switch(I.label){case 0:g=Date.now()+c(4),v=Date.now()+f,y=i+"-"+p,b=this.storageHandler===void 0?s:this.storageHandler,I.label=1;case 1:return Date.now()<v?[4,a(30)]:[3,8];case 2:return I.sent(),b.getItemSync(y)!==null?[3,5]:(C=this.id+"-"+p+"-"+g,[4,a(Math.floor(25*Math.random()))]);case 3:return I.sent(),b.setItemSync(y,JSON.stringify({id:this.id,iat:g,timeoutKey:C,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,a(30)];case 4:return I.sent(),(S=b.getItemSync(y))!==null&&(E=JSON.parse(S)).id===this.id&&E.iat===g?(this.acquiredIatSet.add(g),this.refreshLockWhileAcquired(y,g),[2,!0]):[3,7];case 5:return h.lockCorrector(this.storageHandler===void 0?s:this.storageHandler),[4,this.waitForSomethingToChange(v)];case 6:I.sent(),I.label=7;case 7:return g=Date.now()+c(4),[3,1];case 8:return[2,!1]}})})},h.prototype.refreshLockWhileAcquired=function(p,f){return n(this,void 0,void 0,function(){var g=this;return r(this,function(v){return setTimeout(function(){return n(g,void 0,void 0,function(){var y,b,C;return r(this,function(S){switch(S.label){case 0:return[4,qa.default().lock(f)];case 1:return S.sent(),this.acquiredIatSet.has(f)?(y=this.storageHandler===void 0?s:this.storageHandler,(b=y.getItemSync(p))===null?(qa.default().unlock(f),[2]):((C=JSON.parse(b)).timeRefreshed=Date.now(),y.setItemSync(p,JSON.stringify(C)),qa.default().unlock(f),this.refreshLockWhileAcquired(p,f),[2])):(qa.default().unlock(f),[2])}})})},1e3),[2]})})},h.prototype.waitForSomethingToChange=function(p){return n(this,void 0,void 0,function(){return r(this,function(f){switch(f.label){case 0:return[4,new Promise(function(g){var v=!1,y=Date.now(),b=!1;function C(){if(b||(window.removeEventListener("storage",C),h.removeFromWaiting(C),clearTimeout(S),b=!0),!v){v=!0;var E=50-(Date.now()-y);E>0?setTimeout(g,E):g(null)}}window.addEventListener("storage",C),h.addToWaiting(C);var S=setTimeout(C,Math.max(0,p-Date.now()))})];case 1:return f.sent(),[2]}})})},h.addToWaiting=function(p){this.removeFromWaiting(p),h.waiters!==void 0&&h.waiters.push(p)},h.removeFromWaiting=function(p){h.waiters!==void 0&&(h.waiters=h.waiters.filter(function(f){return f!==p}))},h.notifyWaiters=function(){h.waiters!==void 0&&h.waiters.slice().forEach(function(p){return p()})},h.prototype.releaseLock=function(p){return n(this,void 0,void 0,function(){return r(this,function(f){switch(f.label){case 0:return[4,this.releaseLock__private__(p)];case 1:return[2,f.sent()]}})})},h.prototype.releaseLock__private__=function(p){return n(this,void 0,void 0,function(){var f,g,v,y;return r(this,function(b){switch(b.label){case 0:return f=this.storageHandler===void 0?s:this.storageHandler,g=i+"-"+p,(v=f.getItemSync(g))===null?[2]:(y=JSON.parse(v)).id!==this.id?[3,2]:[4,qa.default().lock(y.iat)];case 1:b.sent(),this.acquiredIatSet.delete(y.iat),f.removeItemSync(g),qa.default().unlock(y.iat),h.notifyWaiters(),b.label=2;case 2:return[2]}})})},h.lockCorrector=function(p){for(var f=Date.now()-5e3,g=p,v=[],y=0;;){var b=g.keySync(y);if(b===null)break;v.push(b),y++}for(var C=!1,S=0;S<v.length;S++){var E=v[S];if(E.includes(i)){var I=g.getItemSync(E);if(I!==null){var T=JSON.parse(I);(T.timeRefreshed===void 0&&T.timeAcquired<f||T.timeRefreshed!==void 0&&T.timeRefreshed<f)&&(g.removeItemSync(E),C=!0)}}}C&&h.notifyWaiters()},h.waiters=void 0,h}();e.default=u}));const BZ={timeoutInSeconds:60},DL={name:"auth0-spa-js",version:"2.1.3"},jL=()=>Date.now();class tr extends Error{constructor(e,n){super(n),this.error=e,this.error_description=n,Object.setPrototypeOf(this,tr.prototype)}static fromPayload({error:e,error_description:n}){return new tr(e,n)}}let HZ=class UL extends tr{constructor(e,n,r,o=null){super(e,n),this.state=r,this.appState=o,Object.setPrototypeOf(this,UL.prototype)}},h1=class FL extends tr{constructor(){super("timeout","Timeout"),Object.setPrototypeOf(this,FL.prototype)}},zZ=class BL extends h1{constructor(e){super(),this.popup=e,Object.setPrototypeOf(this,BL.prototype)}},VZ=class HL extends tr{constructor(e){super("cancelled","Popup closed"),this.popup=e,Object.setPrototypeOf(this,HL.prototype)}},$Z=class zL extends tr{constructor(e,n,r){super(e,n),this.mfa_token=r,Object.setPrototypeOf(this,zL.prototype)}},VL=class $L extends tr{constructor(e,n){super("missing_refresh_token",`Missing Refresh Token (audience: '${dx(e,["default"])}', scope: '${dx(n)}')`),this.audience=e,this.scope=n,Object.setPrototypeOf(this,$L.prototype)}};function dx(t,e=[]){return t&&!e.includes(t)?t:""}const Km=()=>window.crypto,kC=()=>{const t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.";let e="";return Array.from(Km().getRandomValues(new Uint8Array(43))).forEach(n=>e+=t[n%t.length]),e},hx=t=>btoa(t),f1=t=>{var{clientId:e}=t,n=Ri(t,["clientId"]);return new URLSearchParams((r=>Object.keys(r).filter(o=>r[o]!==void 0).reduce((o,i)=>Object.assign(Object.assign({},o),{[i]:r[i]}),{}))(Object.assign({client_id:e},n))).toString()},fx=t=>(e=>decodeURIComponent(atob(e).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))(t.replace(/_/g,"/").replace(/-/g,"+")),GZ=async(t,e)=>{const n=await fetch(t,e);return{ok:n.ok,json:await n.json()}},KZ=async(t,e,n)=>{const r=new AbortController;let o;return e.signal=r.signal,Promise.race([GZ(t,e),new Promise((i,s)=>{o=setTimeout(()=>{r.abort(),s(new Error("Timeout when executing 'fetch'"))},n)})]).finally(()=>{clearTimeout(o)})},qZ=async(t,e,n,r,o,i,s)=>{return a={auth:{audience:e,scope:n},timeout:o,fetchUrl:t,fetchOptions:r,useFormData:s},c=i,new Promise(function(u,h){const p=new MessageChannel;p.port1.onmessage=function(f){f.data.error?h(new Error(f.data.error)):u(f.data),p.port1.close()},c.postMessage(a,[p.port2])});var a,c},WZ=async(t,e,n,r,o,i,s=1e4)=>o?qZ(t,e,n,r,s,o,i):KZ(t,r,s);async function YZ(t,e){var{baseUrl:n,timeout:r,audience:o,scope:i,auth0Client:s,useFormData:a}=t,c=Ri(t,["baseUrl","timeout","audience","scope","auth0Client","useFormData"]);const u=a?f1(c):JSON.stringify(c);return await async function(h,p,f,g,v,y,b){let C,S=null;for(let A=0;A<3;A++)try{C=await WZ(h,f,g,v,y,b,p),S=null;break}catch(M){S=M}if(S)throw S;const E=C.json,{error:I,error_description:T}=E,_=Ri(E,["error","error_description"]),{ok:w}=C;if(!w){const A=T||`HTTP error. Unable to fetch ${h}`;throw I==="mfa_required"?new $Z(I,A,_.mfa_token):I==="missing_refresh_token"?new VL(f,g):new tr(I||"request_error",A)}return _}(`${n}/oauth/token`,r,o||"default",i,{method:"POST",body:u,headers:{"Content-Type":a?"application/x-www-form-urlencoded":"application/json","Auth0-Client":btoa(JSON.stringify(s||DL))}},e,a)}const Zp=(...t)=>{return(e=t.filter(Boolean).join(" ").trim().split(/\s+/),Array.from(new Set(e))).join(" ");var e};let ic=class p1{constructor(e,n="@@auth0spajs@@",r){this.prefix=n,this.suffix=r,this.clientId=e.clientId,this.scope=e.scope,this.audience=e.audience}toKey(){return[this.prefix,this.clientId,this.audience,this.scope,this.suffix].filter(Boolean).join("::")}static fromKey(e){const[n,r,o,i]=e.split("::");return new p1({clientId:r,scope:i,audience:o},n)}static fromCacheEntry(e){const{scope:n,audience:r,client_id:o}=e;return new p1({scope:n,audience:r,clientId:o})}},QZ=class{set(e,n){localStorage.setItem(e,JSON.stringify(n))}get(e){const n=window.localStorage.getItem(e);if(n)try{return JSON.parse(n)}catch{return}}remove(e){localStorage.removeItem(e)}allKeys(){return Object.keys(window.localStorage).filter(e=>e.startsWith("@@auth0spajs@@"))}},GL=class{constructor(){this.enclosedCache=function(){let e={};return{set(n,r){e[n]=r},get(n){const r=e[n];if(r)return r},remove(n){delete e[n]},allKeys:()=>Object.keys(e)}}()}},JZ=class{constructor(e,n,r){this.cache=e,this.keyManifest=n,this.nowProvider=r||jL}async setIdToken(e,n,r){var o;const i=this.getIdTokenCacheKey(e);await this.cache.set(i,{id_token:n,decodedToken:r}),await((o=this.keyManifest)===null||o===void 0?void 0:o.add(i))}async getIdToken(e){const n=await this.cache.get(this.getIdTokenCacheKey(e.clientId));if(!n&&e.scope&&e.audience){const r=await this.get(e);return!r||!r.id_token||!r.decodedToken?void 0:{id_token:r.id_token,decodedToken:r.decodedToken}}if(n)return{id_token:n.id_token,decodedToken:n.decodedToken}}async get(e,n=0){var r;let o=await this.cache.get(e.toKey());if(!o){const a=await this.getCacheKeys();if(!a)return;const c=this.matchExistingCacheKey(e,a);c&&(o=await this.cache.get(c))}if(!o)return;const i=await this.nowProvider(),s=Math.floor(i/1e3);return o.expiresAt-n<s?o.body.refresh_token?(o.body={refresh_token:o.body.refresh_token},await this.cache.set(e.toKey(),o),o.body):(await this.cache.remove(e.toKey()),void await((r=this.keyManifest)===null||r===void 0?void 0:r.remove(e.toKey()))):o.body}async set(e){var n;const r=new ic({clientId:e.client_id,scope:e.scope,audience:e.audience}),o=await this.wrapCacheEntry(e);await this.cache.set(r.toKey(),o),await((n=this.keyManifest)===null||n===void 0?void 0:n.add(r.toKey()))}async clear(e){var n;const r=await this.getCacheKeys();r&&(await r.filter(o=>!e||o.includes(e)).reduce(async(o,i)=>{await o,await this.cache.remove(i)},Promise.resolve()),await((n=this.keyManifest)===null||n===void 0?void 0:n.clear()))}async wrapCacheEntry(e){const n=await this.nowProvider();return{body:e,expiresAt:Math.floor(n/1e3)+e.expires_in}}async getCacheKeys(){var e;return this.keyManifest?(e=await this.keyManifest.get())===null||e===void 0?void 0:e.keys:this.cache.allKeys?this.cache.allKeys():void 0}getIdTokenCacheKey(e){return new ic({clientId:e},"@@auth0spajs@@","@@user@@").toKey()}matchExistingCacheKey(e,n){return n.filter(r=>{var o;const i=ic.fromKey(r),s=new Set(i.scope&&i.scope.split(" ")),a=((o=e.scope)===null||o===void 0?void 0:o.split(" "))||[],c=i.scope&&a.reduce((u,h)=>u&&s.has(h),!0);return i.prefix==="@@auth0spajs@@"&&i.clientId===e.clientId&&i.audience===e.audience&&c})[0]}},ZZ=class{constructor(e,n,r){this.storage=e,this.clientId=n,this.cookieDomain=r,this.storageKey=`a0.spajs.txs.${this.clientId}`}create(e){this.storage.save(this.storageKey,e,{daysUntilExpire:1,cookieDomain:this.cookieDomain})}get(){return this.storage.get(this.storageKey)}remove(){this.storage.remove(this.storageKey,{cookieDomain:this.cookieDomain})}};const ch=t=>typeof t=="number",XZ=["iss","aud","exp","nbf","iat","jti","azp","nonce","auth_time","at_hash","c_hash","acr","amr","sub_jwk","cnf","sip_from_tag","sip_date","sip_callid","sip_cseq_num","sip_via_branch","orig","dest","mky","events","toe","txn","rph","sid","vot","vtm"],eX=t=>{if(!t.id_token)throw new Error("ID token is required but missing");const e=(i=>{const s=i.split("."),[a,c,u]=s;if(s.length!==3||!a||!c||!u)throw new Error("ID token could not be decoded");const h=JSON.parse(fx(c)),p={__raw:i},f={};return Object.keys(h).forEach(g=>{p[g]=h[g],XZ.includes(g)||(f[g]=h[g])}),{encoded:{header:a,payload:c,signature:u},header:JSON.parse(fx(a)),claims:p,user:f}})(t.id_token);if(!e.claims.iss)throw new Error("Issuer (iss) claim must be a string present in the ID token");if(e.claims.iss!==t.iss)throw new Error(`Issuer (iss) claim mismatch in the ID token; expected "${t.iss}", found "${e.claims.iss}"`);if(!e.user.sub)throw new Error("Subject (sub) claim must be a string present in the ID token");if(e.header.alg!=="RS256")throw new Error(`Signature algorithm of "${e.header.alg}" is not supported. Expected the ID token to be signed with "RS256".`);if(!e.claims.aud||typeof e.claims.aud!="string"&&!Array.isArray(e.claims.aud))throw new Error("Audience (aud) claim must be a string or array of strings present in the ID token");if(Array.isArray(e.claims.aud)){if(!e.claims.aud.includes(t.aud))throw new Error(`Audience (aud) claim mismatch in the ID token; expected "${t.aud}" but was not one of "${e.claims.aud.join(", ")}"`);if(e.claims.aud.length>1){if(!e.claims.azp)throw new Error("Authorized Party (azp) claim must be a string present in the ID token when Audience (aud) claim has multiple values");if(e.claims.azp!==t.aud)throw new Error(`Authorized Party (azp) claim mismatch in the ID token; expected "${t.aud}", found "${e.claims.azp}"`)}}else if(e.claims.aud!==t.aud)throw new Error(`Audience (aud) claim mismatch in the ID token; expected "${t.aud}" but found "${e.claims.aud}"`);if(t.nonce){if(!e.claims.nonce)throw new Error("Nonce (nonce) claim must be a string present in the ID token");if(e.claims.nonce!==t.nonce)throw new Error(`Nonce (nonce) claim mismatch in the ID token; expected "${t.nonce}", found "${e.claims.nonce}"`)}if(t.max_age&&!ch(e.claims.auth_time))throw new Error("Authentication Time (auth_time) claim must be a number present in the ID token when Max Age (max_age) is specified");if(e.claims.exp==null||!ch(e.claims.exp))throw new Error("Expiration Time (exp) claim must be a number present in the ID token");if(!ch(e.claims.iat))throw new Error("Issued At (iat) claim must be a number present in the ID token");const n=t.leeway||60,r=new Date(t.now||Date.now()),o=new Date(0);if(o.setUTCSeconds(e.claims.exp+n),r>o)throw new Error(`Expiration Time (exp) claim error in the ID token; current time (${r}) is after expiration time (${o})`);if(e.claims.nbf!=null&&ch(e.claims.nbf)){const i=new Date(0);if(i.setUTCSeconds(e.claims.nbf-n),r<i)throw new Error(`Not Before time (nbf) claim in the ID token indicates that this token can't be used just yet. Current time (${r}) is before ${i}`)}if(e.claims.auth_time!=null&&ch(e.claims.auth_time)){const i=new Date(0);if(i.setUTCSeconds(parseInt(e.claims.auth_time)+t.max_age+n),r>i)throw new Error(`Authentication Time (auth_time) claim in the ID token indicates that too much time has passed since the last end-user authentication. Current time (${r}) is after last auth at ${i}`)}if(t.organization){const i=t.organization.trim();if(i.startsWith("org_")){const s=i;if(!e.claims.org_id)throw new Error("Organization ID (org_id) claim must be a string present in the ID token");if(s!==e.claims.org_id)throw new Error(`Organization ID (org_id) claim mismatch in the ID token; expected "${s}", found "${e.claims.org_id}"`)}else{const s=i.toLowerCase();if(!e.claims.org_name)throw new Error("Organization Name (org_name) claim must be a string present in the ID token");if(s!==e.claims.org_name)throw new Error(`Organization Name (org_name) claim mismatch in the ID token; expected "${s}", found "${e.claims.org_name}"`)}}return e};var sc=xT(function(t,e){var n=Xa&&Xa.__assign||function(){return n=Object.assign||function(c){for(var u,h=1,p=arguments.length;h<p;h++)for(var f in u=arguments[h])Object.prototype.hasOwnProperty.call(u,f)&&(c[f]=u[f]);return c},n.apply(this,arguments)};function r(c,u){if(!u)return"";var h="; "+c;return u===!0?h:h+"="+u}function o(c,u,h){return encodeURIComponent(c).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(u).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(p){if(typeof p.expires=="number"){var f=new Date;f.setMilliseconds(f.getMilliseconds()+864e5*p.expires),p.expires=f}return r("Expires",p.expires?p.expires.toUTCString():"")+r("Domain",p.domain)+r("Path",p.path)+r("Secure",p.secure)+r("SameSite",p.sameSite)}(h)}function i(c){for(var u={},h=c?c.split("; "):[],p=/(%[\dA-F]{2})+/gi,f=0;f<h.length;f++){var g=h[f].split("="),v=g.slice(1).join("=");v.charAt(0)==='"'&&(v=v.slice(1,-1));try{u[g[0].replace(p,decodeURIComponent)]=v.replace(p,decodeURIComponent)}catch{}}return u}function s(){return i(document.cookie)}function a(c,u,h){document.cookie=o(c,u,n({path:"/"},h))}e.__esModule=!0,e.encode=o,e.parse=i,e.getAll=s,e.get=function(c){return s()[c]},e.set=a,e.remove=function(c,u){a(c,"",n(n({},u),{expires:-1}))}});kT(sc),sc.encode,sc.parse,sc.getAll;var tX=sc.get,KL=sc.set,qL=sc.remove;const Yl={get(t){const e=tX(t);if(e!==void 0)return JSON.parse(e)},save(t,e,n){let r={};window.location.protocol==="https:"&&(r={secure:!0,sameSite:"none"}),n!=null&&n.daysUntilExpire&&(r.expires=n.daysUntilExpire),n!=null&&n.cookieDomain&&(r.domain=n.cookieDomain),KL(t,JSON.stringify(e),r)},remove(t,e){let n={};e!=null&&e.cookieDomain&&(n.domain=e.cookieDomain),qL(t,n)}},nX={get(t){return Yl.get(t)||Yl.get(`_legacy_${t}`)},save(t,e,n){let r={};window.location.protocol==="https:"&&(r={secure:!0}),n!=null&&n.daysUntilExpire&&(r.expires=n.daysUntilExpire),n!=null&&n.cookieDomain&&(r.domain=n.cookieDomain),KL(`_legacy_${t}`,JSON.stringify(e),r),Yl.save(t,e,n)},remove(t,e){let n={};e!=null&&e.cookieDomain&&(n.domain=e.cookieDomain),qL(t,n),Yl.remove(t,e),Yl.remove(`_legacy_${t}`,e)}},rX={get(t){if(typeof sessionStorage>"u")return;const e=sessionStorage.getItem(t);return e!=null?JSON.parse(e):void 0},save(t,e){sessionStorage.setItem(t,JSON.stringify(e))},remove(t){sessionStorage.removeItem(t)}};function oX(t,e,n){var r=e===void 0?null:e,o=function(c,u){var h=atob(c);if(u){for(var p=new Uint8Array(h.length),f=0,g=h.length;f<g;++f)p[f]=h.charCodeAt(f);return String.fromCharCode.apply(null,new Uint16Array(p.buffer))}return h}(t,n!==void 0&&n),i=o.indexOf(`
`,10)+1,s=o.substring(i)+(r?"//# sourceMappingURL="+r:""),a=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(a)}var px,mx,gx,xC,iX=(px="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Y2xhc3MgZSBleHRlbmRzIEVycm9ye2NvbnN0cnVjdG9yKHQscil7c3VwZXIociksdGhpcy5lcnJvcj10LHRoaXMuZXJyb3JfZGVzY3JpcHRpb249cixPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxlLnByb3RvdHlwZSl9c3RhdGljIGZyb21QYXlsb2FkKHtlcnJvcjp0LGVycm9yX2Rlc2NyaXB0aW9uOnJ9KXtyZXR1cm4gbmV3IGUodCxyKX19Y2xhc3MgdCBleHRlbmRzIGV7Y29uc3RydWN0b3IoZSxzKXtzdXBlcigibWlzc2luZ19yZWZyZXNoX3Rva2VuIixgTWlzc2luZyBSZWZyZXNoIFRva2VuIChhdWRpZW5jZTogJyR7cihlLFsiZGVmYXVsdCJdKX0nLCBzY29wZTogJyR7cihzKX0nKWApLHRoaXMuYXVkaWVuY2U9ZSx0aGlzLnNjb3BlPXMsT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsdC5wcm90b3R5cGUpfX1mdW5jdGlvbiByKGUsdD1bXSl7cmV0dXJuIGUmJiF0LmluY2x1ZGVzKGUpP2U6IiJ9ImZ1bmN0aW9uIj09dHlwZW9mIFN1cHByZXNzZWRFcnJvciYmU3VwcHJlc3NlZEVycm9yO2NvbnN0IHM9ZT0+e3ZhcntjbGllbnRJZDp0fT1lLHI9ZnVuY3Rpb24oZSx0KXt2YXIgcj17fTtmb3IodmFyIHMgaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxzKSYmdC5pbmRleE9mKHMpPDAmJihyW3NdPWVbc10pO2lmKG51bGwhPWUmJiJmdW5jdGlvbiI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz0wO2ZvcihzPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7bzxzLmxlbmd0aDtvKyspdC5pbmRleE9mKHNbb10pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLHNbb10pJiYocltzW29dXT1lW3Nbb11dKX1yZXR1cm4gcn0oZSxbImNsaWVudElkIl0pO3JldHVybiBuZXcgVVJMU2VhcmNoUGFyYW1zKChlPT5PYmplY3Qua2V5cyhlKS5maWx0ZXIoKHQ9PnZvaWQgMCE9PWVbdF0pKS5yZWR1Y2UoKCh0LHIpPT5PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse1tyXTplW3JdfSkpLHt9KSkoT2JqZWN0LmFzc2lnbih7Y2xpZW50X2lkOnR9LHIpKSkudG9TdHJpbmcoKX07bGV0IG89e307Y29uc3Qgbj0oZSx0KT0+YCR7ZX18JHt0fWA7YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGFzeW5jKHtkYXRhOnt0aW1lb3V0OmUsYXV0aDpyLGZldGNoVXJsOmksZmV0Y2hPcHRpb25zOmMsdXNlRm9ybURhdGE6YX0scG9ydHM6W3BdfSk9PntsZXQgZjtjb25zdHthdWRpZW5jZTp1LHNjb3BlOmx9PXJ8fHt9O3RyeXtjb25zdCByPWE/KGU9Pntjb25zdCB0PW5ldyBVUkxTZWFyY2hQYXJhbXMoZSkscj17fTtyZXR1cm4gdC5mb3JFYWNoKCgoZSx0KT0+e3JbdF09ZX0pKSxyfSkoYy5ib2R5KTpKU09OLnBhcnNlKGMuYm9keSk7aWYoIXIucmVmcmVzaF90b2tlbiYmInJlZnJlc2hfdG9rZW4iPT09ci5ncmFudF90eXBlKXtjb25zdCBlPSgoZSx0KT0+b1tuKGUsdCldKSh1LGwpO2lmKCFlKXRocm93IG5ldyB0KHUsbCk7Yy5ib2R5PWE/cyhPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse3JlZnJlc2hfdG9rZW46ZX0pKTpKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse3JlZnJlc2hfdG9rZW46ZX0pKX1sZXQgaCxnOyJmdW5jdGlvbiI9PXR5cGVvZiBBYm9ydENvbnRyb2xsZXImJihoPW5ldyBBYm9ydENvbnRyb2xsZXIsYy5zaWduYWw9aC5zaWduYWwpO3RyeXtnPWF3YWl0IFByb21pc2UucmFjZShbKGQ9ZSxuZXcgUHJvbWlzZSgoZT0+c2V0VGltZW91dChlLGQpKSkpLGZldGNoKGksT2JqZWN0LmFzc2lnbih7fSxjKSldKX1jYXRjaChlKXtyZXR1cm4gdm9pZCBwLnBvc3RNZXNzYWdlKHtlcnJvcjplLm1lc3NhZ2V9KX1pZighZylyZXR1cm4gaCYmaC5hYm9ydCgpLHZvaWQgcC5wb3N0TWVzc2FnZSh7ZXJyb3I6IlRpbWVvdXQgd2hlbiBleGVjdXRpbmcgJ2ZldGNoJyJ9KTtmPWF3YWl0IGcuanNvbigpLGYucmVmcmVzaF90b2tlbj8oKChlLHQscik9PntvW24odCxyKV09ZX0pKGYucmVmcmVzaF90b2tlbix1LGwpLGRlbGV0ZSBmLnJlZnJlc2hfdG9rZW4pOigoZSx0KT0+e2RlbGV0ZSBvW24oZSx0KV19KSh1LGwpLHAucG9zdE1lc3NhZ2Uoe29rOmcub2ssanNvbjpmfSl9Y2F0Y2goZSl7cC5wb3N0TWVzc2FnZSh7b2s6ITEsanNvbjp7ZXJyb3I6ZS5lcnJvcixlcnJvcl9kZXNjcmlwdGlvbjplLm1lc3NhZ2V9fSl9dmFyIGR9KSl9KCk7Cgo=",mx=null,gx=!1,function(t){return xC=xC||oX(px,mx,gx),new Worker(xC,t)});const RC={};let sX=class{constructor(e,n){this.cache=e,this.clientId=n,this.manifestKey=this.createManifestKeyFrom(this.clientId)}async add(e){var n;const r=new Set(((n=await this.cache.get(this.manifestKey))===null||n===void 0?void 0:n.keys)||[]);r.add(e),await this.cache.set(this.manifestKey,{keys:[...r]})}async remove(e){const n=await this.cache.get(this.manifestKey);if(n){const r=new Set(n.keys);return r.delete(e),r.size>0?await this.cache.set(this.manifestKey,{keys:[...r]}):await this.cache.remove(this.manifestKey)}}get(){return this.cache.get(this.manifestKey)}clear(){return this.cache.remove(this.manifestKey)}createManifestKeyFrom(e){return`@@auth0spajs@@::${e}`}};const aX={memory:()=>new GL().enclosedCache,localstorage:()=>new QZ},vx=t=>aX[t],bx=t=>{const{openUrl:e,onRedirect:n}=t,r=Ri(t,["openUrl","onRedirect"]);return Object.assign(Object.assign({},r),{openUrl:e===!1||e?e:n})},NC=new FZ;let cX=class{constructor(e){let n,r;if(this.userCache=new GL().enclosedCache,this.defaultOptions={authorizationParams:{scope:"openid profile email"},useRefreshTokensFallback:!1,useFormData:!0},this._releaseLockOnPageHide=async()=>{await NC.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)},this.options=Object.assign(Object.assign(Object.assign({},this.defaultOptions),e),{authorizationParams:Object.assign(Object.assign({},this.defaultOptions.authorizationParams),e.authorizationParams)}),typeof window<"u"&&(()=>{if(!Km())throw new Error("For security reasons, `window.crypto` is required to run `auth0-spa-js`.");if(Km().subtle===void 0)throw new Error(`
      auth0-spa-js must run on a secure origin. See https://github.com/auth0/auth0-spa-js/blob/main/FAQ.md#why-do-i-get-auth0-spa-js-must-run-on-a-secure-origin for more information.
    `)})(),e.cache&&e.cacheLocation&&console.warn("Both `cache` and `cacheLocation` options have been specified in the Auth0Client configuration; ignoring `cacheLocation` and using `cache`."),e.cache)r=e.cache;else{if(n=e.cacheLocation||"memory",!vx(n))throw new Error(`Invalid cache location "${n}"`);r=vx(n)()}this.httpTimeoutMs=e.httpTimeoutInSeconds?1e3*e.httpTimeoutInSeconds:1e4,this.cookieStorage=e.legacySameSiteCookie===!1?Yl:nX,this.orgHintCookieName=`auth0.${this.options.clientId}.organization_hint`,this.isAuthenticatedCookieName=(s=>`auth0.${s}.is.authenticated`)(this.options.clientId),this.sessionCheckExpiryDays=e.sessionCheckExpiryDays||1;const o=e.useCookiesForTransactions?this.cookieStorage:rX;var i;this.scope=Zp("openid",this.options.authorizationParams.scope,this.options.useRefreshTokens?"offline_access":""),this.transactionManager=new ZZ(o,this.options.clientId,this.options.cookieDomain),this.nowProvider=this.options.nowProvider||jL,this.cacheManager=new JZ(r,r.allKeys?void 0:new sX(r,this.options.clientId),this.nowProvider),this.domainUrl=(i=this.options.domain,/^https?:\/\//.test(i)?i:`https://${i}`),this.tokenIssuer=((s,a)=>s?s.startsWith("https://")?s:`https://${s}/`:`${a}/`)(this.options.issuer,this.domainUrl),typeof window<"u"&&window.Worker&&this.options.useRefreshTokens&&n==="memory"&&(this.options.workerUrl?this.worker=new Worker(this.options.workerUrl):this.worker=new iX)}_url(e){const n=encodeURIComponent(btoa(JSON.stringify(this.options.auth0Client||DL)));return`${this.domainUrl}${e}&auth0Client=${n}`}_authorizeUrl(e){return this._url(`/authorize?${f1(e)}`)}async _verifyIdToken(e,n,r){const o=await this.nowProvider();return eX({iss:this.tokenIssuer,aud:this.options.clientId,id_token:e,nonce:n,organization:r,leeway:this.options.leeway,max_age:(i=this.options.authorizationParams.max_age,typeof i!="string"?i:parseInt(i,10)||void 0),now:o});var i}_processOrgHint(e){e?this.cookieStorage.save(this.orgHintCookieName,e,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}):this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain})}async _prepareAuthorizeUrl(e,n,r){const o=hx(kC()),i=hx(kC()),s=kC(),a=(h=>{const p=new Uint8Array(h);return(f=>{const g={"+":"-","/":"_","=":""};return f.replace(/[+/=]/g,v=>g[v])})(window.btoa(String.fromCharCode(...Array.from(p))))})(await(async h=>await Km().subtle.digest({name:"SHA-256"},new TextEncoder().encode(h)))(s)),c=((h,p,f,g,v,y,b,C)=>Object.assign(Object.assign(Object.assign({client_id:h.clientId},h.authorizationParams),f),{scope:Zp(p,f.scope),response_type:"code",response_mode:C||"query",state:g,nonce:v,redirect_uri:b||h.authorizationParams.redirect_uri,code_challenge:y,code_challenge_method:"S256"}))(this.options,this.scope,e,o,i,a,e.redirect_uri||this.options.authorizationParams.redirect_uri||r,n==null?void 0:n.response_mode),u=this._authorizeUrl(c);return{nonce:i,code_verifier:s,scope:c.scope,audience:c.audience||"default",redirect_uri:c.redirect_uri,state:o,url:u}}async loginWithPopup(e,n){var r;if(e=e||{},!(n=n||{}).popup&&(n.popup=(a=>{const c=window.screenX+(window.innerWidth-400)/2,u=window.screenY+(window.innerHeight-600)/2;return window.open(a,"auth0:authorize:popup",`left=${c},top=${u},width=400,height=600,resizable,scrollbars=yes,status=1`)})(""),!n.popup))throw new Error("Unable to open a popup for loginWithPopup - window.open returned `null`");const o=await this._prepareAuthorizeUrl(e.authorizationParams||{},{response_mode:"web_message"},window.location.origin);n.popup.location.href=o.url;const i=await(a=>new Promise((c,u)=>{let h;const p=setInterval(()=>{a.popup&&a.popup.closed&&(clearInterval(p),clearTimeout(f),window.removeEventListener("message",h,!1),u(new VZ(a.popup)))},1e3),f=setTimeout(()=>{clearInterval(p),u(new zZ(a.popup)),window.removeEventListener("message",h,!1)},1e3*(a.timeoutInSeconds||60));h=function(g){if(g.data&&g.data.type==="authorization_response"){if(clearTimeout(f),clearInterval(p),window.removeEventListener("message",h,!1),a.popup.close(),g.data.response.error)return u(tr.fromPayload(g.data.response));c(g.data.response)}},window.addEventListener("message",h)}))(Object.assign(Object.assign({},n),{timeoutInSeconds:n.timeoutInSeconds||this.options.authorizeTimeoutInSeconds||60}));if(o.state!==i.state)throw new tr("state_mismatch","Invalid state");const s=((r=e.authorizationParams)===null||r===void 0?void 0:r.organization)||this.options.authorizationParams.organization;await this._requestToken({audience:o.audience,scope:o.scope,code_verifier:o.code_verifier,grant_type:"authorization_code",code:i.code,redirect_uri:o.redirect_uri},{nonceIn:o.nonce,organization:s})}async getUser(){var e;const n=await this._getIdTokenFromCache();return(e=n==null?void 0:n.decodedToken)===null||e===void 0?void 0:e.user}async getIdTokenClaims(){var e;const n=await this._getIdTokenFromCache();return(e=n==null?void 0:n.decodedToken)===null||e===void 0?void 0:e.claims}async loginWithRedirect(e={}){var n;const r=bx(e),{openUrl:o,fragment:i,appState:s}=r,a=Ri(r,["openUrl","fragment","appState"]),c=((n=a.authorizationParams)===null||n===void 0?void 0:n.organization)||this.options.authorizationParams.organization,u=await this._prepareAuthorizeUrl(a.authorizationParams||{}),{url:h}=u,p=Ri(u,["url"]);this.transactionManager.create(Object.assign(Object.assign(Object.assign({},p),{appState:s}),c&&{organization:c}));const f=i?`${h}#${i}`:h;o?await o(f):window.location.assign(f)}async handleRedirectCallback(e=window.location.href){const n=e.split("?").slice(1);if(n.length===0)throw new Error("There are no query params available for parsing.");const{state:r,code:o,error:i,error_description:s}=(p=>{p.indexOf("#")>-1&&(p=p.substring(0,p.indexOf("#")));const f=new URLSearchParams(p);return{state:f.get("state"),code:f.get("code")||void 0,error:f.get("error")||void 0,error_description:f.get("error_description")||void 0}})(n.join("")),a=this.transactionManager.get();if(!a)throw new tr("missing_transaction","Invalid state");if(this.transactionManager.remove(),i)throw new HZ(i,s||i,r,a.appState);if(!a.code_verifier||a.state&&a.state!==r)throw new tr("state_mismatch","Invalid state");const c=a.organization,u=a.nonce,h=a.redirect_uri;return await this._requestToken(Object.assign({audience:a.audience,scope:a.scope,code_verifier:a.code_verifier,grant_type:"authorization_code",code:o},h?{redirect_uri:h}:{}),{nonceIn:u,organization:c}),{appState:a.appState}}async checkSession(e){if(!this.cookieStorage.get(this.isAuthenticatedCookieName)){if(!this.cookieStorage.get("auth0.is.authenticated"))return;this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove("auth0.is.authenticated")}try{await this.getTokenSilently(e)}catch{}}async getTokenSilently(e={}){var n;const r=Object.assign(Object.assign({cacheMode:"on"},e),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),e.authorizationParams),{scope:Zp(this.scope,(n=e.authorizationParams)===null||n===void 0?void 0:n.scope)})}),o=await((i,s)=>{let a=RC[s];return a||(a=i().finally(()=>{delete RC[s],a=null}),RC[s]=a),a})(()=>this._getTokenSilently(r),`${this.options.clientId}::${r.authorizationParams.audience}::${r.authorizationParams.scope}`);return e.detailedResponse?o:o==null?void 0:o.access_token}async _getTokenSilently(e){const{cacheMode:n}=e,r=Ri(e,["cacheMode"]);if(n!=="off"){const o=await this._getEntryFromCache({scope:r.authorizationParams.scope,audience:r.authorizationParams.audience||"default",clientId:this.options.clientId});if(o)return o}if(n!=="cache-only"){if(!await(async(o,i=3)=>{for(let s=0;s<i;s++)if(await o())return!0;return!1})(()=>NC.acquireLock("auth0.lock.getTokenSilently",5e3),10))throw new h1;try{if(window.addEventListener("pagehide",this._releaseLockOnPageHide),n!=="off"){const u=await this._getEntryFromCache({scope:r.authorizationParams.scope,audience:r.authorizationParams.audience||"default",clientId:this.options.clientId});if(u)return u}const o=this.options.useRefreshTokens?await this._getTokenUsingRefreshToken(r):await this._getTokenFromIFrame(r),{id_token:i,access_token:s,oauthTokenScope:a,expires_in:c}=o;return Object.assign(Object.assign({id_token:i,access_token:s},a?{scope:a}:null),{expires_in:c})}finally{await NC.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)}}}async getTokenWithPopup(e={},n={}){var r;const o=Object.assign(Object.assign({},e),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),e.authorizationParams),{scope:Zp(this.scope,(r=e.authorizationParams)===null||r===void 0?void 0:r.scope)})});return n=Object.assign(Object.assign({},BZ),n),await this.loginWithPopup(o,n),(await this.cacheManager.get(new ic({scope:o.authorizationParams.scope,audience:o.authorizationParams.audience||"default",clientId:this.options.clientId}))).access_token}async isAuthenticated(){return!!await this.getUser()}_buildLogoutUrl(e){e.clientId!==null?e.clientId=e.clientId||this.options.clientId:delete e.clientId;const n=e.logoutParams||{},{federated:r}=n,o=Ri(n,["federated"]),i=r?"&federated":"";return this._url(`/v2/logout?${f1(Object.assign({clientId:e.clientId},o))}`)+i}async logout(e={}){const n=bx(e),{openUrl:r}=n,o=Ri(n,["openUrl"]);e.clientId===null?await this.cacheManager.clear():await this.cacheManager.clear(e.clientId||this.options.clientId),this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove(this.isAuthenticatedCookieName,{cookieDomain:this.options.cookieDomain}),this.userCache.remove("@@user@@");const i=this._buildLogoutUrl(o);r?await r(i):r!==!1&&window.location.assign(i)}async _getTokenFromIFrame(e){const n=Object.assign(Object.assign({},e.authorizationParams),{prompt:"none"}),r=this.cookieStorage.get(this.orgHintCookieName);r&&!n.organization&&(n.organization=r);const{url:o,state:i,nonce:s,code_verifier:a,redirect_uri:c,scope:u,audience:h}=await this._prepareAuthorizeUrl(n,{response_mode:"web_message"},window.location.origin);try{if(window.crossOriginIsolated)throw new tr("login_required","The application is running in a Cross-Origin Isolated context, silently retrieving a token without refresh token is not possible.");const p=e.timeoutInSeconds||this.options.authorizeTimeoutInSeconds,f=await((v,y,b=60)=>new Promise((C,S)=>{const E=window.document.createElement("iframe");E.setAttribute("width","0"),E.setAttribute("height","0"),E.style.display="none";const I=()=>{window.document.body.contains(E)&&(window.document.body.removeChild(E),window.removeEventListener("message",T,!1))};let T;const _=setTimeout(()=>{S(new h1),I()},1e3*b);T=function(w){if(w.origin!=y||!w.data||w.data.type!=="authorization_response")return;const A=w.source;A&&A.close(),w.data.response.error?S(tr.fromPayload(w.data.response)):C(w.data.response),clearTimeout(_),window.removeEventListener("message",T,!1),setTimeout(I,2e3)},window.addEventListener("message",T,!1),window.document.body.appendChild(E),E.setAttribute("src",v)}))(o,this.domainUrl,p);if(i!==f.state)throw new tr("state_mismatch","Invalid state");const g=await this._requestToken(Object.assign(Object.assign({},e.authorizationParams),{code_verifier:a,code:f.code,grant_type:"authorization_code",redirect_uri:c,timeout:e.authorizationParams.timeout||this.httpTimeoutMs}),{nonceIn:s,organization:n.organization});return Object.assign(Object.assign({},g),{scope:u,oauthTokenScope:g.scope,audience:h})}catch(p){throw p.error==="login_required"&&this.logout({openUrl:!1}),p}}async _getTokenUsingRefreshToken(e){const n=await this.cacheManager.get(new ic({scope:e.authorizationParams.scope,audience:e.authorizationParams.audience||"default",clientId:this.options.clientId}));if(!(n&&n.refresh_token||this.worker)){if(this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(e);throw new VL(e.authorizationParams.audience||"default",e.authorizationParams.scope)}const r=e.authorizationParams.redirect_uri||this.options.authorizationParams.redirect_uri||window.location.origin,o=typeof e.timeoutInSeconds=="number"?1e3*e.timeoutInSeconds:null;try{const i=await this._requestToken(Object.assign(Object.assign(Object.assign({},e.authorizationParams),{grant_type:"refresh_token",refresh_token:n&&n.refresh_token,redirect_uri:r}),o&&{timeout:o}));return Object.assign(Object.assign({},i),{scope:e.authorizationParams.scope,oauthTokenScope:i.scope,audience:e.authorizationParams.audience||"default"})}catch(i){if((i.message.indexOf("Missing Refresh Token")>-1||i.message&&i.message.indexOf("invalid refresh token")>-1)&&this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(e);throw i}}async _saveEntryInCache(e){const{id_token:n,decodedToken:r}=e,o=Ri(e,["id_token","decodedToken"]);this.userCache.set("@@user@@",{id_token:n,decodedToken:r}),await this.cacheManager.setIdToken(this.options.clientId,e.id_token,e.decodedToken),await this.cacheManager.set(o)}async _getIdTokenFromCache(){const e=this.options.authorizationParams.audience||"default",n=await this.cacheManager.getIdToken(new ic({clientId:this.options.clientId,audience:e,scope:this.scope})),r=this.userCache.get("@@user@@");return n&&n.id_token===(r==null?void 0:r.id_token)?r:(this.userCache.set("@@user@@",n),n)}async _getEntryFromCache({scope:e,audience:n,clientId:r}){const o=await this.cacheManager.get(new ic({scope:e,audience:n,clientId:r}),60);if(o&&o.access_token){const{access_token:i,oauthTokenScope:s,expires_in:a}=o,c=await this._getIdTokenFromCache();return c&&Object.assign(Object.assign({id_token:c.id_token,access_token:i},s?{scope:s}:null),{expires_in:a})}}async _requestToken(e,n){const{nonceIn:r,organization:o}=n||{},i=await YZ(Object.assign({baseUrl:this.domainUrl,client_id:this.options.clientId,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs},e),this.worker),s=await this._verifyIdToken(i.id_token,r,o);return await this._saveEntryInCache(Object.assign(Object.assign(Object.assign(Object.assign({},i),{decodedToken:s,scope:e.scope,audience:e.audience||"default"}),i.scope?{oauthTokenScope:i.scope}:null),{client_id:this.options.clientId})),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this._processOrgHint(o||s.claims.org_id),Object.assign(Object.assign({},i),{decodedToken:s})}};async function lX(t){const e=new cX(t);return await e.checkSession(),e}const WL=D(!1),An=D(null),il=D(t=>{const e=t(An);return e?e.accountType==="AAD":!1}),$xe=D(t=>{const e=t(An);return e?e.accountType==="MSA":!1}),YL=D(t=>t(An)!==null),Zo=D(null),uX=D(!0);function QL(t,e="all"){const n=m.useRef(t),r=m.useMemo(()=>{const o=n.current.map(Aa);return D(i=>e==="all"?o.every(s=>i(s)):o.some(s=>i(s)))},[e]);return L(r)}function Ju(t,e="all"){return e==="all"?t.every(n=>We(n)):t.some(n=>We(n))}const dX=["token-retry-max-1","token-retry-max-2"],hX=["token-retry-max-1-auth0","token-retry-max-2-auth0"],fX=["token-retry-max-1-auth0","token-retry-max-1"],pX=["token-retry-max-2-auth0","token-retry-max-2"];function JL(){const t={initialDelayMs:100,maxDelayMs:500,backoffFactor:2};return Ju(fX,"any")?{...t,maxRetries:1}:Ju(pX,"any")?{...t,maxRetries:2}:{...t,maxRetries:0}}function ZL(t,e,n){return n!==void 0?n:e&&!t}function Lr(){const t=L(hL),e=L(il),n=!!L(An);return ZL(e,n,t)}function Dg(){const t=st(),e=t.get(hL),n=t.get(il),r=!!t.get(An);return ZL(n,r,e)}async function mX(t){var r;const e=(r=t.body)==null?void 0:r.getReader();if(!e)return 0;let n=0;try{const o=performance.now();for(;performance.now()-o<2e3;){const{value:i,done:s}=await e.read();if(s)break;n+=i.byteLength}return n}catch{return 0}}const XL=["character-animation-spda2e","character-animation-vasa","tv-lumi"];function RT(){return QL(XL,"any")}function gX(){const t=L(Qu);return RT()&&!!t}function m1(){const t=st().get(Qu);return Ju(XL,"any")&&!!t}function Xp(t){return t5.includes(t)}const vX="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/meshopt_decoder-3Kt66jYv.js",Hn=class Hn{static async loadLibraries(){const[e,,n]=await Promise.all([H(()=>import("./index-DLqVI8Dc.js").then(r=>r.c),__vite__mapDeps([3,4,5,6,7,8,9,10,11,12,13,14,15,1,2,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169])),H(()=>import("./index-xcMIO94s.js").then(r=>r.b),__vite__mapDeps([170,171,4,5,23,7,8,13,172,173,24,25,1,2,94,174,175,144,33,34,95,31,176,146,177,154,178,179,180,181,153,98,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,10,11,12,203,204,205,206,36,37,207,208,209,210,211])),H(()=>import("./math.scalar.functions-C0i4R8fp.js").then(r=>r.f),[])]);e.MeshoptCompression.Configuration={decoder:{url:vX}},e.Logger.LogLevels=e.Logger.NoneLogLevel,Hn.Core=e,Hn.Math=n,Hn.isInitialized=!0}static async loadViewerLibraries(){const e=await H(()=>import("./index-C7HE8YkO.js").then(n=>n.i),__vite__mapDeps([212,14,4,5,9,172,213]));Hn.Viewer=e}static async loadDebugLibraries(){await Hn.loadLibraries(),await H(()=>import("./babylon.inspector.bundle-BUT6bMSw.js").then(e=>e.b),__vite__mapDeps([214,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,170,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,215,213,216,217]))}static isLoaded(){return Hn.isInitialized}static getCore(){return Hn.throwIfNotInitialized("Core"),Hn.Core}static getMath(){return Hn.throwIfNotInitialized("Core"),Hn.Math}static getViewer(){return Hn.throwIfNotInitialized("Viewer"),Hn.Viewer}static throwIfNotInitialized(e){if(!Hn.isInitialized)throw new Error(`Libraries ${e} are not loaded yet. Call loadLibraries first.`)}};W(Hn,"Core"),W(Hn,"Math"),W(Hn,"Viewer"),W(Hn,"isInitialized",!1);let Zu=Hn;function Gxe(t){const e=t.split(/[\\/]/),n=e.pop();return{basePath:`${e.join("/")}/`,fileName:n??""}}function Kxe(t,e){z.trackEvent({name:"interaction",data:{eventName:"characterAnimation",eventInfo_characterAnimationState:t,eventInfo_characterId:e}})}function qxe(t,e){const{Texture:n}=Zu.getCore();return new Promise((r,o)=>{const i=new n(t,e,!1,!1,1,()=>{r(i)},o)})}function Wxe(t){const{Vector3:e}=Zu.getCore();return new e(t[0],t[1]??0,t[2]??0)}function Yxe(t){return Math.max(...t)-Math.min(...t)}function Qxe(t){return t*Math.PI/180}function Jxe(t){const{Clamp:e}=Zu.getMath();return e(t,0,1)}function bX(t,e,n){return Math.abs(t-e)>n?e:t}function Zxe(t,e,n=.01,r=.2){const{MoveTowards:o}=Zu.getMath();return o(t,bX(t,e,n),r)}let yx;function lh(...t){yx===void 0&&(yx=We("babylon-debug"))}class yX{constructor(){W(this,"resourceObserver");W(this,"entries",[]);W(this,"keyword",null);this.resourceObserver=new PerformanceObserver(e=>{this.handleResources(e)})}trackStart(e){this.keyword=e,this.resourceObserver.observe({type:"resource",buffered:!1})}trackEnd(){const{entries:e}=this,n=e[e.length-1];return this.resourceObserver.disconnect(),this.entries=[],this.keyword=null,n?{name:n.name,duration:Math.round(n.duration)}:null}handleResources(e){if(this.keyword)for(const n of e.getEntries())n.name.includes(this.keyword)&&this.entries.push(n)}}class CX{constructor(e=!0){W(this,"interactTime",0);W(this,"voiceChatToggledTime",0);W(this,"speechEndDetectedTime",0);W(this,"startMessageTime",0);W(this,"mountedTime",0);W(this,"libsLoadedTime",0);W(this,"sceneInitializedTime",0);W(this,"interactSource","");W(this,"currentConversationId","");W(this,"currentMessageId","");W(this,"visualizerEnabled",!1);W(this,"loadedEnd",!1);W(this,"voiceChatToggledOn",!1);W(this,"resourceMonitor",new yX);W(this,"isVoiceCall");W(this,"resetLoading",()=>{lh("%c[] -> resetAppearanceEvent"),this.interactTime=0,this.visualizerEnabled=!1,this.loadedEnd=!1});W(this,"isAvailable",()=>this.isVoiceCall?m1()&&this.voiceChatToggledOn&&this.interactTime>0:m1()&&this.mountedTime>0);W(this,"trackLoadingEvent",e=>{if(!this.isAvailable())return;const{eventName:n,duration:r,characterId:o,networkDuration:i}=e;if(o&&!Xp(o))return;const a=["voiceChatToggled","appearanceVisible","appearanceLoadingComplete"].includes(n),c=!Sn(y$);z.trackEvent({name:"system",data:{eventName:n,eventInfo_duration:Math.round(r),eventInfo_conversationId:this.currentConversationId,eventInfo_firstTime:c,eventInfo_characterId:o,eventInfo_trigger:a?this.interactSource:void 0,eventInfo_networkDuration:i,eventInfo_customData:JSON.stringify({isVoiceCall:this.isVoiceCall})}}),lh(`%c[] -> ${n} : `,"color: #691dc6",Math.round(r),c?"firstTime":"",o?`characterId: ${o}`:"",`isVoiceCall: ${this.isVoiceCall===!0}`)});W(this,"onUserInteract",e=>{this.resetLoading(),this.interactTime=performance.now(),this.interactSource=e,lh("%c[] -> onUserInteract","color: #222222")});W(this,"onVoiceChatToggled",(e,n)=>{if(e==="end")this.voiceChatToggledOn=!1,this.speechEndDetectedTime=0,this.resourceMonitor.trackEnd();else{this.voiceChatToggledOn=!0,this.voiceChatToggledTime=performance.now(),this.currentConversationId=n??"";const r=this.voiceChatToggledTime-this.interactTime;this.trackLoadingEvent({eventName:"voiceChatToggled",duration:r})}});W(this,"onMounted",()=>{this.mountedTime=performance.now();let e;this.isVoiceCall?e=this.mountedTime-this.voiceChatToggledTime:(this.interactTime=this.mountedTime,e=0),this.trackLoadingEvent({eventName:"appearanceMounted",duration:e})});W(this,"onUnmounted",()=>{this.resourceMonitor.trackEnd()});W(this,"onBabylonLibrariesLoaded",e=>{if(!Xp(e))return;this.libsLoadedTime=performance.now();const n=this.libsLoadedTime-this.mountedTime;this.trackLoadingEvent({eventName:"appearanceBabylonLoaded",duration:n,characterId:e})});W(this,"onSceneInitializationStart",e=>{Xp(e)&&this.resourceMonitor.trackStart(".glb")});W(this,"onSceneInitialized",e=>{if(!Xp(e))return;this.sceneInitializedTime=performance.now();const n=this.sceneInitializedTime-this.libsLoadedTime,r=this.resourceMonitor.trackEnd();lh("%c[] -> monitorResult : ","color: #5bb173",r),this.trackLoadingEvent({eventName:"appearanceSceneInitialized",duration:n,characterId:e,networkDuration:r?r.duration:void 0}),this.trackLoadingEvent({eventName:"appearanceLoadingComplete",duration:this.sceneInitializedTime-this.interactTime,characterId:e}),this.loadedEnd=!0,this.checkEnd()});W(this,"onVisualizerEnabled",()=>{if(this.visualizerEnabled)return;this.visualizerEnabled=!0;const e=Math.round(performance.now()-this.interactTime);this.trackLoadingEvent({eventName:"appearanceVisible",duration:e}),this.checkEnd()});W(this,"checkEnd",()=>{this.visualizerEnabled&&this.loadedEnd&&this.resetLoading()});W(this,"onStartMessage",(e,n)=>{this.currentMessageId=e,this.startMessageTime=n});W(this,"onSpeechEndDetected",e=>{this.speechEndDetectedTime=e});W(this,"onAnimationStart",()=>{const e=Math.round(performance.now()-(this.speechEndDetectedTime||this.startMessageTime));z.trackEvent({name:"system",data:{eventName:"copilotAnimationStart",eventInfo_conversationId:this.currentConversationId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:e}}),lh("%c[] -> onAnimationStart : ","color: #691dc6",Math.round(e))});this.isVoiceCall=e}}const PC=new Map,SX=(t=!0)=>(PC.has(t)||PC.set(t,new CX(t)),PC.get(t)),jg=SX(!0),EX=1e3;function eD(t){(t.source==="audioCallButton"||t.source==="characterTalkToggleButton")&&jg.onUserInteract(t.source)}function Tn(t){z.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:t.source,eventInfo_clickScenario:t.scenario,eventInfo_clickDestination:t.destination,eventInfo_conversationId:t.conversationId,eventInfo_podcastId:t.podcastId,eventInfo_messageId:t.messageId,eventInfo_mode:t.chatMode,eventInfo_messageType:t.messageType,eventInfo_cardType:t.cardType,eventInfo_merchantPlatform:t.merchantPlatform,eventInfo_additionalData:t.additionalData?JSON.stringify(t.additionalData):void 0}}),eD(t)}function ht(t){z.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_pageName:t.pageName,eventInfo_sectionName:t.sectionName,eventInfo_clickSource:t.source,eventInfo_clickScenario:t.scenario,eventInfo_clickDestination:t.destination,eventInfo_conversationId:t.conversationId,eventInfo_customData:t.customData}}),eD(t)}function sl(t){z.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionScenario:t.scenario,eventInfo_impressionPage:t.page,eventInfo_impressionElement:t.element,eventInfo_status:t.status,eventInfo_customData:t.customData}})}function ga(t){z.trackEvent({name:"health",data:{eventName:"copilotFeatureSuccess",eventInfo_feature:t.feature,eventInfo_scenario:t.scenario,eventInfo_duration:t.duration,eventInfo_customData:t.customData}})}function xr(t){z.trackEvent({name:"health",data:{eventName:"copilotError",eventInfo_feature:t.feature,eventInfo_scenario:t.scenario,eventInfo_errorType:t.errorType,eventInfo_errorMessage:t.errorMessage,eventInfo_exception:t.exception,eventInfo_customData:t.customData}})}function IX(t){z.trackEvent({name:"interaction",data:{eventName:"copilotSettingChange",eventInfo_settingName:t.settingName,eventInfo_settingOldValue:t.oldValue,eventInfo_settingNewValue:t.newValue}})}function Xxe(t,e=EX){let n;function r(){n=window.setTimeout(()=>{t()},e)}function o(){window.clearTimeout(n)}return{onHoverStart:r,onHoverEnd:o}}function tD(t,e,n,r){setTimeout(async()=>{try{const{status:o}=r,i=await mX(r),s=r.headers.get("x-ceto-ref")??"";z.trackEvent({name:"apiresponse",data:{eventName:"copilotApiResponse",eventInfo_path:t,eventInfo_method:e,eventInfo_status:o,eventInfo_duration:n,eventInfo_responseContentLength:i,eventInfo_cetoRef:s}})}catch{}},0)}function Cx(){performance.mark("userSession-end",{startTime:performance.now()});const{duration:t}=performance.measure("userSession-duration","startupTime-begin","userSession-end");z.trackEvent({name:"system",data:{eventName:"copilotExitEvent",eventInfo_duration:t}})}function TX(t,e,n){z.trackEvent({name:"interaction",data:{eventName:"copilotComposerInput",eventInfo_conversationId:t,eventInfo_inputMethod:e,eventInfo_customData:n}})}function _X(t){z.trackEvent({name:"interaction",data:{eventName:"copilotScroll",eventInfo_ScrollSource:t.scrollSource,eventInfo_ScrollStartX:t.scrollStartX,eventInfo_ScrollStartY:t.scrollStartY,eventInfo_ScrollEndX:t.scrollEndX,eventInfo_ScrollEndY:t.scrollEndY,eventInfo_ScrollDuration:t.scrollDuration,eventInfo_userInitiated:t.userInitiated,eventInfo_customData:t.customData}})}const g1="authInitStartTime";function nD(t,e){if(Dg()){const r=st().get(An),o=r==null?void 0:r.accountType;xr({feature:"api",scenario:e,errorType:"missingToken",errorMessage:`User is authenticated but no token was available for ${e==="getWssAPIUrl"?"WebSocket connection":"API request"}`,customData:JSON.stringify({path:t,accountType:o})})}}function rD(t,e){const r=st().get(An),o=r==null?void 0:r.accountType,i=r==null?void 0:r.provider,s=r==null?void 0:r.tenantId;o||xr({feature:"api",scenario:e,errorType:"emptyAccountTypeWithToken",errorMessage:`Can get the token but with no user account type ${e==="getWssAPIUrl"?"WebSocket connection":"API request"}`,customData:JSON.stringify({path:t,provider:i,tenantId:s})})}function oD(t){const{providerType:e,apiName:n,extraInfo:r}=t,o=Date.now().toString();pa(g1,o),z.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_apiName:n,eventInfo_success:!0,eventInfo_customData:JSON.stringify({eventInfo_providerType:e,...r})}})}function iD(t){const{providerType:e,apiName:n,extraInfo:r}=t,o=Date.now(),i=ci(g1);if(i){const s=parseFloat(i),a=o-s;sessionStorage.removeItem(g1),z.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_apiName:n,eventInfo_success:!0,eventInfo_duration:a,eventInfo_customData:JSON.stringify({eventInfo_providerType:e,...r})}})}}function sD(t){const{authWorkflowAccountType:e,interactionType:n,correlationId:r,prompt:o,redirectUri:i,apiName:s,extraInfo:a}=t,c=Date.now().toString();ar(X0,c),z.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_apiName:s,eventInfo_success:!0,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:e??"unknown",eventInfo_interactionType:n??"",eventInfo_correlationId:r??"",eventInfo_prompt:o??"",eventInfo_redirectUri:i??"",...a})}})}function v1(t){const{authWorkflowAccountType:e,isMSA:n,authority:r,correlationId:o,interactionType:i,apiName:s,extraInfo:a}=t,c=Date.now(),u=Sn(X0);let h;if(u){const p=parseFloat(u);h=c-p,$r(X0)}z.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_apiName:s,eventInfo_success:!0,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:e??"unknown",eventInfo_interactionType:i,eventInfo_correlationId:o,eventInfo_authority:r,eventInfo_isMSA:n??!1,...a}),eventInfo_duration:h??0}})}function aD(t){const{providerType:e,apiName:n,extraInfo:r}=t;z.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!0,eventInfo_apiName:n,eventInfo_customData:JSON.stringify({eventInfo_providerType:e,...r})}})}function ca(t){const{authWorkflowAccountType:e,apiName:n,duration:r,extraInfo:o}=t;z.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!0,eventInfo_apiName:n,eventInfo_duration:r??0,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:e,...o})}})}function Xu(t){const{authWorkflowAccountType:e,apiName:n,errorMessage:r,errorType:o,errorExtraInfo:i,errorCode:s,extraInfo:a}=t;z.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!1,eventInfo_apiName:n,eventInfo_errorType:o,eventInfo_errorMessage:r,eventInfo_errorCode:s,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:e??"unknown",...a,...i})}})}function MC(t){const{authWorkflowAccountType:e,apiName:n}=t;ar(e1,"1"),z.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!0,eventInfo_apiName:n,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:e})}})}function cD(t){const{authWorkflowAccountType:e,apiName:n,duration:r}=t,o=Sn(e1);o==="1"&&$r(e1),o==="1"&&z.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!0,eventInfo_apiName:n,eventInfo_duration:r??0,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:e})}})}function lD(t,e){return{eventInfo_requestType:e,eventInfo_retryAttemptCount:t.attemptCount,eventInfo_retryStartTime:t.startTime,eventInfo_retryEndDelay:t.endTime,eventInfo_retryDelayTimings:t.delayTimings.join(","),eventInfo_allErrors:JSON.stringify(t.errors)}}function uD(t,e,n){ca({authWorkflowAccountType:n,apiName:n==="microsoft"?LL.ACQUIRE_TOKEN_OVERALL_SUCCESS:io.ACQUIRE_TOKEN_OVERALL_SUCCESS,extraInfo:lD(t,e)})}function dD(t,e,n){const r=lD(t,e),o=t.errors[t.errors.length-1];Xu({authWorkflowAccountType:n,apiName:n==="microsoft"?LL.ACQUIRE_TOKEN_OVERALL_FAILURE:io.ACQUIRE_TOKEN_OVERALL_FAILURE,errorType:(o==null?void 0:o.errorType)??"unknown",errorMessage:(o==null?void 0:o.errorMessage)??"unknown error",extraInfo:{...r,eventInfo_exitReason:t.exitReason}})}var Zf,na,Pu,hs;class al{constructor(e,n){ln(this,Zf);ln(this,na,null);ln(this,Pu);ln(this,hs,null);Bt(this,Zf,e),Bt(this,Pu,n)}async get(e){return(he(this,hs)===null||he(this,Pu)&&(!he(this,na)||he(this,na)<Date.now()-he(this,Pu)))&&(Bt(this,hs,he(this,Zf).call(this,e)),Bt(this,na,Date.now())),he(this,hs)}set(e){Bt(this,hs,e),Bt(this,na,Date.now())}reset(){Bt(this,hs,null),Bt(this,na,null)}get isInstantiated(){return he(this,hs)!==null}}Zf=new WeakMap,na=new WeakMap,Pu=new WeakMap,hs=new WeakMap;function hD(t){return new Promise(e=>{setTimeout(e,t)})}const wX={maxRetries:2,initialDelayMs:100,maxDelayMs:500,backoffFactor:2,jitterFactor:.1};function AX(t){return t instanceof Error?{errorType:t.name,errorMessage:t.message}:{errorType:"Unknown",errorMessage:String(t)}}function kX(t,e,n,r){const o=t.maxDurationMs!==void 0&&r>=t.maxDurationMs;return n>t.maxRetries?{shouldExit:!0,exitReason:"maxRetriesReached"}:o?{shouldExit:!0,exitReason:"maxDurationReached"}:t.shouldRetry&&!t.shouldRetry(e)?{shouldExit:!0,exitReason:"shouldRetryFalse"}:{shouldExit:!1,exitReason:null}}function xX(t,e){const n=e.jitterFactor?t*e.jitterFactor*(Math.random()*2-1):0,r=t+n;return Math.min(Math.max(r,0),e.maxDelayMs)}async function fD(t,e={}){var c,u,h,p;const n={...wX,...e},r=performance.now();let o=n.initialDelayMs,i=0;const s=[],a=[];for(let f=0;f<=n.maxRetries;f+=1)try{const g=await t(),v=performance.now();return(c=n.onSuccess)==null||c.call(n,{attemptCount:f+1,delayTimings:a,startTime:r,endTime:v,errors:s}),g}catch(g){i=f+1,s.push(AX(g));const v=performance.now();if(f===n.maxRetries)throw(u=n.onFailure)==null||u.call(n,{attemptCount:f+1,delayTimings:a,startTime:r,endTime:v,errors:s,exitReason:"maxRetriesReached"}),g;const y=v-r,{shouldExit:b,exitReason:C}=kX(n,g,i,y);if(b)throw(h=n.onFailure)==null||h.call(n,{attemptCount:f+1,delayTimings:a,startTime:r,endTime:v,errors:s,exitReason:C}),g;let S=xX(o,n);if(n.maxDurationMs!==void 0){const _=n.maxDurationMs-y;if(_<=0)throw(p=n.onFailure)==null||p.call(n,{attemptCount:f+1,delayTimings:a,startTime:r,endTime:v,errors:s,exitReason:"maxDurationReached"}),g;S=Math.min(S,_)}const E=performance.now();await hD(S);const T=performance.now()-E;a.push(T),o=Math.min(o*n.backoffFactor,n.maxDelayMs)}throw new Error("Unexpected end of retry loop")}const wo=new al(RX);async function RX(){oD({apiName:io.INITIALIZE_START,providerType:"auth0"});const t=await lX(Oz);iD({apiName:io.INITIALIZE_END,providerType:"auth0"});const e=new Map([["on",null],["off",null],["cache-only",null]]);async function n(i,s){const a=performance.now(),c=Ju(hX,"any");try{if(!c){const g=await t.getTokenSilently(i),v=performance.now();return ga({feature:"auth0SdkUsage",scenario:"getAuth0AccessToken",duration:v-a,customData:JSON.stringify({cacheMode:i.cacheMode??"on"})}),g}const h={...JL(),shouldRetry:g=>!(g instanceof tr&&g.error==="login_required"),onSuccess:g=>uD(g,"graph",s??"google"),onFailure:g=>dD(g,"graph",s??"google")},p=await fD(()=>t.getTokenSilently(i),h),f=performance.now();return ga({feature:"auth0SdkUsage",scenario:"getAuth0AccessToken",duration:f-a,customData:JSON.stringify({cacheMode:i.cacheMode??"on"})}),p}catch(u){u instanceof tr?(o({options:i,startTime:a,authWorkflowAccountType:s,errorType:u.error,errorMessage:u.error_description,exception:u.stack}),u.error==="login_required"&&fn(Zo,{reason:"token-expired",provider:"auth0"})):u instanceof Error?o({options:i,startTime:a,authWorkflowAccountType:s,errorType:u.name,errorMessage:u.message,exception:u.stack}):o({options:i,startTime:a,authWorkflowAccountType:s,errorType:"unknown",errorMessage:`${u}`});return}}async function r(i){const s=await t.getUser();if(!s)return;const a=s.sub&&s.sub.startsWith("google")?"google":"apple",c=i.cacheMode??"on",u=e.get(c);if(!u){const h=n(i,a);e.set(c,h);const p=await h;return e.set(c,null),p}return u}function o(i){const{startTime:s,options:a,authWorkflowAccountType:c,errorType:u,errorMessage:h,exception:p}=i;Xu({authWorkflowAccountType:c,apiName:io.ACQUIRE_TOKEN_FAILURE,errorType:u,errorMessage:h,errorExtraInfo:{eventInfo_providerType:"auth0",eventInfo_exception:p??"",cacheMode:a.cacheMode??"on",duration:performance.now()-s}})}return{auth0:t,getAuth0AccessToken:r}}function NT(t){const e=t.split(".")[1];if(e===void 0)return;const n=e.replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(n).split("").map(o=>`%${`00${o.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""));try{const o=JSON.parse(r);return UZ.parse(o)}catch{return}}async function NX(t,e){const{getAuth0AccessToken:n}=await wo.get(),{authorizationParams:r}=gf,o={...r,dob:t,ctry:e},i=await n({authorizationParams:o,cacheMode:"off"});if(!i)return;const s=NT(i);if(s)return s}async function PX(){const{getAuth0AccessToken:t}=await wo.get(),e=await t(gf);if(!e)return;const n=NT(e);if(n){if(n.sub.startsWith("google"))return"Google";if(n.sub.startsWith("apple"))return"Apple"}}function MX(t){switch(t){case"apple":return"Apple";case"google":return"Google";case"msa":return"MSA";default:return}}const Kh=new BroadcastChannel("cp.broadcast");class OX{constructor(){W(this,"hasTrackedRedirectError",!1);W(this,"CODE_RE",/[?&]code=[^&]+/);W(this,"STATE_RE",/[?&]state=[^&]+/);W(this,"ERROR_RE",/[?&]error=[^&]+/)}async handleRedirect(){try{const{auth0:e}=await wo.get();if(!this.hasAuthParams())return null;const n=performance.now();await e.handleRedirectCallback();const r=performance.now();ga({feature:"auth0SdkUsage",scenario:"handleRedirect",duration:r-n});const o=await e.getUser();if(!o)return null;const i=o.sub?this.getTokenType(o.sub):void 0;return v1({apiName:io.LOGIN_SUCCESS,authWorkflowAccountType:i}),cD({apiName:io.REAUTH_SUCCESS,authWorkflowAccountType:i}),Kh.postMessage({eventName:"auth0.accountAdded"}),{id:o.sub,tenantId:crypto.randomUUID(),provider:"auth0",accountType:this.getAccountType(o.sub)}}catch(e){this.trackRedirectErrorOncePerSession(e)}return null}async handleRedirectWithoutAccount(){try{const{auth0:e}=await wo.get();if(this.hasAuthParams()){const n=performance.now();await e.handleRedirectCallback();const r=performance.now();ga({feature:"auth0SdkUsage",scenario:"handleRedirect",duration:r-n});const o=await e.getUser();if(!o)return;const i=o.sub?this.getTokenType(o.sub):void 0;v1({apiName:io.LOGIN_SUCCESS,authWorkflowAccountType:i}),Kh.postMessage({eventName:"auth0.accountAdded"})}}catch(e){this.trackRedirectErrorOncePerSession(e)}}async getCurrentActiveUserAccount(){const{auth0:e}=await wo.get(),n=await e.getUser();if(!n)return null;const{sub:r}=n;return r?{id:r,tenantId:crypto.randomUUID(),provider:"auth0",accountType:this.getAccountType(r)}:null}async maybeInitializeAccountWithToken(){const{auth0:e,getAuth0AccessToken:n}=await wo.get(),r=await n(gf);if(!r)return null;const o=await e.getUser();if(!o)return null;const i=o.sub;return{userAccount:{id:i,tenantId:crypto.randomUUID(),provider:"auth0",accountType:this.getAccountType(i)},authToken:{accessToken:r,tokenType:this.getTokenType(i)}}}async logIn(e){const{connection:n}=e;if(!n)throw new Error("connection in LoginOpts are required");const{auth0:r}=await wo.get();return sD({apiName:io.LOGIN_START,authWorkflowAccountType:e.connection??void 0}),r.loginWithRedirect({authorizationParams:{...Lz.authorizationParams,connection:this.getConnectionFromTokenType(n)}})}async logOut(){const{auth0:e}=await wo.get(),n=await e.getUser(),r=n&&n.sub?this.getTokenType(n.sub):void 0;try{await e.logout({logoutParams:{returnTo:window.location.origin}}),Kh.postMessage({eventName:"auth0.accountRemoved"}),aD({apiName:io.LOGOUT_SUCCESS,providerType:"auth0"})}catch(o){Xu({authWorkflowAccountType:r,apiName:io.LOGOUT_FAILURE,errorMessage:`${o}`,errorExtraInfo:{eventInfo_providerType:"auth0"}}),console.error("Auth0 logout failed:",o)}}async getAuthToken(){try{const{auth0:e,getAuth0AccessToken:n}=await wo.get(),r=await n(gf);if(!r)return;const o=await e.getUser();if(o){const i=o.sub,s=this.getTokenType(i);return{accessToken:r,tokenType:s}}}catch{return}}async getUserInfo(){const{auth0:e}=await wo.get(),n=await e.getUser();if(n)return{mail:n.email??"",givenName:n.given_name??"",surname:n.surname??"",imgSrc:n.picture,isStudent:!1}}async getUserInfoFromToken(e){const n=NT(e);if(!n)return;const{email:r,name:o}=n;return{mail:r,givenName:o.split(" ")[0]??"",surname:"",imgSrc:"",isStudent:!1}}supportsTokenType(e){return e==="apple"||e==="google"}getTokenType(e){return e.startsWith("google")?"google":"apple"}getAccountType(e){return e.startsWith("google")?"Google":"Apple"}getConnectionFromTokenType(e){return e==="apple"?"apple":"google-oauth2"}hasAuthParams(e=window.location.search){return(this.CODE_RE.test(e)||this.ERROR_RE.test(e))&&this.STATE_RE.test(e)}trackRedirectErrorOncePerSession(e){this.hasTrackedRedirectError||(z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"auth0HandleRedirectPromise",eventInfo_details:"Error handling redirect promise",eventInfo_errorMessage:`${e}`}}),Xu({apiName:io.LOGIN_FAILURE,errorExtraInfo:{eventInfo_providerType:"auth0"},errorMessage:`${e}`})),this.hasTrackedRedirectError=!0}}function b1(){return Bo(t1,l.boolean().nullable())===!0}function LX(){return Bo(n1,l.boolean().nullable())===!0}var y1=function(t,e){return y1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},y1(t,e)};function eRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");y1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Sx=function(){return Sx=Object.assign||function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Sx.apply(this,arguments)};function tRe(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n}function tn(t,e,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function a(h){try{u(r.next(h))}catch(p){s(p)}}function c(h){try{u(r.throw(h))}catch(p){s(p)}}function u(h){h.done?i(h.value):o(h.value).then(a,c)}u((r=r.apply(t,e||[])).next())})}function nRe(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(h){return c([u,h])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(n=0)),n;)try{if(r=1,o&&(i=u[0]&2?o.return:u[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,u[1])).done)return i;switch(o=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,o=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(h){u=[6,h],o=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function rRe(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function oRe(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return i}function iRe(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,i;r<o;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var so;(function(t){t.GET="GET",t.PATCH="PATCH",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE"})(so||(so={}));const DX="v1.0",jX="https://graph.microsoft.com/",UX=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class kc extends Error{static setGraphClientError(e){let n;return e instanceof Error?n=e:(n=new kc,n.customError=e),n}constructor(e){super(e),Object.setPrototypeOf(this,kc.prototype)}}const FX=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],BX=t=>{const e=i=>i.replace(/\/+$/,""),n=i=>i.replace(/^\/+/,""),r=(i,s)=>[e(i),n(s)].join("/");return Array.prototype.slice.call(t).reduce(r)},OC=t=>{const e=t&&t.constructor&&t.constructor.name;if(e==="Buffer"||e==="Blob"||e==="File"||e==="FormData"||typeof t=="string")return t;if(e==="ArrayBuffer")t=Buffer.from(t);else if(e==="Int8Array"||e==="Int16Array"||e==="Int32Array"||e==="Uint8Array"||e==="Uint16Array"||e==="Uint32Array"||e==="Uint8ClampedArray"||e==="Float32Array"||e==="Float64Array"||e==="DataView")t=Buffer.from(t.buffer);else try{t=JSON.stringify(t)}catch{throw new Error("Unable to stringify the content")}return t},pD=t=>gD(t),mD=(t,e)=>(e.forEach(n=>HX(n)),gD(t,e)),gD=(t,e=UX)=>{if(t=t.toLowerCase(),t.indexOf("https://")!==-1){t=t.replace("https://","");const n=t.indexOf(":"),r=t.indexOf("/");let o="";if(r!==-1)return n!==-1&&n<r?(o=t.substring(0,n),e.has(o)):(o=t.substring(0,r),e.has(o))}return!1},HX=t=>{if(t.indexOf("/")!==-1)throw new kc("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class xc{constructor(e=[]){this.middlewareOptions=new Map;for(const n of e){const r=n.constructor;this.middlewareOptions.set(r,n)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,n){this.middlewareOptions.set(e,n)}}const zX=()=>{let t="";for(let e=0;e<32;e++)(e===8||e===12||e===16||e===20)&&(t+="-"),t+=Math.floor(Math.random()*16).toString(16);return t},vD=(t,e,n)=>{let r=null;if(typeof Request<"u"&&t instanceof Request)r=t.headers.get(n);else if(typeof e<"u"&&e.headers!==void 0)if(typeof Headers<"u"&&e.headers instanceof Headers)r=e.headers.get(n);else if(e.headers instanceof Array){const o=e.headers;for(let i=0,s=o.length;i<s;i++)if(o[i][0]===n){r=o[i][1];break}}else e.headers[n]!==void 0&&(r=e.headers[n]);return r},bD=(t,e,n,r)=>{if(typeof Request<"u"&&t instanceof Request)t.headers.set(n,r);else if(typeof e<"u")if(e.headers===void 0)e.headers=new Headers({[n]:r});else if(typeof Headers<"u"&&e.headers instanceof Headers)e.headers.set(n,r);else if(e.headers instanceof Array){let o=0;const i=e.headers.length;for(;o<i;o++){const s=e.headers[o];if(s[0]===n){s[1]=r;break}}o===i&&e.headers.push([n,r])}else Object.assign(e.headers,{[n]:r})},yD=(t,e,n,r)=>{typeof Request<"u"&&t instanceof Request?t.headers.append(n,r):typeof e<"u"&&(e.headers===void 0?e.headers=new Headers({[n]:r}):typeof Headers<"u"&&e.headers instanceof Headers?e.headers.append(n,r):e.headers instanceof Array?e.headers.push([n,r]):e.headers===void 0?e.headers={[n]:r}:e.headers[n]===void 0?e.headers[n]=r:e.headers[n]+=`, ${r}`)},VX=(t,e)=>tn(void 0,void 0,void 0,function*(){const n=e.headers.get("Content-Type")?yield e.blob():yield Promise.resolve(void 0),{method:r,headers:o,referrer:i,referrerPolicy:s,mode:a,credentials:c,cache:u,redirect:h,integrity:p,keepalive:f,signal:g}=e;return new Request(t,{method:r,headers:o,body:n,referrer:i,referrerPolicy:s,mode:a,credentials:c,cache:u,redirect:h,integrity:p,keepalive:f,signal:g})});class $X{constructor(e,n){this.authenticationProvider=e,this.authenticationProviderOptions=n}}var ed;(function(t){t[t.NONE=0]="NONE",t[t.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",t[t.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",t[t.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"})(ed||(ed={}));class la{constructor(){this.featureUsage=ed.NONE}static updateFeatureUsageFlag(e,n){let r;e.middlewareControl instanceof xc?r=e.middlewareControl.getMiddlewareOptions(la):e.middlewareControl=new xc,typeof r>"u"&&(r=new la,e.middlewareControl.setMiddlewareOptions(la,r)),r.setFeatureUsage(n)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class xf{constructor(e){this.authenticationProvider=e}execute(e){return tn(this,void 0,void 0,function*(){const n=typeof e.request=="string"?e.request:e.request.url;if(pD(n)||e.customHosts&&mD(n,e.customHosts)){let r;e.middlewareControl instanceof xc&&(r=e.middlewareControl.getMiddlewareOptions($X));let o,i;r&&(o=r.authenticationProvider,i=r.authenticationProviderOptions),o||(o=this.authenticationProvider);const a=`Bearer ${yield o.getAccessToken(i)}`;yD(e.request,e.options,xf.AUTHORIZATION_HEADER,a),la.updateFeatureUsageFlag(e,ed.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[xf.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}xf.AUTHORIZATION_HEADER="Authorization";class GX{execute(e){return tn(this,void 0,void 0,function*(){e.response=yield fetch(e.request,e.options)})}}class In{constructor(e=In.DEFAULT_DELAY,n=In.DEFAULT_MAX_RETRIES,r=In.defaultShouldRetry){if(e>In.MAX_DELAY&&n>In.MAX_MAX_RETRIES){const o=new Error(`Delay and MaxRetries should not be more than ${In.MAX_DELAY} and ${In.MAX_MAX_RETRIES}`);throw o.name="MaxLimitExceeded",o}else if(e>In.MAX_DELAY){const o=new Error(`Delay should not be more than ${In.MAX_DELAY}`);throw o.name="MaxLimitExceeded",o}else if(n>In.MAX_MAX_RETRIES){const o=new Error(`MaxRetries should not be more than ${In.MAX_MAX_RETRIES}`);throw o.name="MaxLimitExceeded",o}else if(e<0&&n<0){const o=new Error("Delay and MaxRetries should not be negative");throw o.name="MinExpectationNotMet",o}else if(e<0){const o=new Error("Delay should not be negative");throw o.name="MinExpectationNotMet",o}else if(n<0){const o=new Error("MaxRetries should not be negative");throw o.name="MinExpectationNotMet",o}this.delay=Math.min(e,In.MAX_DELAY),this.maxRetries=Math.min(n,In.MAX_MAX_RETRIES),this.shouldRetry=r}getMaxDelay(){return In.MAX_DELAY}}In.DEFAULT_DELAY=3;In.DEFAULT_MAX_RETRIES=3;In.MAX_DELAY=180;In.MAX_MAX_RETRIES=10;In.defaultShouldRetry=()=>!0;class ua{constructor(e=new In){this.options=e}isRetry(e){return ua.RETRY_STATUS_CODES.indexOf(e.status)!==-1}isBuffered(e,n){const r=typeof e=="string"?n.method:e.method;return!((r===so.PUT||r===so.PATCH||r===so.POST)&&vD(e,n,"Content-Type")==="application/octet-stream")}getDelay(e,n,r){const o=()=>Number(Math.random().toFixed(3)),i=e.headers!==void 0?e.headers.get(ua.RETRY_AFTER_HEADER):null;let s;return i!==null?Number.isNaN(Number(i))?s=Math.round((new Date(i).getTime()-Date.now())/1e3):s=Number(i):s=n>=2?this.getExponentialBackOffTime(n)+r+o():r+o(),Math.min(s,this.options.getMaxDelay()+o())}getExponentialBackOffTime(e){return Math.round(1/2*(Math.pow(2,e)-1))}sleep(e){return tn(this,void 0,void 0,function*(){const n=e*1e3;return new Promise(r=>setTimeout(r,n))})}getOptions(e){let n;return e.middlewareControl instanceof xc&&(n=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),typeof n>"u"&&(n=Object.assign(new In,this.options)),n}executeWithRetry(e,n,r){return tn(this,void 0,void 0,function*(){if(yield this.nextMiddleware.execute(e),n<r.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&r.shouldRetry(r.delay,n,e.request,e.options,e.response)){++n,bD(e.request,e.options,ua.RETRY_ATTEMPT_HEADER,n.toString());const o=this.getDelay(e.response,n,r.delay);return yield this.sleep(o),yield this.executeWithRetry(e,n,r)}else return})}execute(e){return tn(this,void 0,void 0,function*(){const r=this.getOptions(e);return la.updateFeatureUsageFlag(e,ed.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,r)})}setNext(e){this.nextMiddleware=e}}ua.RETRY_STATUS_CODES=[429,503,504];ua.RETRY_ATTEMPT_HEADER="Retry-Attempt";ua.RETRY_AFTER_HEADER="Retry-After";class Ro{constructor(e=Ro.DEFAULT_MAX_REDIRECTS,n=Ro.defaultShouldRedirect){if(e>Ro.MAX_MAX_REDIRECTS){const r=new Error(`MaxRedirects should not be more than ${Ro.MAX_MAX_REDIRECTS}`);throw r.name="MaxLimitExceeded",r}if(e<0){const r=new Error("MaxRedirects should not be negative");throw r.name="MinExpectationNotMet",r}this.maxRedirects=e,this.shouldRedirect=n}}Ro.DEFAULT_MAX_REDIRECTS=5;Ro.MAX_MAX_REDIRECTS=20;Ro.defaultShouldRedirect=()=>!0;let xd=class Wa{constructor(e=new Ro){this.options=e}isRedirect(e){return Wa.REDIRECT_STATUS_CODES.indexOf(e.status)!==-1}hasLocationHeader(e){return e.headers.has(Wa.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(Wa.LOCATION_HEADER)}isRelativeURL(e){return e.indexOf("://")===-1}shouldDropAuthorizationHeader(e,n){const r=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,o=r.exec(e);let i,s;o!==null&&(i=o[0]);const a=r.exec(n);return a!==null&&(s=a[0]),typeof i<"u"&&typeof s<"u"&&i!==s}updateRequestUrl(e,n){return tn(this,void 0,void 0,function*(){n.request=typeof n.request=="string"?e:yield VX(e,n.request)})}getOptions(e){let n;return e.middlewareControl instanceof xc&&(n=e.middlewareControl.getMiddlewareOptions(Ro)),typeof n>"u"&&(n=Object.assign(new Ro,this.options)),n}executeWithRedirect(e,n,r){return tn(this,void 0,void 0,function*(){yield this.nextMiddleware.execute(e);const o=e.response;if(n<r.maxRedirects&&this.isRedirect(o)&&this.hasLocationHeader(o)&&r.shouldRedirect(o)){if(++n,o.status===Wa.STATUS_CODE_SEE_OTHER)e.options.method=so.GET,delete e.options.body;else{const i=this.getLocationHeader(o);!this.isRelativeURL(i)&&this.shouldDropAuthorizationHeader(o.url,i)&&delete e.options.headers[Wa.AUTHORIZATION_HEADER],yield this.updateRequestUrl(i,e)}yield this.executeWithRedirect(e,n,r)}else return})}execute(e){return tn(this,void 0,void 0,function*(){const r=this.getOptions(e);return e.options.redirect=Wa.MANUAL_REDIRECT,la.updateFeatureUsageFlag(e,ed.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,r)})}setNext(e){this.nextMiddleware=e}};xd.REDIRECT_STATUS_CODES=[301,302,303,307,308];xd.STATUS_CODE_SEE_OTHER=303;xd.LOCATION_HEADER="Location";xd.AUTHORIZATION_HEADER="Authorization";xd.MANUAL_REDIRECT="manual";const KX="3.0.7";class ao{execute(e){return tn(this,void 0,void 0,function*(){const n=typeof e.request=="string"?e.request:e.request.url;if(pD(n)||e.customHosts&&mD(n,e.customHosts)){let r=vD(e.request,e.options,ao.CLIENT_REQUEST_ID_HEADER);r||(r=zX(),bD(e.request,e.options,ao.CLIENT_REQUEST_ID_HEADER,r));let o=`${ao.PRODUCT_NAME}/${KX}`,i;if(e.middlewareControl instanceof xc&&(i=e.middlewareControl.getMiddlewareOptions(la)),i){const s=i.getFeatureUsage();o+=` (${ao.FEATURE_USAGE_STRING}=${s})`}yD(e.request,e.options,ao.SDK_VERSION_HEADER,o)}else delete e.options.headers[ao.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[ao.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}ao.CLIENT_REQUEST_ID_HEADER="client-request-id";ao.SDK_VERSION_HEADER="SdkVersion";ao.PRODUCT_NAME="graph-js";ao.FEATURE_USAGE_STRING="featureUsage";function qX(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ex;(function(t){t[t.MANUAL=0]="MANUAL",t[t.RANDOM=1]="RANDOM"})(Ex||(Ex={}));var wi;(function(t){t.ARRAYBUFFER="arraybuffer",t.BLOB="blob",t.DOCUMENT="document",t.JSON="json",t.RAW="raw",t.STREAM="stream",t.TEXT="text"})(wi||(wi={}));var C1;(function(t){t.TEXT_HTML="text/html",t.TEXT_XML="text/xml",t.APPLICATION_XML="application/xml",t.APPLICATION_XHTML="application/xhtml+xml"})(C1||(C1={}));var Ug;(function(t){t.TEXT_PLAIN="text/plain",t.APPLICATION_JSON="application/json"})(Ug||(Ug={}));var Fg;(function(t){t.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",t.IMAGE="^image\\/.+"})(Fg||(Fg={}));class qh{static parseDocumentResponse(e,n){return typeof DOMParser<"u"?new Promise((r,o)=>{e.text().then(i=>{try{const a=new DOMParser().parseFromString(i,n);r(a)}catch(s){o(s)}})}):Promise.resolve(e.body)}static convertResponse(e,n){return tn(this,void 0,void 0,function*(){if(e.status===204)return Promise.resolve();let r;const o=e.headers.get("Content-type");switch(n){case wi.ARRAYBUFFER:r=yield e.arrayBuffer();break;case wi.BLOB:r=yield e.blob();break;case wi.DOCUMENT:r=yield qh.parseDocumentResponse(e,C1.TEXT_XML);break;case wi.JSON:r=yield e.json();break;case wi.STREAM:r=yield Promise.resolve(e.body);break;case wi.TEXT:r=yield e.text();break;default:if(o!==null){const i=o.split(";")[0];new RegExp(Fg.DOCUMENT).test(i)?r=yield qh.parseDocumentResponse(e,i):new RegExp(Fg.IMAGE).test(i)?r=e.blob():i===Ug.TEXT_PLAIN?r=yield e.text():i===Ug.APPLICATION_JSON?r=yield e.json():r=Promise.resolve(e.body)}else r=Promise.resolve(e.body);break}return r})}static getResponse(e,n,r){return tn(this,void 0,void 0,function*(){if(n===wi.RAW)return Promise.resolve(e);{const o=yield qh.convertResponse(e,n);if(e.ok)if(typeof r=="function")r(null,o);else return o;else throw o}})}}class WX{constructor(e){this.provider=e}getAccessToken(){return tn(this,void 0,void 0,function*(){return new Promise((e,n)=>{this.provider((r,o)=>tn(this,void 0,void 0,function*(){if(o)e(o);else{if(!r){const s="Access token is undefined or empty.						Please provide a valid token.						For more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md";r=new kc(s)}const i=yield kc.setGraphClientError(r);n(i)}}))})})}}class Wh extends Error{constructor(e=-1,n,r){super(n||r&&r.message),Object.setPrototypeOf(this,Wh.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=r?r.stack:this.stack}}class Bg{static constructError(e,n,r){const o=new Wh(n,"",e);return e.name!==void 0&&(o.code=e.name),o.body=e.toString(),o.date=new Date,o.headers=r==null?void 0:r.headers,o}static constructErrorFromResponse(e,n,r){const o=e.error,i=new Wh(n,o.message);return i.code=o.code,o.innerError!==void 0&&(i.requestId=o.innerError["request-id"],i.date=new Date(o.innerError.date)),i.body=JSON.stringify(o),i.headers=r==null?void 0:r.headers,i}static getError(e=null,n=-1,r,o){return tn(this,void 0,void 0,function*(){let i;if(e&&e.error?i=Bg.constructErrorFromResponse(e,n,o):e instanceof Error?i=Bg.constructError(e,n,o):(i=new Wh(n),i.body=e),typeof r=="function")r(i,null);else return i})}}class YX{constructor(e,n,r){this.parsePath=o=>{if(o.indexOf("https://")!==-1){o=o.replace("https://","");const s=o.indexOf("/");s!==-1&&(this.urlComponents.host="https://"+o.substring(0,s),o=o.substring(s+1,o.length));const a=o.indexOf("/");a!==-1&&(this.urlComponents.version=o.substring(0,a),o=o.substring(a+1,o.length))}o.charAt(0)==="/"&&(o=o.substr(1));const i=o.indexOf("?");if(i===-1)this.urlComponents.path=o;else{this.urlComponents.path=o.substr(0,i);const s=o.substring(i+1,o.length).split("&");for(const a of s)this.parseQueryParameter(a)}},this.httpClient=e,this.config=n,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(r)}addCsvQueryParameter(e,n,r){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let o=[];r.length>1&&typeof n=="string"?o=Array.prototype.slice.call(r):typeof n=="string"?o.push(n):o=o.concat(n),this.urlComponents.oDataQueryParams[e]+=o.join(",")}buildFullUrl(){const e=BX([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,n=[];if(Object.keys(e.oDataQueryParams).length!==0)for(const r in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,r)&&n.push(r+"="+e.oDataQueryParams[r]);if(Object.keys(e.otherURLQueryParams).length!==0)for(const r in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,r)&&n.push(r+"="+e.otherURLQueryParams[r]);if(e.otherURLQueryOptions.length!==0)for(const r of e.otherURLQueryOptions)n.push(r);return n.length>0?"?"+n.join("&"):""}parseQueryParameter(e){if(typeof e=="string")if(e.charAt(0)==="?"&&(e=e.substring(1)),e.indexOf("&")!==-1){const n=e.split("&");for(const r of n)this.parseQueryParamenterString(r)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&this.setURLComponentsQueryParamater(n,e[n]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const n=e.indexOf("="),r=e.substring(0,n),o=e.substring(n+1);this.setURLComponentsQueryParamater(r,o)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,n){if(FX.indexOf(e)!==-1){const r=this.urlComponents.oDataQueryParams[e],o=r&&(e==="$expand"||e==="$select"||e==="$orderby");this.urlComponents.oDataQueryParams[e]=o?r+","+n:n}else this.urlComponents.otherURLQueryParams[e]=n}isValidQueryKeyValuePair(e){const n=e.indexOf("=");return!(n===-1||e.indexOf("(")!==-1&&e.indexOf("(")<n)}updateRequestOptions(e){const n=Object.assign({},e.headers);if(this.config.fetchOptions!==void 0){const r=Object.assign({},this.config.fetchOptions);Object.assign(e,r),typeof this.config.fetchOptions.headers!==void 0&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),e.headers!==void 0&&Object.assign(n,e.headers),Object.assign(n,this._headers),e.headers=n}send(e,n,r){var o;return tn(this,void 0,void 0,function*(){let i;const s=new xc(this._middlewareOptions);this.updateRequestOptions(n);const a=(o=this.config)===null||o===void 0?void 0:o.customHosts;try{return i=(yield this.httpClient.sendRequest({request:e,options:n,middlewareControl:s,customHosts:a})).response,yield qh.getResponse(i,this._responseType,r)}catch(c){if(c instanceof kc)throw c;let u;throw i&&(u=i.status),yield Bg.getError(c,u,r,i)}})}setHeaderContentType(){if(!this._headers){this.header("Content-Type","application/json");return}const e=Object.keys(this._headers);for(const n of e)if(n.toLowerCase()==="content-type")return;this.header("Content-Type","application/json")}header(e,n){return this._headers[e]=n,this}headers(e){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(this._headers[n]=e[n]);return this}option(e,n){return this._options[e]=n,this}options(e){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(this._options[n]=e[n]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return tn(this,void 0,void 0,function*(){const n=this.buildFullUrl(),r={method:so.GET};return yield this.send(n,r,e)})}post(e,n){return tn(this,void 0,void 0,function*(){const r=this.buildFullUrl(),o={method:so.POST,body:OC(e)};return(e&&e.constructor&&e.constructor.name)==="FormData"?o.headers={}:(this.setHeaderContentType(),o.headers=this._headers),yield this.send(r,o,n)})}create(e,n){return tn(this,void 0,void 0,function*(){return yield this.post(e,n)})}put(e,n){return tn(this,void 0,void 0,function*(){const r=this.buildFullUrl();this.setHeaderContentType();const o={method:so.PUT,body:OC(e)};return yield this.send(r,o,n)})}patch(e,n){return tn(this,void 0,void 0,function*(){const r=this.buildFullUrl();this.setHeaderContentType();const o={method:so.PATCH,body:OC(e)};return yield this.send(r,o,n)})}update(e,n){return tn(this,void 0,void 0,function*(){return yield this.patch(e,n)})}delete(e){return tn(this,void 0,void 0,function*(){const n=this.buildFullUrl(),r={method:so.DELETE};return yield this.send(n,r,e)})}del(e){return tn(this,void 0,void 0,function*(){return yield this.delete(e)})}getStream(e){return tn(this,void 0,void 0,function*(){const n=this.buildFullUrl(),r={method:so.GET};return this.responseType(wi.STREAM),yield this.send(n,r,e)})}putStream(e,n){return tn(this,void 0,void 0,function*(){const r=this.buildFullUrl(),o={method:so.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(r,o,n)})}}class CD{constructor(...e){if(!e||!e.length){const n=new Error;throw n.name="InvalidMiddlewareChain",n.message="Please provide a default middleware chain or custom middleware chain",n}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach((n,r)=>{r<e.length-1&&n.setNext(e[r+1])}),this.middleware=e[0]}sendRequest(e){return tn(this,void 0,void 0,function*(){if(typeof e.request=="string"&&e.options===void 0){const n=new Error;throw n.name="InvalidRequestOptions",n.message="Unable to execute the middleware, Please provide valid options for a request",n}return yield this.middleware.execute(e),e})}}const QX=()=>typeof process=="object"&&typeof qX=="function";class PT{static createWithAuthenticationProvider(e){const n=new xf(e),r=new ua(new In),o=new ao,i=new GX;if(n.setNext(r),QX()){const s=new xd(new Ro);r.setNext(s),s.setNext(o)}else r.setNext(o);return o.setNext(i),PT.createWithMiddleware(n)}static createWithMiddleware(...e){return new CD(...e)}}const JX=()=>{if(typeof Promise>"u"&&typeof fetch>"u"){const t=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw t.name="PolyFillNotAvailable",t}else if(typeof Promise>"u"){const t=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}else if(typeof fetch>"u"){const t=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}return!0};class Hg{static init(e){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=r==="authProvider"?new WX(e[r]):e[r]);return Hg.initWithMiddleware(n)}static initWithMiddleware(e){return new Hg(e)}constructor(e){this.config={baseUrl:jX,debugLogging:!1,defaultVersion:DX},JX();for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(this.config[r]=e[r]);let n;if(e.authProvider!==void 0&&e.middleware!==void 0){const r=new Error;throw r.name="AmbiguityInInitialization",r.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",r}else if(e.authProvider!==void 0)n=PT.createWithAuthenticationProvider(e.authProvider);else if(e.middleware!==void 0)n=new CD(...[].concat(e.middleware));else{const r=new Error;throw r.name="InvalidMiddlewareChain",r.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",r}this.httpClient=n}api(e){return new YX(this.httpClient,this.config,e)}}const ZX=["CAREERCOACH_STUDENTS","EXCHANGESTANDARD_STUDENT","M365EDU_A3_STUDENT","M365EDU_A3_STUUSEBNFT","M365EDU_A3_STUUSEBNFT_RPA1","M365EDU_A5_STUDENT","M365EDU_A5_STUUSEBNFT","M365EDU_A5_NOPSTNCONF_STUUSEBNFT","OFFICESUBSCRIPTION_STUDENT","ATP_ENTERPRISE_STUDENT","ATP_ENTERPRISE_STUDENTS_USE_BENEFIT","POWER_BI_STANDARD_STUDENT","MCOEV_STUDENT","MEE_STUDENT","STANDARDWOFFPACK_STUDENT","STANDARDWOFFPACK_IW_STUDENT","ENTERPRISEPACKPLUS_STUDENT","ENTERPRISEPREMIUM_STUDENT","WIN10_ENT_A3_STU","MCO_TEAMS_EDU_HS_STUDENT","PROJECT_PROFESSIONAL_STUDENT","PROJECT_P1_STUDENT"];function XX(t){return Hg.init({authProvider:e=>{e(null,t)}})}async function LC(t,e){const n=performance.now(),r=await e;return z.trackEvent({name:"system",data:{eventName:"externalApiResponse",eventInfo_id:t,eventInfo_duration:performance.now()-n,eventInfo_service:"microsoft-graph"}}),r}async function eee(t){return t.api(TI.graphMeApiSuffix).get()}async function tee(t){try{const e=await t.api(TI.graphMeImageApiSuffix).get();return URL.createObjectURL(e)}catch{return}}async function nee(t){const e=Ge(il);if(We("aad-student")&&e)try{const n=await t.api(TI.graphMeLicenseDetails).get();return n&&n.value.some(o=>o.skuPartNumber&&ZX.includes(o.skuPartNumber))}catch(n){return console.error("Error checking student status:",n),!1}else return!1}async function Ix(t){const e=XX(t),[n,r,o]=await Promise.all([LC("user",eee(e)),LC("user_photo",tee(e)),LC("is_student",nee(e))]);return{...n,imgSrc:r,isStudent:o}}/*! @azure/msal-common v14.15.0 2024-09-20 */const oe={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},em={CLIENT_ERROR_RANGE_START:400,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR_RANGE_START:500,SERVER_ERROR_RANGE_END:599},va=[oe.OPENID_SCOPE,oe.PROFILE_SCOPE,oe.OFFLINE_ACCESS_SCOPE],Tx=[...va,oe.EMAIL_SCOPE],Fi={CONTENT_TYPE:"Content-Type",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},Jn={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},da={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},tm={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},nr={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},_x={PLAIN:"plain",S256:"S256"},hp={QUERY:"query",FRAGMENT:"fragment"},ree={...hp},SD={AUTHORIZATION_CODE_GRANT:"authorization_code",REFRESH_TOKEN_GRANT:"refresh_token"},nm={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",GENERIC_ACCOUNT_TYPE:"Generic"},fr={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},ft={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},MT="appmetadata",oee="client_info",Yh="1",zg={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},no={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},sr={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},$t={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Qh={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},wx={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Ax={username:"username",password:"password"},rm={httpSuccess:200,httpBadRequest:400},Pl={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},DC={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},Ys={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},iee={Pop:"pop"},see=300;/*! @azure/msal-common v14.15.0 2024-09-20 */const Nb="unexpected_error",aee="post_request_failed";/*! @azure/msal-common v14.15.0 2024-09-20 */const kx={[Nb]:"Unexpected error in authentication.",[aee]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class _t extends Error{constructor(e,n,r){const o=n?`${e}: ${n}`:e;super(o),Object.setPrototypeOf(this,_t.prototype),this.errorCode=e||oe.EMPTY_STRING,this.errorMessage=n||oe.EMPTY_STRING,this.subError=r||oe.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function ED(t,e){return new _t(t,e?`${kx[t]} ${e}`:kx[t])}/*! @azure/msal-common v14.15.0 2024-09-20 */const Pb="client_info_decoding_error",OT="client_info_empty_error",Mb="token_parsing_error",LT="null_or_empty_token",Ai="endpoints_resolution_error",DT="network_error",jT="openid_config_error",UT="hash_not_deserialized",Rc="invalid_state",FT="state_mismatch",Rf="state_not_found",BT="nonce_mismatch",Ob="auth_time_not_found",HT="max_age_transpired",ID="multiple_matching_tokens",TD="multiple_matching_accounts",zT="multiple_matching_appMetadata",VT="request_cannot_be_made",$T="cannot_remove_empty_scope",GT="cannot_append_scopeset",Vg="empty_input_scopeset",_D="device_code_polling_cancelled",wD="device_code_expired",AD="device_code_unknown_error",Lb="no_account_in_silent_request",KT="invalid_cache_record",Db="invalid_cache_environment",$g="no_account_found",Gg="no_crypto_object",Kg="unexpected_credential_type",kD="invalid_assertion",xD="invalid_client_credential",ni="token_refresh_required",RD="user_timeout_reached",qT="token_claims_cnf_required_for_signedjwt",WT="authorization_code_missing_from_server_response",YT="binding_key_not_removed",QT="end_session_endpoint_not_supported",jb="key_id_missing",ND="no_network_connectivity",PD="user_canceled",MD="missing_tenant_id_error",Ct="method_not_implemented",OD="nested_app_auth_bridge_disabled";/*! @azure/msal-common v14.15.0 2024-09-20 */const mt={[Pb]:"The client info could not be parsed/decoded correctly",[OT]:"The client info was empty",[Mb]:"Token cannot be parsed",[LT]:"The token is null or empty",[Ai]:"Endpoints cannot be resolved",[DT]:"Network request failed",[jT]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[UT]:"The hash parameters could not be deserialized",[Rc]:"State was not the expected format",[FT]:"State mismatch error",[Rf]:"State not found",[BT]:"Nonce mismatch error",[Ob]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[HT]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[ID]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[TD]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[zT]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[VT]:"Token request cannot be made without authorization code or refresh token.",[$T]:"Cannot remove null or empty scope from ScopeSet",[GT]:"Cannot append ScopeSet",[Vg]:"Empty input ScopeSet cannot be processed",[_D]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[wD]:"Device code is expired.",[AD]:"Device code stopped polling for unknown reasons.",[Lb]:"Please pass an account object, silent flow is not supported without account information",[KT]:"Cache record object was null or undefined.",[Db]:"Invalid environment when attempting to create cache entry",[$g]:"No account found in cache for given key.",[Gg]:"No crypto object detected.",[Kg]:"Unexpected credential type.",[kD]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[xD]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[ni]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[RD]:"User defined timeout for device code polling reached",[qT]:"Cannot generate a POP jwt if the token_claims are not populated",[WT]:"Server response does not contain an authorization code to proceed",[YT]:"Could not remove the credential's binding key from storage.",[QT]:"The provided authority does not support logout",[jb]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[ND]:"No network connectivity. Check your internet connection.",[PD]:"User cancelled the flow.",[MD]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Ct]:"This method has not been implemented",[OD]:"The nested app auth bridge is disabled"};mt[Pb],mt[OT],mt[Mb],mt[LT],mt[Ai],mt[DT],mt[jT],mt[UT],mt[Rc],mt[FT],mt[Rf],mt[BT],mt[Ob],mt[HT],mt[ID],mt[TD],mt[zT],mt[VT],mt[$T],mt[GT],mt[Vg],mt[_D],mt[wD],mt[AD],mt[Lb],mt[KT],mt[Db],mt[$g],mt[Gg],mt[Kg],mt[kD],mt[xD],mt[ni],mt[RD],mt[qT],mt[WT],mt[YT],mt[QT],mt[jb],mt[ND],mt[PD],mt[MD],mt[OD];class Rd extends _t{constructor(e,n){super(e,n?`${mt[e]}: ${n}`:mt[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,Rd.prototype)}}function ke(t,e){return new Rd(t,e)}/*! @azure/msal-common v14.15.0 2024-09-20 */const qg={createNewGuid:()=>{throw ke(Ct)},base64Decode:()=>{throw ke(Ct)},base64Encode:()=>{throw ke(Ct)},base64UrlEncode:()=>{throw ke(Ct)},encodeKid:()=>{throw ke(Ct)},async getPublicKeyThumbprint(){throw ke(Ct)},async removeTokenBindingKey(){throw ke(Ct)},async clearKeystore(){throw ke(Ct)},async signJwt(){throw ke(Ct)},async hashString(){throw ke(Ct)}};/*! @azure/msal-common v14.15.0 2024-09-20 */var bn;(function(t){t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose",t[t.Trace=4]="Trace"})(bn||(bn={}));class di{constructor(e,n,r){this.level=bn.Info;const o=()=>{},i=e||di.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||o,this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level=typeof i.logLevel=="number"?i.logLevel:bn.Info,this.correlationId=i.correlationId||oe.EMPTY_STRING,this.packageName=n||oe.EMPTY_STRING,this.packageVersion=r||oe.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:bn.Info}}clone(e,n,r){return new di({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,n)}logMessage(e,n){if(n.logLevel>this.level||!this.piiLoggingEnabled&&n.containsPii)return;const i=`${`[${new Date().toUTCString()}] : [${n.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${bn[n.logLevel]} - ${e}`;this.executeCallback(n.logLevel,i,n.containsPii||!1)}executeCallback(e,n,r){this.localCallback&&this.localCallback(e,n,r)}error(e,n){this.logMessage(e,{logLevel:bn.Error,containsPii:!1,correlationId:n||oe.EMPTY_STRING})}errorPii(e,n){this.logMessage(e,{logLevel:bn.Error,containsPii:!0,correlationId:n||oe.EMPTY_STRING})}warning(e,n){this.logMessage(e,{logLevel:bn.Warning,containsPii:!1,correlationId:n||oe.EMPTY_STRING})}warningPii(e,n){this.logMessage(e,{logLevel:bn.Warning,containsPii:!0,correlationId:n||oe.EMPTY_STRING})}info(e,n){this.logMessage(e,{logLevel:bn.Info,containsPii:!1,correlationId:n||oe.EMPTY_STRING})}infoPii(e,n){this.logMessage(e,{logLevel:bn.Info,containsPii:!0,correlationId:n||oe.EMPTY_STRING})}verbose(e,n){this.logMessage(e,{logLevel:bn.Verbose,containsPii:!1,correlationId:n||oe.EMPTY_STRING})}verbosePii(e,n){this.logMessage(e,{logLevel:bn.Verbose,containsPii:!0,correlationId:n||oe.EMPTY_STRING})}trace(e,n){this.logMessage(e,{logLevel:bn.Trace,containsPii:!1,correlationId:n||oe.EMPTY_STRING})}tracePii(e,n){this.logMessage(e,{logLevel:bn.Trace,containsPii:!0,correlationId:n||oe.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}/*! @azure/msal-common v14.15.0 2024-09-20 */const LD="@azure/msal-common",JT="14.15.0";/*! @azure/msal-common v14.15.0 2024-09-20 */const Nf={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net"};/*! @azure/msal-common v14.15.0 2024-09-20 */function cl(t,e){const n=cee(t);try{const r=e(n);return JSON.parse(r)}catch{throw ke(Mb)}}function cee(t){if(!t)throw ke(LT);const n=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!n||n.length<4)throw ke(Mb);return n[2]}function DD(t,e){if(e===0||Date.now()-3e5>t+e)throw ke(HT)}/*! @azure/msal-common v14.15.0 2024-09-20 */function Ki(){return Math.round(new Date().getTime()/1e3)}function S1(t,e){const n=Number(t)||0;return Ki()+e>n}function lee(t){return Number(t)>Ki()}/*! @azure/msal-common v14.15.0 2024-09-20 */function cu(t){return[uee(t),dee(t),hee(t),fee(t),pee(t)].join(fr.CACHE_KEY_SEPARATOR).toLowerCase()}function Ub(t,e,n,r,o){return{credentialType:ft.ID_TOKEN,homeAccountId:t,environment:e,clientId:r,secret:n,realm:o}}function Fb(t,e,n,r,o,i,s,a,c,u,h,p,f,g,v){var b,C;const y={homeAccountId:t,credentialType:ft.ACCESS_TOKEN,secret:n,cachedAt:Ki().toString(),expiresOn:s.toString(),extendedExpiresOn:a.toString(),environment:e,clientId:r,realm:o,target:i,tokenType:h||$t.BEARER};if(p&&(y.userAssertionHash=p),u&&(y.refreshOn=u.toString()),g&&(y.requestedClaims=g,y.requestedClaimsHash=v),((b=y.tokenType)==null?void 0:b.toLowerCase())!==$t.BEARER.toLowerCase())switch(y.credentialType=ft.ACCESS_TOKEN_WITH_AUTH_SCHEME,y.tokenType){case $t.POP:const S=cl(n,c);if(!((C=S==null?void 0:S.cnf)!=null&&C.kid))throw ke(qT);y.keyId=S.cnf.kid;break;case $t.SSH:y.keyId=f}return y}function jD(t,e,n,r,o,i,s){const a={credentialType:ft.REFRESH_TOKEN,homeAccountId:t,environment:e,clientId:r,secret:n};return i&&(a.userAssertionHash=i),o&&(a.familyId=o),s&&(a.expiresOn=s.toString()),a}function ZT(t){return t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")}function xx(t){return t?ZT(t)&&t.hasOwnProperty("realm")&&t.hasOwnProperty("target")&&(t.credentialType===ft.ACCESS_TOKEN||t.credentialType===ft.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function Rx(t){return t?ZT(t)&&t.hasOwnProperty("realm")&&t.credentialType===ft.ID_TOKEN:!1}function Nx(t){return t?ZT(t)&&t.credentialType===ft.REFRESH_TOKEN:!1}function uee(t){return[t.homeAccountId,t.environment].join(fr.CACHE_KEY_SEPARATOR).toLowerCase()}function dee(t){const e=t.credentialType===ft.REFRESH_TOKEN&&t.familyId||t.clientId;return[t.credentialType,e,t.realm||""].join(fr.CACHE_KEY_SEPARATOR).toLowerCase()}function hee(t){return(t.target||"").toLowerCase()}function fee(t){return(t.requestedClaimsHash||"").toLowerCase()}function pee(t){return t.tokenType&&t.tokenType.toLowerCase()!==$t.BEARER.toLowerCase()?t.tokenType.toLowerCase():""}function mee(t,e){const n=t.indexOf(sr.CACHE_KEY)===0;let r=!0;return e&&(r=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),n&&r}function gee(t,e){let n=!1;t&&(n=t.indexOf(Qh.THROTTLING_PREFIX)===0);let r=!0;return e&&(r=e.hasOwnProperty("throttleTime")),n&&r}function vee({environment:t,clientId:e}){return[MT,t,e].join(fr.CACHE_KEY_SEPARATOR).toLowerCase()}function bee(t,e){return e?t.indexOf(MT)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function yee(t,e){return e?t.indexOf(zg.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function Px(){return Ki()+zg.REFRESH_TIME_SECONDS}function om(t,e,n){t.authorization_endpoint=e.authorization_endpoint,t.token_endpoint=e.token_endpoint,t.end_session_endpoint=e.end_session_endpoint,t.issuer=e.issuer,t.endpointsFromNetwork=n,t.jwks_uri=e.jwks_uri}function jC(t,e,n){t.aliases=e.aliases,t.preferred_cache=e.preferred_cache,t.preferred_network=e.preferred_network,t.aliasesFromNetwork=n}function Mx(t){return t.expiresAt<=Ki()}/*! @azure/msal-common v14.15.0 2024-09-20 */const UD="redirect_uri_empty",Cee="claims_request_parsing_error",FD="authority_uri_insecure",Mh="url_parse_error",BD="empty_url_error",HD="empty_input_scopes_error",zD="invalid_prompt_value",XT="invalid_claims",VD="token_request_empty",$D="logout_request_empty",GD="invalid_code_challenge_method",e_="pkce_params_missing",t_="invalid_cloud_discovery_metadata",KD="invalid_authority_metadata",qD="untrusted_authority",Bb="missing_ssh_jwk",WD="missing_ssh_kid",See="missing_nonce_authentication_header",Eee="invalid_authentication_header",YD="cannot_set_OIDCOptions",QD="cannot_allow_native_broker",JD="authority_mismatch";/*! @azure/msal-common v14.15.0 2024-09-20 */const Iee={[UD]:"A redirect URI is required for all calls, and none has been set.",[Cee]:"Could not parse the given claims request object.",[FD]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[Mh]:"URL could not be parsed into appropriate segments.",[BD]:"URL was empty or null.",[HD]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[zD]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[XT]:"Given claims parameter must be a stringified JSON object.",[VD]:"Token request was empty and not found in cache.",[$D]:"The logout request was null or undefined.",[GD]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[e_]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[t_]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[KD]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[qD]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Bb]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[WD]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[See]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[Eee]:"Invalid authentication header provided",[YD]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[QD]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[JD]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class Hb extends _t{constructor(e){super(e,Iee[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,Hb.prototype)}}function nn(t){return new Hb(t)}/*! @azure/msal-common v14.15.0 2024-09-20 */class si{static isEmptyObj(e){if(e)try{const n=JSON.parse(e);return Object.keys(n).length===0}catch{}return!0}static startsWith(e,n){return e.indexOf(n)===0}static endsWith(e,n){return e.length>=n.length&&e.lastIndexOf(n)===e.length-n.length}static queryStringToObject(e){const n={},r=e.split("&"),o=i=>decodeURIComponent(i.replace(/\+/g," "));return r.forEach(i=>{if(i.trim()){const[s,a]=i.split(/=(.+)/g,2);s&&a&&(n[o(s)]=o(a))}}),n}static trimArrayEntries(e){return e.map(n=>n.trim())}static removeEmptyStringsFromArray(e){return e.filter(n=>!!n)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,n){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(n)}}/*! @azure/msal-common v14.15.0 2024-09-20 */class Nn{constructor(e){const n=e?si.trimArrayEntries([...e]):[],r=n?si.removeEmptyStringsFromArray(n):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach(o=>this.scopes.add(o))}static fromString(e){const r=(e||oe.EMPTY_STRING).split(" ");return new Nn(r)}static createSearchScopes(e){const n=new Nn(e);return n.containsOnlyOIDCScopes()?n.removeScope(oe.OFFLINE_ACCESS_SCOPE):n.removeOIDCScopes(),n}validateInputScopes(e){if(!e||e.length<1)throw nn(HD)}containsScope(e){const n=this.printScopesLowerCase().split(" "),r=new Nn(n);return e?r.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(n=>this.containsScope(n))}containsOnlyOIDCScopes(){let e=0;return Tx.forEach(n=>{this.containsScope(n)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(n=>this.appendScope(n))}catch{throw ke(GT)}}removeScope(e){if(!e)throw ke($T);this.scopes.delete(e.trim())}removeOIDCScopes(){Tx.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw ke(Vg);const n=new Set;return e.scopes.forEach(r=>n.add(r.toLowerCase())),this.scopes.forEach(r=>n.add(r.toLowerCase())),n}intersectingScopeSets(e){if(!e)throw ke(Vg);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const n=this.unionScopeSets(e),r=e.getScopeCount(),o=this.getScopeCount();return n.size<o+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(n=>e.push(n)),e}printScopes(){return this.scopes?this.asArray().join(" "):oe.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}/*! @azure/msal-common v14.15.0 2024-09-20 */function Wg(t,e){if(!t)throw ke(OT);try{const n=e(t);return JSON.parse(n)}catch{throw ke(Pb)}}function lu(t){if(!t)throw ke(Pb);const e=t.split(fr.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?oe.EMPTY_STRING:e[1]}}/*! @azure/msal-common v14.15.0 2024-09-20 */function Yg(t,e){return!!t&&!!e&&t===e.split(".")[1]}function n_(t,e,n,r){if(r){const{oid:o,sub:i,tid:s,name:a,tfp:c,acr:u}=r,h=s||c||u||"";return{tenantId:h,localAccountId:o||i||"",name:a,isHomeTenant:Yg(h,t)}}else return{tenantId:n,localAccountId:e,isHomeTenant:Yg(n,t)}}function r_(t,e,n,r){let o=t;if(e){const{isHomeTenant:i,...s}=e;o={...t,...s}}if(n){const{isHomeTenant:i,...s}=n_(t.homeAccountId,t.localAccountId,t.tenantId,n);return o={...o,...s,idTokenClaims:n,idToken:r},o}return o}/*! @azure/msal-common v14.15.0 2024-09-20 */const Qo={Default:0,Adfs:1,Dsts:2,Ciam:3};/*! @azure/msal-common v14.15.0 2024-09-20 */function ZD(t){return t&&(t.tid||t.tfp||t.acr)||null}/*! @azure/msal-common v14.15.0 2024-09-20 */const ms={AAD:"AAD",OIDC:"OIDC"};/*! @azure/msal-common v14.15.0 2024-09-20 */class Kn{generateAccountId(){return[this.homeAccountId,this.environment].join(fr.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return Kn.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const n=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",n||e.tenantId||""].join(fr.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,n,r){var u,h,p,f,g,v;const o=new Kn;n.authorityType===Qo.Adfs?o.authorityType=nm.ADFS_ACCOUNT_TYPE:n.protocolMode===ms.AAD?o.authorityType=nm.MSSTS_ACCOUNT_TYPE:o.authorityType=nm.GENERIC_ACCOUNT_TYPE;let i;e.clientInfo&&r&&(i=Wg(e.clientInfo,r)),o.clientInfo=e.clientInfo,o.homeAccountId=e.homeAccountId,o.nativeAccountId=e.nativeAccountId;const s=e.environment||n&&n.getPreferredCache();if(!s)throw ke(Db);o.environment=s,o.realm=(i==null?void 0:i.utid)||ZD(e.idTokenClaims)||"",o.localAccountId=(i==null?void 0:i.uid)||((u=e.idTokenClaims)==null?void 0:u.oid)||((h=e.idTokenClaims)==null?void 0:h.sub)||"";const a=((p=e.idTokenClaims)==null?void 0:p.preferred_username)||((f=e.idTokenClaims)==null?void 0:f.upn),c=(g=e.idTokenClaims)!=null&&g.emails?e.idTokenClaims.emails[0]:null;if(o.username=a||c||"",o.name=((v=e.idTokenClaims)==null?void 0:v.name)||"",o.cloudGraphHostName=e.cloudGraphHostName,o.msGraphHost=e.msGraphHost,e.tenantProfiles)o.tenantProfiles=e.tenantProfiles;else{const y=n_(e.homeAccountId,o.localAccountId,o.realm,e.idTokenClaims);o.tenantProfiles=[y]}return o}static createFromAccountInfo(e,n,r){var i;const o=new Kn;return o.authorityType=e.authorityType||nm.GENERIC_ACCOUNT_TYPE,o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.cloudGraphHostName=n,o.msGraphHost=r,o.tenantProfiles=Array.from(((i=e.tenantProfiles)==null?void 0:i.values())||[]),o}static generateHomeAccountId(e,n,r,o,i){if(!(n===Qo.Adfs||n===Qo.Dsts)){if(e)try{const s=Wg(e,o.base64Decode);if(s.uid&&s.utid)return`${s.uid}.${s.utid}`}catch{}r.warning("No client info in response")}return(i==null?void 0:i.sub)||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,n,r){if(!e||!n)return!1;let o=!0;if(r){const i=e.idTokenClaims||{},s=n.idTokenClaims||{};o=i.iat===s.iat&&i.nonce===s.nonce}return e.homeAccountId===n.homeAccountId&&e.localAccountId===n.localAccountId&&e.username===n.username&&e.tenantId===n.tenantId&&e.environment===n.environment&&e.nativeAccountId===n.nativeAccountId&&o}}/*! @azure/msal-common v14.15.0 2024-09-20 */function XD(t){return t.startsWith("#/")?t.substring(2):t.startsWith("#")||t.startsWith("?")?t.substring(1):t}function Qg(t){if(!t||t.indexOf("=")<0)return null;try{const e=XD(t),n=Object.fromEntries(new URLSearchParams(e));if(n.code||n.error||n.error_description||n.state)return n}catch{throw ke(UT)}return null}/*! @azure/msal-common v14.15.0 2024-09-20 */class At{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw nn(BD);e.includes("#")||(this._urlString=At.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let n=e.toLowerCase();return si.endsWith(n,"?")?n=n.slice(0,-1):si.endsWith(n,"?/")&&(n=n.slice(0,-2)),si.endsWith(n,"/")||(n+="/"),n}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw nn(Mh)}if(!e.HostNameAndPort||!e.PathSegments)throw nn(Mh);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw nn(FD)}static appendQueryString(e,n){return n?e.indexOf("?")<0?`${e}?${n}`:`${e}&${n}`:e}static removeHashFromUrl(e){return At.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const n=this.getUrlComponents(),r=n.PathSegments;return e&&r.length!==0&&(r[0]===da.COMMON||r[0]===da.ORGANIZATIONS)&&(r[0]=e),At.constructAuthorityUriFromObject(n)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),n=this.urlString.match(e);if(!n)throw nn(Mh);const r={Protocol:n[1],HostNameAndPort:n[4],AbsolutePath:n[5],QueryString:n[7]};let o=r.AbsolutePath.split("/");return o=o.filter(i=>i&&i.length>0),r.PathSegments=o,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const n=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(n);if(!r)throw nn(Mh);return r[2]}static getAbsoluteUrl(e,n){if(e[0]===oe.FORWARD_SLASH){const o=new At(n).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new At(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Qg(e)}}/*! @azure/msal-common v14.15.0 2024-09-20 */const e3={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},Ox=e3.endpointMetadata,o_=e3.instanceDiscoveryMetadata,t3=new Set;o_.metadata.forEach(t=>{t.aliases.forEach(e=>{t3.add(e)})});function Tee(t,e){var o;let n;const r=t.canonicalAuthority;if(r){const i=new At(r).getUrlComponents().HostNameAndPort;n=Lx(i,(o=t.cloudDiscoveryMetadata)==null?void 0:o.metadata,no.CONFIG,e)||Lx(i,o_.metadata,no.HARDCODED_VALUES,e)||t.knownAuthorities}return n||[]}function Lx(t,e,n,r){if(r==null||r.trace(`getAliasesFromMetadata called with source: ${n}`),t&&e){const o=Jg(e,t);if(o)return r==null||r.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${n}, returning aliases`),o.aliases;r==null||r.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${n}`)}return null}function _ee(t){return Jg(o_.metadata,t)}function Jg(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(r.aliases.includes(e))return r}return null}/*! @azure/msal-common v14.15.0 2024-09-20 */const n3="cache_quota_exceeded",i_="cache_error_unknown";/*! @azure/msal-common v14.15.0 2024-09-20 */const UC={[n3]:"Exceeded cache storage capacity.",[i_]:"Unexpected error occurred when using cache storage."};class pc extends Error{constructor(e,n){const r=n||(UC[e]?UC[e]:UC[i_]);super(`${e}: ${r}`),Object.setPrototypeOf(this,pc.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}/*! @azure/msal-common v14.15.0 2024-09-20 */class td{constructor(e,n,r,o){this.clientId=e,this.cryptoImpl=n,this.commonLogger=r.clone(LD,JT),this.staticAuthorityOptions=o}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const n=this.getAllAccounts(e);return n.length>1?n.sort(o=>o.idTokenClaims?-1:1)[0]:n.length===1?n[0]:null}getBaseAccountInfo(e){const n=this.getAccountsFilteredBy(e);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,n){return e.flatMap(r=>this.getTenantProfilesFromAccountEntity(r,n==null?void 0:n.tenantId,n))}getTenantedAccountInfoByFilter(e,n,r,o){let i=null,s;if(o&&!this.tenantProfileMatchesFilter(r,o))return null;const a=this.getIdToken(e,n,r.tenantId);return a&&(s=cl(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(s,o))?null:(i=r_(e,r,s,a==null?void 0:a.secret),i)}getTenantProfilesFromAccountEntity(e,n,r){const o=e.getAccountInfo();let i=o.tenantProfiles||new Map;const s=this.getTokenKeys();if(n){const c=i.get(n);if(c)i=new Map([[n,c]]);else return[]}const a=[];return i.forEach(c=>{const u=this.getTenantedAccountInfoByFilter(o,s,c,r);u&&a.push(u)}),a}tenantProfileMatchesFilter(e,n){return!(n.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,n.localAccountId)||n.name&&e.name!==n.name||n.isHomeTenant!==void 0&&e.isHomeTenant!==n.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,n){return!(n&&(n.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,n.localAccountId)||n.loginHint&&!this.matchLoginHintFromTokenClaims(e,n.loginHint)||n.username&&!this.matchUsername(e.preferred_username,n.username)||n.name&&!this.matchName(e,n.name)||n.sid&&!this.matchSid(e,n.sid)))}async saveCacheRecord(e,n,r){var o,i,s,a;if(!e)throw ke(KT);try{e.account&&this.setAccount(e.account),e.idToken&&(n==null?void 0:n.idToken)!==!1&&this.setIdTokenCredential(e.idToken),e.accessToken&&(n==null?void 0:n.accessToken)!==!1&&await this.saveAccessToken(e.accessToken),e.refreshToken&&(n==null?void 0:n.refreshToken)!==!1&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(c){throw(o=this.commonLogger)==null||o.error("CacheManager.saveCacheRecord: failed"),c instanceof Error?((i=this.commonLogger)==null||i.errorPii(`CacheManager.saveCacheRecord: ${c.message}`,r),c.name==="QuotaExceededError"||c.name==="NS_ERROR_DOM_QUOTA_REACHED"||c.message.includes("exceeded the quota")?((s=this.commonLogger)==null||s.error("CacheManager.saveCacheRecord: exceeded storage quota",r),new pc(n3)):new pc(c.name,c.message)):((a=this.commonLogger)==null||a.errorPii(`CacheManager.saveCacheRecord: ${c}`,r),new pc(i_))}}async saveAccessToken(e){const n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),o=Nn.fromString(e.target),i=[];r.accessToken.forEach(s=>{if(!this.accessTokenKeyMatchesFilter(s,n,!1))return;const a=this.getAccessTokenCredential(s);a&&this.credentialMatchesFilter(a,n)&&Nn.fromString(a.target).intersectingScopeSets(o)&&i.push(this.removeAccessToken(s))}),await Promise.all(i),this.setAccessTokenCredential(e)}getAccountsFilteredBy(e){const n=this.getAccountKeys(),r=[];return n.forEach(o=>{var c;if(!this.isAccountKey(o,e.homeAccountId))return;const i=this.getAccount(o,this.commonLogger);if(!i||e.homeAccountId&&!this.matchHomeAccountId(i,e.homeAccountId)||e.username&&!this.matchUsername(i.username,e.username)||e.environment&&!this.matchEnvironment(i,e.environment)||e.realm&&!this.matchRealm(i,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(i,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(i,e.authorityType))return;const s={localAccountId:e==null?void 0:e.localAccountId,name:e==null?void 0:e.name},a=(c=i.tenantProfiles)==null?void 0:c.filter(u=>this.tenantProfileMatchesFilter(u,s));a&&a.length===0||r.push(i)}),r}isAccountKey(e,n,r){return!(e.split(fr.CACHE_KEY_SEPARATOR).length<3||n&&!e.toLowerCase().includes(n.toLowerCase())||r&&!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(fr.CACHE_KEY_SEPARATOR).length<6)return!1;const n=e.toLowerCase();if(n.indexOf(ft.ID_TOKEN.toLowerCase())===-1&&n.indexOf(ft.ACCESS_TOKEN.toLowerCase())===-1&&n.indexOf(ft.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&n.indexOf(ft.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(n.indexOf(ft.REFRESH_TOKEN.toLowerCase())>-1){const r=`${ft.REFRESH_TOKEN}${fr.CACHE_KEY_SEPARATOR}${this.clientId}${fr.CACHE_KEY_SEPARATOR}`,o=`${ft.REFRESH_TOKEN}${fr.CACHE_KEY_SEPARATOR}${Yh}${fr.CACHE_KEY_SEPARATOR}`;if(n.indexOf(r.toLowerCase())===-1&&n.indexOf(o.toLowerCase())===-1)return!1}else if(n.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,n){return!(n.clientId&&!this.matchClientId(e,n.clientId)||n.userAssertionHash&&!this.matchUserAssertionHash(e,n.userAssertionHash)||typeof n.homeAccountId=="string"&&!this.matchHomeAccountId(e,n.homeAccountId)||n.environment&&!this.matchEnvironment(e,n.environment)||n.realm&&!this.matchRealm(e,n.realm)||n.credentialType&&!this.matchCredentialType(e,n.credentialType)||n.familyId&&!this.matchFamilyId(e,n.familyId)||n.target&&!this.matchTarget(e,n.target)||(n.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==n.requestedClaimsHash||e.credentialType===ft.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(n.tokenType&&!this.matchTokenType(e,n.tokenType)||n.tokenType===$t.SSH&&n.keyId&&!this.matchKeyId(e,n.keyId)))}getAppMetadataFilteredBy(e){const n=this.getKeys(),r={};return n.forEach(o=>{if(!this.isAppMetadata(o))return;const i=this.getAppMetadata(o);i&&(e.environment&&!this.matchEnvironment(i,e.environment)||e.clientId&&!this.matchClientId(i,e.clientId)||(r[o]=i))}),r}getAuthorityMetadataByAlias(e){const n=this.getAuthorityMetadataKeys();let r=null;return n.forEach(o=>{if(!this.isAuthorityMetadata(o)||o.indexOf(this.clientId)===-1)return;const i=this.getAuthorityMetadata(o);i&&i.aliases.indexOf(e)!==-1&&(r=i)}),r}async removeAllAccounts(){const e=this.getAccountKeys(),n=[];e.forEach(r=>{n.push(this.removeAccount(r))}),await Promise.all(n)}async removeAccount(e){const n=this.getAccount(e,this.commonLogger);n&&(await this.removeAccountContext(n),this.removeItem(e))}async removeAccountContext(e){const n=this.getTokenKeys(),r=e.generateAccountId(),o=[];n.idToken.forEach(i=>{i.indexOf(r)===0&&this.removeIdToken(i)}),n.accessToken.forEach(i=>{i.indexOf(r)===0&&o.push(this.removeAccessToken(i))}),n.refreshToken.forEach(i=>{i.indexOf(r)===0&&this.removeRefreshToken(i)}),await Promise.all(o)}updateOutdatedCachedAccount(e,n,r){var o;if(n&&n.isSingleTenant()){(o=this.commonLogger)==null||o.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");const i=this.getAccountKeys().filter(h=>h.startsWith(n.homeAccountId)),s=[];i.forEach(h=>{const p=this.getCachedAccountEntity(h);p&&s.push(p)});const a=s.find(h=>Yg(h.realm,h.homeAccountId))||s[0];a.tenantProfiles=s.map(h=>({tenantId:h.realm,localAccountId:h.localAccountId,name:h.name,isHomeTenant:Yg(h.realm,h.homeAccountId)}));const c=td.toObject(new Kn,{...a}),u=c.generateAccountKey();return i.forEach(h=>{h!==u&&this.removeOutdatedAccount(e)}),this.setAccount(c),r==null||r.verbose("Updated an outdated account entity in the cache"),c}return n}async removeAccessToken(e){const n=this.getAccessTokenCredential(e);if(n){if(n.credentialType.toLowerCase()===ft.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&n.tokenType===$t.POP){const o=n.keyId;if(o)try{await this.cryptoImpl.removeTokenBindingKey(o)}catch{throw ke(YT)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach(n=>{this.isAppMetadata(n)&&this.removeItem(n)}),!0}readAccountFromCache(e){const n=Kn.generateAccountCacheKey(e);return this.getAccount(n,this.commonLogger)}getIdToken(e,n,r,o,i){this.commonLogger.trace("CacheManager - getIdToken called");const s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:ft.ID_TOKEN,clientId:this.clientId,realm:r},a=this.getIdTokensByFilter(s,n),c=a.size;if(c<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(c>1){let u=a;if(!r){const h=new Map;a.forEach((f,g)=>{f.realm===e.tenantId&&h.set(g,f)});const p=h.size;if(p<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(p===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),h.values().next().value;u=h}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),u.forEach((h,p)=>{this.removeIdToken(p)}),o&&i&&o.addFields({multiMatchedID:a.size},i),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,n){const r=n&&n.idToken||this.getTokenKeys().idToken,o=new Map;return r.forEach(i=>{if(!this.idTokenKeyMatchesFilter(i,{clientId:this.clientId,...e}))return;const s=this.getIdTokenCredential(i);s&&this.credentialMatchesFilter(s,e)&&o.set(i,s)}),o}idTokenKeyMatchesFilter(e,n){const r=e.toLowerCase();return!(n.clientId&&r.indexOf(n.clientId.toLowerCase())===-1||n.homeAccountId&&r.indexOf(n.homeAccountId.toLowerCase())===-1)}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,n,r,o,i,s){this.commonLogger.trace("CacheManager - getAccessToken called");const a=Nn.createSearchScopes(n.scopes),c=n.authenticationScheme||$t.BEARER,u=c.toLowerCase()!==$t.BEARER.toLowerCase()?ft.ACCESS_TOKEN_WITH_AUTH_SCHEME:ft.ACCESS_TOKEN,h={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:u,clientId:this.clientId,realm:o||e.tenantId,target:a,tokenType:c,keyId:n.sshKid,requestedClaimsHash:n.requestedClaimsHash},p=r&&r.accessToken||this.getTokenKeys().accessToken,f=[];p.forEach(v=>{if(this.accessTokenKeyMatchesFilter(v,h,!0)){const y=this.getAccessTokenCredential(v);y&&this.credentialMatchesFilter(y,h)&&f.push(y)}});const g=f.length;return g<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):g>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),f.forEach(v=>{this.removeAccessToken(cu(v))}),i&&s&&i.addFields({multiMatchedAT:f.length},s),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),f[0])}accessTokenKeyMatchesFilter(e,n,r){const o=e.toLowerCase();if(n.clientId&&o.indexOf(n.clientId.toLowerCase())===-1||n.homeAccountId&&o.indexOf(n.homeAccountId.toLowerCase())===-1||n.realm&&o.indexOf(n.realm.toLowerCase())===-1||n.requestedClaimsHash&&o.indexOf(n.requestedClaimsHash.toLowerCase())===-1)return!1;if(n.target){const i=n.target.asArray();for(let s=0;s<i.length;s++){if(r&&!o.includes(i[s].toLowerCase()))return!1;if(!r&&o.includes(i[s].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const n=this.getTokenKeys(),r=[];return n.accessToken.forEach(o=>{if(!this.accessTokenKeyMatchesFilter(o,e,!0))return;const i=this.getAccessTokenCredential(o);i&&this.credentialMatchesFilter(i,e)&&r.push(i)}),r}getRefreshToken(e,n,r,o,i){this.commonLogger.trace("CacheManager - getRefreshToken called");const s=n?Yh:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:ft.REFRESH_TOKEN,clientId:this.clientId,familyId:s},c=r&&r.refreshToken||this.getTokenKeys().refreshToken,u=[];c.forEach(p=>{if(this.refreshTokenKeyMatchesFilter(p,a)){const f=this.getRefreshTokenCredential(p);f&&this.credentialMatchesFilter(f,a)&&u.push(f)}});const h=u.length;return h<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(h>1&&o&&i&&o.addFields({multiMatchedRT:h},i),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),u[0])}refreshTokenKeyMatchesFilter(e,n){const r=e.toLowerCase();return!(n.familyId&&r.indexOf(n.familyId.toLowerCase())===-1||!n.familyId&&n.clientId&&r.indexOf(n.clientId.toLowerCase())===-1||n.homeAccountId&&r.indexOf(n.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){const n={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(n),o=Object.keys(r).map(s=>r[s]),i=o.length;if(i<1)return null;if(i>1)throw ke(zT);return o[0]}isAppMetadataFOCI(e){const n=this.readAppMetadataFromCache(e);return!!(n&&n.familyId===Yh)}matchHomeAccountId(e,n){return typeof e.homeAccountId=="string"&&n===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,n){const r=e.oid||e.sub;return n===r}matchLocalAccountIdFromTenantProfile(e,n){return e.localAccountId===n}matchName(e,n){var r;return n.toLowerCase()===((r=e.name)==null?void 0:r.toLowerCase())}matchUsername(e,n){return!!(e&&typeof e=="string"&&(n==null?void 0:n.toLowerCase())===e.toLowerCase())}matchUserAssertionHash(e,n){return!!(e.userAssertionHash&&n===e.userAssertionHash)}matchEnvironment(e,n){if(this.staticAuthorityOptions){const o=Tee(this.staticAuthorityOptions,this.commonLogger);if(o.includes(n)&&o.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(n);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,n){return e.credentialType&&n.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,n){return!!(e.clientId&&n===e.clientId)}matchFamilyId(e,n){return!!(e.familyId&&n===e.familyId)}matchRealm(e,n){var r;return((r=e.realm)==null?void 0:r.toLowerCase())===n.toLowerCase()}matchNativeAccountId(e,n){return!!(e.nativeAccountId&&n===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,n){return e.login_hint===n||e.preferred_username===n||e.upn===n}matchSid(e,n){return e.sid===n}matchAuthorityType(e,n){return!!(e.authorityType&&n.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,n){return e.credentialType!==ft.ACCESS_TOKEN&&e.credentialType!==ft.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:Nn.fromString(e.target).containsScopeSet(n)}matchTokenType(e,n){return!!(e.tokenType&&e.tokenType===n)}matchKeyId(e,n){return!!(e.keyId&&e.keyId===n)}isAppMetadata(e){return e.indexOf(MT)!==-1}isAuthorityMetadata(e){return e.indexOf(zg.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${zg.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,n){for(const r in n)e[r]=n[r];return e}}class wee extends td{setAccount(){throw ke(Ct)}getAccount(){throw ke(Ct)}getCachedAccountEntity(){throw ke(Ct)}setIdTokenCredential(){throw ke(Ct)}getIdTokenCredential(){throw ke(Ct)}setAccessTokenCredential(){throw ke(Ct)}getAccessTokenCredential(){throw ke(Ct)}setRefreshTokenCredential(){throw ke(Ct)}getRefreshTokenCredential(){throw ke(Ct)}setAppMetadata(){throw ke(Ct)}getAppMetadata(){throw ke(Ct)}setServerTelemetry(){throw ke(Ct)}getServerTelemetry(){throw ke(Ct)}setAuthorityMetadata(){throw ke(Ct)}getAuthorityMetadata(){throw ke(Ct)}getAuthorityMetadataKeys(){throw ke(Ct)}setThrottlingCache(){throw ke(Ct)}getThrottlingCache(){throw ke(Ct)}removeItem(){throw ke(Ct)}getKeys(){throw ke(Ct)}getAccountKeys(){throw ke(Ct)}getTokenKeys(){throw ke(Ct)}async clear(){throw ke(Ct)}updateCredentialCacheKey(){throw ke(Ct)}removeOutdatedAccount(){throw ke(Ct)}}/*! @azure/msal-common v14.15.0 2024-09-20 */const r3={tokenRenewalOffsetSeconds:see,preventCorsPreflight:!1},Aee={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:bn.Info,correlationId:oe.EMPTY_STRING},kee={claimsBasedCachingEnabled:!1},xee={async sendGetRequestAsync(){throw ke(Ct)},async sendPostRequestAsync(){throw ke(Ct)}},Ree={sku:oe.SKU,version:JT,cpu:oe.EMPTY_STRING,os:oe.EMPTY_STRING},Nee={clientSecret:oe.EMPTY_STRING,clientAssertion:void 0},Pee={azureCloudInstance:Nf.None,tenant:`${oe.DEFAULT_COMMON_TENANT}`},Mee={application:{appName:"",appVersion:""}};function Oee({authOptions:t,systemOptions:e,loggerOptions:n,cacheOptions:r,storageInterface:o,networkInterface:i,cryptoInterface:s,clientCredentials:a,libraryInfo:c,telemetry:u,serverTelemetryManager:h,persistencePlugin:p,serializableCache:f}){const g={...Aee,...n};return{authOptions:Lee(t),systemOptions:{...r3,...e},loggerOptions:g,cacheOptions:{...kee,...r},storageInterface:o||new wee(t.clientId,qg,new di(g)),networkInterface:i||xee,cryptoInterface:s||qg,clientCredentials:a||Nee,libraryInfo:{...Ree,...c},telemetry:{...Mee,...u},serverTelemetryManager:h||null,persistencePlugin:p||null,serializableCache:f||null}}function Lee(t){return{clientCapabilities:[],azureCloudOptions:Pee,skipAuthorityMetadataCache:!1,instanceAware:!1,...t}}function E1(t){return t.authOptions.authority.options.protocolMode===ms.OIDC}/*! @azure/msal-common v14.15.0 2024-09-20 */class qi extends _t{constructor(e,n,r,o,i){super(e,n,r),this.name="ServerError",this.errorNo=o,this.status=i,Object.setPrototypeOf(this,qi.prototype)}}/*! @azure/msal-common v14.15.0 2024-09-20 */class Pi{static generateThrottlingStorageKey(e){return`${Qh.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,n){var i;const r=Pi.generateThrottlingStorageKey(n),o=e.getThrottlingCache(r);if(o){if(o.throttleTime<Date.now()){e.removeItem(r);return}throw new qi(((i=o.errorCodes)==null?void 0:i.join(" "))||oe.EMPTY_STRING,o.errorMessage,o.subError)}}static postProcess(e,n,r){if(Pi.checkResponseStatus(r)||Pi.checkResponseForRetryAfter(r)){const o={throttleTime:Pi.calculateThrottleTime(parseInt(r.headers[Fi.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(Pi.generateThrottlingStorageKey(n),o)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(Fi.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){const n=e<=0?0:e,r=Date.now()/1e3;return Math.floor(Math.min(r+(n||Qh.DEFAULT_THROTTLE_TIME_SECONDS),r+Qh.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,n,r,o){const i={clientId:n,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:o,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},s=this.generateThrottlingStorageKey(i);e.removeItem(s)}}/*! @azure/msal-common v14.15.0 2024-09-20 */class Dee{constructor(e,n){this.networkClient=e,this.cacheManager=n}async sendPostRequest(e,n,r){Pi.preProcess(this.cacheManager,e);let o;try{o=await this.networkClient.sendPostRequestAsync(n,r)}catch(i){throw i instanceof _t?i:ke(DT)}return Pi.postProcess(this.cacheManager,e,o),o}}/*! @azure/msal-common v14.15.0 2024-09-20 */const uo={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};/*! @azure/msal-common v14.15.0 2024-09-20 */const nd="client_id",jee="redirect_uri",Dx="response_type",Uee="response_mode",Fee="grant_type",Bee="claims",Hee="scope",zee="refresh_token",Vee="state",$ee="nonce",Gee="prompt",Kee="code",qee="code_challenge",Wee="code_challenge_method",Yee="code_verifier",Qee="client-request-id",Jee="x-client-SKU",Zee="x-client-VER",Xee="x-client-OS",ete="x-client-CPU",tte="x-client-current-telemetry",nte="x-client-last-telemetry",rte="x-ms-lib-capability",ote="x-app-name",ite="x-app-ver",ste="post_logout_redirect_uri",ate="id_token_hint",cte="device_code",lte="client_secret",ute="client_assertion",dte="client_assertion_type",jx="token_type",Ux="req_cnf",hte="assertion",fte="requested_token_use",Fx="return_spa_code",pte="nativebroker",mte="logout_hint",gte="sid",vte="login_hint",bte="domain_hint",yte="x-client-xtra-sku";/*! @azure/msal-common v14.15.0 2024-09-20 */class Ql{static validateRedirectUri(e){if(!e)throw nn(UD)}static validatePrompt(e){const n=[];for(const r in nr)n.push(nr[r]);if(n.indexOf(e)<0)throw nn(zD)}static validateClaims(e){try{JSON.parse(e)}catch{throw nn(XT)}}static validateCodeChallengeParams(e,n){if(!e||!n)throw nn(e_);this.validateCodeChallengeMethod(n)}static validateCodeChallengeMethod(e){if([_x.PLAIN,_x.S256].indexOf(e)<0)throw nn(GD)}}/*! @azure/msal-common v14.15.0 2024-09-20 */class Jh{constructor(){this.parameters=new Map}addResponseTypeCode(){this.parameters.set(Dx,encodeURIComponent(oe.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(Dx,encodeURIComponent(`${oe.TOKEN_RESPONSE_TYPE} ${oe.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(Uee,encodeURIComponent(e||ree.QUERY))}addNativeBroker(){this.parameters.set(pte,encodeURIComponent("1"))}addScopes(e,n=!0,r=va){n&&!r.includes("openid")&&!e.includes("openid")&&r.push("openid");const o=n?[...e||[],...r]:e||[],i=new Nn(o);this.parameters.set(Hee,encodeURIComponent(i.printScopes()))}addClientId(e){this.parameters.set(nd,encodeURIComponent(e))}addRedirectUri(e){Ql.validateRedirectUri(e),this.parameters.set(jee,encodeURIComponent(e))}addPostLogoutRedirectUri(e){Ql.validateRedirectUri(e),this.parameters.set(ste,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(ate,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(bte,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(vte,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(Fi.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(Fi.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(gte,encodeURIComponent(e))}addClaims(e,n){const r=this.addClientCapabilitiesToClaims(e,n);Ql.validateClaims(r),this.parameters.set(Bee,encodeURIComponent(r))}addCorrelationId(e){this.parameters.set(Qee,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(Jee,e.sku),this.parameters.set(Zee,e.version),e.os&&this.parameters.set(Xee,e.os),e.cpu&&this.parameters.set(ete,e.cpu)}addApplicationTelemetry(e){e!=null&&e.appName&&this.parameters.set(ote,e.appName),e!=null&&e.appVersion&&this.parameters.set(ite,e.appVersion)}addPrompt(e){Ql.validatePrompt(e),this.parameters.set(`${Gee}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(Vee,encodeURIComponent(e))}addNonce(e){this.parameters.set($ee,encodeURIComponent(e))}addCodeChallengeParams(e,n){if(Ql.validateCodeChallengeParams(e,n),e&&n)this.parameters.set(qee,encodeURIComponent(e)),this.parameters.set(Wee,encodeURIComponent(n));else throw nn(e_)}addAuthorizationCode(e){this.parameters.set(Kee,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(cte,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(zee,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(Yee,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(lte,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(ute,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(dte,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(hte,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(fte,encodeURIComponent(e))}addGrantType(e){this.parameters.set(Fee,encodeURIComponent(e))}addClientInfo(){this.parameters.set(oee,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([n,r])=>{!this.parameters.has(n)&&r&&this.parameters.set(n,r)})}addClientCapabilitiesToClaims(e,n){let r;if(!e)r={};else try{r=JSON.parse(e)}catch{throw nn(XT)}return n&&n.length>0&&(r.hasOwnProperty(tm.ACCESS_TOKEN)||(r[tm.ACCESS_TOKEN]={}),r[tm.ACCESS_TOKEN][tm.XMS_CC]={values:n}),JSON.stringify(r)}addUsername(e){this.parameters.set(Ax.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(Ax.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(jx,$t.POP),this.parameters.set(Ux,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(jx,$t.SSH),this.parameters.set(Ux,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(tte,e.generateCurrentRequestHeaderValue()),this.parameters.set(nte,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(rte,Qh.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(mte,encodeURIComponent(e))}createQueryString(){const e=new Array;return this.parameters.forEach((n,r)=>{e.push(`${r}=${n}`)}),e.join("&")}}/*! @azure/msal-common v14.15.0 2024-09-20 */function Cte(t){return t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("jwks_uri")}/*! @azure/msal-common v14.15.0 2024-09-20 */function Ste(t){return t.hasOwnProperty("tenant_discovery_endpoint")&&t.hasOwnProperty("metadata")}/*! @azure/msal-common v14.15.0 2024-09-20 */function Ete(t){return t.hasOwnProperty("error")&&t.hasOwnProperty("error_description")}/*! @azure/msal-common v14.15.0 2024-09-20 */const x={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},Ite=new Map([[x.AcquireTokenByCode,"ATByCode"],[x.AcquireTokenByRefreshToken,"ATByRT"],[x.AcquireTokenSilent,"ATS"],[x.AcquireTokenSilentAsync,"ATSAsync"],[x.AcquireTokenPopup,"ATPopup"],[x.AcquireTokenRedirect,"ATRedirect"],[x.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[x.CryptoOptsSignJwt,"CryptoSignJwt"],[x.SilentCacheClientAcquireToken,"SltCacheClientAT"],[x.SilentIframeClientAcquireToken,"SltIframeClientAT"],[x.SilentRefreshClientAcquireToken,"SltRClientAT"],[x.SsoSilent,"SsoSlt"],[x.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[x.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[x.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[x.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[x.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[x.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[x.BrokerHandhshake,"BrokerHandshake"],[x.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[x.AcquireTokenByBroker,"ATByBroker"],[x.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[x.RefreshTokenClientAcquireToken,"RTClientAT"],[x.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[x.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[x.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[x.AcquireTokenFromCache,"ATFromCache"],[x.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[x.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[x.AcquireTokenBySilentIframe,"ATBySltIframe"],[x.InitializeBaseRequest,"InitBaseReq"],[x.InitializeSilentRequest,"InitSltReq"],[x.InitializeClientApplication,"InitClientApplication"],[x.SilentIframeClientTokenHelper,"SIClientTHelper"],[x.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[x.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[x.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[x.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[x.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[x.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[x.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[x.StandardInteractionClientInitializeAuthorizationCodeRequest,"StdIntClientInitAuthCodeReq"],[x.GetAuthCodeUrl,"GetAuthCodeUrl"],[x.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[x.HandleCodeResponse,"HandleCodeResp"],[x.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[x.AuthClientAcquireToken,"AuthClientAT"],[x.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[x.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[x.AuthClientCreateQueryString,"AuthClientCreateQueryStr"],[x.PopTokenGenerateCnf,"PopTGenCnf"],[x.PopTokenGenerateKid,"PopTGenKid"],[x.HandleServerTokenResponse,"HandleServerTRes"],[x.DeserializeResponse,"DeserializeRes"],[x.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[x.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[x.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[x.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[x.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[x.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[x.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[x.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[x.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[x.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[x.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[x.AcquireTokenByCodeAsync,"ATByCodeAsync"],[x.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[x.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[x.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[x.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[x.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[x.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[x.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[x.NativeGenerateAuthResult,"NtvGenAuthRes"],[x.RemoveHiddenIframe,"RemoveHiddenIframe"],[x.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[x.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[x.GeneratePkceCodes,"GenPkceCodes"],[x.GenerateCodeVerifier,"GenCodeVerifier"],[x.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[x.Sha256Digest,"Sha256Digest"],[x.GetRandomValues,"GetRandomValues"]]),I1={InProgress:1,Completed:2},Tte=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT"]);/*! @azure/msal-common v14.15.0 2024-09-20 */const ll=(t,e,n,r,o)=>(...i)=>{n.trace(`Executing function ${e}`);const s=r==null?void 0:r.startMeasurement(e,o);if(o){const a=e+"CallCount";r==null||r.incrementFields({[a]:1},o)}try{const a=t(...i);return s==null||s.end({success:!0}),n.trace(`Returning result from ${e}`),a}catch(a){n.trace(`Error occurred in ${e}`);try{n.trace(JSON.stringify(a))}catch{n.trace("Unable to print error message.")}throw s==null||s.end({success:!1},a),a}},Ue=(t,e,n,r,o)=>(...i)=>{n.trace(`Executing function ${e}`);const s=r==null?void 0:r.startMeasurement(e,o);if(o){const a=e+"CallCount";r==null||r.incrementFields({[a]:1},o)}return r==null||r.setPreQueueTime(e,o),t(...i).then(a=>(n.trace(`Returning result from ${e}`),s==null||s.end({success:!0}),a)).catch(a=>{n.trace(`Error occurred in ${e}`);try{n.trace(JSON.stringify(a))}catch{n.trace("Unable to print error message.")}throw s==null||s.end({success:!1},a),a})};/*! @azure/msal-common v14.15.0 2024-09-20 */class zb{constructor(e,n,r,o){this.networkInterface=e,this.logger=n,this.performanceClient=r,this.correlationId=o}async detectRegion(e,n){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(x.RegionDiscoveryDetectRegion,this.correlationId);let r=e;if(r)n.region_source=Pl.ENVIRONMENT_VARIABLE;else{const i=zb.IMDS_OPTIONS;try{const s=await Ue(this.getRegionFromIMDS.bind(this),x.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(oe.IMDS_VERSION,i);if(s.status===rm.httpSuccess&&(r=s.body,n.region_source=Pl.IMDS),s.status===rm.httpBadRequest){const a=await Ue(this.getCurrentVersion.bind(this),x.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(i);if(!a)return n.region_source=Pl.FAILED_AUTO_DETECTION,null;const c=await Ue(this.getRegionFromIMDS.bind(this),x.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(a,i);c.status===rm.httpSuccess&&(r=c.body,n.region_source=Pl.IMDS)}}catch{return n.region_source=Pl.FAILED_AUTO_DETECTION,null}}return r||(n.region_source=Pl.FAILED_AUTO_DETECTION),r||null}async getRegionFromIMDS(e,n){var r;return(r=this.performanceClient)==null||r.addQueueMeasurement(x.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${oe.IMDS_ENDPOINT}?api-version=${e}&format=text`,n,oe.IMDS_TIMEOUT)}async getCurrentVersion(e){var n;(n=this.performanceClient)==null||n.addQueueMeasurement(x.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const r=await this.networkInterface.sendGetRequestAsync(`${oe.IMDS_ENDPOINT}?format=json`,e);return r.status===rm.httpBadRequest&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?r.body["newest-versions"][0]:null}catch{return null}}}zb.IMDS_OPTIONS={headers:{Metadata:"true"}};/*! @azure/msal-common v14.15.0 2024-09-20 */class dr{constructor(e,n,r,o,i,s,a,c){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=n,this.cacheManager=r,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=a,this.correlationId=s,this.managedIdentity=c||!1,this.regionDiscovery=new zb(n,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(oe.CIAM_AUTH_URL))return Qo.Ciam;const n=e.PathSegments;if(n.length)switch(n[0].toLowerCase()){case oe.ADFS:return Qo.Adfs;case oe.DSTS:return Qo.Dsts}return Qo.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new At(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw ke(Ai)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw ke(Ai)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw ke(Ai)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw ke(QT);return this.replacePath(this.metadata.end_session_endpoint)}else throw ke(Ai)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw ke(Ai)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw ke(Ai)}canReplaceTenant(e){return e.PathSegments.length===1&&!dr.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Qo.Default&&this.protocolMode===ms.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let n=e;const o=new At(this.metadata.canonical_authority).getUrlComponents(),i=o.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((a,c)=>{let u=i[c];if(c===0&&this.canReplaceTenant(o)){const h=new At(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];u!==h&&(this.logger.verbose(`Replacing tenant domain name ${u} with id ${h}`),u=h)}a!==u&&(n=n.replace(`/${u}/`,`/${a}/`))}),this.replaceTenant(n)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Qo.Adfs||this.protocolMode!==ms.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var o,i;(o=this.performanceClient)==null||o.addQueueMeasurement(x.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),n=await Ue(this.updateCloudDiscoveryMetadata.bind(this),x.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const r=await Ue(this.updateEndpointMetadata.bind(this),x.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,n,{source:r}),(i=this.performanceClient)==null||i.addFields({cloudDiscoverySource:n,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Px(),jwks_uri:""}),e}updateCachedMetadata(e,n,r){n!==no.CACHE&&(r==null?void 0:r.source)!==no.CACHE&&(e.expiresAt=Px(),e.canonical_authority=this.canonicalAuthority);const o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e}async updateEndpointMetadata(e){var o,i,s;(o=this.performanceClient)==null||o.addQueueMeasurement(x.AuthorityUpdateEndpointMetadata,this.correlationId);const n=this.updateEndpointMetadataFromLocalSources(e);if(n){if(n.source===no.HARDCODED_VALUES&&(i=this.authorityOptions.azureRegionConfiguration)!=null&&i.azureRegion&&n.metadata){const a=await Ue(this.updateMetadataWithRegionalInformation.bind(this),x.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n.metadata);om(e,a,!1),e.canonical_authority=this.canonicalAuthority}return n.source}let r=await Ue(this.getEndpointMetadataFromNetwork.bind(this),x.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return(s=this.authorityOptions.azureRegionConfiguration)!=null&&s.azureRegion&&(r=await Ue(this.updateMetadataWithRegionalInformation.bind(this),x.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r)),om(e,r,!0),no.NETWORK;throw ke(jT,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const n=this.getEndpointMetadataFromConfig();if(n)return this.logger.verbose("Found endpoint metadata in authority configuration"),om(e,n,!1),{source:no.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const o=this.getEndpointMetadataFromHardcodedValues();if(o)return om(e,o,!1),{source:no.HARDCODED_VALUES,metadata:o};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=Mx(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:no.CACHE}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new At(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw nn(KD)}return null}async getEndpointMetadataFromNetwork(){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(x.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},n=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${n}`);try{const o=await this.networkInterface.sendGetRequestAsync(n,e);return Cte(o.body)?o.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(o){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${o}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Ox?Ox[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var r,o,i;(r=this.performanceClient)==null||r.addQueueMeasurement(x.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const n=(o=this.authorityOptions.azureRegionConfiguration)==null?void 0:o.azureRegion;if(n){if(n!==oe.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=DC.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=n,dr.replaceWithRegionalInformation(e,n);const s=await Ue(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),x.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)((i=this.authorityOptions.azureRegionConfiguration)==null?void 0:i.environmentRegion,this.regionDiscoveryMetadata);if(s)return this.regionDiscoveryMetadata.region_outcome=DC.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=s,dr.replaceWithRegionalInformation(e,s);this.regionDiscoveryMetadata.region_outcome=DC.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(x.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const n=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(n)return n;const r=await Ue(this.getCloudDiscoveryMetadataFromNetwork.bind(this),x.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return jC(e,r,!0),no.NETWORK;throw nn(qD)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||oe.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||oe.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||oe.NOT_APPLICABLE}`);const n=this.getCloudDiscoveryMetadataFromConfig();if(n)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),jC(e,n,!1),no.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const o=_ee(this.hostnameAndPort);if(o)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),jC(e,o,!1),no.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const r=Mx(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),no.CACHE):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Qo.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),dr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),n=Jg(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),n)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),n;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),nn(t_)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),dr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(x.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${oe.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,n={};let r=null;try{const i=await this.networkInterface.sendGetRequestAsync(e,n);let s,a;if(Ste(i.body))s=i.body,a=s.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${s.tenant_discovery_endpoint}`);else if(Ete(i.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${i.status}`),s=i.body,s.error===oe.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${s.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${s.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=Jg(a,this.hostnameAndPort)}catch(i){if(i instanceof _t)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${i.errorCode}
Error Description: ${i.errorMessage}`);else{const s=i;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${s.name}
Error Description: ${s.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=dr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(n=>n&&At.getDomainFromUrl(n).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,n){let r;if(n&&n.azureCloudInstance!==Nf.None){const o=n.tenant?n.tenant:oe.DEFAULT_COMMON_TENANT;r=`${n.azureCloudInstance}/${o}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return oe.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw ke(Ai)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return t3.has(e)}static isPublicCloudAuthority(e){return oe.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,n,r){const o=new At(e);o.validateAsUri();const i=o.getUrlComponents();let s=`${n}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(s=`${n}.${oe.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const a=At.constructAuthorityUriFromObject({...o.getUrlComponents(),HostNameAndPort:s}).urlString;return r?`${a}?${r}`:a}static replaceWithRegionalInformation(e,n){const r={...e};return r.authorization_endpoint=dr.buildRegionalAuthorityString(r.authorization_endpoint,n),r.token_endpoint=dr.buildRegionalAuthorityString(r.token_endpoint,n),r.end_session_endpoint&&(r.end_session_endpoint=dr.buildRegionalAuthorityString(r.end_session_endpoint,n)),r}static transformCIAMAuthority(e){let n=e;const o=new At(e).getUrlComponents();if(o.PathSegments.length===0&&o.HostNameAndPort.endsWith(oe.CIAM_AUTH_URL)){const i=o.HostNameAndPort.split(".")[0];n=`${n}${i}${oe.AAD_TENANT_DOMAIN_SUFFIX}`}return n}}dr.reservedTenantDomains=new Set(["{tenant}","{tenantid}",da.COMMON,da.CONSUMERS,da.ORGANIZATIONS]);function _te(t){var o;const r=(o=new At(t).getUrlComponents().PathSegments.slice(-1)[0])==null?void 0:o.toLowerCase();switch(r){case da.COMMON:case da.ORGANIZATIONS:case da.CONSUMERS:return;default:return r}}function o3(t){return t.endsWith(oe.FORWARD_SLASH)?t:`${t}${oe.FORWARD_SLASH}`}function wte(t){const e=t.cloudDiscoveryMetadata;let n;if(e)try{n=JSON.parse(e)}catch{throw nn(t_)}return{canonicalAuthority:t.authority?o3(t.authority):void 0,knownAuthorities:t.knownAuthorities,cloudDiscoveryMetadata:n}}/*! @azure/msal-common v14.15.0 2024-09-20 */async function i3(t,e,n,r,o,i,s){s==null||s.addQueueMeasurement(x.AuthorityFactoryCreateDiscoveredInstance,i);const a=dr.transformCIAMAuthority(o3(t)),c=new dr(a,e,n,r,o,i,s);try{return await Ue(c.resolveEndpointsAsync.bind(c),x.AuthorityResolveEndpointsAsync,o,s,i)(),c}catch{throw ke(Ai)}}/*! @azure/msal-common v14.15.0 2024-09-20 */class s_{constructor(e,n){this.config=Oee(e),this.logger=new di(this.config.loggerOptions,LD,JT),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Dee(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=n}createTokenRequestHeaders(e){const n={};if(n[Fi.CONTENT_TYPE]=oe.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case uo.HOME_ACCOUNT_ID:try{const r=lu(e.credential);n[Fi.CCS_HEADER]=`Oid:${r.uid}@${r.utid}`}catch(r){this.logger.verbose("Could not parse home account ID for CCS Header: "+r)}break;case uo.UPN:n[Fi.CCS_HEADER]=`UPN: ${e.credential}`;break}return n}async executePostToTokenEndpoint(e,n,r,o,i,s){var c,u,h,p;s&&((c=this.performanceClient)==null||c.addQueueMeasurement(s,i));const a=await this.networkManager.sendPostRequest(o,e,{body:n,headers:r});return(p=this.performanceClient)==null||p.addFields({refreshTokenSize:((u=a.body.refresh_token)==null?void 0:u.length)||0,httpVerToken:((h=a.headers)==null?void 0:h[Fi.X_MS_HTTP_VERSION])||""},i),this.config.serverTelemetryManager&&a.status<500&&a.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async updateAuthority(e,n){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(x.UpdateTokenEndpointAuthority,n);const r=`https://${e}/${this.authority.tenant}/`,o=await i3(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,n,this.performanceClient);this.authority=o}createTokenQueryParameters(e){const n=new Jh;return e.tokenQueryParameters&&n.addExtraQueryParameters(e.tokenQueryParameters),n.createQueryString()}}/*! @azure/msal-common v14.15.0 2024-09-20 */const Zg="no_tokens_found",s3="native_account_unavailable",a_="refresh_token_expired",Ate="interaction_required",kte="consent_required",xte="login_required",Vb="bad_token";/*! @azure/msal-common v14.15.0 2024-09-20 */const Bx=[Ate,kte,xte,Vb],Rte=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Nte={[Zg]:"No refresh token found in the cache. Please sign-in.",[s3]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[a_]:"Refresh token has expired.",[Vb]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class Rr extends _t{constructor(e,n,r,o,i,s,a,c){super(e,n,r),Object.setPrototypeOf(this,Rr.prototype),this.timestamp=o||oe.EMPTY_STRING,this.traceId=i||oe.EMPTY_STRING,this.correlationId=s||oe.EMPTY_STRING,this.claims=a||oe.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=c}}function Hx(t,e,n){const r=!!t&&Bx.indexOf(t)>-1,o=!!n&&Rte.indexOf(n)>-1,i=!!e&&Bx.some(s=>e.indexOf(s)>-1);return r||i||o}function T1(t){return new Rr(t,Nte[t])}/*! @azure/msal-common v14.15.0 2024-09-20 */class ai{static setRequestState(e,n,r){const o=ai.generateLibraryState(e,r);return n?`${o}${oe.RESOURCE_DELIM}${n}`:o}static generateLibraryState(e,n){if(!e)throw ke(Gg);const r={id:e.createNewGuid()};n&&(r.meta=n);const o=JSON.stringify(r);return e.base64Encode(o)}static parseRequestState(e,n){if(!e)throw ke(Gg);if(!n)throw ke(Rc);try{const r=n.split(oe.RESOURCE_DELIM),o=r[0],i=r.length>1?r.slice(1).join(oe.RESOURCE_DELIM):oe.EMPTY_STRING,s=e.base64Decode(o),a=JSON.parse(s);return{userRequestState:i||oe.EMPTY_STRING,libraryState:a}}catch{throw ke(Rc)}}}/*! @azure/msal-common v14.15.0 2024-09-20 */const Pte={SW:"sw"};class Nc{constructor(e,n){this.cryptoUtils=e,this.performanceClient=n}async generateCnf(e,n){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(x.PopTokenGenerateCnf,e.correlationId);const r=await Ue(this.generateKid.bind(this),x.PopTokenGenerateCnf,n,this.performanceClient,e.correlationId)(e),o=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:o}}async generateKid(e){var r;return(r=this.performanceClient)==null||r.addQueueMeasurement(x.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:Pte.SW}}async signPopToken(e,n,r){return this.signPayload(e,n,r)}async signPayload(e,n,r,o){const{resourceRequestMethod:i,resourceRequestUri:s,shrClaims:a,shrNonce:c,shrOptions:u}=r,h=s?new At(s):void 0,p=h==null?void 0:h.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:Ki(),m:i==null?void 0:i.toUpperCase(),u:p==null?void 0:p.HostNameAndPort,nonce:c||this.cryptoUtils.createNewGuid(),p:p==null?void 0:p.AbsolutePath,q:p!=null&&p.QueryString?[[],p.QueryString]:void 0,client_claims:a||void 0,...o},n,u,r.correlationId)}}/*! @azure/msal-common v14.15.0 2024-09-20 */class Mte{constructor(e,n){this.cache=e,this.hasChanged=n}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}/*! @azure/msal-common v14.15.0 2024-09-20 */function Ote(t){var r,o;const e="code=",n=(r=t.error_uri)==null?void 0:r.lastIndexOf(e);return n&&n>=0?(o=t.error_uri)==null?void 0:o.substring(n+e.length):void 0}class Pc{constructor(e,n,r,o,i,s,a){this.clientId=e,this.cacheStorage=n,this.cryptoObj=r,this.logger=o,this.serializableCache=i,this.persistencePlugin=s,this.performanceClient=a}validateServerAuthorizationCodeResponse(e,n){if(!e.state||!n)throw e.state?ke(Rf,"Cached State"):ke(Rf,"Server State");let r,o;try{r=decodeURIComponent(e.state)}catch{throw ke(Rc,e.state)}try{o=decodeURIComponent(n)}catch{throw ke(Rc,e.state)}if(r!==o)throw ke(FT);if(e.error||e.error_description||e.suberror){const i=Ote(e);throw Hx(e.error,e.error_description,e.suberror)?new Rr(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",i):new qi(e.error||"",e.error_description,e.suberror,i)}}validateTokenResponse(e,n){var r;if(e.error||e.error_description||e.suberror){const o=`Error(s): ${e.error_codes||oe.NOT_AVAILABLE} - Timestamp: ${e.timestamp||oe.NOT_AVAILABLE} - Description: ${e.error_description||oe.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||oe.NOT_AVAILABLE} - Trace ID: ${e.trace_id||oe.NOT_AVAILABLE}`,i=(r=e.error_codes)!=null&&r.length?e.error_codes[0]:void 0,s=new qi(e.error,o,e.suberror,i,e.status);if(n&&e.status&&e.status>=em.SERVER_ERROR_RANGE_START&&e.status<=em.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${s}`);return}else if(n&&e.status&&e.status>=em.CLIENT_ERROR_RANGE_START&&e.status<=em.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${s}`);return}throw Hx(e.error,e.error_description,e.suberror)?new Rr(e.error,e.error_description,e.suberror,e.timestamp||oe.EMPTY_STRING,e.trace_id||oe.EMPTY_STRING,e.correlation_id||oe.EMPTY_STRING,e.claims||oe.EMPTY_STRING,i):s}}async handleServerTokenResponse(e,n,r,o,i,s,a,c,u){var v;(v=this.performanceClient)==null||v.addQueueMeasurement(x.HandleServerTokenResponse,e.correlation_id);let h;if(e.id_token){if(h=cl(e.id_token||oe.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&h.nonce!==i.nonce)throw ke(BT);if(o.maxAge||o.maxAge===0){const y=h.auth_time;if(!y)throw ke(Ob);DD(y,o.maxAge)}}this.homeAccountIdentifier=Kn.generateHomeAccountId(e.client_info||oe.EMPTY_STRING,n.authorityType,this.logger,this.cryptoObj,h);let p;i&&i.state&&(p=ai.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0;const f=this.generateCacheRecord(e,n,r,o,h,s,i);let g;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),g=new Mte(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(g)),a&&!c&&f.account){const y=f.account.generateAccountKey();if(!this.cacheStorage.getAccount(y,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Pc.generateAuthenticationResult(this.cryptoObj,n,f,!1,o,h,p,void 0,u)}await this.cacheStorage.saveCacheRecord(f,o.storeInCache,o.correlationId)}finally{this.persistencePlugin&&this.serializableCache&&g&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(g))}return Pc.generateAuthenticationResult(this.cryptoObj,n,f,!1,o,h,p,e,u)}generateCacheRecord(e,n,r,o,i,s,a){const c=n.getPreferredCache();if(!c)throw ke(Db);const u=ZD(i);let h,p;e.id_token&&i&&(h=Ub(this.homeAccountIdentifier,c,e.id_token,this.clientId,u||""),p=c_(this.cacheStorage,n,this.homeAccountIdentifier,this.cryptoObj.base64Decode,i,e.client_info,c,u,a,void 0,this.logger));let f=null;if(e.access_token){const y=e.scope?Nn.fromString(e.scope):new Nn(o.scopes||[]),b=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,C=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,S=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,E=r+b,I=E+C,T=S&&S>0?r+S:void 0;f=Fb(this.homeAccountIdentifier,c,e.access_token,this.clientId,u||n.tenant||"",y.printScopes(),E,I,this.cryptoObj.base64Decode,T,e.token_type,s,e.key_id,o.claims,o.requestedClaimsHash)}let g=null;if(e.refresh_token){let y;if(e.refresh_token_expires_in){const b=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;y=r+b}g=jD(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci,s,y)}let v=null;return e.foci&&(v={clientId:this.clientId,environment:c,familyId:e.foci}),{account:p,idToken:h,accessToken:f,refreshToken:g,appMetadata:v}}static async generateAuthenticationResult(e,n,r,o,i,s,a,c,u){var E,I,T,_,w;let h=oe.EMPTY_STRING,p=[],f=null,g,v,y=oe.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType===$t.POP&&!i.popKid){const A=new Nc(e),{secret:M,keyId:R}=r.accessToken;if(!R)throw ke(jb);h=await A.signPopToken(M,R,i)}else h=r.accessToken.secret;p=Nn.fromString(r.accessToken.target).asArray(),f=new Date(Number(r.accessToken.expiresOn)*1e3),g=new Date(Number(r.accessToken.extendedExpiresOn)*1e3),r.accessToken.refreshOn&&(v=new Date(Number(r.accessToken.refreshOn)*1e3))}r.appMetadata&&(y=r.appMetadata.familyId===Yh?Yh:"");const b=(s==null?void 0:s.oid)||(s==null?void 0:s.sub)||"",C=(s==null?void 0:s.tid)||"";c!=null&&c.spa_accountid&&r.account&&(r.account.nativeAccountId=c==null?void 0:c.spa_accountid);const S=r.account?r_(r.account.getAccountInfo(),void 0,s,(E=r.idToken)==null?void 0:E.secret):null;return{authority:n.canonicalAuthority,uniqueId:b,tenantId:C,scopes:p,account:S,idToken:((I=r==null?void 0:r.idToken)==null?void 0:I.secret)||"",idTokenClaims:s||{},accessToken:h,fromCache:o,expiresOn:f,extExpiresOn:g,refreshOn:v,correlationId:i.correlationId,requestId:u||oe.EMPTY_STRING,familyId:y,tokenType:((T=r.accessToken)==null?void 0:T.tokenType)||oe.EMPTY_STRING,state:a?a.userRequestState:oe.EMPTY_STRING,cloudGraphHostName:((_=r.account)==null?void 0:_.cloudGraphHostName)||oe.EMPTY_STRING,msGraphHost:((w=r.account)==null?void 0:w.msGraphHost)||oe.EMPTY_STRING,code:c==null?void 0:c.spa_code,fromNativeBroker:!1}}}function c_(t,e,n,r,o,i,s,a,c,u,h){h==null||h.verbose("setCachedAccount called");const f=t.getAccountKeys().find(C=>C.startsWith(n));let g=null;f&&(g=t.getAccount(f,h));const v=g||Kn.createAccount({homeAccountId:n,idTokenClaims:o,clientInfo:i,environment:s,cloudGraphHostName:c==null?void 0:c.cloud_graph_host_name,msGraphHost:c==null?void 0:c.msgraph_host,nativeAccountId:u},e,r),y=v.tenantProfiles||[],b=a||v.realm;if(b&&!y.find(C=>C.tenantId===b)){const C=n_(n,v.localAccountId,b,o);y.push(C)}return v.tenantProfiles=y,v}/*! @azure/msal-common v14.15.0 2024-09-20 */async function a3(t,e,n){return typeof t=="string"?t:t({clientId:e,tokenEndpoint:n})}/*! @azure/msal-common v14.15.0 2024-09-20 */class c3 extends s_{constructor(e,n){var r;super(e,n),this.includeRedirectUri=!0,this.oidcDefaultScopes=(r=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:r.defaultScopes}async getAuthCodeUrl(e){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(x.GetAuthCodeUrl,e.correlationId);const n=await Ue(this.createAuthCodeUrlQueryString.bind(this),x.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return At.appendQueryString(this.authority.authorizationEndpoint,n)}async acquireToken(e,n){var a,c;if((a=this.performanceClient)==null||a.addQueueMeasurement(x.AuthClientAcquireToken,e.correlationId),!e.code)throw ke(VT);const r=Ki(),o=await Ue(this.executeTokenRequest.bind(this),x.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=(c=o.headers)==null?void 0:c[Fi.X_MS_REQUEST_ID],s=new Pc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return s.validateTokenResponse(o.body),Ue(s.handleServerTokenResponse.bind(s),x.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,r,e,n,void 0,void 0,void 0,i)}handleFragmentResponse(e,n){if(new Pc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,n),!e.code)throw ke(WT);return e}getLogoutUri(e){if(!e)throw nn($D);const n=this.createLogoutUrlQueryString(e);return At.appendQueryString(this.authority.endSessionEndpoint,n)}async executeTokenRequest(e,n){var u,h;(u=this.performanceClient)==null||u.addQueueMeasurement(x.AuthClientExecuteTokenRequest,n.correlationId);const r=this.createTokenQueryParameters(n),o=At.appendQueryString(e.tokenEndpoint,r),i=await Ue(this.createTokenRequestBody.bind(this),x.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,n.correlationId)(n);let s;if(n.clientInfo)try{const p=Wg(n.clientInfo,this.cryptoUtils.base64Decode);s={credential:`${p.uid}${fr.CLIENT_INFO_SEPARATOR}${p.utid}`,type:uo.HOME_ACCOUNT_ID}}catch(p){this.logger.verbose("Could not parse client info for CCS Header: "+p)}const a=this.createTokenRequestHeaders(s||n.ccsCredential),c={clientId:((h=n.tokenBodyParameters)==null?void 0:h.clientId)||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:n.scopes,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid};return Ue(this.executePostToTokenEndpoint.bind(this),x.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,n.correlationId)(o,i,a,c,n.correlationId,x.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var i,s;(i=this.performanceClient)==null||i.addQueueMeasurement(x.AuthClientCreateTokenRequestBody,e.correlationId);const n=new Jh;if(n.addClientId(((s=e.tokenBodyParameters)==null?void 0:s[nd])||this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(e.redirectUri):Ql.validateRedirectUri(e.redirectUri),n.addScopes(e.scopes,!0,this.oidcDefaultScopes),n.addAuthorizationCode(e.code),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&!E1(this.config)&&n.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&n.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;n.addClientAssertion(await a3(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),n.addClientAssertionType(a.assertionType)}if(n.addGrantType(SD.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),e.authenticationScheme===$t.POP){const a=new Nc(this.cryptoUtils,this.performanceClient);let c;e.popKid?c=this.cryptoUtils.encodeKid(e.popKid):c=(await Ue(a.generateCnf.bind(a),x.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,n.addPopToken(c)}else if(e.authenticationScheme===$t.SSH)if(e.sshJwk)n.addSshJwk(e.sshJwk);else throw nn(Bb);const r=e.correlationId||this.config.cryptoInterface.createNewGuid();n.addCorrelationId(r),(!si.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities);let o;if(e.clientInfo)try{const a=Wg(e.clientInfo,this.cryptoUtils.base64Decode);o={credential:`${a.uid}${fr.CLIENT_INFO_SEPARATOR}${a.utid}`,type:uo.HOME_ACCOUNT_ID}}catch(a){this.logger.verbose("Could not parse client info for CCS Header: "+a)}else o=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&o)switch(o.type){case uo.HOME_ACCOUNT_ID:try{const a=lu(o.credential);n.addCcsOid(a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case uo.UPN:n.addCcsUpn(o.credential);break}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[Fx])&&n.addExtraQueryParameters({[Fx]:"1"}),n.createQueryString()}async createAuthCodeUrlQueryString(e){var i,s;(i=this.performanceClient)==null||i.addQueueMeasurement(x.AuthClientCreateQueryString,e.correlationId);const n=new Jh;n.addClientId(((s=e.extraQueryParameters)==null?void 0:s[nd])||this.config.authOptions.clientId);const r=[...e.scopes||[],...e.extraScopesToConsent||[]];n.addScopes(r,!0,this.oidcDefaultScopes),n.addRedirectUri(e.redirectUri);const o=e.correlationId||this.config.cryptoInterface.createNewGuid();if(n.addCorrelationId(o),n.addResponseMode(e.responseMode),n.addResponseTypeCode(),n.addLibraryInfo(this.config.libraryInfo),E1(this.config)||n.addApplicationTelemetry(this.config.telemetry.application),n.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&n.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&n.addPrompt(e.prompt),e.domainHint&&n.addDomainHint(e.domainHint),e.prompt!==nr.SELECT_ACCOUNT)if(e.sid&&e.prompt===nr.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),n.addSid(e.sid);else if(e.account){const a=this.extractAccountSid(e.account);let c=this.extractLoginHint(e.account);if(c&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),c=null),c){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),n.addLoginHint(c);try{const u=lu(e.account.homeAccountId);n.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(a&&e.prompt===nr.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),n.addSid(a);try{const u=lu(e.account.homeAccountId);n.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),n.addLoginHint(e.account.username);try{const u=lu(e.account.homeAccountId);n.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&n.addNonce(e.nonce),e.state&&n.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.addExtraQueryParams(e,n),e.nativeBroker&&(n.addNativeBroker(),e.authenticationScheme===$t.POP)){const a=new Nc(this.cryptoUtils);let c;e.popKid?c=this.cryptoUtils.encodeKid(e.popKid):c=(await Ue(a.generateCnf.bind(a),x.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,n.addPopToken(c)}return n.createQueryString()}createLogoutUrlQueryString(e){const n=new Jh;return e.postLogoutRedirectUri&&n.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&n.addCorrelationId(e.correlationId),e.idTokenHint&&n.addIdTokenHint(e.idTokenHint),e.state&&n.addState(e.state),e.logoutHint&&n.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,n),n.createQueryString()}addExtraQueryParams(e,n){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&n.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){var n;return((n=e.idTokenClaims)==null?void 0:n.sid)||null}extractLoginHint(e){var n;return((n=e.idTokenClaims)==null?void 0:n.login_hint)||null}}/*! @azure/msal-common v14.15.0 2024-09-20 */const Lte=300;class _1 extends s_{constructor(e,n){super(e,n)}async acquireToken(e){var s,a;(s=this.performanceClient)==null||s.addQueueMeasurement(x.RefreshTokenClientAcquireToken,e.correlationId);const n=Ki(),r=await Ue(this.executeTokenRequest.bind(this),x.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),o=(a=r.headers)==null?void 0:a[Fi.X_MS_REQUEST_ID],i=new Pc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(r.body),Ue(i.handleServerTokenResponse.bind(i),x.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,n,e,void 0,void 0,!0,e.forceCache,o)}async acquireTokenByRefreshToken(e){var r;if(!e)throw nn(VD);if((r=this.performanceClient)==null||r.addQueueMeasurement(x.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw ke(Lb);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await Ue(this.acquireTokenWithCachedRefreshToken.bind(this),x.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(o){const i=o instanceof Rr&&o.errorCode===Zg,s=o instanceof qi&&o.errorCode===wx.INVALID_GRANT_ERROR&&o.subError===wx.CLIENT_MISMATCH_ERROR;if(i||s)return Ue(this.acquireTokenWithCachedRefreshToken.bind(this),x.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw o}return Ue(this.acquireTokenWithCachedRefreshToken.bind(this),x.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,n){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(x.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const r=ll(this.cacheManager.getRefreshToken.bind(this.cacheManager),x.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,n,void 0,this.performanceClient,e.correlationId);if(!r)throw T1(Zg);if(r.expiresOn&&S1(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||Lte))throw T1(a_);const o={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||$t.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:uo.HOME_ACCOUNT_ID}};try{return await Ue(this.acquireToken.bind(this),x.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(o)}catch(s){if(s instanceof Rr&&s.subError===Vb){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const a=cu(r);this.cacheManager.removeRefreshToken(a)}throw s}}async executeTokenRequest(e,n){var c,u;(c=this.performanceClient)==null||c.addQueueMeasurement(x.RefreshTokenClientExecuteTokenRequest,e.correlationId);const r=this.createTokenQueryParameters(e),o=At.appendQueryString(n.tokenEndpoint,r),i=await Ue(this.createTokenRequestBody.bind(this),x.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),s=this.createTokenRequestHeaders(e.ccsCredential),a={clientId:((u=e.tokenBodyParameters)==null?void 0:u.clientId)||this.config.authOptions.clientId,authority:n.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return Ue(this.executePostToTokenEndpoint.bind(this),x.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(o,i,s,a,e.correlationId,x.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var o,i,s;(o=this.performanceClient)==null||o.addQueueMeasurement(x.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const n=e.correlationId,r=new Jh;if(r.addClientId(((i=e.tokenBodyParameters)==null?void 0:i[nd])||this.config.authOptions.clientId),e.redirectUri&&r.addRedirectUri(e.redirectUri),r.addScopes(e.scopes,!0,(s=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:s.defaultScopes),r.addGrantType(SD.REFRESH_TOKEN_GRANT),r.addClientInfo(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!E1(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),r.addCorrelationId(n),r.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;r.addClientAssertion(await a3(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),r.addClientAssertionType(a.assertionType)}if(e.authenticationScheme===$t.POP){const a=new Nc(this.cryptoUtils,this.performanceClient);let c;e.popKid?c=this.cryptoUtils.encodeKid(e.popKid):c=(await Ue(a.generateCnf.bind(a),x.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(c)}else if(e.authenticationScheme===$t.SSH)if(e.sshJwk)r.addSshJwk(e.sshJwk);else throw nn(Bb);if((!si.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case uo.HOME_ACCOUNT_ID:try{const a=lu(e.ccsCredential.credential);r.addCcsOid(a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case uo.UPN:r.addCcsUpn(e.ccsCredential.credential);break}return e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),r.createQueryString()}}/*! @azure/msal-common v14.15.0 2024-09-20 */class Dte extends s_{constructor(e,n){super(e,n)}async acquireToken(e){var n;try{const[r,o]=await this.acquireCachedToken({...e,scopes:(n=e.scopes)!=null&&n.length?e.scopes:[...va]});return o===Ys.PROACTIVELY_REFRESHED&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new _1(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})),r}catch(r){if(r instanceof Rd&&r.errorCode===ni)return new _1(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw r}}async acquireCachedToken(e){var c;(c=this.performanceClient)==null||c.addQueueMeasurement(x.SilentFlowClientAcquireCachedToken,e.correlationId);let n=Ys.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!si.isEmptyObj(e.claims))throw this.setCacheOutcome(Ys.FORCE_REFRESH_OR_CLAIMS,e.correlationId),ke(ni);if(!e.account)throw ke(Lb);const r=e.account.tenantId||_te(e.authority),o=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,o,r,this.performanceClient,e.correlationId);if(i){if(lee(i.cachedAt)||S1(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(Ys.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),ke(ni);i.refreshOn&&S1(i.refreshOn,0)&&(n=Ys.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(Ys.NO_CACHED_ACCESS_TOKEN,e.correlationId),ke(ni);const s=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,o,r,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(s)};return this.setCacheOutcome(n,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await Ue(this.generateResultFromCacheRecord.bind(this),x.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(a,e),n]}setCacheOutcome(e,n){var r,o;(r=this.serverTelemetryManager)==null||r.setCacheOutcome(e),(o=this.performanceClient)==null||o.addFields({cacheOutcome:e},n),e!==Ys.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,n){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(x.SilentFlowClientGenerateResultFromCacheRecord,n.correlationId);let r;if(e.idToken&&(r=cl(e.idToken.secret,this.config.cryptoInterface.base64Decode)),n.maxAge||n.maxAge===0){const i=r==null?void 0:r.auth_time;if(!i)throw ke(Ob);DD(i,n.maxAge)}return Pc.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,n,r)}}/*! @azure/msal-common v14.15.0 2024-09-20 */const jte={sendGetRequestAsync:()=>Promise.reject(ke(Ct)),sendPostRequestAsync:()=>Promise.reject(ke(Ct))};/*! @azure/msal-common v14.15.0 2024-09-20 */const zx=",",l3="|";function Ute(t){const{skus:e,libraryName:n,libraryVersion:r,extensionName:o,extensionVersion:i}=t,s=new Map([[0,[n,r]],[2,[o,i]]]);let a=[];if(e!=null&&e.length){if(a=e.split(zx),a.length<4)return e}else a=Array.from({length:4},()=>l3);return s.forEach((c,u)=>{var h,p;c.length===2&&((h=c[0])!=null&&h.length)&&((p=c[1])!=null&&p.length)&&Fte({skuArr:a,index:u,skuName:c[0],skuVersion:c[1]})}),a.join(zx)}function Fte(t){const{skuArr:e,index:n,skuName:r,skuVersion:o}=t;n>=e.length||(e[n]=[r,o].join(l3))}class Pf{constructor(e,n){this.cacheOutcome=Ys.NOT_APPLICABLE,this.cacheManager=n,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||oe.EMPTY_STRING,this.wrapperVer=e.wrapperVer||oe.EMPTY_STRING,this.telemetryCacheKey=sr.CACHE_KEY+fr.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${sr.VALUE_SEPARATOR}${this.cacheOutcome}`,n=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r!=null&&r.length&&n.push(`broker_error=${r}`);const o=n.join(sr.VALUE_SEPARATOR),i=this.getRegionDiscoveryFields(),s=[e,i].join(sr.VALUE_SEPARATOR);return[sr.SCHEMA_VERSION,s,o].join(sr.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),n=Pf.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*n).join(sr.VALUE_SEPARATOR),o=e.errors.slice(0,n).join(sr.VALUE_SEPARATOR),i=e.errors.length,s=n<i?sr.OVERFLOW_TRUE:sr.OVERFLOW_FALSE,a=[i,s].join(sr.VALUE_SEPARATOR);return[sr.SCHEMA_VERSION,e.cacheHits,r,o,a].join(sr.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const n=this.getLastRequests();n.errors.length>=sr.MAX_CACHED_ERRORS&&(n.failedRequests.shift(),n.failedRequests.shift(),n.errors.shift()),n.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof _t?e.subError?n.errors.push(e.subError):e.errorCode?n.errors.push(e.errorCode):n.errors.push(e.toString()):n.errors.push(e.toString()):n.errors.push(sr.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){const e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),n=Pf.maxErrorsToSend(e),r=e.errors.length;if(n===r)this.cacheManager.removeItem(this.telemetryCacheKey);else{const o={failedRequests:e.failedRequests.slice(n*2),errors:e.errors.slice(n),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)}}static maxErrorsToSend(e){let n,r=0,o=0;const i=e.errors.length;for(n=0;n<i;n++){const s=e.failedRequests[2*n]||oe.EMPTY_STRING,a=e.failedRequests[2*n+1]||oe.EMPTY_STRING,c=e.errors[n]||oe.EMPTY_STRING;if(o+=s.toString().length+a.toString().length+c.length+3,o<sr.MAX_LAST_HEADER_BYTES)r+=1;else break}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||oe.EMPTY_STRING),e.push(this.regionSource||oe.EMPTY_STRING),e.push(this.regionOutcome||oe.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const n=this.getLastRequests();n.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return Ute(e)}}/*! @azure/msal-common v14.15.0 2024-09-20 */const u3="missing_kid_error",d3="missing_alg_error";/*! @azure/msal-common v14.15.0 2024-09-20 */const Bte={[u3]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[d3]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class l_ extends _t{constructor(e,n){super(e,n),this.name="JoseHeaderError",Object.setPrototypeOf(this,l_.prototype)}}function Vx(t){return new l_(t,Bte[t])}/*! @azure/msal-common v14.15.0 2024-09-20 */class u_{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Vx(u3);if(!e.alg)throw Vx(d3);const n=new u_({typ:e.typ||iee.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(n)}}/*! @azure/msal-common v14.15.0 2024-09-20 */class w1{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class h3{generateId(){return"callback-id"}startMeasurement(e,n){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:I1.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:n||""},measurement:new w1}}startPerformanceMeasurement(){return new w1}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}/*! @azure/msal-common v14.15.0 2024-09-20 */function Hte(t,e,n){n&&n.push({name:e.get(t.name)||t.name})}function zte(t,e,n,r){if(!(n!=null&&n.length))return;const o=g=>g.length?g[g.length-1]:void 0,i=e.get(t.name)||t.name,s=o(n);if((s==null?void 0:s.name)!==i)return;const a=n==null?void 0:n.pop();if(!a)return;const c=r instanceof _t?r.errorCode:r instanceof Error?r.name:void 0,u=r instanceof _t?r.subError:void 0;c&&a.childErr!==c&&(a.err=c,u&&(a.subErr=u)),delete a.name,delete a.childErr;const h={...a,dur:t.durationMs};t.success||(h.fail=1);const p=o(n);if(!p)return{[i]:h};c&&(p.childErr=c);let f;if(!p[i])f=i;else{const g=Object.keys(p).filter(v=>v.startsWith(i)).length;f=`${i}_${g+1}`}return p[f]=h,p}function Vte(t,e,n,r=5){var o,i;if(t instanceof Error){if(t instanceof _t){n.errorCode=t.errorCode,n.subErrorCode=t.subError,(t instanceof qi||t instanceof Rr)&&(n.serverErrorNo=t.errorNo);return}else if(t instanceof pc){n.errorCode=t.errorCode;return}else if((o=n.errorStack)!=null&&o.length){e.trace("PerformanceClient.addErrorStack: Stack already exist",n.correlationId);return}else if(!((i=t.stack)!=null&&i.length)){e.trace("PerformanceClient.addErrorStack: Input stack is empty",n.correlationId);return}}else{e.trace("PerformanceClient.addErrorStack: Input error is not instance of Error",n.correlationId);return}t.stack&&(n.errorStack=$te(t.stack,r)),n.errorName=t.name}function $te(t,e){if(e<0)return[];const n=t.split(`
`)||[];if(n.length<2)return[];const r=[];for(let o=Math.max(n.length-e-1,1);o<n.length;o++){const i=n[o];if(r.length>=e)break;r.push(Gte(i))}return r}function Gte(t){const e=t.lastIndexOf(" ")+1;if(e<1)return t;const n=t.substring(e);let r=n.lastIndexOf("/");return r=r<0?n.lastIndexOf("\\"):r,r>=0?(t.substring(0,e)+"("+n.substring(r+1)+(n.charAt(n.length-1)===")"?"":")")).trimStart():t.trimStart()}class Kte{constructor(e,n,r,o,i,s,a,c){this.authority=n,this.libraryName=o,this.libraryVersion=i,this.applicationTelemetry=s,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.eventStack=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map,this.intFields=a||new Set;for(const u of Tte)this.intFields.add(u);this.abbreviations=c||new Map;for(const[u,h]of Ite)this.abbreviations.set(u,h)}startPerformanceMeasurement(e,n){return{}}getPreQueueTime(e,n){const r=this.preQueueTimeByCorrelationId.get(n);if(r){if(r.name!==e){this.logger.trace(`PerformanceClient.getPreQueueTime: no pre-queue time found for ${e}, unable to add queue measurement`);return}}else{this.logger.trace(`PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: ${n}, unable to add queue measurement`);return}return r.time}calculateQueuedTime(e,n){return e<1?(this.logger.trace(`PerformanceClient: preQueueTime should be a positive integer and not ${e}`),0):n<1?(this.logger.trace(`PerformanceClient: currentTime should be a positive integer and not ${n}`),0):n<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):n-e}addQueueMeasurement(e,n,r,o){if(!n){this.logger.trace(`PerformanceClient.addQueueMeasurement: correlationId not provided for ${e}, cannot add queue measurement`);return}if(r===0)this.logger.trace(`PerformanceClient.addQueueMeasurement: queue time provided for ${e} is ${r}`);else if(!r){this.logger.trace(`PerformanceClient.addQueueMeasurement: no queue time provided for ${e}`);return}const i={eventName:e,queueTime:o?0:r,manuallyCompleted:o},s=this.queueMeasurements.get(n);if(s)s.push(i),this.queueMeasurements.set(n,s);else{this.logger.trace(`PerformanceClient.addQueueMeasurement: adding correlationId ${n} to queue measurements`);const a=[i];this.queueMeasurements.set(n,a)}this.preQueueTimeByCorrelationId.delete(n)}startMeasurement(e,n){var i,s;const r=n||this.generateId();n||this.logger.info(`PerformanceClient: No correlation id provided for ${e}, generating`,r),this.logger.trace(`PerformanceClient: Performance measurement started for ${e}`,r);const o={eventId:this.generateId(),status:I1.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:r,appName:(i=this.applicationTelemetry)==null?void 0:i.appName,appVersion:(s=this.applicationTelemetry)==null?void 0:s.appVersion};return this.cacheEventByCorrelationId(o),Hte(o,this.abbreviations,this.eventStack.get(r)),{end:(a,c)=>this.endMeasurement({...o,...a},c),discard:()=>this.discardMeasurements(o.correlationId),add:a=>this.addFields(a,o.correlationId),increment:a=>this.incrementFields(a,o.correlationId),event:o,measurement:new w1}}endMeasurement(e,n){var u,h;const r=this.eventsByCorrelationId.get(e.correlationId);if(!r)return this.logger.trace(`PerformanceClient: Measurement not found for ${e.eventId}`,e.correlationId),null;const o=e.eventId===r.eventId;let i={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};e.durationMs=Math.round(e.durationMs||this.getDurationMs(e.startTimeMs));const s=JSON.stringify(zte(e,this.abbreviations,this.eventStack.get(r.correlationId),n));if(o?(i=this.getQueueInfo(e.correlationId),this.discardMeasurements(r.correlationId)):(u=r.incompleteSubMeasurements)==null||u.delete(e.eventId),this.logger.trace(`PerformanceClient: Performance measurement ended for ${e.name}: ${e.durationMs} ms`,e.correlationId),!o)return r[e.name+"DurationMs"]=Math.floor(e.durationMs),{...r};n&&Vte(n,this.logger,r);let a={...r,...e},c=0;return(h=a.incompleteSubMeasurements)==null||h.forEach(p=>{this.logger.trace(`PerformanceClient: Incomplete submeasurement ${p.name} found for ${e.name}`,a.correlationId),c++}),a.incompleteSubMeasurements=void 0,a={...a,queuedTimeMs:i.totalQueueTime,queuedCount:i.totalQueueCount,queuedManuallyCompletedCount:i.manuallyCompletedCount,status:I1.Completed,incompleteSubsCount:c,context:s},this.truncateIntegralFields(a),this.emitEvents([a],e.correlationId),a}addFields(e,n){this.logger.trace("PerformanceClient: Updating static fields");const r=this.eventsByCorrelationId.get(n);r?this.eventsByCorrelationId.set(n,{...r,...e}):this.logger.trace("PerformanceClient: Event not found for",n)}incrementFields(e,n){this.logger.trace("PerformanceClient: Updating counters");const r=this.eventsByCorrelationId.get(n);if(r)for(const o in e){if(!r.hasOwnProperty(o))r[o]=0;else if(isNaN(Number(r[o])))return;r[o]+=e[o]}else this.logger.trace("PerformanceClient: Event not found for",n)}cacheEventByCorrelationId(e){const n=this.eventsByCorrelationId.get(e.correlationId);n?(this.logger.trace(`PerformanceClient: Performance measurement for ${e.name} added/updated`,e.correlationId),n.incompleteSubMeasurements=n.incompleteSubMeasurements||new Map,n.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace(`PerformanceClient: Performance measurement for ${e.name} started`,e.correlationId),this.eventsByCorrelationId.set(e.correlationId,{...e}),this.eventStack.set(e.correlationId,[]))}getQueueInfo(e){const n=this.queueMeasurements.get(e);n||this.logger.trace(`PerformanceClient: no queue measurements found for for correlationId: ${e}`);let r=0,o=0,i=0;return n==null||n.forEach(s=>{r+=s.queueTime,o++,i+=s.manuallyCompleted?1:0}),{totalQueueTime:r,totalQueueCount:o,manuallyCompletedCount:i}}discardMeasurements(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e),this.logger.trace("PerformanceClient: Event stack discarded",e),this.eventStack.delete(e)}addPerformanceCallback(e){for(const[r,o]of this.callbacks)if(o.toString()===e.toString())return this.logger.warning(`PerformanceClient: Performance callback is already registered with id: ${r}`),r;const n=this.generateId();return this.callbacks.set(n,e),this.logger.verbose(`PerformanceClient: Performance callback registered with id: ${n}`),n}removePerformanceCallback(e){const n=this.callbacks.delete(e);return n?this.logger.verbose(`PerformanceClient: Performance callback ${e} removed.`):this.logger.verbose(`PerformanceClient: Performance callback ${e} not removed.`),n}emitEvents(e,n){this.logger.verbose("PerformanceClient: Emitting performance events",n),this.callbacks.forEach((r,o)=>{this.logger.trace(`PerformanceClient: Emitting event to callback ${o}`,n),r.apply(null,[e])})}truncateIntegralFields(e){this.intFields.forEach(n=>{n in e&&typeof e[n]=="number"&&(e[n]=Math.floor(e[n]))})}getDurationMs(e){const n=Date.now()-e;return n<0?n:0}}/*! @azure/msal-browser v3.26.1 2024-10-08 */const d_="pkce_not_created",f3="crypto_nonexistent",$b="empty_navigate_uri",p3="hash_empty_error",h_="no_state_in_hash",m3="hash_does_not_contain_known_properties",g3="unable_to_parse_state",v3="state_interaction_type_mismatch",b3="interaction_in_progress",y3="popup_window_error",C3="empty_window_error",Mc="user_cancelled",qte="monitor_popup_timeout",S3="monitor_window_timeout",E3="redirect_in_iframe",I3="block_iframe_reload",T3="block_nested_popups",Wte="iframe_closed_prematurely",Gb="silent_logout_unsupported",_3="no_account_error",Yte="silent_prompt_value_error",w3="no_token_request_cache_error",A3="unable_to_parse_token_request_cache_error",f_="no_cached_authority_error",Qte="auth_request_not_set_error",Jte="invalid_cache_type",p_="non_browser_environment",Jl="database_not_open",Xg="no_network_connectivity",k3="post_request_failed",x3="get_request_failed",A1="failed_to_parse_response",R3="unable_to_load_token",m_="crypto_key_not_found",N3="auth_code_required",P3="auth_code_or_nativeAccountId_required",M3="spa_code_and_nativeAccountId_present",g_="database_unavailable",O3="unable_to_acquire_token_from_native_platform",L3="native_handshake_timeout",D3="native_extension_not_installed",fp="native_connection_not_established",j3="uninitialized_public_client_application",U3="native_prompt_not_supported",F3="invalid_base64_string",B3="invalid_pop_token_request";/*! @azure/msal-browser v3.26.1 2024-10-08 */const os="For more visit: aka.ms/msaljs/browser-errors",Zte={[d_]:"The PKCE code challenge and verifier could not be generated.",[f3]:"The crypto object or function is not available.",[$b]:"Navigation URI is empty. Please check stack trace for more info.",[p3]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${os}`,[h_]:"Hash does not contain state. Please verify that the request originated from msal.",[m3]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${os}`,[g3]:"Unable to parse state. Please verify that the request originated from msal.",[v3]:"Hash contains state but the interaction type does not match the caller.",[b3]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${os}`,[y3]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[C3]:"window.open returned null or undefined window object.",[Mc]:"User cancelled the flow.",[qte]:`Token acquisition in popup failed due to timeout.  ${os}`,[S3]:`Token acquisition in iframe failed due to timeout.  ${os}`,[E3]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[I3]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${os}`,[T3]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[Wte]:"The iframe being monitored was closed prematurely.",[Gb]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[_3]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[Yte]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[w3]:"No token request found in cache.",[A3]:"The cached token request could not be parsed.",[f_]:"No cached authority found.",[Qte]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[Jte]:"Invalid cache type",[p_]:"Login and token requests are not supported in non-browser environments.",[Jl]:"Database is not open!",[Xg]:"No network connectivity. Check your internet connection.",[k3]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[x3]:"Network request failed. Please check the network trace to determine root cause.",[A1]:"Failed to parse network response. Check network trace.",[R3]:"Error loading token to cache.",[m_]:"Cryptographic Key or Keypair not found in browser storage.",[N3]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[P3]:"An authorization code or nativeAccountId must be provided to this flow.",[M3]:"Request cannot contain both spa code and native account id.",[g_]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[O3]:`Unable to acquire token from native platform.  ${os}`,[L3]:"Timed out while attempting to establish connection to browser extension",[D3]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[fp]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${os}`,[j3]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${os}`,[U3]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[F3]:"Invalid base64 encoded string.",[B3]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true."};class Nd extends _t{constructor(e){super(e,Zte[e]),Object.setPrototypeOf(this,Nd.prototype),this.name="BrowserAuthError"}}function Ze(t){return new Nd(t)}/*! @azure/msal-browser v3.26.1 2024-10-08 */const co={INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},uu={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},ac={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},wn={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},$x={GET:"GET",POST:"POST"},Yt={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},Hs={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},im={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},pn={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var Ae;(function(t){t.Redirect="redirect",t.Popup="popup",t.Silent="silent",t.None="none"})(Ae||(Ae={}));const Gx={scopes:va},H3="jwk",k1="msal.db",Xte=1,ene=`${k1}.keys`,Vn={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},tne=[Vn.Default,Vn.Skip,Vn.RefreshTokenAndNetwork],nne="msal.browser.log.level",rne="msal.browser.log.pii",one="msal.browser.performance.enabled";/*! @azure/msal-browser v3.26.1 2024-10-08 */function sm(t){return encodeURIComponent(v_(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Kb(t){return z3(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function v_(t){return z3(new TextEncoder().encode(t))}function z3(t){const e=Array.from(t,n=>String.fromCodePoint(n)).join("");return btoa(e)}/*! @azure/msal-browser v3.26.1 2024-10-08 */const ine="RSASSA-PKCS1-v1_5",V3="SHA-256",sne=2048,ane=new Uint8Array([1,0,1]),Kx="0123456789abcdef",qx=new Uint32Array(1),b_={name:ine,hash:V3,modulusLength:sne,publicExponent:ane};function cne(t){if("crypto"in window)t.verbose("BrowserCrypto: modern crypto interface available");else throw t.error("BrowserCrypto: crypto interface is unavailable"),Ze(f3)}async function $3(t,e,n){e==null||e.addQueueMeasurement(x.Sha256Digest,n);const o=new TextEncoder().encode(t);return window.crypto.subtle.digest(V3,o)}function lne(t){return window.crypto.getRandomValues(t)}function FC(){return window.crypto.getRandomValues(qx),qx[0]}function Wi(){const t=Date.now(),e=FC()*1024+(FC()&1023),n=new Uint8Array(16),r=Math.trunc(e/2**30),o=e&2**30-1,i=FC();n[0]=t/2**40,n[1]=t/2**32,n[2]=t/2**24,n[3]=t/2**16,n[4]=t/2**8,n[5]=t,n[6]=112|r>>>8,n[7]=r,n[8]=128|o>>>24,n[9]=o>>>16,n[10]=o>>>8,n[11]=o,n[12]=i>>>24,n[13]=i>>>16,n[14]=i>>>8,n[15]=i;let s="";for(let a=0;a<n.length;a++)s+=Kx.charAt(n[a]>>>4),s+=Kx.charAt(n[a]&15),(a===3||a===5||a===7||a===9)&&(s+="-");return s}async function une(t,e){return window.crypto.subtle.generateKey(b_,t,e)}async function BC(t){return window.crypto.subtle.exportKey(H3,t)}async function dne(t,e,n){return window.crypto.subtle.importKey(H3,t,b_,e,n)}async function hne(t,e){return window.crypto.subtle.sign(b_,t,e)}async function G3(t){const e=await $3(t),n=new Uint8Array(e);return Kb(n)}/*! @azure/msal-browser v3.26.1 2024-10-08 */const K3="storage_not_supported",fne="stubbed_public_client_application_called",q3="in_mem_redirect_unavailable";/*! @azure/msal-browser v3.26.1 2024-10-08 */const pne={[K3]:"Given storage configuration option was not supported.",[fne]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[q3]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class qb extends _t{constructor(e,n){super(e,n),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,qb.prototype)}}function W3(t){return new qb(t,pne[t])}/*! @azure/msal-browser v3.26.1 2024-10-08 */function mne(t){t.location.hash="",typeof t.history.replaceState=="function"&&t.history.replaceState(null,"",`${t.location.origin}${t.location.pathname}${t.location.search}`)}function gne(t){const e=t.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function y_(){return window.parent!==window}function vne(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${co.POPUP_NAME_PREFIX}.`)===0}function ri(){return window.location.href.split("?")[0].split("#")[0]}function bne(){const e=new At(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function yne(){if(At.hashContainsKnownProperties(window.location.hash)&&y_())throw Ze(I3)}function Cne(t){if(y_()&&!t)throw Ze(E3)}function Sne(){if(vne())throw Ze(T3)}function Y3(){if(typeof window>"u")throw Ze(p_)}function C_(t){if(!t)throw Ze(j3)}function gs(t){Y3(),yne(),Sne(),C_(t)}function Wx(t,e){if(gs(t),Cne(e.system.allowRedirectInIframe),e.cache.cacheLocation===wn.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw W3(q3)}function Q3(t){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(t).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function No(){return Wi()}/*! @azure/msal-browser v3.26.1 2024-10-08 */class ev{navigateInternal(e,n){return ev.defaultNavigateWindow(e,n)}navigateExternal(e,n){return ev.defaultNavigateWindow(e,n)}static defaultNavigateWindow(e,n){return n.noHistory?window.location.replace(e):window.location.assign(e),new Promise(r=>{setTimeout(()=>{r(!0)},n.timeout)})}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class Ene{async sendGetRequestAsync(e,n){let r;try{r=await fetch(e,{method:$x.GET,headers:this.getFetchHeaders(n)})}catch{throw window.navigator.onLine?Ze(x3):Ze(Xg)}try{return{headers:this.getHeaderDict(r.headers),body:await r.json(),status:r.status}}catch{throw Ze(A1)}}async sendPostRequestAsync(e,n){const r=n&&n.body||oe.EMPTY_STRING;let o;try{o=await fetch(e,{method:$x.POST,headers:this.getFetchHeaders(n),body:r})}catch{throw window.navigator.onLine?Ze(k3):Ze(Xg)}try{return{headers:this.getHeaderDict(o.headers),body:await o.json(),status:o.status}}catch{throw Ze(A1)}}getFetchHeaders(e){const n=new Headers;if(!(e&&e.headers))return n;const r=e.headers;return Object.keys(r).forEach(o=>{n.append(o,r[o])}),n}getHeaderDict(e){const n={};return e.forEach((r,o)=>{n[o]=r}),n}}/*! @azure/msal-browser v3.26.1 2024-10-08 */const Ine=6e4,tv=1e4,Tne=3e4,_ne=2e3;function wne({auth:t,cache:e,system:n,telemetry:r},o){const i={clientId:oe.EMPTY_STRING,authority:`${oe.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:oe.EMPTY_STRING,authorityMetadata:oe.EMPTY_STRING,redirectUri:oe.EMPTY_STRING,postLogoutRedirectUri:oe.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:ms.AAD,OIDCOptions:{serverResponseType:hp.FRAGMENT,defaultScopes:[oe.OPENID_SCOPE,oe.PROFILE_SCOPE,oe.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:Nf.None,tenant:oe.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},s={cacheLocation:wn.SessionStorage,temporaryCacheLocation:wn.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===wn.LocalStorage),claimsBasedCachingEnabled:!1},a={loggerCallback:()=>{},logLevel:bn.Info,piiLoggingEnabled:!1},u={...{...r3,loggerOptions:a,networkClient:o?new Ene:jte,navigationClient:new ev,loadFrameTimeout:0,windowHashTimeout:(n==null?void 0:n.loadFrameTimeout)||Ine,iframeHashTimeout:(n==null?void 0:n.loadFrameTimeout)||tv,navigateFrameWait:0,redirectNavigationTimeout:Tne,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(n==null?void 0:n.nativeBrokerHandshakeTimeout)||_ne,pollIntervalMilliseconds:co.DEFAULT_POLL_INTERVAL_MS},...n,loggerOptions:(n==null?void 0:n.loggerOptions)||a},h={application:{appName:oe.EMPTY_STRING,appVersion:oe.EMPTY_STRING},client:new h3};if((t==null?void 0:t.protocolMode)!==ms.OIDC&&(t!=null&&t.OIDCOptions)&&new di(u.loggerOptions).warning(JSON.stringify(nn(YD))),t!=null&&t.protocolMode&&t.protocolMode!==ms.AAD&&(u!=null&&u.allowNativeBroker))throw nn(QD);return{auth:{...i,...t,OIDCOptions:{...i.OIDCOptions,...t==null?void 0:t.OIDCOptions}},cache:{...s,...e},system:u,telemetry:{...h,...r}}}/*! @azure/msal-browser v3.26.1 2024-10-08 */const nv="@azure/msal-browser",Oc="3.26.1";/*! @azure/msal-browser v3.26.1 2024-10-08 */class S_{static loggerCallback(e,n){switch(e){case bn.Error:console.error(n);return;case bn.Info:console.info(n);return;case bn.Verbose:console.debug(n);return;case bn.Warning:console.warn(n);return;default:console.log(n);return}}constructor(e){var c;this.browserEnvironment=typeof window<"u",this.config=wne(e,this.browserEnvironment);let n;try{n=window[wn.SessionStorage]}catch{}const r=n==null?void 0:n.getItem(nne),o=(c=n==null?void 0:n.getItem(rne))==null?void 0:c.toLowerCase(),i=o==="true"?!0:o==="false"?!1:void 0,s={...this.config.system.loggerOptions},a=r&&Object.keys(bn).includes(r)?bn[r]:void 0;a&&(s.loggerCallback=S_.loggerCallback,s.logLevel=a),i!==void 0&&(s.piiLoggingEnabled=i),this.logger=new di(s,nv,Oc),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class Lc extends S_{getModuleName(){return Lc.MODULE_NAME}getId(){return Lc.ID}async initialize(){return this.available=typeof window<"u",this.available}}Lc.MODULE_NAME="";Lc.ID="StandardOperatingContext";/*! @azure/msal-browser v3.26.1 2024-10-08 */function Vi(t){return new TextDecoder().decode(Ane(t))}function Ane(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw Ze(F3)}const n=atob(e);return Uint8Array.from(n,r=>r.codePointAt(0)||0)}/*! @azure/msal-browser v3.26.1 2024-10-08 */class kne{constructor(){this.dbName=k1,this.version=Xte,this.tableName=ene,this.dbOpen=!1}async open(){return new Promise((e,n)=>{const r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",o=>{o.target.result.createObjectStore(this.tableName)}),r.addEventListener("success",o=>{const i=o;this.db=i.target.result,this.dbOpen=!0,e()}),r.addEventListener("error",()=>n(Ze(g_)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(Ze(Jl));const s=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);s.addEventListener("success",a=>{const c=a;this.closeConnection(),n(c.target.result)}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async setItem(e,n){return await this.validateDbIsOpen(),new Promise((r,o)=>{if(!this.db)return o(Ze(Jl));const a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(n,e);a.addEventListener("success",()=>{this.closeConnection(),r()}),a.addEventListener("error",c=>{this.closeConnection(),o(c)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(Ze(Jl));const s=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);s.addEventListener("success",()=>{this.closeConnection(),n()}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,n)=>{if(!this.db)return n(Ze(Jl));const i=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();i.addEventListener("success",s=>{const a=s;this.closeConnection(),e(a.target.result)}),i.addEventListener("error",s=>{this.closeConnection(),n(s)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(Ze(Jl));const s=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);s.addEventListener("success",a=>{const c=a;this.closeConnection(),n(c.target.result===1)}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,n)=>{const r=window.indexedDB.deleteDatabase(k1),o=setTimeout(()=>n(!1),200);r.addEventListener("success",()=>(clearTimeout(o),e(!0))),r.addEventListener("blocked",()=>(clearTimeout(o),e(!0))),r.addEventListener("error",()=>(clearTimeout(o),n(!1)))})}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class rv{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,n){this.cache.set(e,n)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((n,r)=>{e.push(r)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class xne{constructor(e){this.inMemoryCache=new rv,this.indexedDBCache=new kne,this.logger=e}handleDatabaseAccessError(e){if(e instanceof Nd&&e.errorCode===g_)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const n=this.inMemoryCache.getItem(e);if(!n)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(r){this.handleDatabaseAccessError(r)}return n}async setItem(e,n){this.inMemoryCache.setItem(e,n);try{await this.indexedDBCache.setItem(e,n)}catch(r){this.handleDatabaseAccessError(r)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(n){this.handleDatabaseAccessError(n)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(n){this.handleDatabaseAccessError(n)}return e}async containsKey(e){const n=this.inMemoryCache.containsKey(e);if(!n)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(r){this.handleDatabaseAccessError(r)}return n}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class Dc{constructor(e,n){this.logger=e,cne(e),this.cache=new xne(this.logger),this.performanceClient=n}createNewGuid(){return Wi()}base64Encode(e){return v_(e)}base64Decode(e){return Vi(e)}base64UrlEncode(e){return sm(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var h;const n=(h=this.performanceClient)==null?void 0:h.startMeasurement(x.CryptoOptsGetPublicKeyThumbprint,e.correlationId),r=await une(Dc.EXTRACTABLE,Dc.POP_KEY_USAGES),o=await BC(r.publicKey),i={e:o.e,kty:o.kty,n:o.n},s=Yx(i),a=await this.hashString(s),c=await BC(r.privateKey),u=await dne(c,!1,["sign"]);return await this.cache.setItem(a,{privateKey:u,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),n&&n.end({success:!0}),a}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,n,r,o){var E;const i=(E=this.performanceClient)==null?void 0:E.startMeasurement(x.CryptoOptsSignJwt,o),s=await this.cache.getItem(n);if(!s)throw Ze(m_);const a=await BC(s.publicKey),c=Yx(a),u=sm(JSON.stringify({kid:n})),h=u_.getShrHeaderString({...r==null?void 0:r.header,alg:a.alg,kid:u}),p=sm(h);e.cnf={jwk:JSON.parse(c)};const f=sm(JSON.stringify(e)),g=`${p}.${f}`,y=new TextEncoder().encode(g),b=await hne(s.privateKey,y),C=Kb(new Uint8Array(b)),S=`${g}.${C}`;return i&&i.end({success:!0}),S}async hashString(e){return G3(e)}}Dc.POP_KEY_USAGES=["sign","verify"];Dc.EXTRACTABLE=!0;function Yx(t){return JSON.stringify(t,Object.keys(t).sort())}/*! @azure/msal-browser v3.26.1 2024-10-08 */class ov{constructor(e){this.validateWindowStorage(e),this.windowStorage=window[e]}validateWindowStorage(e){if(e!==wn.LocalStorage&&e!==wn.SessionStorage||!window[e])throw W3(K3)}getItem(e){return this.windowStorage.getItem(e)}setItem(e,n){this.windowStorage.setItem(e,n)}removeItem(e){this.windowStorage.removeItem(e)}getKeys(){return Object.keys(this.windowStorage)}containsKey(e){return this.windowStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.26.1 2024-10-08 */function J3(t,e){if(!e)return null;try{return ai.parseRequestState(t,e).libraryState.meta}catch{throw ke(Rc)}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class x1 extends td{constructor(e,n,r,o,i,s){super(e,r,o,i),this.COOKIE_LIFE_MULTIPLIER=24*60*60*1e3,this.cacheConfig=n,this.logger=o,this.internalStorage=new rv,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupTemporaryCacheStorage(this.cacheConfig.temporaryCacheLocation,this.cacheConfig.cacheLocation),n.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=s}setupBrowserStorage(e){switch(e){case wn.LocalStorage:case wn.SessionStorage:try{return new ov(e)}catch(n){this.logger.verbose(n);break}}return this.cacheConfig.cacheLocation=wn.MemoryStorage,new rv}setupTemporaryCacheStorage(e,n){switch(n){case wn.LocalStorage:case wn.SessionStorage:try{return new ov(e||wn.SessionStorage)}catch(r){return this.logger.verbose(r),this.internalStorage}case wn.MemoryStorage:default:return this.internalStorage}}migrateCacheEntries(){const e=`${oe.CACHE_PREFIX}.${Jn.ID_TOKEN}`,n=`${oe.CACHE_PREFIX}.${Jn.CLIENT_INFO}`,r=`${oe.CACHE_PREFIX}.${Jn.ERROR}`,o=`${oe.CACHE_PREFIX}.${Jn.ERROR_DESC}`,i=this.browserStorage.getItem(e),s=this.browserStorage.getItem(n),a=this.browserStorage.getItem(r),c=this.browserStorage.getItem(o),u=[i,s,a,c];[Jn.ID_TOKEN,Jn.CLIENT_INFO,Jn.ERROR,Jn.ERROR_DESC].forEach((p,f)=>{const g=u[f];g&&this.setTemporaryCache(p,g,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.getItem(Hs.ACCOUNT_KEYS),n=this.getItem(`${Hs.TOKEN_KEYS}.${this.clientId}`);if(e&&n){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}this.browserStorage.getKeys().forEach(o=>{if(this.isCredentialKey(o)){const i=this.getItem(o);if(i){const s=this.validateAndParseJson(i);if(s&&s.hasOwnProperty("credentialType"))switch(s.credentialType){case ft.ID_TOKEN:if(Rx(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${o} found, saving key to token key map`);const a=s,c=this.updateCredentialCacheKey(o,a);this.addTokenKey(c,ft.ID_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${o}`);break;case ft.ACCESS_TOKEN:case ft.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(xx(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${o} found, saving key to token key map`);const a=s,c=this.updateCredentialCacheKey(o,a);this.addTokenKey(c,ft.ACCESS_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${o}`);break;case ft.REFRESH_TOKEN:if(Nx(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${o} found, saving key to token key map`);const a=s,c=this.updateCredentialCacheKey(o,a);this.addTokenKey(c,ft.REFRESH_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${o}`);break}}}if(this.isAccountKey(o)){const i=this.getItem(o);if(i){const s=this.validateAndParseJson(i);s&&Kn.isAccountEntity(s)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${o} found, saving key to account key map`),this.addAccountKeyToMap(o))}}})}validateAndParseJson(e){try{const n=JSON.parse(e);return n&&typeof n=="object"?n:null}catch{return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,n){this.browserStorage.setItem(e,n)}getAccount(e,n){this.logger.trace("BrowserCacheManager.getAccount called");const r=this.getCachedAccountEntity(e);return this.updateOutdatedCachedAccount(e,r,n)}getCachedAccountEntity(e){const n=this.getItem(e);if(!n)return this.removeAccountKeyFromMap(e),null;const r=this.validateAndParseJson(n);return!r||!Kn.isAccountEntity(r)?(this.removeAccountKeyFromMap(e),null):td.toObject(new Kn,r)}setAccount(e){this.logger.trace("BrowserCacheManager.setAccount called");const n=e.generateAccountKey();this.setItem(n,JSON.stringify(e)),this.addAccountKeyToMap(n)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(Hs.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const n=this.getAccountKeys();n.indexOf(e)===-1?(n.push(e),this.setItem(Hs.ACCOUNT_KEYS,JSON.stringify(n)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const n=this.getAccountKeys(),r=n.indexOf(e);r>-1?(n.splice(r,1),this.setItem(Hs.ACCOUNT_KEYS,JSON.stringify(n)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}removeOutdatedAccount(e){this.removeItem(e),this.removeAccountKeyFromMap(e)}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,ft.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,ft.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,ft.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem(`${Hs.TOKEN_KEYS}.${this.clientId}`);if(e){const n=this.validateAndParseJson(e);if(n&&n.hasOwnProperty("idToken")&&n.hasOwnProperty("accessToken")&&n.hasOwnProperty("refreshToken"))return n;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(e,n){this.logger.trace("BrowserCacheManager addTokenKey called");const r=this.getTokenKeys();switch(n){case ft.ID_TOKEN:r.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case ft.ACCESS_TOKEN:r.accessToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case ft.REFRESH_TOKEN:r.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${n}`),ke(Kg)}this.setItem(`${Hs.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(r))}removeTokenKey(e,n){this.logger.trace("BrowserCacheManager removeTokenKey called");const r=this.getTokenKeys();switch(n){case ft.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const o=r.idToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case ft.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const i=r.accessToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case ft.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const s=r.refreshToken.indexOf(e);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${n}`),ke(Kg)}this.setItem(`${Hs.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(r))}getIdTokenCredential(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,ft.ID_TOKEN),null;const r=this.validateAndParseJson(n);return!r||!Rx(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,ft.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r)}setIdTokenCredential(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const n=cu(e);this.setItem(n,JSON.stringify(e)),this.addTokenKey(n,ft.ID_TOKEN)}getAccessTokenCredential(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,ft.ACCESS_TOKEN),null;const r=this.validateAndParseJson(n);return!r||!xx(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,ft.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r)}setAccessTokenCredential(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const n=cu(e);this.setItem(n,JSON.stringify(e)),this.addTokenKey(n,ft.ACCESS_TOKEN)}getRefreshTokenCredential(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,ft.REFRESH_TOKEN),null;const r=this.validateAndParseJson(n);return!r||!Nx(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,ft.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r)}setRefreshTokenCredential(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const n=cu(e);this.setItem(n,JSON.stringify(e)),this.addTokenKey(n,ft.REFRESH_TOKEN)}getAppMetadata(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(n);return!r||!bee(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const n=vee(e);this.setItem(n,JSON.stringify(e))}getServerTelemetry(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(n);return!r||!mee(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r)}setServerTelemetry(e,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(n))}getAuthorityMetadata(e){const n=this.internalStorage.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(n);return r&&yee(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(n=>this.isAuthorityMetadata(n))}setWrapperMetadata(e,n){this.internalStorage.setItem(im.WRAPPER_SKU,e),this.internalStorage.setItem(im.WRAPPER_VER,n)}getWrapperMetadata(){const e=this.internalStorage.getItem(im.WRAPPER_SKU)||oe.EMPTY_STRING,n=this.internalStorage.getItem(im.WRAPPER_VER)||oe.EMPTY_STRING;return[e,n]}setAuthorityMetadata(e,n){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(n))}getActiveAccount(){const e=this.generateCacheKey(Jn.ACTIVE_ACCOUNT_FILTERS),n=this.getItem(e);if(!n){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const o=this.generateCacheKey(Jn.ACTIVE_ACCOUNT),i=this.getItem(o);if(!i)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const s=this.getAccountInfoFilteredBy({localAccountId:i});return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(s),s):null}const r=this.validateAndParseJson(n);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const n=this.generateCacheKey(Jn.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(Jn.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");const o={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(n,JSON.stringify(o)),this.browserStorage.setItem(r,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n),this.browserStorage.removeItem(r)}getThrottlingCache(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(n);return!r||!gee(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r)}setThrottlingCache(e,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(n))}getTemporaryCache(e,n){const r=n?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const i=this.getItemCookie(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),i}const o=this.temporaryCacheStorage.getItem(r);if(!o){if(this.cacheConfig.cacheLocation===wn.LocalStorage){const i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o}setTemporaryCache(e,n,r){const o=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(o,n),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(o,n))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach(e=>{(e.indexOf(oe.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{(e.indexOf(oe.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(e)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,n){e.addQueueMeasurement(x.ClearTokensAndKeysWithClaims,n);const r=this.getTokenKeys(),o=[];r.accessToken.forEach(i=>{const s=this.getAccessTokenCredential(i);s!=null&&s.requestedClaimsHash&&i.includes(s.requestedClaimsHash.toLowerCase())&&o.push(this.removeAccessToken(i))}),await Promise.all(o),o.length>0&&this.logger.warning(`${o.length} access tokens with claims in the cache keys have been removed from the cache.`)}setItemCookie(e,n,r){let o=`${encodeURIComponent(e)}=${encodeURIComponent(n)};path=/;SameSite=Lax;`;if(r){const i=this.getCookieExpirationTime(r);o+=`expires=${i};`}this.cacheConfig.secureCookies&&(o+="Secure;"),document.cookie=o}getItemCookie(e){const n=`${encodeURIComponent(e)}=`,r=document.cookie.split(";");for(let o=0;o<r.length;o++){let i=r[o];for(;i.charAt(0)===" ";)i=i.substring(1);if(i.indexOf(n)===0)return decodeURIComponent(i.substring(n.length,i.length))}return oe.EMPTY_STRING}clearMsalCookies(){const e=`${oe.CACHE_PREFIX}.${this.clientId}`;document.cookie.split(";").forEach(r=>{for(;r.charAt(0)===" ";)r=r.substring(1);if(r.indexOf(e)===0){const o=r.split("=")[0];this.clearItemCookie(o)}})}clearItemCookie(e){this.setItemCookie(e,oe.EMPTY_STRING,-1)}getCookieExpirationTime(e){const n=new Date;return new Date(n.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):si.startsWith(e,oe.CACHE_PREFIX)||si.startsWith(e,Jn.ADAL_ID_TOKEN)?e:`${oe.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:n}}=ai.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Yt.AUTHORITY}.${n}`)}generateNonceKey(e){const{libraryState:{id:n}}=ai.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Yt.NONCE_IDTOKEN}.${n}`)}generateStateKey(e){const{libraryState:{id:n}}=ai.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Yt.REQUEST_STATE}.${n}`)}getCachedAuthority(e){const n=this.generateStateKey(e),r=this.getTemporaryCache(n);if(!r)return null;const o=this.generateAuthorityKey(r);return this.getTemporaryCache(o)}updateCacheEntries(e,n,r,o,i){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const s=this.generateStateKey(e);this.setTemporaryCache(s,e,!1);const a=this.generateNonceKey(e);this.setTemporaryCache(a,n,!1);const c=this.generateAuthorityKey(e);if(this.setTemporaryCache(c,r,!1),i){const u={credential:i.homeAccountId,type:uo.HOME_ACCOUNT_ID};this.setTemporaryCache(Yt.CCS_CREDENTIAL,JSON.stringify(u),!0)}else if(o){const u={credential:o,type:uo.UPN};this.setTemporaryCache(Yt.CCS_CREDENTIAL,JSON.stringify(u),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(n=>{n.indexOf(e)!==-1&&this.removeTemporaryItem(n)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(Yt.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(Yt.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(Yt.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(Yt.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(Yt.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(Yt.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const n=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(n);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r||oe.EMPTY_STRING)}this.clearMsalCookies()}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(n=>{if(n.indexOf(Yt.REQUEST_STATE)===-1)return;const r=this.temporaryCacheStorage.getItem(n);if(!r)return;const o=J3(this.cryptoImpl,r);o&&o.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r))}),this.clearMsalCookies(),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const n=v_(JSON.stringify(e));this.setTemporaryCache(Yt.REQUEST_PARAMS,n,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const n=this.getTemporaryCache(Yt.REQUEST_PARAMS,!0);if(!n)throw Ze(w3);let r;try{r=JSON.parse(Vi(n))}catch(o){throw this.logger.errorPii(`Attempted to parse: ${n}`),this.logger.error(`Parsing cached token request threw with error: ${o}`),Ze(A3)}if(this.removeTemporaryItem(this.generateCacheKey(Yt.REQUEST_PARAMS)),!r.authority){const o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw Ze(f_);r.authority=i}return r}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(Yt.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const n=this.validateAndParseJson(e);return n||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const n=this.getInteractionInProgress();return e?n===this.clientId:!!n}getInteractionInProgress(){const e=`${oe.CACHE_PREFIX}.${Yt.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const n=`${oe.CACHE_PREFIX}.${Yt.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw Ze(b3);this.setTemporaryCache(n,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(n)}getLegacyLoginHint(){const e=this.getTemporaryCache(Jn.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(Jn.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const n=this.getTemporaryCache(Jn.ID_TOKEN,!0);n&&(this.browserStorage.removeItem(this.generateCacheKey(Jn.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const r=n||e;if(r){const o=cl(r,Vi);if(o.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),o.preferred_username;if(o.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),o.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,n){const r=cu(n);if(e!==r){const o=this.getItem(e);if(o)return this.browserStorage.removeItem(e),this.setItem(r,o),this.logger.verbose(`Updated an outdated ${n.credentialType} cache key`),r;this.logger.error(`Attempted to update an outdated ${n.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}async hydrateCache(e,n){var a,c,u;const r=Ub((a=e.account)==null?void 0:a.homeAccountId,(c=e.account)==null?void 0:c.environment,e.idToken,this.clientId,e.tenantId);let o;n.claims&&(o=await this.cryptoImpl.hashString(n.claims));const i=Fb((u=e.account)==null?void 0:u.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,Vi,void 0,e.tokenType,void 0,n.sshKid,n.claims,o),s={idToken:r,accessToken:i};return this.saveCacheRecord(s)}async saveCacheRecord(e,n,r){try{await super.saveCacheRecord(e,n,r)}catch(o){if(o instanceof pc&&this.performanceClient&&r)try{const i=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:i.refreshToken.length,cacheIdCount:i.idToken.length,cacheAtCount:i.accessToken.length},r)}catch{}throw o}}}const Rne=(t,e)=>{const n={cacheLocation:wn.MemoryStorage,temporaryCacheLocation:wn.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new x1(t,n,qg,e)};/*! @azure/msal-browser v3.26.1 2024-10-08 */function Nne(t,e,n,r){return t.verbose("getAllAccounts called"),n?e.getAllAccounts(r):[]}function Pne(t,e,n){if(e.trace("getAccount called"),Object.keys(t).length===0)return e.warning("getAccount: No accountFilter provided"),null;const r=n.getAccountInfoFilteredBy(t);return r?(e.verbose("getAccount: Account matching provided filter found, returning"),r):(e.verbose("getAccount: No matching account found, returning null"),null)}function Mne(t,e,n){if(e.trace("getAccountByUsername called"),!t)return e.warning("getAccountByUsername: No username provided"),null;const r=n.getAccountInfoFilteredBy({username:t});return r?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${t}`),r):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function One(t,e,n){if(e.trace("getAccountByHomeId called"),!t)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const r=n.getAccountInfoFilteredBy({homeAccountId:t});return r?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${t}`),r):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function Lne(t,e,n){if(e.trace("getAccountByLocalId called"),!t)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const r=n.getAccountInfoFilteredBy({localAccountId:t});return r?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${t}`),r):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function Dne(t,e){e.setActiveAccount(t)}function jne(t){return t.getActiveAccount()}/*! @azure/msal-browser v3.26.1 2024-10-08 */const ae={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};/*! @azure/msal-browser v3.26.1 2024-10-08 */class Z3{constructor(e){this.eventCallbacks=new Map,this.logger=e||new di({})}addEventCallback(e,n,r){if(typeof window<"u"){const o=r||No();return this.eventCallbacks.has(o)?(this.logger.error(`Event callback with id: ${o} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(o,[e,n||[]]),this.logger.verbose(`Event callback registered with id: ${o}`),o)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,n,r,o){if(typeof window<"u"){const i={eventType:e,interactionType:n||null,payload:r||null,error:o||null,timestamp:Date.now()};this.eventCallbacks.forEach(([s,a],c)=>{(a.length===0||a.includes(e))&&(this.logger.verbose(`Emitting event to callback ${c}: ${e}`),s.apply(null,[i]))})}}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class X3{constructor(e,n,r,o,i,s,a,c,u){this.config=e,this.browserStorage=n,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=s,this.nativeMessageHandler=c,this.correlationId=u||Wi(),this.logger=o.clone(co.MSAL_SKU,Oc,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e){if(e){Kn.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(Kn.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const n=e||this.config.auth.redirectUri||ri();return At.getAbsoluteUrl(n,ri())}initializeServerTelemetryManager(e,n){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:n||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Pf(r,this.browserStorage)}async getDiscoveredAuthority(e){const{account:n}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(x.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const o={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e.requestAuthority||this.config.auth.authority,s=r!=null&&r.length?r==="true":this.config.auth.instanceAware,a=n&&s?this.config.auth.authority.replace(At.getDomainFromUrl(i),n.environment):i,c=dr.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),u=await Ue(i3,x.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(c,this.config.system.networkClient,this.browserStorage,o,this.logger,this.correlationId,this.performanceClient);if(n&&!u.isAlias(n.environment))throw nn(JD);return u}}/*! @azure/msal-browser v3.26.1 2024-10-08 */const Une=32;async function Fne(t,e,n){t.addQueueMeasurement(x.GeneratePkceCodes,n);const r=ll(Bne,x.GenerateCodeVerifier,e,t,n)(t,e,n),o=await Ue(Hne,x.GenerateCodeChallengeFromVerifier,e,t,n)(r,t,e,n);return{verifier:r,challenge:o}}function Bne(t,e,n){try{const r=new Uint8Array(Une);return ll(lne,x.GetRandomValues,e,t,n)(r),Kb(r)}catch{throw Ze(d_)}}async function Hne(t,e,n,r){e.addQueueMeasurement(x.GenerateCodeChallengeFromVerifier,r);try{const o=await Ue($3,x.Sha256Digest,n,e,r)(t,e,r);return Kb(new Uint8Array(o))}catch{throw Ze(d_)}}/*! @azure/msal-browser v3.26.1 2024-10-08 */async function E_(t,e,n,r){n.addQueueMeasurement(x.InitializeBaseRequest,t.correlationId);const o=t.authority||e.auth.authority,i=[...t&&t.scopes||[]],s={...t,correlationId:t.correlationId,authority:o,scopes:i};if(!s.authenticationScheme)s.authenticationScheme=$t.BEARER,r.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(s.authenticationScheme===$t.SSH){if(!t.sshJwk)throw nn(Bb);if(!t.sshKid)throw nn(WD)}r.verbose(`Authentication Scheme set to "${s.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&t.claims&&!si.isEmptyObj(t.claims)&&(s.requestedClaimsHash=await G3(t.claims)),s}async function zne(t,e,n,r,o){r.addQueueMeasurement(x.InitializeSilentRequest,t.correlationId);const i=await Ue(E_,x.InitializeBaseRequest,o,r,t.correlationId)(t,n,r,o);return{...t,...i,account:e,forceRefresh:t.forceRefresh||!1}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class Pd extends X3{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(x.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);const n=await Ue(Fne,x.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),r={...e,redirectUri:e.redirectUri,code:oe.EMPTY_STRING,codeVerifier:n.verifier};return e.codeChallenge=n.challenge,e.codeChallengeMethod=oe.S256_CODE_CHALLENGE_METHOD,r}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e==null?void 0:e.correlationId);const n={correlationId:this.correlationId||Wi(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),n.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",n.correlationId),n.postLogoutRedirectUri=At.getAbsoluteUrl(e.postLogoutRedirectUri,ri())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",n.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",n.correlationId),n.postLogoutRedirectUri=At.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,ri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",n.correlationId),n.postLogoutRedirectUri=At.getAbsoluteUrl(ri(),ri())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",n.correlationId),n}getLogoutHintFromIdTokenClaims(e){const n=e.idTokenClaims;if(n){if(n.login_hint)return n.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(x.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const n=await Ue(this.getClientConfiguration.bind(this),x.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new c3(n,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:n,requestAuthority:r,requestAzureCloudOptions:o,requestExtraQueryParameters:i,account:s}=e;this.performanceClient.addQueueMeasurement(x.StandardInteractionClientGetClientConfiguration,this.correlationId);const a=await Ue(this.getDiscoveredAuthority.bind(this),x.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:o,requestExtraQueryParameters:i,account:s}),c=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:a,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:c.loggerCallback,piiLoggingEnabled:c.piiLoggingEnabled,logLevel:c.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:n,libraryInfo:{sku:co.MSAL_SKU,version:Oc,cpu:oe.EMPTY_STRING,os:oe.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,n){this.performanceClient.addQueueMeasurement(x.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const r=this.getRedirectUri(e.redirectUri),o={interactionType:n},i=ai.setRequestState(this.browserCrypto,e&&e.state||oe.EMPTY_STRING,o),a={...await Ue(E_,x.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:i,nonce:e.nonce||Wi(),responseMode:this.config.auth.OIDCOptions.serverResponseType},c=e.account||this.browserStorage.getActiveAccount();if(c&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${c.homeAccountId}`,this.correlationId),a.account=c),!a.loginHint&&!c){const u=this.browserStorage.getLegacyLoginHint();u&&(a.loginHint=u)}return a}}/*! @azure/msal-browser v3.26.1 2024-10-08 */const Vne="ContentError",e4="user_switch";/*! @azure/msal-browser v3.26.1 2024-10-08 */const $ne="USER_INTERACTION_REQUIRED",Gne="USER_CANCEL",Kne="NO_NETWORK",qne="PERSISTENT_ERROR",Wne="DISABLED",Yne="ACCOUNT_UNAVAILABLE";/*! @azure/msal-browser v3.26.1 2024-10-08 */const Qne=-2147186943,Jne={[e4]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Mi extends _t{constructor(e,n,r){super(e,n),Object.setPrototypeOf(this,Mi.prototype),this.name="NativeAuthError",this.ext=r}}function Zl(t){if(t.ext&&t.ext.status&&(t.ext.status===qne||t.ext.status===Wne)||t.ext&&t.ext.error&&t.ext.error===Qne)return!0;switch(t.errorCode){case Vne:return!0;default:return!1}}function R1(t,e,n){if(n&&n.status)switch(n.status){case Yne:return T1(s3);case $ne:return new Rr(t,e);case Gne:return Ze(Mc);case Kne:return Ze(Xg)}return new Mi(t,Jne[t]||e,n)}/*! @azure/msal-browser v3.26.1 2024-10-08 */class t4 extends Pd{async acquireToken(e){this.performanceClient.addQueueMeasurement(x.SilentCacheClientAcquireToken,e.correlationId);const n=this.initializeServerTelemetryManager(pn.acquireTokenSilent_silentFlow),r=await Ue(this.getClientConfiguration.bind(this),x.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),o=new Dte(r,this.performanceClient);this.logger.verbose("Silent auth client created");try{const s=(await Ue(o.acquireCachedToken.bind(o),x.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),s}catch(i){throw i instanceof Nd&&i.errorCode===m_&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),i}}logout(e){this.logger.verbose("logoutRedirect called");const n=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(n==null?void 0:n.account)}}/*! @azure/msal-browser v3.26.1 2024-10-08 */const HC={BROKER_CLIENT_ID:"brk_client_id",BROKER_REDIRECT_URI:"brk_redirect_uri"};class Iu extends X3{constructor(e,n,r,o,i,s,a,c,u,h,p,f){var v;super(e,n,r,o,i,s,c,u,f),this.apiId=a,this.accountId=h,this.nativeMessageHandler=u,this.nativeStorageManager=p,this.silentCacheClient=new t4(e,this.nativeStorageManager,r,o,i,s,c,u,f),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);const g=this.nativeMessageHandler.getExtensionId()===uu.PREFERRED_EXTENSION_ID?"chrome":(v=this.nativeMessageHandler.getExtensionId())!=null&&v.length?"unknown":void 0;this.skus=Pf.makeExtraSkuString({libraryName:co.MSAL_SKU,libraryVersion:Oc,extensionName:g,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[yte]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(x.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const n=this.performanceClient.startMeasurement(x.NativeInteractionClientAcquireToken,e.correlationId),r=Ki();try{const o=await this.initializeNativeRequest(e);try{const u=await this.acquireTokensFromCache(this.accountId,o);return n.end({success:!0,isNativeBroker:!1,fromCache:!0}),u}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...i}=o,s={method:ac.GetToken,request:i},a=await this.nativeMessageHandler.sendMessage(s),c=this.validateNativeResponse(a);return await this.handleNativeResponse(c,o,r).then(u=>(n.end({success:!0,isNativeBroker:!0,requestId:u.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),u)).catch(u=>{throw n.end({success:!1,errorCode:u.errorCode,subErrorCode:u.subError,isNativeBroker:!0}),u})}catch(o){throw o instanceof Mi&&this.serverTelemetryManager.setNativeBrokerErrorCode(o.errorCode),o}}createSilentCacheRequest(e,n){return{authority:e.authority,correlationId:this.correlationId,scopes:Nn.fromString(e.scope).asArray(),account:n,forceRefresh:!1}}async acquireTokensFromCache(e,n){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),ke($g);const r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!r)throw ke($g);try{const o=this.createSilentCacheRequest(n,r),i=await this.silentCacheClient.acquireToken(o),s={...r,idTokenClaims:i==null?void 0:i.idTokenClaims,idToken:i==null?void 0:i.idToken};return{...i,account:s}}catch(o){throw o}}async acquireTokenRedirect(e,n){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...r}=e;delete r.onRedirectNavigate;const o=await this.initializeNativeRequest(r),i={method:ac.GetToken,request:o};try{const c=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(c)}catch(c){if(c instanceof Mi&&(this.serverTelemetryManager.setNativeBrokerErrorCode(c.errorCode),Zl(c)))throw c}this.browserStorage.setTemporaryCache(Yt.NATIVE_REQUEST,JSON.stringify(o),!0);const s={apiId:pn.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);n.end({success:!0}),await this.navigationClient.navigateExternal(a,s)}async handleRedirectPromise(e,n){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&n&&(e==null||e.addFields({errorCode:"no_cached_request"},n)),null;const{prompt:o,...i}=r;o&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Yt.NATIVE_REQUEST));const s={method:ac.GetToken,request:i},a=Ki();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const c=await this.nativeMessageHandler.sendMessage(s);this.validateNativeResponse(c);const u=this.handleNativeResponse(c,i,a);this.browserStorage.setInteractionInProgress(!1);const h=await u;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),h}catch(c){throw this.browserStorage.setInteractionInProgress(!1),c}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,n,r){var h;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const o=cl(e.id_token,Vi),i=this.createHomeAccountIdentifier(e,o),s=(h=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:n.accountId}))==null?void 0:h.homeAccountId;if(i!==s&&e.account.id!==n.accountId)throw R1(e4);const a=await this.getDiscoveredAuthority({requestAuthority:n.authority}),c=c_(this.browserStorage,a,i,Vi,o,e.client_info,void 0,o.tid,void 0,e.account.id,this.logger),u=await this.generateAuthenticationResult(e,n,o,c,a.canonicalAuthority,r);return this.cacheAccount(c),this.cacheNativeTokens(e,n,i,o,e.access_token,u.tenantId,r),u}createHomeAccountIdentifier(e,n){return Kn.generateHomeAccountId(e.client_info||oe.EMPTY_STRING,Qo.Default,this.logger,this.browserCrypto,n)}generateScopes(e,n){return e.scope?Nn.fromString(e.scope):Nn.fromString(n.scope)}async generatePopAccessToken(e,n){if(n.tokenType===$t.POP&&n.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const r=new Nc(this.browserCrypto),o={resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,shrNonce:n.shrNonce};if(!n.keyId)throw ke(jb);return r.signPopToken(e.access_token,n.keyId,o)}else return e.access_token}async generateAuthenticationResult(e,n,r,o,i,s){const a=this.addTelemetryFromNativeResponse(e),c=e.scope?Nn.fromString(e.scope):Nn.fromString(n.scope),u=e.account.properties||{},h=u.UID||r.oid||r.sub||oe.EMPTY_STRING,p=u.TenantId||r.tid||oe.EMPTY_STRING,f=r_(o.getAccountInfo(),void 0,r,e.id_token);f.nativeAccountId!==e.account.id&&(f.nativeAccountId=e.account.id);const g=await this.generatePopAccessToken(e,n),v=n.tokenType===$t.POP?$t.POP:$t.BEARER;return{authority:i,uniqueId:h,tenantId:p,scopes:c.asArray(),account:f,idToken:e.id_token,idTokenClaims:r,accessToken:g,fromCache:a?this.isResponseFromCache(a):!1,expiresOn:new Date(Number(s+e.expires_in)*1e3),tokenType:v,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch(n=>{this.logger.error(`Error occurred while removing account context from browser storage. ${n}`)})}cacheNativeTokens(e,n,r,o,i,s,a){const c=Ub(r,n.authority,e.id_token||"",n.clientId,o.tid||""),u=n.tokenType===$t.POP?oe.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,h=a+u,p=this.generateScopes(e,n),f=Fb(r,n.authority,i,n.clientId,o.tid||s,p.printScopes(),h,0,Vi,void 0,n.tokenType,void 0,n.keyId),g={idToken:c,accessToken:f};this.nativeStorageManager.saveCacheRecord(g,n.storeInCache)}addTelemetryFromNativeResponse(e){const n=this.getMATSFromResponse(e);return n?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:n.broker_version,matsAccountJoinOnStart:n.account_join_on_start,matsAccountJoinOnEnd:n.account_join_on_end,matsDeviceJoin:n.device_join,matsPromptBehavior:n.prompt_behavior,matsApiErrorCode:n.api_error_code,matsUiVisible:n.ui_visible,matsSilentCode:n.silent_code,matsSilentBiSubCode:n.silent_bi_sub_code,matsSilentMessage:n.silent_message,matsSilentStatus:n.silent_status,matsHttpStatus:n.http_status,matsHttpEventCount:n.http_event_count},this.correlationId),n):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw ED(Nb,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const n=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:n,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const r=new At(n);r.validateAsUri();const{scopes:o,...i}=e,s=new Nn(o||[]);s.appendScopes(va);const a=()=>{switch(this.apiId){case pn.ssoSilent:case pn.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),nr.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case nr.NONE:case nr.CONSENT:case nr.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),Ze(U3)}},c={...i,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:s.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:a(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(c.signPopToken&&e.popKid)throw Ze(B3);if(this.handleExtraBrokerParams(c),c.extraParameters=c.extraParameters||{},c.extraParameters.telemetry=uu.MATS_TELEMETRY,e.authenticationScheme===$t.POP){const u={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},h=new Nc(this.browserCrypto);let p;if(c.keyId)p=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:c.keyId})),c.signPopToken=!1;else{const f=await Ue(h.generateCnf.bind(h),x.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(u,this.logger);p=f.reqCnfString,c.keyId=f.kid,c.signPopToken=!0}c.reqCnf=p}return this.addRequestSKUs(c),c}handleExtraBrokerParams(e){if(e.extraParameters&&e.extraParameters.hasOwnProperty(HC.BROKER_CLIENT_ID)&&e.extraParameters.hasOwnProperty(HC.BROKER_REDIRECT_URI)&&e.extraParameters.hasOwnProperty(nd)){const n=e.extraParameters[nd],r=e.redirectUri,o=e.extraParameters[HC.BROKER_REDIRECT_URI];e.extraParameters={child_client_id:n,child_redirect_uri:r},e.redirectUri=o}}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class Bi{constructor(e,n,r,o){this.logger=e,this.handshakeTimeoutMs=n,this.extensionId=o,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(x.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const n={channel:uu.CHANNEL_ID,extensionId:this.extensionId,responseId:Wi(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(n)}`),this.messageChannel.port1.postMessage(n),new Promise((r,o)=>{this.resolvers.set(n.responseId,{resolve:r,reject:o})})}static async createProvider(e,n,r){e.trace("NativeMessageHandler - createProvider called.");try{const o=new Bi(e,n,r,uu.PREFERRED_EXTENSION_ID);return await o.sendHandshakeRequest(),o}catch{const i=new Bi(e,n,r);return await i.sendHandshakeRequest(),i}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:uu.CHANNEL_ID,extensionId:this.extensionId,responseId:Wi(),body:{method:ac.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=n=>{this.onChannelMessage(n)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((n,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:n,reject:r}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(Ze(L3)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const n=e.data;if(!(!n.channel||n.channel!==uu.CHANNEL_ID)&&!(n.extensionId&&n.extensionId!==this.extensionId)&&n.body.method===ac.HandshakeRequest){const r=this.handshakeResolvers.get(n.responseId);if(!r){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${n.responseId}`);return}this.logger.verbose(n.extensionId?`Extension with id: ${n.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),r.reject(Ze(D3))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const n=e.data,r=this.resolvers.get(n.responseId),o=this.handshakeResolvers.get(n.responseId);try{const i=n.body.method;if(i===ac.Response){if(!r)return;const s=n.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(s)}`),s.status!=="Success")r.reject(R1(s.code,s.description,s.ext));else if(s.result)s.result.code&&s.result.description?r.reject(R1(s.result.code,s.result.description,s.result.ext)):r.resolve(s.result);else throw ED(Nb,"Event does not contain result.");this.resolvers.delete(n.responseId)}else if(i===ac.HandshakeResponse){if(!o){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${n.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=n.extensionId,this.extensionVersion=n.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),o.resolve(),this.handshakeResolvers.delete(n.responseId)}}catch(i){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${i}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(i):o&&o.reject(i)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,n,r,o){if(n.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return n.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return n.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(o)switch(o){case $t.BEARER:case $t.POP:return n.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return n.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class I_{constructor(e,n,r,o,i){this.authModule=e,this.browserStorage=n,this.authCodeRequest=r,this.logger=o,this.performanceClient=i}async handleCodeResponse(e,n){this.performanceClient.addQueueMeasurement(x.HandleCodeResponse,n.correlationId);let r;try{r=this.authModule.handleFragmentResponse(e,n.state)}catch(o){throw o instanceof qi&&o.subError===Mc?Ze(Mc):o}return Ue(this.handleCodeResponseFromServer.bind(this),x.HandleCodeResponseFromServer,this.logger,this.performanceClient,n.correlationId)(r,n)}async handleCodeResponseFromServer(e,n,r=!0){if(this.performanceClient.addQueueMeasurement(x.HandleCodeResponseFromServer,n.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await Ue(this.authModule.updateAuthority.bind(this.authModule),x.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,n.correlationId)(e.cloud_instance_host_name,n.correlationId),r&&(e.nonce=n.nonce||void 0),e.state=n.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const i=this.createCcsCredentials(n);i&&(this.authCodeRequest.ccsCredential=i)}return await Ue(this.authModule.acquireToken.bind(this.authModule),x.AuthClientAcquireToken,this.logger,this.performanceClient,n.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:uo.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:uo.UPN}:null}}/*! @azure/msal-browser v3.26.1 2024-10-08 */function n4(t,e,n){const r=Qg(t);if(!r)throw XD(t)?(n.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),n.errorPii(`The ${e} detected is: ${t}`),Ze(m3)):(n.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),Ze(p3));return r}function Zne(t,e,n){if(!t.state)throw Ze(h_);const r=J3(e,t.state);if(!r)throw Ze(g3);if(r.interactionType!==n)throw Ze(v3)}/*! @azure/msal-browser v3.26.1 2024-10-08 */class Xne extends Pd{constructor(e,n,r,o,i,s,a,c,u,h){super(e,n,r,o,i,s,a,u,h),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=c}acquireToken(e){try{const r={popupName:this.generatePopupName(e.scopes||va,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(e,r))}catch(n){return Promise.reject(n)}}logout(e){try{this.logger.verbose("logoutPopup called");const n=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(n),popupWindowAttributes:(e==null?void 0:e.popupWindowAttributes)||{},popupWindowParent:(e==null?void 0:e.popupWindowParent)??window},o=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(n,r,o,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(n,r,o,i))}catch(n){return Promise.reject(n)}}async acquireTokenPopupAsync(e,n){var i;this.logger.verbose("acquireTokenPopupAsync called");const r=this.initializeServerTelemetryManager(pn.acquireTokenPopup),o=await Ue(this.initializeAuthorizationRequest.bind(this),x.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,Ae.Popup);Q3(o.authority);try{const s=await Ue(this.initializeAuthorizationCodeRequest.bind(this),x.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(o),a=await Ue(this.createAuthCodeClient.bind(this),x.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:o.authority,requestAzureCloudOptions:o.azureCloudOptions,requestExtraQueryParameters:o.extraQueryParameters,account:o.account}),c=Bi.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let u;c&&(u=this.performanceClient.startMeasurement(x.FetchAccountIdWithNativeBroker,e.correlationId));const h=await a.getAuthCodeUrl({...o,nativeBroker:c}),p=new I_(a,this.browserStorage,s,this.logger,this.performanceClient),f=this.initiateAuthRequest(h,n);this.eventHandler.emitEvent(ae.POPUP_OPENED,Ae.Popup,{popupWindow:f},null);const g=await this.monitorPopupForHash(f,n.popupWindowParent),v=ll(n4,x.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(g,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(Pi.removeThrottle(this.browserStorage,this.config.auth.clientId,s),v.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),u&&u.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Ze(fp);const b=new Iu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,pn.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,v.accountId,this.nativeStorage,o.correlationId),{userRequestState:C}=ai.parseRequestState(this.browserCrypto,o.state);return await b.acquireToken({...o,state:C,prompt:void 0})}return await p.handleCodeResponse(v,o)}catch(s){throw(i=n.popup)==null||i.close(),s instanceof _t&&(s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s)),s}}async logoutPopupAsync(e,n,r,o){var s,a,c,u;this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(ae.LOGOUT_START,Ae.Popup,e);const i=this.initializeServerTelemetryManager(pn.logoutPopup);try{await this.clearCacheOnLogout(e.account);const h=await Ue(this.createAuthCodeClient.bind(this),x.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:r,account:e.account||void 0});try{h.authority.endSessionEndpoint}catch{if((s=e.account)!=null&&s.homeAccountId&&e.postLogoutRedirectUri&&h.authority.protocolMode===ms.OIDC){if(this.browserStorage.removeAccount((a=e.account)==null?void 0:a.homeAccountId),this.eventHandler.emitEvent(ae.LOGOUT_SUCCESS,Ae.Popup,e),o){const g={apiId:pn.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},v=At.getAbsoluteUrl(o,ri());await this.navigationClient.navigateInternal(v,g)}(c=n.popup)==null||c.close();return}}const p=h.getLogoutUri(e);this.eventHandler.emitEvent(ae.LOGOUT_SUCCESS,Ae.Popup,e);const f=this.openPopup(p,n);if(this.eventHandler.emitEvent(ae.POPUP_OPENED,Ae.Popup,{popupWindow:f},null),await this.monitorPopupForHash(f,n.popupWindowParent).catch(()=>{}),o){const g={apiId:pn.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},v=At.getAbsoluteUrl(o,ri());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${v}`),await this.navigationClient.navigateInternal(v,g)}else this.logger.verbose("No main window navigation requested")}catch(h){throw(u=n.popup)==null||u.close(),h instanceof _t&&(h.setCorrelationId(this.correlationId),i.cacheFailedRequest(h)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(ae.LOGOUT_FAILURE,Ae.Popup,null,h),this.eventHandler.emitEvent(ae.LOGOUT_END,Ae.Popup),h}this.eventHandler.emitEvent(ae.LOGOUT_END,Ae.Popup)}initiateAuthRequest(e,n){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,n);throw this.logger.error("Navigate url is empty"),Ze($b)}monitorPopupForHash(e,n){return new Promise((r,o)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const i=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(i),o(Ze(Mc));return}let s="";try{s=e.location.href}catch{}if(!s||s==="about:blank")return;clearInterval(i);let a="";const c=this.config.auth.OIDCOptions.serverResponseType;e&&(c===hp.QUERY?a=e.location.search:a=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),r(a)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,n)})}openPopup(e,n){try{let r;if(n.popup?(r=n.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):typeof n.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,n)),!r)throw Ze(C3);return r.focus&&r.focus(),this.currentWindow=r,n.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(r){throw this.logger.error("error opening popup "+r.message),this.browserStorage.setInteractionInProgress(!1),Ze(y3)}}openSizedPopup(e,{popupName:n,popupWindowAttributes:r,popupWindowParent:o}){var g,v,y,b;const i=o.screenLeft?o.screenLeft:o.screenX,s=o.screenTop?o.screenTop:o.screenY,a=o.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=o.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let u=(g=r.popupSize)==null?void 0:g.width,h=(v=r.popupSize)==null?void 0:v.height,p=(y=r.popupPosition)==null?void 0:y.top,f=(b=r.popupPosition)==null?void 0:b.left;return(!u||u<0||u>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),u=co.POPUP_WIDTH),(!h||h<0||h>c)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),h=co.POPUP_HEIGHT),(!p||p<0||p>c)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),p=Math.max(0,c/2-co.POPUP_HEIGHT/2+s)),(!f||f<0||f>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),f=Math.max(0,a/2-co.POPUP_WIDTH/2+i)),o.open(e,n,`width=${u}, height=${h}, top=${p}, left=${f}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(Ae.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,n){e.close(),n.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,n){return`${co.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${n}.${this.correlationId}`}generateLogoutPopupName(e){const n=e.account&&e.account.homeAccountId;return`${co.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${n}.${this.correlationId}`}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class Qx{constructor(e,n,r,o,i){this.authModule=e,this.browserStorage=n,this.authCodeRequest=r,this.logger=o,this.performanceClient=i}async initiateAuthRequest(e,n){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){n.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Yt.ORIGIN_URI,n.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Yt.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const r={apiId:pn.acquireTokenRedirect,timeout:n.redirectTimeout,noHistory:!1};if(typeof n.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),n.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await n.navigationClient.navigateExternal(e,r);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await n.navigationClient.navigateExternal(e,r);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Ze($b)}async handleCodeResponse(e,n){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const r=this.browserStorage.generateStateKey(n),o=this.browserStorage.getTemporaryCache(r);if(!o)throw ke(Rf,"Cached State");let i;try{i=this.authModule.handleFragmentResponse(e,o)}catch(u){throw u instanceof qi&&u.subError===Mc?Ze(Mc):u}const s=this.browserStorage.generateNonceKey(o),a=this.browserStorage.getTemporaryCache(s);if(this.authCodeRequest.code=i.code,i.cloud_instance_host_name&&await Ue(this.authModule.updateAuthority.bind(this.authModule),x.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(i.cloud_instance_host_name,this.authCodeRequest.correlationId),i.nonce=a||void 0,i.state=o,i.client_info)this.authCodeRequest.clientInfo=i.client_info;else{const u=this.checkCcsCredentials();u&&(this.authCodeRequest.ccsCredential=u)}const c=await this.authModule.acquireToken(this.authCodeRequest,i);return this.browserStorage.cleanRequestByState(n),c}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(Yt.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}/*! @azure/msal-browser v3.26.1 2024-10-08 */function ere(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const t=window.performance.getEntriesByType("navigation"),e=t.length?t[0]:void 0;return e==null?void 0:e.type}class tre extends Pd{constructor(e,n,r,o,i,s,a,c,u,h){super(e,n,r,o,i,s,a,u,h),this.nativeStorage=c}async acquireToken(e){const n=await Ue(this.initializeAuthorizationRequest.bind(this),x.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,Ae.Redirect);this.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority,n.loginHint||"",n.account||null);const r=this.initializeServerTelemetryManager(pn.acquireTokenRedirect),o=i=>{i.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(n.state),this.eventHandler.emitEvent(ae.RESTORE_FROM_BFCACHE,Ae.Redirect))};try{const i=await Ue(this.initializeAuthorizationCodeRequest.bind(this),x.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(n),s=await Ue(this.createAuthCodeClient.bind(this),x.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),a=new Qx(s,this.browserStorage,i,this.logger,this.performanceClient),c=await s.getAuthCodeUrl({...n,nativeBroker:Bi.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),u=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${u}`),window.addEventListener("pageshow",o),await a.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:u,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(i){throw i instanceof _t&&(i.setCorrelationId(this.correlationId),r.cacheFailedRequest(i)),window.removeEventListener("pageshow",o),this.browserStorage.cleanRequestByState(n.state),i}}async handleRedirectPromise(e="",n){const r=this.initializeServerTelemetryManager(pn.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[o,i]=this.getRedirectResponse(e||"");if(!o)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(Ae.Redirect),ere()!=="back_forward"?n.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const s=this.browserStorage.getTemporaryCache(Yt.ORIGIN_URI,!0)||oe.EMPTY_STRING,a=At.removeHashFromUrl(s),c=At.removeHashFromUrl(window.location.href);if(a===c&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),s.indexOf("#")>-1&&gne(s),await this.handleResponse(o,r);if(this.config.auth.navigateToLoginRequestUrl){if(!y_()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(Yt.URL_HASH,i,!0);const u={apiId:pn.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let h=!0;if(!s||s==="null"){const p=bne();this.browserStorage.setTemporaryCache(Yt.ORIGIN_URI,p,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),h=await this.navigationClient.navigateInternal(p,u)}else this.logger.verbose(`Navigating to loginRequestUrl: ${s}`),h=await this.navigationClient.navigateInternal(s,u);if(!h)return await this.handleResponse(o,r)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(o,r);return null}catch(o){throw o instanceof _t&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),this.browserStorage.cleanRequestByInteractionType(Ae.Redirect),o}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let n=e;n||(this.config.auth.OIDCOptions.serverResponseType===hp.QUERY?n=window.location.search:n=window.location.hash);let r=Qg(n);if(r){try{Zne(r,this.browserCrypto,Ae.Redirect)}catch(i){return i instanceof _t&&this.logger.error(`Interaction type validation failed due to ${i.errorCode}: ${i.errorMessage}`),[null,""]}return mne(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,n]}const o=this.browserStorage.getTemporaryCache(Yt.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Yt.URL_HASH)),o&&(r=Qg(o),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,o]):[null,""]}async handleResponse(e,n){const r=e.state;if(!r)throw Ze(h_);const o=this.browserStorage.getCachedRequest(r);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Ze(fp);const c=new Iu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,pn.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,o.correlationId),{userRequestState:u}=ai.parseRequestState(this.browserCrypto,r);return c.acquireToken({...o,state:u,prompt:void 0}).finally(()=>{this.browserStorage.cleanRequestByState(r)})}const i=this.browserStorage.getCachedAuthority(r);if(!i)throw Ze(f_);const s=await Ue(this.createAuthCodeClient.bind(this),x.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:i});return Pi.removeThrottle(this.browserStorage,this.config.auth.clientId,o),new Qx(s,this.browserStorage,o,this.logger,this.performanceClient).handleCodeResponse(e,r)}async logout(e){var o,i;this.logger.verbose("logoutRedirect called");const n=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(pn.logout);try{this.eventHandler.emitEvent(ae.LOGOUT_START,Ae.Redirect,e),await this.clearCacheOnLogout(n.account);const s={apiId:pn.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=await Ue(this.createAuthCodeClient.bind(this),x.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e&&e.authority,requestExtraQueryParameters:e==null?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(a.authority.protocolMode===ms.OIDC)try{a.authority.endSessionEndpoint}catch{if((o=n.account)!=null&&o.homeAccountId){this.browserStorage.removeAccount((i=n.account)==null?void 0:i.homeAccountId),this.eventHandler.emitEvent(ae.LOGOUT_SUCCESS,Ae.Redirect,n);return}}const c=a.getLogoutUri(n);if(this.eventHandler.emitEvent(ae.LOGOUT_SUCCESS,Ae.Redirect,n),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(c)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(c,s);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(c,s);return}}catch(s){throw s instanceof _t&&(s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s)),this.eventHandler.emitEvent(ae.LOGOUT_FAILURE,Ae.Redirect,null,s),this.eventHandler.emitEvent(ae.LOGOUT_END,Ae.Redirect),s}this.eventHandler.emitEvent(ae.LOGOUT_END,Ae.Redirect)}getRedirectStartPage(e){const n=e||window.location.href;return At.getAbsoluteUrl(n,ri())}}/*! @azure/msal-browser v3.26.1 2024-10-08 */async function nre(t,e,n,r,o){if(e.addQueueMeasurement(x.SilentHandlerInitiateAuthRequest,r),!t)throw n.info("Navigate url is empty"),Ze($b);return o?Ue(ore,x.SilentHandlerLoadFrame,n,e,r)(t,o,e,r):ll(ire,x.SilentHandlerLoadFrameSync,n,e,r)(t)}async function rre(t,e,n,r,o,i,s){return r.addQueueMeasurement(x.SilentHandlerMonitorIframeForHash,i),new Promise((a,c)=>{e<tv&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${tv}ms). This may result in timeouts.`);const u=window.setTimeout(()=>{window.clearInterval(h),c(Ze(S3))},e),h=window.setInterval(()=>{let p="";const f=t.contentWindow;try{p=f?f.location.href:""}catch{}if(!p||p==="about:blank")return;let g="";f&&(s===hp.QUERY?g=f.location.search:g=f.location.hash),window.clearTimeout(u),window.clearInterval(h),a(g)},n)}).finally(()=>{ll(sre,x.RemoveHiddenIframe,o,r,i)(t)})}function ore(t,e,n,r){return n.addQueueMeasurement(x.SilentHandlerLoadFrame,r),new Promise((o,i)=>{const s=r4();window.setTimeout(()=>{if(!s){i("Unable to load iframe");return}s.src=t,o(s)},e)})}function ire(t){const e=r4();return e.src=t,e}function r4(){const t=document.createElement("iframe");return t.className="msalSilentIframe",t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(t),t}function sre(t){document.body===t.parentNode&&document.body.removeChild(t)}/*! @azure/msal-browser v3.26.1 2024-10-08 */class are extends Pd{constructor(e,n,r,o,i,s,a,c,u,h,p){super(e,n,r,o,i,s,c,h,p),this.apiId=a,this.nativeStorage=u}async acquireToken(e){this.performanceClient.addQueueMeasurement(x.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const n={...e};n.prompt?n.prompt!==nr.NONE&&n.prompt!==nr.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${n.prompt} with ${nr.NONE}`),n.prompt=nr.NONE):n.prompt=nr.NONE;const r=await Ue(this.initializeAuthorizationRequest.bind(this),x.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(n,Ae.Silent);Q3(r.authority);const o=this.initializeServerTelemetryManager(this.apiId);let i;try{return i=await Ue(this.createAuthCodeClient.bind(this),x.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:o,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),await Ue(this.silentTokenHelper.bind(this),x.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(i,r)}catch(s){if(s instanceof _t&&(s.setCorrelationId(this.correlationId),o.cacheFailedRequest(s)),!i||!(s instanceof _t)||s.errorCode!==co.INVALID_GRANT_ERROR)throw s;this.performanceClient.addFields({retryError:s.errorCode},this.correlationId);const a=await Ue(this.initializeAuthorizationRequest.bind(this),x.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(n,Ae.Silent);return await Ue(this.silentTokenHelper.bind(this),x.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(i,a)}}logout(){return Promise.reject(Ze(Gb))}async silentTokenHelper(e,n){const r=n.correlationId;this.performanceClient.addQueueMeasurement(x.SilentIframeClientTokenHelper,r);const o=await Ue(this.initializeAuthorizationCodeRequest.bind(this),x.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,r)(n),i=await Ue(e.getAuthCodeUrl.bind(e),x.GetAuthCodeUrl,this.logger,this.performanceClient,r)({...n,nativeBroker:Bi.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,n.authenticationScheme)}),s=new I_(e,this.browserStorage,o,this.logger,this.performanceClient),a=await Ue(nre,x.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,r)(i,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),c=this.config.auth.OIDCOptions.serverResponseType,u=await Ue(rre,x.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,r)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,c),h=ll(n4,x.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(u,c,this.logger);if(h.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Ze(fp);const p=new Iu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,h.accountId,this.browserStorage,r),{userRequestState:f}=ai.parseRequestState(this.browserCrypto,n.state);return Ue(p.acquireToken.bind(p),x.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,r)({...n,state:f,prompt:n.prompt||nr.NONE})}return Ue(s.handleCodeResponse.bind(s),x.HandleCodeResponse,this.logger,this.performanceClient,r)(h,n)}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class cre extends Pd{async acquireToken(e){this.performanceClient.addQueueMeasurement(x.SilentRefreshClientAcquireToken,e.correlationId);const n=await Ue(E_,x.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...n};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));const o=this.initializeServerTelemetryManager(pn.acquireTokenSilent_silentFlow),i=await this.createRefreshTokenClient({serverTelemetryManager:o,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return Ue(i.acquireTokenByRefreshToken.bind(i),x.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(r).catch(s=>{throw s.setCorrelationId(this.correlationId),o.cacheFailedRequest(s),s})}logout(){return Promise.reject(Ze(Gb))}async createRefreshTokenClient(e){const n=await Ue(this.getClientConfiguration.bind(this),x.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new _1(n,this.performanceClient)}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class lre{constructor(e,n,r,o){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=n,this.logger=r,this.cryptoObj=o}loadExternalTokens(e,n,r){if(!this.isBrowserEnvironment)throw Ze(p_);const o=n.id_token?cl(n.id_token,Vi):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},s=e.authority?new dr(dr.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||Wi()):void 0,a=this.loadAccount(e,r.clientInfo||n.client_info||"",o,s),c=this.loadIdToken(n,a.homeAccountId,a.environment,a.realm),u=this.loadAccessToken(e,n,a.homeAccountId,a.environment,a.realm,r),h=this.loadRefreshToken(n,a.homeAccountId,a.environment);return this.generateAuthenticationResult(e,{account:a,idToken:c,accessToken:u,refreshToken:h},o,s)}loadAccount(e,n,r,o){if(this.logger.verbose("TokenCache - loading account"),e.account){const c=Kn.createFromAccountInfo(e.account);return this.storage.setAccount(c),c}else if(!o||!n&&!r)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Ze(R3);const i=Kn.generateHomeAccountId(n,o.authorityType,this.logger,this.cryptoObj,r),s=r==null?void 0:r.tid,a=c_(this.storage,o,i,Vi,r,n,o.hostnameAndPort,s,void 0,void 0,this.logger);return this.storage.setAccount(a),a}loadIdToken(e,n,r,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=Ub(n,r,e.id_token,this.config.auth.clientId,o);return this.storage.setIdTokenCredential(i),i}loadAccessToken(e,n,r,o,i,s){if(n.access_token)if(n.expires_in){if(!n.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const a=n.scope?Nn.fromString(n.scope):new Nn(e.scopes),c=s.expiresOn||n.expires_in+new Date().getTime()/1e3,u=s.extendedExpiresOn||(n.ext_expires_in||n.expires_in)+new Date().getTime()/1e3,h=Fb(r,o,n.access_token,this.config.auth.clientId,i,a.printScopes(),c,u,Vi);return this.storage.setAccessTokenCredential(h),h}loadRefreshToken(e,n,r){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const o=jD(n,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(o),o}generateAuthenticationResult(e,n,r,o){var h,p,f;let i="",s=[],a=null,c;n!=null&&n.accessToken&&(i=n.accessToken.secret,s=Nn.fromString(n.accessToken.target).asArray(),a=new Date(Number(n.accessToken.expiresOn)*1e3),c=new Date(Number(n.accessToken.extendedExpiresOn)*1e3));const u=n.account;return{authority:o?o.canonicalAuthority:"",uniqueId:n.account.localAccountId,tenantId:n.account.realm,scopes:s,account:u.getAccountInfo(),idToken:((h=n.idToken)==null?void 0:h.secret)||"",idTokenClaims:r||{},accessToken:i,fromCache:!0,expiresOn:a,correlationId:e.correlationId||"",requestId:"",extExpiresOn:c,familyId:((p=n.refreshToken)==null?void 0:p.familyId)||"",tokenType:((f=n==null?void 0:n.accessToken)==null?void 0:f.tokenType)||"",state:e.state||"",cloudGraphHostName:u.cloudGraphHostName||"",msGraphHost:u.msGraphHost||"",fromNativeBroker:!1}}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class ure extends c3{constructor(e){super(e),this.includeRedirectUri=!1}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class dre extends Pd{constructor(e,n,r,o,i,s,a,c,u,h){super(e,n,r,o,i,s,c,u,h),this.apiId=a}async acquireToken(e){if(!e.code)throw Ze(N3);const n=await Ue(this.initializeAuthorizationRequest.bind(this),x.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,Ae.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{const o={...n,code:e.code},i=await Ue(this.getClientConfiguration.bind(this),x.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),s=new ure(i);this.logger.verbose("Auth code client created");const a=new I_(s,this.browserStorage,o,this.logger,this.performanceClient);return await Ue(a.handleCodeResponseFromServer.bind(a),x.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},n,!1)}catch(o){throw o instanceof _t&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),o}}logout(){return Promise.reject(Ze(Gb))}}/*! @azure/msal-browser v3.26.1 2024-10-08 */function bi(t){const e=t==null?void 0:t.idTokenClaims;if(e!=null&&e.tfp||e!=null&&e.acr)return"B2C";if(e!=null&&e.tid){if((e==null?void 0:e.tid)==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function am(t,e){try{gs(t)}catch(n){throw e.end({success:!1},n),n}}class Wb{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Dc(this.logger,this.performanceClient):qg,this.eventHandler=new Z3(this.logger),this.browserStorage=this.isBrowserEnvironment?new x1(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,wte(this.config.auth),this.performanceClient):Rne(this.config.auth.clientId,this.logger);const n={cacheLocation:wn.MemoryStorage,temporaryCacheLocation:wn.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new x1(this.config.auth.clientId,n,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new lre(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this),this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}static async createController(e,n){const r=new Wb(e);return await r.initialize(n),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(ae.INITIALIZE_END);return}const n=(e==null?void 0:e.correlationId)||this.getRequestCorrelationId(),r=this.config.system.allowNativeBroker,o=this.performanceClient.startMeasurement(x.InitializeClientApplication,n);if(this.eventHandler.emitEvent(ae.INITIALIZE_START),r)try{this.nativeExtensionProvider=await Bi.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(i){this.logger.verbose(i)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await Ue(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),x.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,n)(this.performanceClient,n)),this.initialized=!0,this.eventHandler.emitEvent(ae.INITIALIZE_END),o.end({allowNativeBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),C_(this.initialized),this.isBrowserEnvironment){const n=e||"";let r=this.redirectResponse.get(n);return typeof r>"u"?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(n,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const n=this.getAllAccounts(),r=this.browserStorage.getCachedNativeRequest(),o=r&&Bi.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,i=o?r==null?void 0:r.correlationId:this.browserStorage.getTemporaryCache(Yt.CORRELATION_ID,!0)||"",s=this.performanceClient.startMeasurement(x.AcquireTokenRedirect,i);this.eventHandler.emitEvent(ae.HANDLE_REDIRECT_START,Ae.Redirect);let a;if(o&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const c=new Iu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,pn.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,r.accountId,this.nativeInternalStorage,r.correlationId);a=Ue(c.handleRedirectPromise.bind(c),x.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,s.event.correlationId)(this.performanceClient,s.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const c=this.createRedirectClient(i);a=Ue(c.handleRedirectPromise.bind(c),x.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,s.event.correlationId)(e,s)}return a.then(c=>(c?(n.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(ae.LOGIN_SUCCESS,Ae.Redirect,c),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_SUCCESS,Ae.Redirect,c),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),s.end({success:!0,accountType:bi(c.account)})):s.event.errorCode?s.end({success:!1}):s.discard(),this.eventHandler.emitEvent(ae.HANDLE_REDIRECT_END,Ae.Redirect),c)).catch(c=>{const u=c;throw n.length>0?this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_FAILURE,Ae.Redirect,null,u):this.eventHandler.emitEvent(ae.LOGIN_FAILURE,Ae.Redirect,null,u),this.eventHandler.emitEvent(ae.HANDLE_REDIRECT_END,Ae.Redirect),s.end({success:!1},u),c})}async acquireTokenRedirect(e){const n=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",n);const r=this.performanceClient.startMeasurement(x.AcquireTokenPreRedirect,n);r.add({accountType:bi(e.account),scenarioId:e.scenarioId});const o=e.onRedirectNavigate;if(o)e.onRedirectNavigate=s=>{const a=typeof o=="function"?o(s):void 0;return a!==!1?r.end({success:!0}):r.discard(),a};else{const s=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=a=>{const c=typeof s=="function"?s(a):void 0;return c!==!1?r.end({success:!0}):r.discard(),c}}const i=this.getAllAccounts().length>0;try{Wx(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),i?this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_START,Ae.Redirect,e):this.eventHandler.emitEvent(ae.LOGIN_START,Ae.Redirect,e);let s;return this.nativeExtensionProvider&&this.canUseNative(e)?s=new Iu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,pn.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,n).acquireTokenRedirect(e,r).catch(c=>{if(c instanceof Mi&&Zl(c))return this.nativeExtensionProvider=void 0,this.createRedirectClient(n).acquireToken(e);if(c instanceof Rr)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(n).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),c}):s=this.createRedirectClient(n).acquireToken(e),await s}catch(s){throw r.end({success:!1},s),i?this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_FAILURE,Ae.Redirect,null,s):this.eventHandler.emitEvent(ae.LOGIN_FAILURE,Ae.Redirect,null,s),s}}acquireTokenPopup(e){const n=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(x.AcquireTokenPopup,n);r.add({scenarioId:e.scenarioId,accountType:bi(e.account)});try{this.logger.verbose("acquireTokenPopup called",n),am(this.initialized,r),this.browserStorage.setInteractionInProgress(!0)}catch(s){return Promise.reject(s)}const o=this.getAllAccounts();o.length>0?this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_START,Ae.Popup,e):this.eventHandler.emitEvent(ae.LOGIN_START,Ae.Popup,e);let i;return this.canUseNative(e)?i=this.acquireTokenNative({...e,correlationId:n},pn.acquireTokenPopup).then(s=>(this.browserStorage.setInteractionInProgress(!1),r.end({success:!0,isNativeBroker:!0,requestId:s.requestId,accountType:bi(s.account)}),s)).catch(s=>{if(s instanceof Mi&&Zl(s))return this.nativeExtensionProvider=void 0,this.createPopupClient(n).acquireToken(e);if(s instanceof Rr)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(n).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),s}):i=this.createPopupClient(n).acquireToken(e),i.then(s=>(o.length<this.getAllAccounts().length?this.eventHandler.emitEvent(ae.LOGIN_SUCCESS,Ae.Popup,s):this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_SUCCESS,Ae.Popup,s),r.end({success:!0,requestId:s.requestId,accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length,accountType:bi(s.account)}),s)).catch(s=>(o.length>0?this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_FAILURE,Ae.Popup,null,s):this.eventHandler.emitEvent(ae.LOGIN_FAILURE,Ae.Popup,null,s),r.end({success:!1},s),Promise.reject(s)))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var i,s;const n=this.getRequestCorrelationId(e),r={...e,prompt:e.prompt,correlationId:n};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(x.SsoSilent,n),(i=this.ssoSilentMeasurement)==null||i.add({scenarioId:e.scenarioId,accountType:bi(e.account)}),am(this.initialized,this.ssoSilentMeasurement),(s=this.ssoSilentMeasurement)==null||s.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",n),this.eventHandler.emitEvent(ae.SSO_SILENT_START,Ae.Silent,r);let o;return this.canUseNative(r)?o=this.acquireTokenNative(r,pn.ssoSilent).catch(a=>{if(a instanceof Mi&&Zl(a))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(r.correlationId).acquireToken(r);throw a}):o=this.createSilentIframeClient(r.correlationId).acquireToken(r),o.then(a=>{var c;return this.eventHandler.emitEvent(ae.SSO_SILENT_SUCCESS,Ae.Silent,a),(c=this.ssoSilentMeasurement)==null||c.end({success:!0,isNativeBroker:a.fromNativeBroker,requestId:a.requestId,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:bi(a.account)}),a}).catch(a=>{var c;throw this.eventHandler.emitEvent(ae.SSO_SILENT_FAILURE,Ae.Silent,null,a),(c=this.ssoSilentMeasurement)==null||c.end({success:!1},a),a}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const n=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",n);const r=this.performanceClient.startMeasurement(x.AcquireTokenByCode,n);am(this.initialized,r),this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_BY_CODE_START,Ae.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Ze(M3);if(e.code){const o=e.code;let i=this.hybridAuthCodeResponses.get(o);return i?(this.logger.verbose("Existing acquireTokenByCode request found",n),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",n),i=this.acquireTokenByCodeAsync({...e,correlationId:n}).then(s=>(this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_BY_CODE_SUCCESS,Ae.Silent,s),this.hybridAuthCodeResponses.delete(o),r.end({success:!0,isNativeBroker:s.fromNativeBroker,requestId:s.requestId,accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length,accountType:bi(s.account)}),s)).catch(s=>{throw this.hybridAuthCodeResponses.delete(o),this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_BY_CODE_FAILURE,Ae.Silent,null,s),r.end({success:!1},s),s}),this.hybridAuthCodeResponses.set(o,i)),await i}else if(e.nativeAccountId)if(this.canUseNative(e,e.nativeAccountId)){const o=await this.acquireTokenNative({...e,correlationId:n},pn.acquireTokenByCode,e.nativeAccountId).catch(i=>{throw i instanceof Mi&&Zl(i)&&(this.nativeExtensionProvider=void 0),i});return r.end({accountType:bi(o.account),success:!0}),o}else throw Ze(O3);else throw Ze(P3)}catch(o){throw this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_BY_CODE_FAILURE,Ae.Silent,null,o),r.end({success:!1},o),o}}async acquireTokenByCodeAsync(e){var o;return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(x.AcquireTokenByCodeAsync,e.correlationId),(o=this.acquireTokenByCodeAsyncMeasurement)==null||o.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(i=>{var s;return(s=this.acquireTokenByCodeAsyncMeasurement)==null||s.end({success:!0,fromCache:i.fromCache,isNativeBroker:i.fromNativeBroker,requestId:i.requestId}),i}).catch(i=>{var s;throw(s=this.acquireTokenByCodeAsyncMeasurement)==null||s.end({success:!1},i),i}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,n){switch(this.performanceClient.addQueueMeasurement(x.AcquireTokenFromCache,e.correlationId),n){case Vn.Default:case Vn.AccessToken:case Vn.AccessTokenAndRefreshToken:const r=this.createSilentCacheClient(e.correlationId);return Ue(r.acquireToken.bind(r),x.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw ke(ni)}}async acquireTokenByRefreshToken(e,n){switch(this.performanceClient.addQueueMeasurement(x.AcquireTokenByRefreshToken,e.correlationId),n){case Vn.Default:case Vn.AccessTokenAndRefreshToken:case Vn.RefreshToken:case Vn.RefreshTokenAndNetwork:const r=this.createSilentRefreshClient(e.correlationId);return Ue(r.acquireToken.bind(r),x.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw ke(ni)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(x.AcquireTokenBySilentIframe,e.correlationId);const n=this.createSilentIframeClient(e.correlationId);return Ue(n.acquireToken.bind(n),x.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const n=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",n),this.logoutRedirect({correlationId:n,...e})}async logoutRedirect(e){const n=this.getRequestCorrelationId(e);return Wx(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(n).logout(e)}logoutPopup(e){try{const n=this.getRequestCorrelationId(e);return gs(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(n).logout(e)}catch(n){return Promise.reject(n)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const n=this.getRequestCorrelationId(e);return this.createSilentCacheClient(n).logout(e)}getAllAccounts(e){return Nne(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return Pne(e,this.logger,this.browserStorage)}getAccountByUsername(e){return Mne(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return One(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return Lne(e,this.logger,this.browserStorage)}setActiveAccount(e){Dne(e,this.browserStorage)}getActiveAccount(){return jne(this.browserStorage)}async hydrateCache(e,n){this.logger.verbose("hydrateCache called");const r=Kn.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(r),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,n)):this.browserStorage.hydrateCache(e,n)}async acquireTokenNative(e,n,r){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Ze(fp);return new Iu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,n,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,n){if(this.logger.trace("canUseNative called"),!Bi.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case nr.NONE:case nr.CONSENT:case nr.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!n&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const n=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return n&&n.nativeAccountId||""}createPopupClient(e){return new Xne(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new tre(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new are(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,pn.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new t4(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new cre(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new dre(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,pn.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,n){return this.eventHandler.addEventCallback(e,n)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return Y3(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}handleAccountCacheChange(e){var n;try{(n=e.key)!=null&&n.includes(Jn.ACTIVE_ACCOUNT_FILTERS)&&this.eventHandler.emitEvent(ae.ACTIVE_ACCOUNT_CHANGED);const r=e.newValue||e.oldValue;if(!r)return;const o=JSON.parse(r);if(typeof o!="object"||!Kn.isAccountEntity(o))return;const s=td.toObject(new Kn,o).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.eventHandler.emitEvent(ae.ACCOUNT_ADDED,void 0,s)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.eventHandler.emitEvent(ae.ACCOUNT_REMOVED,void 0,s))}catch{return}}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,n){this.browserStorage.setWrapperMetadata(e,n)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e!=null&&e.correlationId?e.correlationId:this.isBrowserEnvironment?Wi():oe.EMPTY_STRING}async loginRedirect(e){const n=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",n),this.acquireTokenRedirect({correlationId:n,...e||Gx})}loginPopup(e){const n=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",n),this.acquireTokenPopup({correlationId:n,...e||Gx})}async acquireTokenSilent(e){const n=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(x.AcquireTokenSilent,n);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),am(this.initialized,r),this.logger.verbose("acquireTokenSilent called",n);const o=e.account||this.getActiveAccount();if(!o)throw Ze(_3);r.add({accountType:bi(o)});const i={clientId:this.config.auth.clientId,authority:e.authority||oe.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:o.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},s=JSON.stringify(i),a=this.activeSilentTokenRequests.get(s);if(typeof a>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",n);const c=Ue(this.acquireTokenSilentAsync.bind(this),x.AcquireTokenSilentAsync,this.logger,this.performanceClient,n)({...e,correlationId:n},o).then(u=>(this.activeSilentTokenRequests.delete(s),r.end({success:!0,fromCache:u.fromCache,isNativeBroker:u.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:u.requestId,accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),u)).catch(u=>{throw this.activeSilentTokenRequests.delete(s),r.end({success:!1},u),u});return this.activeSilentTokenRequests.set(s,c),{...await c,state:e.state}}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",n),r.discard(),{...await a,state:e.state}}async acquireTokenSilentAsync(e,n){const r=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(x.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_START,Ae.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",r);const o=await Ue(zne,x.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,n,this.config,this.performanceClient,this.logger),i=e.cacheLookupPolicy||Vn.Default;return this.acquireTokenSilentNoIframe(o,i).catch(async a=>{if(hre(a,i))if(this.activeIframeRequest)if(i!==Vn.Skip){const[u,h]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${h}`,o.correlationId);const p=this.performanceClient.startMeasurement(x.AwaitConcurrentIframe,o.correlationId);p.add({awaitIframeCorrelationId:h});const f=await u;if(p.end({success:f}),f)return this.logger.verbose(`Parallel iframe request with correlationId: ${h} succeeded. Retrying cache and/or RT redemption`,o.correlationId),this.acquireTokenSilentNoIframe(o,i);throw this.logger.info(`Iframe request with correlationId: ${h} failed. Interaction is required.`),a}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",o.correlationId),Ue(this.acquireTokenBySilentIframe.bind(this),x.AcquireTokenBySilentIframe,this.logger,this.performanceClient,o.correlationId)(o);else{let u;return this.activeIframeRequest=[new Promise(h=>{u=h}),o.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",o.correlationId),Ue(this.acquireTokenBySilentIframe.bind(this),x.AcquireTokenBySilentIframe,this.logger,this.performanceClient,o.correlationId)(o).then(h=>(u(!0),h)).catch(h=>{throw u(!1),h}).finally(()=>{this.activeIframeRequest=void 0})}else throw a}).then(a=>(this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_SUCCESS,Ae.Silent,a),e.correlationId&&this.performanceClient.addFields({fromCache:a.fromCache,isNativeBroker:a.fromNativeBroker,requestId:a.requestId},e.correlationId),a)).catch(a=>{throw this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_FAILURE,Ae.Silent,null,a),a}).finally(()=>{document.removeEventListener("visibilitychange",r)})}async acquireTokenSilentNoIframe(e,n){return Bi.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,pn.acquireTokenSilent_silentFlow).catch(async r=>{throw r instanceof Mi&&Zl(r)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,ke(ni)):r})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),Ue(this.acquireTokenFromCache.bind(this),x.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,n).catch(r=>{if(n===Vn.AccessToken)throw r;return this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_NETWORK_START,Ae.Silent,e),Ue(this.acquireTokenByRefreshToken.bind(this),x.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,n)}))}}function hre(t,e){const n=!(t instanceof Rr&&t.subError!==Vb),r=t.errorCode===co.INVALID_GRANT_ERROR||t.errorCode===ni,o=n&&r||t.errorCode===Zg||t.errorCode===a_,i=tne.includes(e);return o&&i}/*! @azure/msal-browser v3.26.1 2024-10-08 */async function fre(t,e){const n=new Lc(t);return await n.initialize(),Wb.createController(n,e)}/*! @azure/msal-browser v3.26.1 2024-10-08 */let pre=class o4{static async createPublicClientApplication(e){const n=await fre(e);return new o4(e,n)}constructor(e,n){this.controller=n||new Wb(new Lc(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,n){return this.controller.addEventCallback(e,n)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,n){return this.controller.initializeWrapperLibrary(e,n)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,n){return this.controller.hydrateCache(e,n)}clearCache(e){return this.controller.clearCache(e)}};/*! @azure/msal-browser v3.26.1 2024-10-08 */class Jx{constructor(e,n){const r=n&&n.loggerOptions||{};this.logger=new di(r,nv,Oc),this.cryptoOps=new Dc(this.logger),this.popTokenGenerator=new Nc(this.cryptoOps),this.shrParameters=e}async generatePublicKeyThumbprint(){const{kid:e}=await this.popTokenGenerator.generateKid(this.shrParameters);return e}async signRequest(e,n,r){return this.popTokenGenerator.signPayload(e,n,this.shrParameters,r)}async removeKeys(e){return this.cryptoOps.removeTokenBindingKey(e)}}function Zx(){let t;try{t=window[wn.SessionStorage];const e=t==null?void 0:t.getItem(one);if(Number(e)===1)return H(()=>import("./BrowserPerformanceMeasurement-CIsv1iQ0.js"),[])}catch{}}function qm(){return typeof window<"u"&&typeof window.performance<"u"&&typeof window.performance.now=="function"}function mre(t){if(!(!t||!qm()))return Math.round(window.performance.now()-t)}class gre extends Kte{constructor(e,n,r){var o,i;super(e.auth.clientId,e.auth.authority||`${oe.DEFAULT_AUTHORITY}`,new di(((o=e.system)==null?void 0:o.loggerOptions)||{},nv,Oc),nv,Oc,((i=e.telemetry)==null?void 0:i.application)||{appName:"",appVersion:""},n,r)}generateId(){return Wi()}getPageVisibility(){var e;return((e=document.visibilityState)==null?void 0:e.toString())||null}deleteIncompleteSubMeasurements(e){var n;(n=Zx())==null||n.then(r=>{const o=this.eventsByCorrelationId.get(e.event.correlationId),i=o&&o.eventId===e.event.eventId,s=[];i&&(o!=null&&o.incompleteSubMeasurements)&&o.incompleteSubMeasurements.forEach(a=>{s.push({...a})}),r.BrowserPerformanceMeasurement.flushMeasurements(e.event.correlationId,s)})}startMeasurement(e,n){var a;const r=this.getPageVisibility(),o=super.startMeasurement(e,n),i=qm()?window.performance.now():void 0,s=(a=Zx())==null?void 0:a.then(c=>new c.BrowserPerformanceMeasurement(e,o.event.correlationId));return s==null||s.then(c=>c.startMeasurement()),{...o,end:(c,u)=>{const h=o.end({...c,startPageVisibility:r,endPageVisibility:this.getPageVisibility(),durationMs:mre(i)},u);return s==null||s.then(p=>p.endMeasurement()),this.deleteIncompleteSubMeasurements(o),h},discard:()=>{o.discard(),s==null||s.then(c=>c.flushMeasurement()),this.deleteIncompleteSubMeasurements(o)}}}setPreQueueTime(e,n){if(!qm()){this.logger.trace(`BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for ${e}`);return}if(!n){this.logger.trace(`BrowserPerformanceClient: correlationId for ${e} not provided, unable to set telemetry queue time`);return}const r=this.preQueueTimeByCorrelationId.get(n);r&&(this.logger.trace(`BrowserPerformanceClient: Incomplete pre-queue ${r.name} found`,n),this.addQueueMeasurement(r.name,n,void 0,!0)),this.preQueueTimeByCorrelationId.set(n,{name:e,time:window.performance.now()})}addQueueMeasurement(e,n,r,o){if(!qm()){this.logger.trace(`BrowserPerformanceClient: window performance API not available, unable to add queue measurement for ${e}`);return}if(!n){this.logger.trace(`BrowserPerformanceClient: correlationId for ${e} not provided, unable to add queue measurement`);return}const i=super.getPreQueueTime(e,n);if(!i)return;const s=window.performance.now(),a=r||super.calculateQueuedTime(i,s);return super.addQueueMeasurement(e,n,a,o)}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const It={...x,PairwiseBrokerApplicationInitializeBrokering:"pairwiseBrokerApplicationInitializeBrokering",BrokerClientApplicationHandleBrokerHandshake:"brokerClientApplicationHandleBrokerHandshake",BrokerClientApplicationBrokeredSSOSilentRequest:"brokerClientApplicationBrokeredSSOSilentRequest",BrokerClientApplicationBrokeredSilentRequest:"brokerClientApplicationBrokeredSilentRequest",EmbeddedClientApplicationSendSSOSilentRequest:"embeddedSSOSilent",EmbeddedClientApplicationSendPopupRequest:"embeddedPopup",EmbeddedClientApplicationSendRedirectRequest:"embeddedRedirect",EmbeddedClientApplicationHandleRedirectRequest:"embeddedHandleRedirect",EmbeddedClientApplicationSendSilentRefreshRequest:"embeddedSilentRefresh"},vre=new Map([[It.PairwiseBrokerApplicationInitializeBrokering,"PWBInitBrk"],[It.BrokerClientApplicationHandleBrokerHandshake,"BrkClientHandeBrkHandshake"],[It.BrokerClientApplicationBrokeredSSOSilentRequest,"BrkClientBrkSSOReq"],[It.BrokerClientApplicationBrokeredSilentRequest,"BrkClientBrkSltReq"],[It.EmbeddedClientApplicationSendSSOSilentRequest,"EmbClientSendSSOReq"],[It.EmbeddedClientApplicationSendPopupRequest,"EmbClientSendPopupReq"],[It.EmbeddedClientApplicationSendRedirectRequest,"EmbClientSendRedirectReq"],[It.EmbeddedClientApplicationHandleRedirectRequest,"EmbClientHandleRedirectReq"],[It.EmbeddedClientApplicationSendSilentRefreshRequest,"EmbClientSendSltRefreshReq"]]),bre=new Set(["brokerInteractionTimeoutMs","brokerMessageTimeoutMs","brokerHandshakeTimeoutMs","brokerIframeTimeoutMs"]);var yre="function",T_="object",__="undefined",Zh="prototype",w_=Object,Cre=w_[Zh];/*! https://github.com/nevware21/ts-utils v0.11.5 */function Ms(t,e){return t||e}function Dr(t,e){return t[e]}var lo=void 0,Gn=null,A_="",Yb="function",pp="object",vs="prototype",N1="__proto__",cc="undefined",iv="constructor",k_="Symbol",Sre="_polyfill",mc="length",sv="name",cr="call",Qb="toString",Ho=Ms(Object),x_=Dr(Ho,vs),i4=Ms(String),ul=Dr(i4,vs),Ere=Ms(Math),s4=Ms(Array),a4=Dr(s4,vs),Ts=Dr(a4,"slice");function lr(t,e){try{return{v:t.apply(this,e)}}catch(n){return{e:n}}}function Ire(t,e){var n=lr(t);return n.e?e:n.v}var zC;function Jb(t){return function(e){return typeof e===t}}function c4(t){var e="[object "+t+"]";return function(n){return!!(n&&Tre(n)===e)}}function Tre(t){return x_[Qb].call(t)}function Jt(t){return typeof t===cc||t===cc}function _re(t){return!R_(t)}function Zt(t){return t===Gn||Jt(t)}function wre(t){return t===Gn||!R_(t)}function R_(t){return!!t||t!==lo}function Are(t){return!zC&&(zC=["string","number","boolean",cc,"symbol","bigint"]),t!==pp&&zC.indexOf(t)!==-1}var mr=Jb("string"),on=Jb(Yb);function rd(t){return!t&&Zt(t)?!1:!!t&&typeof t===pp}var kt=Dr(s4,"isArray"),kre=c4("Date"),ba=Jb("number"),jc=Jb("boolean"),xre=c4("Error");function od(t){return!!(t&&t.then&&on(t.then))}function Xx(t){return!(!t||Ire(function(){return!(t&&0+t)},!t))}var N_=Dr(Ho,"getOwnPropertyDescriptor");function Lo(t,e){return!!t&&x_.hasOwnProperty[cr](t,e)}var Tu=Ms(Dr(Ho,"hasOwn"),Rre);function Rre(t,e){return Lo(t,e)||!!N_(t,e)}function sn(t,e,n){if(t&&rd(t)){for(var r in t)if(Tu(t,r)&&e[cr](t,r,t[r])===-1)break}}var cm={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"};function l4(t){var e={};if(e[cm.c]=!0,e[cm.e]=!0,t.l){e.get=function(){return t.l.v};var n=N_(t.l,"v");n&&n.set&&(e.set=function(r){t.l.v=r})}return sn(t,function(r,o){e[cm[r]]=_re(o)?e[cm[r]]:o}),e}var _s=Dr(Ho,"defineProperty"),Nre=Dr(Ho,"defineProperties");function Cn(t,e,n){return _s(t,e,l4(n))}function u4(t,e){var n={};return sn(e,function(r,o){n[r]=l4(o)}),Nre(t,n)}function d4(t,e,n,r,o){var i={};return sn(t,function(s,a){av(i,s,e?a:s),av(i,a,s)}),r?r(i):i}function av(t,e,n,r){_s(t,e,{value:n,enumerable:!0,writable:!1})}var oi=Ms(i4),Pre="[object Error]";function jt(t,e){var n=A_,r=x_[Qb][cr](t);r===Pre&&(t={stack:oi(t.stack),message:oi(t.message),name:oi(t.name)});try{n=JSON.stringify(t,Gn,e?typeof e=="number"?e:4:lo),n=(n?n.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: "):Gn)||oi(t)}catch(o){n=" - "+jt(o,e)}return r+": "+n}function _o(t){throw new Error(t)}function zo(t){throw new TypeError(t)}var h4=Dr(Ho,"freeze");function Mre(t){return t}function Ore(t){return t[N1]||Gn}var eR=Dr(Ho,"assign"),bs=Dr(Ho,"keys");function Md(t){return h4&&sn(t,function(e,n){(kt(n)||rd(n))&&Md(n)}),Uc(t)}var Uc=Ms(h4,Mre),P1=Ms(Dr(Ho,"getPrototypeOf"),Ore);function Lre(t){return d4(t,1,0,Uc)}function Dre(t){return d4(t,0,0,Uc)}function jre(t){var e={};return sn(t,function(n,r){av(e,n,r[1]),av(e,r[0],r[1])}),Uc(e)}function Ure(t){return jre(t)}var f4=Dre({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12}),tR="__tsUtils$gblCfg",VC;function p4(){var t;return typeof globalThis!==cc&&(t=globalThis),!t&&typeof self!==cc&&(t=self),!t&&typeof window!==cc&&(t=window),!t&&typeof global!==cc&&(t=global),t}function m4(){if(!VC){var t=lr(p4).v||{};VC=t[tR]=t[tR]||{}}return VC}var Zb=mp;function mp(t,e,n){var r=e?e[t]:Gn;return function(o){var i=(o?o[t]:Gn)||r;if(i||n){var s=arguments;return(i||n).apply(o,i?Ts[cr](s,1):s)}zo('"'+oi(t)+'" not defined for '+jt(o))}}function Fre(t){return function(e){return e[t]}}var Bre=Dr(Ere,"max"),nR=Zb("slice",ul),Oi=Zb("substring",ul),Xl=mp("substr",ul,Hre);function Hre(t,e,n){return Zt(t)&&zo("Invalid "+jt(t)),n<0?A_:(e=e||0,e<0&&(e=Bre(e+t[mc],0)),Jt(n)?nR(t,e):nR(t,e,e+n))}function P_(t,e){return Oi(t,0,e)}var rR="_urid",$C;function zre(){if(!$C){var t=m4();$C=t.gblSym=t.gblSym||{k:{},s:{}}}return $C}var lm;function M_(t){var e={description:oi(t),toString:function(){return k_+"("+t+")"}};return e[Sre]=!0,e}function Vre(t){var e=zre();if(!Tu(e.k,t)){var n=M_(t),r=bs(e.s).length;n[rR]=function(){return r+"_"+n[Qb]()},e.k[t]=n,e.s[n[rR]()]=oi(t)}return e.k[t]}function $re(t){!lm&&(lm={});var e,n=f4[t];return n&&(e=lm[n]=lm[n]||M_(k_+"."+n)),e}var jn;function xa(){jn=m4()}function Gre(t){var e={};return!jn&&xa(),e.b=jn.lzy,_s(e,"v",{configurable:!0,get:function(){var n=t();return jn.lzy||_s(e,"v",{value:n}),e.b=jn.lzy,n}}),e}function Vo(t){return _s({toJSON:function(){return t}},"v",{value:t})}var g4="window",Xh;function Xb(t,e){var n;return function(){return!jn&&xa(),(!n||jn.lzy)&&(n=Vo(lr(t,e).v)),n.v}}function Od(t){return!jn&&xa(),(!Xh||t===!1||jn.lzy)&&(Xh=Vo(lr(p4).v||Gn)),Xh.v}function Un(t,e){var n;if(!Xh||e===!1?n=Od(e):n=Xh.v,n&&n[t])return n[t];if(t===g4)try{return window}catch{}return Gn}function v4(){return!!ws()}var ws=Xb(Un,["document"]);function Kre(){return!!Ra()}var Ra=Xb(Un,[g4]);function qre(){return!!Xi()}var Xi=Xb(Un,["navigator"]),Wre=Xb(function(){return!!lr(function(){return process&&(process.versions||{}).node}).v}),id,GC;function ey(){return id=Vo(lr(Un,[k_]).v),id}function Yre(t){var e=(jn.lzy?0:id)||ey();return e.v?e.v[t]:lo}function Qre(){return!!Jre()}function Jre(){return!jn&&xa(),((jn.lzy?0:id)||ey()).v}function O_(t,e){var n=f4[t];!jn&&xa();var r=(jn.lzy?0:id)||ey();return r.v?r.v[n||t]:$re(t)}function uh(t,e){!jn&&xa();var n=(jn.lzy?0:id)||ey();return n.v?n.v(t):M_(t)}function L_(t){return!jn&&xa(),GC=(jn.lzy?0:GC)||Vo(lr(Yre,["for"]).v),(GC.v||Vre)(t)}function M1(t){return!!t&&on(t.next)}function b4(t){return!wre(t)&&on(t[O_(3)])}var um;function D_(t,e,n){if(t&&(M1(t)||(!um&&(um=Vo(O_(3))),t=t[um.v]?t[um.v]():Gn),M1(t))){var r=lo,o=lo;try{for(var i=0;!(o=t.next()).done&&e[cr](n||t,o.value,i,t)!==-1;)i++}catch(s){r={e:s},t.throw&&(o=Gn,t.throw(r))}finally{try{o&&!o.done&&t.return&&t.return(o)}finally{if(r)throw r.e}}}}function du(t,e,n){return t.apply(e,n)}function ia(t,e){return!Jt(e)&&t&&(kt(e)?du(t.push,t,e):M1(e)||b4(e)?D_(e,function(n){t.push(n)}):t.push(e)),t}function tt(t,e,n){if(t)for(var r=t[mc]>>>0,o=0;o<r&&!(o in t&&e[cr](t,t[o],o,t)===-1);o++);}var Do=Zb("indexOf",a4);function ty(t,e,n){return((t?t.slice:Gn)||Ts).apply(t,Ts[cr](arguments,1))}var ya=Ms(Dr(Ho,"create"),Zre);function Zre(t){if(!t)return{};var e=typeof t;e!==pp&&e!==Yb&&zo("Prototype must be an Object or function: "+jt(t));function n(){}return n[vs]=t,new n}var KC;function y4(t,e){var n=Ho.setPrototypeOf||function(r,o){var i;!KC&&(KC=Vo((i={},i[N1]=[],i instanceof Array))),KC.v?r[N1]=o:sn(o,function(s,a){return r[s]=a})};return n(t,e)}function Xre(t,e,n){lr(Cn,[e,sv,{v:t,c:!0,e:!1}]),e=y4(e,n);function r(){this[iv]=e,lr(Cn,[this,sv,{v:t,c:!0,e:!1}])}return e[vs]=n===Gn?ya(n):(r[vs]=n[vs],new r),e}function oR(t,e){e&&(t[sv]=e)}function eoe(t,e,n){var r=Error,o=r[vs][sv],i=Error.captureStackTrace;return Xre(t,function(){var s=this,a=arguments;try{lr(oR,[r,t]);var c=du(r,s,Ts[cr](a))||s;if(c!==s){var u=P1(s);u!==P1(c)&&y4(c,u)}return i&&i(c,s[iv]),e&&e(c,a),c}finally{lr(oR,[r,o])}},r)}function Ca(){return(Date.now||toe)()}function toe(){return new Date().getTime()}function noe(t){return function(n){return Zt(n)&&zo("strTrim called ["+jt(n)+"]"),n&&n.replace&&(n=n.replace(t,A_)),n}}var roe=noe(/^\s+|(?=\s)\s+$/g),Gr=mp("trim",ul,roe),qC,WC,YC;function ii(t){if(!t||typeof t!==pp)return!1;YC||(YC=Kre()?Ra():!0);var e=!1;if(t!==YC){WC||(qC=Function[vs][Qb],WC=qC[cr](Ho));try{var n=P1(t);e=!n,e||(Lo(n,iv)&&(n=n[iv]),e=!!(n&&typeof n===Yb&&qC[cr](n)===WC))}catch{}}return e}function ooe(t){return t.value&&S4(t),!0}var iR=[coe,S4,uoe,loe];function ioe(t,e,n,r){var o;return tt(t,function(i){if(i.k===e)return o=i,-1}),o||(o={k:e,v:e},t.push(o),r(o)),o.v}function j_(t,e,n,r){var o=n.handler,i=n.path?r?n.path.concat(r):n.path:[],s={handler:n.handler,src:n.src,path:i},a=typeof e,c=!1,u=e===Gn;u||(e&&a===pp?c=ii(e):u=Are(a));var h={type:a,isPrim:u,isPlain:c,value:e,result:e,path:i,origin:n.src,copy:function(p,f){return j_(t,p,f?s:n,f)},copyTo:function(p,f){return C4(t,p,f,s)}};return h.isPrim?o&&o[cr](n,h)?h.result:e:ioe(t,e,i,function(p){Cn(h,"result",{g:function(){return p.v},s:function(v){p.v=v}});for(var f=0,g=o;!(g||(f<iR.length?iR[f++]:ooe))[cr](n,h);)g=Gn})}function C4(t,e,n,r){if(!Zt(n))for(var o in n)e[o]=j_(t,n[o],r,o);return e}function soe(t,e,n){var r={handler:n,src:e,path:[]};return C4([],t,e,r)}function aoe(t,e){var n={handler:e,src:t};return j_([],t,n)}function coe(t){var e=t.value;if(kt(e)){var n=t.result=[];return n.length=e.length,t.copyTo(n,e),!0}return!1}function loe(t){var e=t.value;return kre(e)?(t.result=new Date(e.getTime()),!0):!1}function uoe(t){return t.type===Yb}function S4(t){var e=t.value;if(e&&t.isPlain){var n=t.result={};return t.copyTo(n,e),!0}return!1}function doe(t,e){return tt(e,function(n){soe(t,n)}),t}function sR(t,e,n,r,o,i,s){return doe(aoe(t)||{},Ts[cr](arguments))}var hoe=Fre(mc),QC;function foe(){return!jn&&xa(),(!QC||jn.lzy)&&(QC=Vo(lr(Un,["performance"]).v)),QC.v}function poe(){var t=foe();return t&&t.now?t.now():Ca()}var moe=mp("endsWith",ul,goe);function goe(t,e,n){mr(t)||zo("'"+jt(t)+"' is not a string");var r=mr(e)?e:oi(e),o=!Jt(n)&&n<t[mc]?n:t[mc];return Oi(t,o-r[mc],o)===r}var ny=Zb("indexOf",ul),aR=mp("startsWith",ul,voe);function voe(t,e,n){mr(t)||zo("'"+jt(t)+"' is not a string");var r=mr(e)?e:oi(e),o=n>0?n:0;return Oi(t,o,o+r[mc])===r}var JC="ref",ZC="unref",XC="hasRef",boe="enabled";function yoe(t,e,n){var r=!0,o=t?e(Gn):Gn,i;function s(){return r=!1,o&&o[ZC]&&o[ZC](),i}function a(){o&&n(o),o=Gn}function c(){return o=e(o),r||s(),i}function u(h){!h&&o&&a(),h&&!o&&c()}return i={cancel:a,refresh:c},i[XC]=function(){return o&&o[XC]?o[XC]():r},i[JC]=function(){return r=!0,o&&o[JC]&&o[JC](),i},i[ZC]=s,i=_s(i,boe,{get:function(){return!!o},set:u}),{h:i,dn:function(){o=Gn}}}function U_(t,e,n){var r=kt(e),o=r?e.length:0,i=(o>0?e[0]:r?lo:e)||setTimeout,s=(o>1?e[1]:lo)||clearTimeout,a=n[0];n[0]=function(){c.dn(),du(a,lo,Ts[cr](arguments))};var c=yoe(t,function(u){if(u){if(u.refresh)return u.refresh(),u;du(s,lo,[u])}return du(i,lo,n)},function(u){du(s,lo,[u])});return c.h}function Fc(t,e){return U_(!0,lo,Ts[cr](arguments))}function Coe(t,e,n){return U_(!0,t,Ts[cr](arguments,1))}function Soe(t,e){return U_(!1,lo,Ts[cr](arguments))}(Od()||{}).Symbol;(Od()||{}).Reflect;var Eoe="hasOwnProperty",O1=function(t,e){return O1=w_.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r[Eoe](o)&&(n[o]=r[o])},O1(t,e)};function gp(t,e){typeof e!==yre&&e!==null&&zo("Class extends value "+String(e)+" is not a constructor or null"),O1(t,e);function n(){this.constructor=t}t[Zh]=e===null?ya(e):(n[Zh]=e[Zh],new n)}function cR(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t}var dm,cv="constructor",As="prototype",lv="function",uv="_dynInstFuncs",L1="_isDynProxy",_u="_dynClass",Ioe="_dynCls$",D1="_dynInstChk",Mf=D1,E4="_dfOpts",lR="_unknown_",F_="__proto__",hm="_dyn"+F_,uR="__dynProto$Gbl",eS="_dynInstProto",Wm="useBaseInst",j1="setInstFuncs",B_=Object,Of=B_.getPrototypeOf,dR=B_.getOwnPropertyNames,hR=Od(),U1=hR[uR]||(hR[uR]={o:(dm={},dm[j1]=!0,dm[Wm]=!0,dm),n:1e3});function Ym(t){return t&&(t===B_[As]||t===Array[As])}function H_(t){return Ym(t)||t===Function[As]}function Bc(t){var e;if(t){if(Of)return Of(t);var n=t[F_]||t[As]||(t[cv]?t[cv][As]:null);e=t[hm]||n,Lo(t,hm)||(delete t[eS],e=t[hm]=t[eS]||t[hm],t[eS]=n)}return e}function dv(t,e){var n=[];if(dR)n=dR(t);else for(var r in t)typeof r=="string"&&Lo(t,r)&&n.push(r);if(n&&n.length>0)for(var o=0;o<n.length;o++)e(n[o])}function z_(t,e,n){return e!==cv&&typeof t[e]===lv&&(n||Lo(t,e))&&e!==F_&&e!==As}function hv(t){zo("DynamicProto: "+t)}function Toe(t){var e=ya(null);return dv(t,function(n){!e[n]&&z_(t,n,!1)&&(e[n]=t[n])}),e}function V_(t,e){for(var n=t.length-1;n>=0;n--)if(t[n]===e)return!0;return!1}function _oe(t,e,n,r){function o(c,u,h){var p=u[h];if(p[L1]&&r){var f=c[uv]||{};f[Mf]!==!1&&(p=(f[u[_u]]||{})[h]||p)}return function(){return p.apply(c,arguments)}}var i=ya(null);dv(n,function(c){i[c]=o(e,n,c)});for(var s=Bc(t),a=[];s&&!H_(s)&&!V_(a,s);)dv(s,function(c){!i[c]&&z_(s,c,!Of)&&(i[c]=o(e,s,c))}),a.push(s),s=Bc(s);return i}function woe(t,e,n,r){var o=null;if(t&&Lo(n,_u)){var i=t[uv]||ya(null);if(o=(i[n[_u]]||ya(null))[e],o||hv("Missing ["+e+"] "+lv),!o[D1]&&i[Mf]!==!1){for(var s=!Lo(t,e),a=Bc(t),c=[];s&&a&&!H_(a)&&!V_(c,a);){var u=a[e];if(u){s=u===r;break}c.push(a),a=Bc(a)}try{s&&(t[e]=o),o[D1]=1}catch{i[Mf]=!1}}}return o}function Aoe(t,e,n){var r=e[t];return r===n&&(r=Bc(e)[t]),typeof r!==lv&&hv("["+t+"] is not a "+lv),r}function koe(t,e,n,r,o){function i(c,u){var h=function(){var p=woe(this,u,c,h)||Aoe(u,c,h);return p.apply(this,arguments)};return h[L1]=1,h}if(!Ym(t)){var s=n[uv]=n[uv]||ya(null);if(!Ym(s)){var a=s[e]=s[e]||ya(null);s[Mf]!==!1&&(s[Mf]=!!o),Ym(a)||dv(n,function(c){z_(n,c,!1)&&n[c]!==r[c]&&(a[c]=n[c],delete n[c],(!Lo(t,c)||t[c]&&!t[c][L1])&&(t[c]=i(t,c)))})}}}function xoe(t,e){if(Of){for(var n=[],r=Bc(e);r&&!H_(r)&&!V_(n,r);){if(r===t)return!0;n.push(r),r=Bc(r)}return!1}return!0}function tS(t,e){return Lo(t,As)?t.name||e||lR:((t||{})[cv]||{}).name||e||lR}function gn(t,e,n,r){Lo(t,As)||hv("theClass is an invalid class definition.");var o=t[As];xoe(o,e)||hv("["+tS(t)+"] not in hierarchy of ["+tS(e)+"]");var i=null;Lo(o,_u)?i=o[_u]:(i=Ioe+tS(t,"_")+"$"+U1.n,U1.n++,o[_u]=i);var s=gn[E4],a=!!s[Wm];a&&r&&r[Wm]!==void 0&&(a=!!r[Wm]);var c=Toe(e),u=_oe(o,e,c,a);n(e,u);var h=!!Of&&!!s[j1];h&&r&&(h=!!r[j1]),koe(o,i,e,c,h!==!1)}gn[E4]=U1.o;var I4=Lre,Qr=Ure,Ua=I4({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}),Ml=I4({NONE:0,PENDING:3,INACTIVE:1,ACTIVE:2}),$_="toLowerCase",fv="blkVal",vt="length",pv="rdOnly",mv="notify",gv="warnToConsole",vp="throwInternal",Ld="setDf",ha="watch",Rn="logger",ry="apply",Vt="push",bp="splice",T4="hdlr",hu="cancel",yp="initialize",Xs="identifier",vv="removeNotificationListener",bv="addNotificationListener",Hi="isInitialized",fR="instrumentationKey",nS="INACTIVE",ef="value",fm="getNotifyMgr",Lf="getPlugin",gc="name",dh="iKey",wu="time",wr="processNext",_4="getProcessTelContext",pR="pollInternalLogs",fu="enabled",mR="stopPollingInternalLogs",Sa="unload",pm="onComplete",gR="version",w4="loggingLevelConsole",Hc="createNew",ds="teardown",yv="messageId",vc="message",sd="isAsync",ys="diagLog",Cv="_doTeardown",Df="update",$i="getNext",jf="setNextPlugin",A4="protocol",F1="userAgent",oy="split",rS="nodeType",bc="replace",Roe="logInternalMessage",Cs="type",G_="handler",Oh="status",vR="getResponseHeader",bR="getAllResponseHeaders",B1="isChildEvt",eu="data",Au="getCtx",Ii="setCtx",H1="complete",hh="urlString",yR="sendPOST",oS="headers",Ol="timeout",CR="setRequestHeader",SR="traceId",ER="spanId",IR="traceFlags",iS;function Noe(t,e){iS||(iS=eoe("AggregationError",function(r,o){o[vt]>1&&(r.errors=o[1])}));var n=t;throw tt(e,function(r,o){n+=`
`.concat(o," > ").concat(jt(r))}),new iS(n,e||[])}/*!
 * NevWare21 Solutions LLC - ts-async, 0.5.2
 * https://github.com/nevware21/ts-async
 * Copyright (c) NevWare21 Solutions LLC and contributors. All rights reserved.
 * Licensed under the MIT license.
 */var Sv="Promise",K_="rejected";function ad(t,e){return k4(t,function(n){return e?e({status:"fulfilled",rejected:!1,value:n}):n},function(n){return e?e({status:K_,rejected:!0,reason:n}):n})}function k4(t,e,n,r){var o=t;try{if(od(t))(e||n)&&(o=t.then(e,n));else try{e&&(o=e(t))}catch(i){if(n)o=n(i);else throw i}}finally{}return o}var x4=["pending","resolving","resolved",K_],TR="dispatchEvent",mm;function Poe(t){var e;return t&&t.createEvent&&(e=t.createEvent("Event")),!!e&&e.initEvent}function Moe(t,e,n,r){var o=ws();!mm&&(mm=Vo(!!lr(Poe,[o]).v));var i=mm.v?o.createEvent("Event"):r?new Event(e):{};if(n&&n(i),mm.v&&i.initEvent(e,!1,!0),i&&t[TR])t[TR](i);else{var s=t["on"+e];if(s)s(i);else{var a=Un("console");a&&(a.error||a.log)(e,jt(i))}}}var R4="unhandledRejection",Ooe=R4.toLowerCase(),_R=[],Loe=0,Doe=10,sS;function wR(t){return on(t)?t.toString():jt(t)}function N4(t,e,n){var r=ty(arguments,3),o=0,i=!1,s,a=[],c=Loe++,u=!1,h=null,p;function f(I,T){try{_R.push(c),u=!0,h&&h.cancel(),h=null;var _=t(function(w,A){a.push(function(){try{var M=o===2?I:T,R=Jt(M)?s:on(M)?M(s):M;od(R)?R.then(w,A):M?w(R):o===3?A(R):w(R)}catch($){A($)}}),i&&b()},r);return _}finally{_R.pop()}}function g(I){return f(void 0,I)}function v(I){var T=I,_=I;return on(I)&&(T=function(w){return I&&I(),w},_=function(w){throw I&&I(),w}),f(T,_)}function y(){return x4[o]}function b(){if(a.length>0){var I=a.slice();a=[],u=!0,h&&h.cancel(),h=null,e(I)}}function C(I,T){return function(_){if(o===T){if(I===2&&od(_)){o=1,_.then(C(2,1),C(3,1));return}o=I,i=!0,s=_,b(),!u&&I===3&&!h&&(h=Fc(S,Doe))}}}function S(){if(!u)if(u=!0,Wre())process.emit(R4,s,p);else{var I=Ra()||Od();!sS&&(sS=Vo(lr(Un,[Sv+"RejectionEvent"]).v)),Moe(I,Ooe,function(T){return Cn(T,"promise",{g:function(){return p}}),T.reason=s,T},!!sS.v)}}p={then:f,catch:g,finally:v},_s(p,"state",{get:y}),Qre()&&(p[O_(11)]="IPromise");function E(){return"IPromise "+y()+(i?" - "+wR(s):"")}return p.toString=E,function(){on(n)||zo(Sv+": executor is not a function - "+wR(n));var T=C(3,0);try{n.call(p,C(2,0),T)}catch(_){T(_)}}(),p}function joe(t){return function(e){var n=ty(arguments,1);return t(function(r,o){try{var i=[],s=1;D_(e,function(a,c){a&&(s++,k4(a,function(u){i[c]=u,--s===0&&r(i)},o))}),s--,s===0&&r(i)}catch(a){o(a)}},n)}}function Uoe(t){return Vo(function(e){var n=ty(arguments,1);return t(function(r,o){var i=[],s=1;function a(c,u){s++,ad(c,function(h){h.rejected?i[u]={status:K_,reason:h.reason}:i[u]={status:"fulfilled",value:h.value},--s===0&&r(i)})}try{kt(e)?tt(e,a):b4(e)?D_(e,a):zo("Input is not an iterable"),s--,s===0&&r(i)}catch(c){o(c)}},n)})}function P4(t){tt(t,function(e){try{e()}catch{}})}function Foe(t){var e=ba(t)?t:0;return function(n){Fc(function(){P4(n)},e)}}function M4(t,e){return N4(M4,Foe(e),t,e)}var aS;function Boe(t,e){!aS&&(aS=Vo(lr(Un,[Sv]).v||null));var n=aS.v;if(!n)return M4(t);on(t)||zo(Sv+": executor is not a function - "+jt(t));var r=0;function o(){return x4[r]}var i=new n(function(s,a){function c(h){r=2,s(h)}function u(h){r=3,a(h)}t(c,u)});return _s(i,"state",{get:o}),i}var cS;function O4(t){return N4(O4,P4,t)}function Hoe(t,e){return!cS&&(cS=Uoe(O4)),cS.v(t,e)}var lS;function zc(t,e){return!lS&&(lS=Vo(Boe)),lS.v.call(this,t,e)}var zoe=joe(zc),Ni=void 0,Dt="",ec="channels",$n="core",z1="createPerfMgr",V1="disabled",ku="extensionConfig",tu="extensions",Yi="processTelemetry",Ev="priority",Qm="eventsSent",tf="eventsDiscarded",Jm="eventsSendRequest",lc="perfEvent",uS="offlineEventsStored",dS="offlineBatchSent",hS="offlineBatchDrop",Iv="getPerfMgr",$1="domain",fS="path",Voe="Not dynamic - ",$oe=/-([a-z])/g,Goe=/([^\w\d_$])/g,Koe=/^(\d+[\w\d_$])/;function Tv(t){return!Zt(t)}function G1(t){var e=t;return e&&mr(e)&&(e=e[bc]($oe,function(n,r){return r.toUpperCase()}),e=e[bc](Goe,"_"),e=e[bc](Koe,function(n,r){return"_"+r})),e}function Br(t,e){return t&&e?ny(t,e)!==-1:!1}function K1(t){return t&&t.toISOString()||""}function L4(t){return xre(t)?t[gc]:Dt}function Ll(t,e,n,r,o){var i=n;return t&&(i=t[e],i!==n&&(!o||o(i))&&(!r||r(n))&&(i=n,t[e]=i)),i}function qoe(t,e,n){var r;return t?(r=t[e],!r&&Zt(r)&&(r=Jt(n)?{}:n,t[e]=r)):r=Jt(n)?{}:n,r}function Woe(t,e){var n=null,r=null;return on(t)?n=t:r=t,function(){var o=arguments;if(n&&(r=n()),r)return r[e][ry](r,o)}}function _v(t,e,n,r,o){t&&e&&n&&(t[e]=Woe(n,r))}function D4(t,e,n,r){return t&&e&&rd(t)&&kt(n)&&tt(n,function(o){mr(o)&&_v(t,o,e,o)}),t}function nu(t){return t&&eR&&(t=w_(eR({},t))),t}function cd(t){try{return t.responseText}catch{}return null}function Yoe(t,e){return t?"XDomainRequest,Response:"+cd(t)||"":e}function AR(t,e){return t?"XMLHttpRequest,Status:"+t[Oh]+",Response:"+cd(t)||t.response||"":e}function kR(t,e){return e&&(ba(e)?t=[e].concat(t):kt(e)&&(t=e.concat(t))),t}var Qoe="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",xR="withCredentials",Joe="timeout";function Zoe(t,e,n,r,o,i){o===void 0&&(o=!1);function s(c,u,h){try{c[u]=h}catch{}}var a=new XMLHttpRequest;return s(a,Qoe,r),n&&s(a,xR,n),a.open(t,e,!o),n&&s(a,xR,n),!o&&i&&s(a,Joe,i),a}function Xoe(t){var e={};if(mr(t)){var n=Gr(t)[oy](/[\r\n]+/);tt(n,function(r){if(r){var o=r.indexOf(": ");if(o!==-1){var i=Gr(r.substring(0,o))[$_](),s=Gr(r.substring(o+1));e[i]=s}else e[Gr(r)]=1}})}return e}function pS(t,e,n){if(!t[n]&&e&&e[vR]){var r=e[vR](n);r&&(t[n]=Gr(r))}return t}var eie="kill-duration",tie="kill-duration-seconds",nie="time-delta-millis";function Zm(t,e){var n={};return t[bR]?n=Xoe(t[bR]()):e&&(n=pS(n,t,nie),n=pS(n,t,eie),n=pS(n,t,tie)),n}var rie="location",oie="console",j4="JSON",iie="crypto",sie="msCrypto",aie="ReactNative",cie="msie",lie="trident/",U4="XMLHttpRequest",mS=null,gS=null,Dl=null,vS=null;function F4(t,e){var n=!1;if(t){try{if(n=e in t,!n){var r=t[Zh];r&&(n=e in r)}}catch{}if(!n)try{var o=new t;n=!Jt(o[e])}catch{}}return n}function iy(t){return typeof location===T_&&location?location:Un(rie)}function uie(){return typeof console!==__?console:Un(oie)}function B4(){return!!(typeof JSON===T_&&JSON||Un(j4)!==null)}function die(){return B4()?JSON||Un(j4):null}function hie(){return Un(iie)}function fie(){return Un(sie)}function q1(){var t=Xi();return t&&t.product?t.product===aie:!1}function W1(){var t=Xi();if(t&&(t[F1]!==gS||mS===null)){gS=t[F1];var e=(gS||Dt)[$_]();mS=Br(e,cie)||Br(e,lie)}return mS}function H4(t){return(vS===null||t===!1)&&(vS=qre()&&!!Xi().sendBeacon),vS}function z4(t){var e=!1;try{e=!!Un("fetch");var n=Un("Request");e&&t&&n&&(e=F4(n,"keepalive"))}catch{}return e}function pie(){return Dl===null&&(Dl=typeof XDomainRequest!==__,Dl&&V4()&&(Dl=Dl&&!F4(Un(U4),"withCredentials"))),Dl}function V4(){var t=!1;try{var e=Un(U4);t=!!e}catch{}return t}var $4=4294967296,yc=4294967295,G4=123456789,K4=987654321,q4=!1,Lh=G4,Dh=K4;function mie(t){t<0&&(t>>>=0),Lh=G4+t&yc,Dh=K4-t&yc,q4=!0}function gie(){try{var t=Ca()&2147483647;mie((Math.random()*$4^t)+t)}catch{}}function Uf(t){var e=0,n=hie()||fie();return n&&n.getRandomValues&&(e=n.getRandomValues(new Uint32Array(1))[0]&yc),e===0&&W1()&&(q4||gie(),e=vie()&yc),e===0&&(e=Math.floor($4*Math.random()|0)),t||(e>>>=0),e}function vie(t){Dh=36969*(Dh&65535)+(Dh>>16)&yc,Lh=18e3*(Lh&65535)+(Lh>>16)&yc;var e=(Dh<<16)+(Lh&65535)>>>0&yc|0;return e>>>=0,e}function q_(t){t===void 0&&(t=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=Uf()>>>0,r=0,o=Dt;o[vt]<t;)r++,o+=e.charAt(n&63),n>>>=6,r===5&&(n=(Uf()<<2&4294967295|n&3)>>>0,r=0);return o}var W4="3.3.3",bie="."+q_(6),yie=0;function Y4(t){return t[rS]===1||t[rS]===9||!+t[rS]}function Cie(t,e){var n=e[t.id];if(!n){n={};try{Y4(e)&&Cn(e,t.id,{e:!1,v:n})}catch{}}return n}function Dd(t,e){return e===void 0&&(e=!1),G1(t+yie+++(e?"."+W4:Dt)+bie)}function Q4(t){var e={id:Dd("_aiData-"+(t||Dt)+"."+W4),accept:function(n){return Y4(n)},get:function(n,r,o,i){var s=n[e.id];return s?s[G1(r)]:(i&&(s=Cie(e,n),s[G1(r)]=o),o)},kill:function(n,r){if(n&&n[r])try{delete n[r]}catch{}}};return e}function Xm(t){return t&&rd(t)&&(t.isVal||t.fb||Tu(t,"v")||Tu(t,"mrg")||Tu(t,"ref")||t.set)}function J4(t,e,n){var r,o=n.dfVal||R_;if(e&&n.fb){var i=n.fb;kt(i)||(i=[i]);for(var s=0;s<i[vt];s++){var a=i[s],c=e[a];if(o(c)?r=c:t&&(c=t.cfg[a],o(c)&&(r=c),t.set(t.cfg,oi(a),c)),o(r))break}}return!o(r)&&o(n.v)&&(r=n.v),r}function Y1(t,e,n){var r=n;if(n&&Xm(n)&&(r=J4(t,e,n)),r){Xm(r)&&(r=Y1(t,e,r));var o;kt(r)?(o=[],o[vt]=r[vt]):ii(r)&&(o={}),o&&(sn(r,function(i,s){s&&Xm(s)&&(s=Y1(t,e,s)),o[i]=s}),r=o)}return r}function W_(t,e,n,r){var o,i,s,a=r,c,u,h,p;Xm(a)?(o=a.isVal,i=a.set,h=a[pv],p=a[fv],c=a.mrg,u=a.ref,!u&&Jt(u)&&(u=!!c),s=J4(t,e,a)):s=r,p&&t[fv](e,n);var f,g=!0,v=e[n];(v||!Zt(v))&&(f=v,g=!1,o&&f!==s&&!o(f)&&(f=s,g=!0),i&&(f=i(f,s,e),g=f===s)),g?s?f=Y1(t,e,s):f=s:(ii(f)||kt(s))&&c&&s&&(ii(s)||kt(s))&&sn(s,function(y,b){W_(t,f,y,b)}),t.set(e,n,f),u&&t.ref(e,n),h&&t[pv](e,n)}var Ea=L_("[[ai_dynCfg_1]]"),Z4=L_("[[ai_blkDynCfg_1]]"),Sie=L_("[[ai_frcDynCfg_1]]");function X4(t){if(t){var e;if(kt(t)?(e=[],e[vt]=t[vt]):ii(t)&&(e={}),e)return sn(t,function(n,r){e[n]=X4(r)}),e}return t}function Eie(t){if(t){var e=t[Ea]||t;if(e.cfg&&(e.cfg===t||e.cfg[Ea]===e))return e}return null}function Iie(t){if(t&&(ii(t)||kt(t)))try{t[Z4]=!0}catch{}return t}function bS(t,e,n){var r=!1;return n&&!t[e.blkVal]&&(r=n[Sie],!r&&!n[Z4]&&(r=ii(n)||kt(n))),r}function e6(t){zo("InvalidAccess:"+t)}var Tie=["push","pop","shift","unshift","splice"],Ff=function(t,e,n,r){t&&t[vp](3,108,"".concat(n," [").concat(e,"] failed - ")+jt(r))};function _ie(t,e,n){kt(e)&&tt(Tie,function(r){var o=e[r];e[r]=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var a=o[ry](this,i);return Av(t,e,n,"Patching"),a}})}function wv(t,e){var n=N_(t,e);return n&&n.get}function wie(t,e,n,r){var o={n,h:[],trk:function(u){u&&u.fn&&(Do(o.h,u)===-1&&o.h[Vt](u),t.trk(u,o))},clr:function(u){var h=Do(o.h,u);h!==-1&&o.h[bp](h,1)}},i=!0,s=!1;function a(){i&&(s=s||bS(a,t,r),r&&!r[Ea]&&s&&(r=Av(t,r,n,"Converting")),i=!1);var u=t.act;return u&&o.trk(u),r}a[t.prop]={chng:function(){t.add(o)}};function c(u){if(r!==u){a[t.ro]&&!t.upd&&e6("["+n+"] is read-only:"+jt(e)),i&&(s=s||bS(a,t,r),i=!1);var h=s&&a[t.rf];if(s)if(h){sn(r,function(f){r[f]=u?u[f]:Ni});try{sn(u,function(f,g){sy(t,r,f,g)}),u=r}catch(f){Ff((t.hdlr||{})[Rn],n,"Assigning",f),s=!1}}else r&&r[Ea]&&sn(r,function(f){var g=wv(r,f);if(g){var v=g[t.prop];v&&v.chng()}});if(u!==r){var p=u&&bS(a,t,u);!h&&p&&(u=Av(t,u,n,"Converting")),r=u,s=p}t.add(o)}}Cn(e,o.n,{g:a,s:c})}function sy(t,e,n,r){if(e){var o=wv(e,n),i=o&&!!o[t.prop];i?e[n]=r:wie(t,e,n,r)}return e}function yS(t,e,n,r){if(e){var o=wv(e,n),i=o&&!!o[t.prop],s=r&&r[0],a=r&&r[1],c=r&&r[2];if(!i){if(c)try{Iie(e)}catch(u){Ff((t.hdlr||{})[Rn],n,"Blocking",u)}try{sy(t,e,n,e[n]),o=wv(e,n)}catch(u){Ff((t.hdlr||{})[Rn],n,"State",u)}}s&&(o[t.rf]=s),a&&(o[t.ro]=a),c&&(o[t.blkVal]=!0)}return e}function Av(t,e,n,r){try{sn(e,function(o,i){sy(t,e,o,i)}),e[Ea]||(_s(e,Ea,{get:function(){return t[T4]}}),_ie(t,e,n))}catch(o){Ff((t.hdlr||{})[Rn],n,r,o)}return e}var fh="[[ai_",ph="]]";function Aie(t){var e,n=uh(fh+"get"+t.uid+ph),r=uh(fh+"ro"+t.uid+ph),o=uh(fh+"rf"+t.uid+ph),i=uh(fh+"blkVal"+t.uid+ph),s=uh(fh+"dtl"+t.uid+ph),a=null,c=null,u;function h(v,y){var b=u.act;try{u.act=v,v&&v[s]&&(tt(v[s],function(S){S.clr(v)}),v[s]=[]),y({cfg:t.cfg,set:t.set.bind(t),setDf:t[Ld].bind(t),ref:t.ref.bind(t),rdOnly:t[pv].bind(t)})}catch(S){var C=t[Rn];throw C&&C[vp](1,107,jt(S)),S}finally{u.act=b||null}}function p(){if(a){var v=a;a=null,c&&c[hu](),c=null;var y=[];if(tt(v,function(b){if(b&&(b[s]&&(tt(b[s],function(C){C.clr(b)}),b[s]=null),b.fn))try{h(b,b.fn)}catch(C){y[Vt](C)}}),a)try{p()}catch(b){y[Vt](b)}y[vt]>0&&Noe("Watcher error(s): ",y)}}function f(v){if(v&&v.h[vt]>0){a||(a=[]),c||(c=Fc(function(){c=null,p()},0));for(var y=0;y<v.h[vt];y++){var b=v.h[y];b&&Do(a,b)===-1&&a[Vt](b)}}}function g(v,y){if(v){var b=v[s]=v[s]||[];Do(b,y)===-1&&b[Vt](y)}}return u=(e={prop:n,ro:r,rf:o},e[fv]=i,e[T4]=t,e.add=f,e[mv]=p,e.use=h,e.trk=g,e),u}function kie(t,e){var n={fn:e,rm:function(){n.fn=null,t=null,e=null}};return Cn(n,"toJSON",{v:function(){return"WatcherHandler"+(n.fn?"":"[X]")}}),t.use(n,e),n}function xie(t,e,n){var r,o=Eie(e);if(o)return o;var i=Dd("dyncfg",!0),s=e&&n!==!1?e:X4(e),a;function c(){a[mv]()}function u(C,S,E){try{C=sy(a,C,S,E)}catch(I){Ff(t,S,"Setting value",I)}return C[S]}function h(C){return kie(a,C)}function p(C,S){a.use(null,function(E){var I=a.upd;try{Jt(S)||(a.upd=S),C(E)}finally{a.upd=I}})}function f(C,S){var E;return yS(a,C,S,(E={},E[0]=!0,E))[S]}function g(C,S){var E;return yS(a,C,S,(E={},E[1]=!0,E))[S]}function v(C,S){var E;return yS(a,C,S,(E={},E[2]=!0,E))[S]}function y(C,S){return S&&sn(S,function(E,I){W_(b,C,E,I)}),C}var b=(r={uid:null,cfg:s},r[Rn]=t,r[mv]=c,r.set=u,r[Ld]=y,r[ha]=h,r.ref=f,r[pv]=g,r[fv]=v,r._block=p,r);return Cn(b,"uid",{c:!1,e:!1,w:!1,v:i}),a=Aie(b),Av(a,s,"config","Creating"),b}function Rie(t,e){t?(t[gv](e),t[vp](2,108,e)):e6(e)}function mo(t,e,n,r){var o=xie(n,t||{},r);return e&&o[Ld](o.cfg,e),o}function vr(t,e,n){var r=t[Ea]||t;return r.cfg&&(r.cfg===t||r.cfg[Ea]===r)?r[ha](e):(Rie(n,Voe+jt(t)),mo(t,null,n)[ha](e))}function jh(t,e){if(t&&t[Sa])return t[Sa](e)}function t6(t,e,n){var r;return n||(r=zc(function(o){n=o})),t&&hoe(t)>0?ad(jh(t[0],e),function(){t6(ty(t,1),e,n)}):n(),r}var Nie=500,RR="Microsoft_ApplicationInsights_BypassAjaxInstrumentation";function Q1(t){return{mrg:!0,v:t}}function Fa(t){return{isVal:mr,v:oi(Dt)}}var CS=[Qm,tf,Jm,lc],kv=null,gm;function Pie(t,e){return function(){var n=arguments,r=n6(e);if(r){var o=r.listener;o&&o[t]&&o[t][ry](o,n)}}}function Mie(){var t=Un("Microsoft");return t&&(kv=t.ApplicationInsights),kv}function n6(t){var e=kv;return!e&&t.disableDbgExt!==!0&&(e=kv||Mie()),e?e.ChromeDbgExt:null}function Oie(t){if(!gm){gm={};for(var e=0;e<CS[vt];e++)gm[CS[e]]=Pie(CS[e],t)}return gm}var jl,r6="warnToConsole",Lie="AI (Internal): ",Die="AI: ",jie="AITR_",Uie={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},Fie=(jl={},jl[0]=null,jl[1]="errorToConsole",jl[2]=r6,jl[3]="debugToConsole",jl);function NR(t){return t?'"'+t[bc](/\"/g,Dt)+'"':Dt}function SS(t,e){var n=uie();if(n){var r="log";n[t]&&(r=t),on(n[r])&&n[r](e)}}var J1=function(){function t(e,n,r,o){r===void 0&&(r=!1);var i=this;i[yv]=e,i[vc]=(r?Die:Lie)+e;var s=Dt;B4()&&(s=die().stringify(o));var a=(n?" message:"+NR(n):Dt)+(o?" props:"+NR(s):Dt);i[vc]+=a}return t.dataType="MessageData",t}();function Y_(t,e){return(t||{})[Rn]||new xv(e)}var xv=function(){function t(e){this.identifier="DiagnosticLogger",this.queue=[];var n=0,r={},o,i,s,a,c;gn(t,this,function(u){c=p(e||{}),u.consoleLoggingLevel=function(){return o},u[vp]=function(v,y,b,C,S){S===void 0&&(S=!1);var E=new J1(y,b,S,C);if(a)throw jt(E);var I=Fie[v]||r6;if(Jt(E[vc]))g("throw"+(v===1?"Critical":"Warning"),E);else{if(S){var T=+E[yv];!r[T]&&o>=v&&(u[I](E[vc]),r[T]=!0)}else o>=v&&u[I](E[vc]);h(v,E)}},u.debugToConsole=function(v){SS("debug",v),g("warning",v)},u[gv]=function(v){SS("warn",v),g("warning",v)},u.errorToConsole=function(v){SS("error",v),g("error",v)},u.resetInternalMessageCount=function(){n=0,r={}},u[Roe]=h,u[Sa]=function(v){c&&c.rm(),c=null};function h(v,y){if(!f()){var b=!0,C=jie+y[yv];if(r[C]?b=!1:r[C]=!0,b&&(v<=i&&(u.queue[Vt](y),n++,g(v===1?"error":"warn",y)),n===s)){var S="Internal events throttle limit per PageView reached for this app.",E=new J1(23,S,!1);u.queue[Vt](E),v===1?u.errorToConsole(S):u[gv](S)}}}function p(v){return vr(mo(v,Uie,u).cfg,function(y){var b=y.cfg;o=b[w4],i=b.loggingLevelTelemetry,s=b.maxMessageLimit,a=b.enableDebug})}function f(){return n>=s}function g(v,y){var b=n6(e||{});b&&b[ys]&&b[ys](v,y)}})}return t.__ieDyn=1,t}();function o6(t){return t||new xv}function rn(t,e,n,r,o,i){i===void 0&&(i=!1),o6(t)[vp](e,n,r,o,i)}function nf(t,e){o6(t)[gv](e)}var ES,Ba,PR="toGMTString",MR="toUTCString",Q_="cookie",IS="expires",OR="isCookieUseDisabled",Z1="disableCookiesUsage",pu="_ckMgr",vm=null,TS=null,LR=null,Gi,DR={},Rv={},Bie=(ES={cookieCfg:Q1((Ba={},Ba[$1]={fb:"cookieDomain",dfVal:Tv},Ba.path={fb:"cookiePath",dfVal:Tv},Ba.enabled=Ni,Ba.ignoreCookies=Ni,Ba.blockedCookies=Ni,Ba)),cookieDomain:Ni,cookiePath:Ni},ES[Z1]=Ni,ES);function J_(){!Gi&&(Gi=Gre(function(){return ws()}))}function Hie(t,e){var n=eg[pu]||Rv[pu];return n||(n=eg[pu]=eg(t,e),Rv[pu]=n),n}function bm(t){return t?t.isEnabled():!0}function i6(t,e){return e&&t&&kt(t.ignoreCookies)?Do(t.ignoreCookies,e)!==-1:!1}function zie(t,e){return e&&t&&kt(t.blockedCookies)&&Do(t.blockedCookies,e)!==-1?!0:i6(t,e)}function jR(t,e){var n=e[fu];if(Zt(n)){var r=void 0;Jt(t[OR])||(r=!t[OR]),Jt(t[Z1])||(r=!t[Z1]),n=r}return n}function s6(t,e){var n;return t&&(n=t.getCookieMgr()),n||(n=Hie(e,(t||{})[Rn])),n}function eg(t,e){var n,r,o,i,s,a,c,u,h;t=mo(t||Rv,null,e).cfg,s=vr(t,function(f){f[Ld](f.cfg,Bie),r=f.ref(f.cfg,"cookieCfg"),o=r[fS]||"/",i=r[$1],a=jR(t,r)!==!1,c=r.getCookie||Vie,u=r.setCookie||HR,h=r.delCookie||HR},e);var p=(n={isEnabled:function(){var f=jR(t,r)!==!1&&a&&UR(e),g=Rv[pu];return f&&g&&p!==g&&(f=bm(g)),f},setEnabled:function(f){a=f!==!1,r[fu]=f},set:function(f,g,v,y,b){var C=!1;if(bm(p)&&!zie(r,f)){var S={},E=Gr(g||Dt),I=ny(E,";");if(I!==-1&&(E=Gr(P_(g,I)),S=a6(Oi(g,I+1))),Ll(S,$1,y||i,Xx,Jt),!Zt(v)){var T=W1();if(Jt(S[IS])){var _=Ca(),w=_+v*1e3;if(w>0){var A=new Date;A.setTime(w),Ll(S,IS,FR(A,T?PR:MR)||FR(A,T?PR:MR)||Dt,Xx)}}T||Ll(S,"max-age",Dt+v,null,Jt)}var M=iy();M&&M[A4]==="https:"&&(Ll(S,"secure",null,null,Jt),TS===null&&(TS=!$ie((Xi()||{})[F1])),TS&&Ll(S,"SameSite","None",null,Jt)),Ll(S,fS,b||o,null,Jt),u(f,BR(E,S)),C=!0}return C},get:function(f){var g=Dt;return bm(p)&&!i6(r,f)&&(g=c(f)),g},del:function(f,g){var v=!1;return bm(p)&&(v=p.purge(f,g)),v},purge:function(f,g){var v,y=!1;if(UR(e)){var b=(v={},v[fS]=g||"/",v[IS]="Thu, 01 Jan 1970 00:00:01 GMT",v);W1()||(b["max-age"]="0"),h(f,BR(Dt,b)),y=!0}return y}},n[Sa]=function(f){s&&s.rm(),s=null},n);return p[pu]=p,p}function UR(t){if(vm===null){vm=!1,!Gi&&J_();try{var e=Gi.v||{};vm=e[Q_]!==void 0}catch(n){rn(t,2,68,"Cannot access document.cookie - "+L4(n),{exception:jt(n)})}}return vm}function a6(t){var e={};if(t&&t[vt]){var n=Gr(t)[oy](";");tt(n,function(r){if(r=Gr(r||Dt),r){var o=ny(r,"=");o===-1?e[r]=null:e[Gr(P_(r,o))]=Gr(Oi(r,o+1))}})}return e}function FR(t,e){return on(t[e])?t[e]():null}function BR(t,e){var n=t||Dt;return sn(e,function(r,o){n+="; "+r+(Zt(o)?Dt:"="+o)}),n}function Vie(t){var e=Dt;if(!Gi&&J_(),Gi.v){var n=Gi.v[Q_]||Dt;LR!==n&&(DR=a6(n),LR=n),e=Gr(DR[t]||Dt)}return e}function HR(t,e){!Gi&&J_(),Gi.v&&(Gi.v[Q_]=t+"="+e)}function $ie(t){return mr(t)?!!(Br(t,"CPU iPhone OS 12")||Br(t,"iPad; CPU OS 12")||Br(t,"Macintosh; Intel Mac OS X 10_14")&&Br(t,"Version/")&&Br(t,"Safari")||Br(t,"Macintosh; Intel Mac OS X 10_14")&&moe(t,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Br(t,"Chrome/5")||Br(t,"Chrome/6")||Br(t,"UnrealEngine")&&!Br(t,"Chrome")||Br(t,"UCBrowser/12")||Br(t,"UCBrowser/11")):!1}var Gie={perfEvtsSendAll:!1};function Kie(t){t.h=null;var e=t.cb;t.cb=[],tt(e,function(n){lr(n.fn,[n.arg])})}function zs(t,e,n,r){tt(t,function(o){o&&o[e]&&(n?(n.cb[Vt]({fn:r,arg:o}),n.h=n.h||Fc(Kie,0,n)):lr(r,[o]))})}var qie=function(){function t(e){this.listeners=[];var n,r,o=[],i={h:null,cb:[]},s=mo(e,Gie);r=s[ha](function(a){n=!!a.cfg.perfEvtsSendAll}),gn(t,this,function(a){Cn(a,"listeners",{g:function(){return o}}),a[bv]=function(c){o[Vt](c)},a[vv]=function(c){for(var u=Do(o,c);u>-1;)o[bp](u,1),u=Do(o,c)},a[Qm]=function(c){zs(o,Qm,i,function(u){u[Qm](c)})},a[tf]=function(c,u){zs(o,tf,i,function(h){h[tf](c,u)})},a[Jm]=function(c,u){zs(o,Jm,u?i:null,function(h){h[Jm](c,u)})},a[lc]=function(c){c&&(n||!c[B1]())&&zs(o,lc,null,function(u){c[sd]?Fc(function(){return u[lc](c)},0):u[lc](c)})},a[uS]=function(c){c&&c[vt]&&zs(o,uS,i,function(u){u[uS](c)})},a[dS]=function(c){c&&c[eu]&&zs(o,dS,i,function(u){u[dS](c)})},a[hS]=function(c,u){if(c>0){var h=u||0;zs(o,hS,i,function(p){p[hS](c,h)})}},a[Sa]=function(c){var u=function(){r&&r.rm(),r=null,o=[],i.h&&i.h[hu](),i.h=null,i.cb=[]},h;if(zs(o,"unload",null,function(p){var f=p[Sa](c);f&&(h||(h=[]),h[Vt](f))}),h)return zc(function(p){return ad(zoe(h),function(){u(),p()})});u()}})}return t.__ieDyn=1,t}(),xu="ctx",X1="ParentContextKey",rf="ChildrenContextKey",Wie=null,tg=function(){function t(e,n,r){var o=this;if(o.start=Ca(),o[gc]=e,o[sd]=r,o[B1]=function(){return!1},on(n)){var i;Cn(o,"payload",{g:function(){return!i&&on(n)&&(i=n(),n=null),i}})}o[Au]=function(s){return s?s===t[X1]||s===t[rf]?o[s]:(o[xu]||{})[s]:null},o[Ii]=function(s,a){if(s)if(s===t[X1])o[s]||(o[B1]=function(){return!0}),o[s]=a;else if(s===t[rf])o[s]=a;else{var c=o[xu]=o[xu]||{};c[s]=a}},o[H1]=function(){var s=0,a=o[Au](t[rf]);if(kt(a))for(var c=0;c<a[vt];c++){var u=a[c];u&&(s+=u[wu])}o[wu]=Ca()-o.start,o.exTime=o[wu]-s,o[H1]=function(){}}}return t.ParentContextKey="parent",t.ChildrenContextKey="childEvts",t}(),Yie=function(){function t(e){this.ctx={},gn(t,this,function(n){n.create=function(r,o,i){return new tg(r,o,i)},n.fire=function(r){r&&(r[H1](),e&&on(e[lc])&&e[lc](r))},n[Ii]=function(r,o){if(r){var i=n[xu]=n[xu]||{};i[r]=o}},n[Au]=function(r){return(n[xu]||{})[r]}})}return t.__ieDyn=1,t}(),_S="CoreUtils.doPerf";function zr(t,e,n,r,o){if(t){var i=t;if(i[Iv]&&(i=i[Iv]()),i){var s=void 0,a=i[Au](_S);try{if(s=i.create(e(),r,o),s){if(a&&s[Ii]&&(s[Ii](tg[X1],a),a[Au]&&a[Ii])){var c=a[Au](tg[rf]);c||(c=[],a[Ii](tg[rf],c)),c[Vt](s)}return i[Ii](_S,s),n(s)}}catch(u){s&&s[Ii]&&s[Ii]("exception",u)}finally{s&&i.fire(s),i[Ii](_S,a)}}}return n()}function Qie(){return Wie}function c6(){var t=eE();return Oi(t,0,8)+"-"+Oi(t,8,12)+"-"+Oi(t,12,16)+"-"+Oi(t,16,20)+"-"+Oi(t,20)}function eE(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=Dt,n,r=0;r<4;r++)n=Uf(),e+=t[n&15]+t[n>>4&15]+t[n>>8&15]+t[n>>12&15]+t[n>>16&15]+t[n>>20&15]+t[n>>24&15]+t[n>>28&15];var o=t[8+(Uf()&3)|0];return Xl(e,0,8)+Xl(e,9,4)+"4"+Xl(e,13,3)+o+Xl(e,16,3)+Xl(e,19,12)}var Jie="00000000000000000000000000000000",Zie="0000000000000000";function l6(t,e,n){return t&&t[vt]===e&&t!==n?!!t.match(/^[\da-f]*$/i):!1}function u6(t){return l6(t,32,Jie)}function d6(t){return l6(t,16,Zie)}var Xie=Q4("plugin");function Cc(t){return Xie.get(t,"state",{},!0)}function zR(t,e){for(var n=[],r=null,o=t[$i](),i;o;){var s=o[Lf]();if(s){r&&r[jf]&&s[Yi]&&r[jf](s),i=Cc(s);var a=!!i[Hi];s[Hi]&&(a=s[Hi]()),a||n[Vt](s),r=s,o=o[$i]()}}tt(n,function(c){var u=t[$n]();c[yp](t.getCfg(),u,e,t[$i]()),i=Cc(c),!c[$n]&&!i[$n]&&(i[$n]=u),i[Hi]=!0,delete i[ds]})}function wS(t){return t.sort(function(e,n){var r=0;if(n){var o=n[Yi];e[Yi]?r=o?e[Ev]-n[Ev]:1:o&&(r=-1)}else r=e?1:-1;return r})}function ese(t){var e={};return{getName:function(){return e[gc]},setName:function(n){e[gc]=n},getTraceId:function(){return e[SR]},setTraceId:function(n){u6(n)&&(e[SR]=n)},getSpanId:function(){return e[ER]},setSpanId:function(n){d6(n)&&(e[ER]=n)},getTraceFlags:function(){return e[IR]},setTraceFlags:function(n){e[IR]=n}}}var tse="TelemetryPluginChain",VR="_hasRun",$R="_getTelCtx",GR=0;function nse(t,e,n){for(;t;){if(t[Lf]()===n)return t;t=t[$i]()}return $c([n],e.config||{},e)}function Z_(t,e,n,r){var o=null,i=[];e||(e=mo({},null,n[Rn])),r!==null&&(o=r?nse(t,n,r):t);var s={_next:c,ctx:{core:function(){return n},diagLog:function(){return Y_(n,e.cfg)},getCfg:function(){return e.cfg},getExtCfg:h,getConfig:p,hasNext:function(){return!!o},getNext:function(){return o},setNext:function(g){o=g},iterate:f,onComplete:a}};function a(g,v){for(var y=[],b=2;b<arguments.length;b++)y[b-2]=arguments[b];g&&i[Vt]({func:g,self:Jt(v)?s.ctx:v,args:y})}function c(){var g=o;if(o=g?g[$i]():null,!g){var v=i;v&&v[vt]>0&&(tt(v,function(y){try{y.func.call(y.self,y.args)}catch(b){rn(n[Rn],2,73,"Unexpected Exception during onComplete - "+jt(b))}}),i=[])}return g}function u(g,v){var y=null,b=e.cfg;if(b&&g){var C=b[ku];!C&&v&&(C={}),b[ku]=C,C=e.ref(b,ku),C&&(y=C[g],!y&&v&&(y={}),C[g]=y,y=e.ref(C,g))}return y}function h(g,v){var y=u(g,!0);return v&&sn(v,function(b,C){if(Zt(y[b])){var S=e.cfg[b];(S||!Zt(S))&&(y[b]=S)}W_(e,y,b,C)}),e[Ld](y,v)}function p(g,v,y){y===void 0&&(y=!1);var b,C=u(g,!1),S=e.cfg;return C&&(C[v]||!Zt(C[v]))?b=C[v]:(S[v]||!Zt(S[v]))&&(b=S[v]),b||!Zt(b)?b:y}function f(g){for(var v;v=s._next();){var y=v[Lf]();y&&g(y)}}return s}function Vc(t,e,n,r){var o=mo(e),i=Z_(t,o,n,r),s=i.ctx;function a(u){var h=i._next();return h&&h[Yi](u,s),!h}function c(u,h){return u===void 0&&(u=null),kt(u)&&(u=$c(u,o.cfg,n,h)),Vc(u||s[$i](),o.cfg,n,h)}return s[wr]=a,s[Hc]=c,s}function Nv(t,e,n){var r=mo(e.config),o=Z_(t,r,e,n),i=o.ctx;function s(c){var u=o._next();return u&&u[Sa](i,c),!u}function a(c,u){return c===void 0&&(c=null),kt(c)&&(c=$c(c,r.cfg,e,u)),Nv(c||i[$i](),e,u)}return i[wr]=s,i[Hc]=a,i}function X_(t,e,n){var r=mo(e.config),o=Z_(t,r,e,n),i=o.ctx;function s(c){return i.iterate(function(u){on(u[Df])&&u[Df](i,c)})}function a(c,u){return c===void 0&&(c=null),kt(c)&&(c=$c(c,r.cfg,e,u)),X_(c||i[$i](),e,u)}return i[wr]=s,i[Hc]=a,i}function $c(t,e,n,r){var o=null,i=!r;if(kt(t)&&t[vt]>0){var s=null;tt(t,function(a){if(!i&&r===a&&(i=!0),i&&a&&on(a[Yi])){var c=rse(a,e,n);o||(o=c),s&&s._setNext(c),s=c}})}return r&&!o?$c([r],e,n):o}function rse(t,e,n){var r=null,o=on(t[Yi]),i=on(t[jf]),s;t?s=t[Xs]+"-"+t[Ev]+"-"+GR++:s="Unknown-0-"+GR++;var a={getPlugin:function(){return t},getNext:function(){return r},processTelemetry:h,unload:p,update:f,_id:s,_setNext:function(g){r=g}};function c(){var g;return t&&on(t[$R])&&(g=t[$R]()),g||(g=Vc(a,e,n)),g}function u(g,v,y,b,C){var S=!1,E=t?t[Xs]:tse,I=g[VR];return I||(I=g[VR]={}),g.setNext(r),t&&zr(g[$n](),function(){return E+":"+y},function(){I[s]=!0;try{var T=r?r._id:Dt;T&&(I[T]=!1),S=v(g)}catch(w){var _=r?I[r._id]:!0;_&&(S=!0),(!r||!_)&&rn(g[ys](),1,73,"Plugin ["+E+"] failed during "+y+" - "+jt(w)+", run flags: "+jt(I))}},b,C),S}function h(g,v){v=v||c();function y(b){if(!t||!o)return!1;var C=Cc(t);return C[ds]||C[V1]?!1:(i&&t[jf](r),t[Yi](g,b),!0)}u(v,y,"processTelemetry",function(){return{item:g}},!g.sync)||v[wr](g)}function p(g,v){function y(){var b=!1;if(t){var C=Cc(t),S=t[$n]||C[$n];t&&(!S||S===g.core())&&!C[ds]&&(C[$n]=null,C[ds]=!0,C[Hi]=!1,t[ds]&&t[ds](g,v)===!0&&(b=!0))}return b}u(g,y,"unload",function(){},v[sd])||g[wr](v)}function f(g,v){function y(){var b=!1;if(t){var C=Cc(t),S=t[$n]||C[$n];t&&(!S||S===g.core())&&!C[ds]&&t[Df]&&t[Df](g,v)===!0&&(b=!0)}return b}u(g,y,"update",function(){},!1)||g[wr](v)}return Uc(a)}function h6(){var t=[];function e(r){r&&t[Vt](r)}function n(r,o){tt(t,function(i){try{i(r,o)}catch(s){rn(r[ys](),2,73,"Unexpected error calling unload handler - "+jt(s))}}),t=[]}return{add:e,run:n}}function f6(){var t=[];function e(r){var o=t;t=[],tt(o,function(i){try{(i.rm||i.remove).call(i)}catch(s){rn(r,2,73,"Unloading:"+jt(s))}})}function n(r){r&&ia(t,r)}return{run:e,add:n}}var AS,Vs="getPlugin",ose=(AS={},AS[ku]={isVal:Tv,v:{}},AS),ew=function(){function t(){var e=this,n,r,o,i,s;u(),gn(t,e,function(h){h[yp]=function(p,f,g,v){c(p,f,v),n=!0},h[ds]=function(p,f){var g,v=h[$n];if(!v||p&&v!==p[$n]())return;var y,b=!1,C=p||Nv(null,v,o&&o[Vs]?o[Vs]():o),S=f||(g={reason:0},g[sd]=!1,g);function E(){b||(b=!0,i.run(C,f),s.run(C[ys]()),y===!0&&C[wr](S),u())}return!h[Cv]||h[Cv](C,S,E)!==!0?E():y=!0,y},h[Df]=function(p,f){var g=h[$n];if(!g||p&&g!==p[$n]())return;var v,y=!1,b=p||X_(null,g,o&&o[Vs]?o[Vs]():o),C=f||{reason:0};function S(){y||(y=!0,c(b.getCfg(),b.core(),b[$i]()))}return!h._doUpdate||h._doUpdate(b,C,S)!==!0?S():v=!0,v},_v(h,"_addUnloadCb",function(){return i},"add"),_v(h,"_addHook",function(){return s},"add"),Cn(h,"_unloadHooks",{g:function(){return s}})}),e[ys]=function(h){return a(h)[ys]()},e[Hi]=function(){return n},e.setInitialized=function(h){n=h},e[jf]=function(h){o=h},e[wr]=function(h,p){p?p[wr](h):o&&on(o[Yi])&&o[Yi](h,null)},e._getTelCtx=a;function a(h){h===void 0&&(h=null);var p=h;if(!p){var f=r||Vc(null,{},e[$n]);o&&o[Vs]?p=f[Hc](null,o[Vs]):p=f[Hc](null,o)}return p}function c(h,p,f){mo(h,ose,Y_(p)),!f&&p&&(f=p[_4]()[$i]());var g=o;o&&o[Vs]&&(g=o[Vs]()),e[$n]=p,r=Vc(f,h,p,g)}function u(){n=!1,e[$n]=null,r=null,o=null,s=f6(),i=h6()}}return t.__ieDyn=1,t}();function ise(t,e,n){var r={id:e,fn:n};ia(t,r);var o={remove:function(){tt(t,function(i,s){if(i.id===r.id)return t[bp](s,1),-1})}};return o}function sse(t,e,n){for(var r=!1,o=t[vt],i=0;i<o;++i){var s=t[i];if(s)try{if(s.fn[ry](null,[e])===!1){r=!0;break}}catch(a){rn(n,2,64,"Telemetry initializer failed: "+L4(a),{exception:jt(a)},!0)}}return!r}var ase=function(t){gp(e,t);function e(){var n=t.call(this)||this;n.identifier="TelemetryInitializerPlugin",n.priority=199;var r,o;i(),gn(e,n,function(s,a){s.addTelemetryInitializer=function(c){return ise(o,r++,c)},s[Yi]=function(c,u){sse(o,c,u?u[ys]():s[ys]())&&s[wr](c,u)},s[Cv]=function(){i()}});function i(){r=0,o=[]}return n}return e.__ieDyn=1,e}(ew),$s,p6="Plugins must provide initialize method",cse="_notificationManager",KR="SDK is still unloading...",lse="SDK is not initialized",use=100,dse=5e4,kS=Md(($s={cookieCfg:{}},$s[tu]={rdOnly:!0,ref:!0,v:[]},$s[ec]={rdOnly:!0,ref:!0,v:[]},$s[ku]={ref:!0,v:{}},$s[z1]=Ni,$s.loggingLevelConsole=0,$s.diagnosticLogInterval=Ni,$s));function hse(t,e){return new Yie(e)}function fse(t,e,n){var r,o=[],i=[],s={};return tt(n,function(a){(Zt(a)||Zt(a[yp]))&&_o(p6);var c=a[Ev],u=a[Xs];a&&c&&(Zt(s[c])?s[c]=u:nf(t,"Two extensions have same priority #"+c+" - "+s[c]+", "+u)),!c||c<e?o[Vt](a):i[Vt](a)}),r={},r[$n]=o,r[ec]=i,r}function qR(t,e){var n=!1;return tt(e,function(r){if(r===t)return n=!0,-1}),n}function tE(t,e,n,r){n&&sn(n,function(o,i){r&&ii(i)&&ii(e[o])&&tE(t,e[o],i,r),r&&ii(i)&&ii(e[o])?tE(t,e[o],i,r):t.set(e,o,i)})}function WR(t,e){var n=null,r=-1;return tt(t,function(o,i){if(o.w===e)return n=o,r=i,-1}),{i:r,l:n}}function pse(t,e){var n=WR(t,e).l;return n||(n={w:e,rm:function(){var r=WR(t,e);r.i!==-1&&t[bp](r.i,1)}},t[Vt](n)),n}function mse(t,e,n){tt(e,function(r){var o=vr(t,r.w,n);delete r.w,r.rm=function(){o.rm()}})}function gse(t,e,n,r){return e.add(t[ha](function(o){var i=o.cfg.disableDbgExt;i===!0&&r&&(n[vv](r),r=null),n&&!r&&i!==!0&&(r=Oie(o.cfg),n[bv](r))})),r}function vse(t){return Cn({rm:function(){t.rm()}},"toJSON",{v:function(){return"aicore::onCfgChange<"+JSON.stringify(t)+">"}})}var bse=function(){function t(){var e,n,r,o,i,s,a,c,u,h,p,f,g,v,y,b,C,S,E,I,T,_,w,A,M,R,$,V,ie,N,Y,ue;gn(t,this,function(j){Z(),j._getDbgPlgTargets=function(){return[w,o]},j[Hi]=function(){return n},j.activeStatus=function(){return R},j._setPendingStatus=function(){R=3},j[yp]=function(O,ce,se,ne){g&&_o(KR),j[Hi]()&&_o("Core cannot be initialized more than once"),e=mo(O,kS,se||j[Rn],!1),O=e.cfg,Te(e[ha](function(He){var at=He.cfg,ut=R===3;if(!ut){V=at.initInMemoMaxSize||use;var Le=at[fR],Xe=at.endpointUrl;if(Zt(Le)){T=null,R=Ml[nS];var St="Please provide instrumentation key";n?(rn(r,1,100,St),te()):_o(St);return}var Ut=[];if(od(Le)?(Ut[Vt](Le),T=null):T=Le,od(Xe)?(Ut[Vt](Xe),$=null):$=Xe,Ut[vt]){ie=!1,R=3;var Gt=Tv(at.initTimeOut)?at.initTimeOut:dse,Kt=Hoe(Ut);Fc(function(){ie||U()},Gt),ad(Kt,function(F){try{if(ie)return;if(!F.rejected){var me=F[ef];if(me&&me[vt]){var ve=me[0];if(T=ve&&ve[ef],me[vt]>1){var je=me[1];$=je&&je[ef]}}T&&(O[fR]=T,O.endpointUrl=$)}U()}catch{ie||U()}})}else U();var kn=He.ref(He.cfg,ku);sn(kn,function(F){He.ref(kn,F)})}})),i=ne,E=gse(e,S,i&&j[fm](),E),ge(),j[Rn]=se;var K=O[tu];if(h=[],h[Vt].apply(h,cR(cR([],ce,!1),K)),p=O[ec],ye(null),(!f||f[vt]===0)&&_o("No "+ec+" available"),p&&p[vt]>1){var pe=j[Lf]("TeeChannelController");(!pe||!pe.plugin)&&rn(r,1,28,"TeeChannel required")}mse(O,_,r),_=null,n=!0,R===Ml.ACTIVE&&te()},j.getChannels=function(){var O=[];return f&&tt(f,function(ce){O[Vt](ce)}),Uc(O)},j.track=function(O){zr(j[Iv](),function(){return"AppInsightsCore:track"},function(){O===null&&(J(O),_o("Invalid telemetry item")),!O[gc]&&Zt(O[gc])&&(J(O),_o("telemetry name required")),O[dh]=O[dh]||T,O[wu]=O[wu]||K1(new Date),O.ver=O.ver||"4.0",!g&&j[Hi]()&&R===Ml.ACTIVE?_e()[wr](O):R!==Ml[nS]&&o[vt]<=V&&o[Vt](O)},function(){return{item:O}},!O.sync)},j[_4]=_e,j[fm]=function(){return i||(i=new qie(e.cfg),j[cse]=i),i},j[bv]=function(O){j.getNotifyMgr()[bv](O)},j[vv]=function(O){i&&i[vv](O)},j.getCookieMgr=function(){return c||(c=eg(e.cfg,j[Rn])),c},j.setCookieMgr=function(O){c!==O&&(jh(c,!1),c=O)},j[Iv]=function(){return s||a||Qie()},j.setPerfMgr=function(O){s=O},j.eventCnt=function(){return o[vt]},j.releaseQueue=function(){if(n&&o[vt]>0){var O=o;o=[],R===2?tt(O,function(ce){ce[dh]=ce[dh]||T,_e()[wr](ce)}):rn(r,2,20,"core init status is not active")}},j[pR]=function(O){return y=O||null,ue=!1,N&&N[hu](),Q(!0)};function U(){ie=!0,Zt(T)?(R=Ml[nS],rn(r,1,112,"ikey can't be resolved from promises")):R=Ml.ACTIVE,te()}function te(){n&&(j.releaseQueue(),j[pR]())}function Q(O){if((!N||!N[fu])&&!ue){var ce=O||r&&r.queue[vt]>0;ce&&(Y||(Y=!0,Te(e[ha](function(se){var ne=se.cfg.diagnosticLogInterval;(!ne||!(ne>0))&&(ne=1e4);var K=!1;N&&(K=N[fu],N[hu]()),N=Soe(Ke,ne),N.unref(),N[fu]=K}))),N[fu]=!0)}return N}j[mR]=function(){ue=!0,N&&N[hu](),Ke()},D4(j,function(){return v},["addTelemetryInitializer"]),j[Sa]=function(O,ce,se){var ne;O===void 0&&(O=!0),n||_o(lse),g&&_o(KR);var K=(ne={reason:50},ne[sd]=O,ne.flushComplete=!1,ne),pe;O&&!ce&&(pe=zc(function(ut){ce=ut}));var He=Nv(Ne(),j);He[pm](function(){S.run(j[Rn]),t6([c,i,r],O,function(){Z(),ce&&ce(K)})},j);function at(ut){K.flushComplete=ut,g=!0,C.run(He,K),j[mR](),He[wr](K)}return Ke(),de(O,at,6,se),pe},j[Lf]=Se,j.addPlugin=function(O,ce,se,ne){if(!O){ne&&ne(!1),P(p6);return}var K=Se(O[Xs]);if(K&&!ce){ne&&ne(!1),P("Plugin ["+O[Xs]+"] is already loaded!");return}var pe={reason:16};function He(Le){h[Vt](O),pe.added=[O],ye(pe),ne&&ne(!0)}if(K){var at=[K.plugin],ut={reason:2,isAsync:!!se};we(at,ut,function(Le){Le?(pe.removed=at,pe.reason|=32,He()):ne&&ne(!1)})}else He()},j.updateCfg=function(O,ce){ce===void 0&&(ce=!0);var se;if(j[Hi]()){se={reason:1,cfg:e.cfg,oldCfg:sR({},e.cfg),newConfig:sR({},O),merge:ce},O=se.newConfig;var ne=e.cfg;O[tu]=ne[tu],O[ec]=ne[ec]}e._block(function(K){var pe=K.cfg;tE(K,pe,O,ce),ce||sn(pe,function(He){Tu(O,He)||K.set(pe,He,Ni)}),K[Ld](pe,kS)},!0),e[mv](),se&&$e(se)},j.evtNamespace=function(){return b},j.flush=de,j.getTraceCtx=function(O){return I||(I=ese()),I},j.setTraceCtx=function(O){I=O||null},j.addUnloadHook=Te,_v(j,"addUnloadCb",function(){return C},"add"),j.onCfgChange=function(O){var ce;return n?ce=vr(e.cfg,O,j[Rn]):ce=pse(_,O),vse(ce)},j.getWParam=function(){return v4()||e.cfg.enableWParam?0:-1};function re(){var O={};A=[];var ce=function(se){se&&tt(se,function(ne){if(ne[Xs]&&ne[gR]&&!O[ne.identifier]){var K=ne[Xs]+"="+ne[gR];A[Vt](K),O[ne.identifier]=ne}})};ce(f),p&&tt(p,function(se){ce(se)}),ce(h)}function Z(){n=!1,e=mo({},kS,j[Rn]),e.cfg[w4]=1,Cn(j,"config",{g:function(){return e.cfg},s:function(ce){j.updateCfg(ce,!1)}}),Cn(j,"pluginVersionStringArr",{g:function(){return A||re(),A}}),Cn(j,"pluginVersionString",{g:function(){return M||(A||re(),M=A.join(";")),M||Dt}}),Cn(j,"logger",{g:function(){return r||(r=new xv(e.cfg),e[Rn]=r),r},s:function(ce){e[Rn]=ce,r!==ce&&(jh(r,!1),r=ce)}}),j[Rn]=new xv(e.cfg),w=[];var O=j.config[tu]||[];O.splice(0,O[vt]),ia(O,w),v=new ase,o=[],jh(i,!1),i=null,s=null,a=null,jh(c,!1),c=null,u=null,h=[],p=null,f=null,g=!1,y=null,b=Dd("AIBaseCore",!0),C=h6(),I=null,T=null,S=f6(),_=[],M=null,A=null,ue=!1,N=null,Y=!1,R=0,$=null,V=null,ie=!1}function _e(){var O=Vc(Ne(),e.cfg,j);return O[pm](Q),O}function ye(O){var ce=fse(j[Rn],Nie,h);u=null,M=null,A=null,f=(p||[])[0]||[],f=wS(ia(f,ce[ec]));var se=ia(wS(ce[$n]),f);w=Uc(se);var ne=j.config[tu]||[];ne.splice(0,ne[vt]),ia(ne,w);var K=_e();f&&f[vt]>0&&zR(K[Hc](f),se),zR(K,se),O&&$e(O)}function Se(O){var ce=null,se=null,ne=[];return tt(w,function(K){if(K[Xs]===O&&K!==v)return se=K,-1;K.getChannel&&ne[Vt](K)}),!se&&ne[vt]>0&&tt(ne,function(K){if(se=K.getChannel(O),!se)return-1}),se&&(ce={plugin:se,setEnabled:function(K){Cc(se)[V1]=!K},isEnabled:function(){var K=Cc(se);return!K[ds]&&!K[V1]},remove:function(K,pe){var He;K===void 0&&(K=!0);var at=[se],ut=(He={reason:1},He[sd]=K,He);we(at,ut,function(Le){Le&&ye({reason:32,removed:at}),pe&&pe(Le)})}}),ce}function Ne(){if(!u){var O=(w||[]).slice();Do(O,v)===-1&&O[Vt](v),u=$c(wS(O),e.cfg,j)}return u}function we(O,ce,se){if(O&&O[vt]>0){var ne=$c(O,e.cfg,j),K=Nv(ne,j);K[pm](function(){var pe=!1,He=[];tt(h,function(ut,Le){qR(ut,O)?pe=!0:He[Vt](ut)}),h=He,M=null,A=null;var at=[];p&&(tt(p,function(ut,Le){var Xe=[];tt(ut,function(St){qR(St,O)?pe=!0:Xe[Vt](St)}),at[Vt](Xe)}),p=at),se&&se(pe),Q()}),K[wr](ce)}else se(!1)}function Ke(){if(r&&r.queue){var O=r.queue.slice(0);r.queue[vt]=0,tt(O,function(ce){var se,ne=(se={},se[gc]=y||"InternalMessageId: "+ce[yv],se[dh]=T,se[wu]=K1(new Date),se.baseType=J1.dataType,se.baseData={message:ce[vc]},se);j.track(ne)})}}function de(O,ce,se,ne){var K=1,pe=!1,He=null;ne=ne||5e3;function at(){K--,pe&&K===0&&(He&&He[hu](),He=null,ce&&ce(pe),ce=null)}if(f&&f[vt]>0){var ut=_e()[Hc](f);ut.iterate(function(Le){if(Le.flush){K++;var Xe=!1;Le.flush(O,function(){Xe=!0,at()},se)||Xe||(O&&He==null?He=Fc(function(){He=null,at()},ne):at())}})}return pe=!0,at(),!0}function ge(){var O;Te(e[ha](function(ce){var se=ce.cfg.enablePerfMgr;if(se){var ne=ce.cfg[z1];O!==ne&&(ne||(ne=hse),qoe(ce.cfg,z1,ne),O=ne,a=null),!s&&!a&&on(ne)&&(a=ne(j,j[fm]()))}else a=null,O=null}))}function $e(O){var ce=X_(Ne(),j);ce[pm](Q),(!j._updateHook||j._updateHook(ce,O)!==!0)&&ce[wr](O)}function P(O){var ce=j[Rn];ce?(rn(ce,2,73,O),Q()):_o(O)}function J(O){var ce=j[fm]();ce&&ce[tf]([O],2)}function Te(O){S.add(O)}})}return t.__ieDyn=1,t}(),yi="",yse="NoResponseBody",YR="&"+yse+"=true",xS="POST",Cse=function(){function t(){var e=0,n,r,o,i,s,a,c,u,h,p,f,g,v,y;gn(t,this,function(b,C){var S=!0;ie(),b[yp]=function(N,Y){o=Y,r&&rn(o,1,28,"Sender is already initialized"),b.SetConfig(N),r=!0},b._getDbgPlgTargets=function(){return[r,i,a,n]},b.SetConfig=function(N){try{if(s=N.senderOnCompleteCallBack||{},a=!!N.disableCredentials,c=N.fetchCredentials,i=!!N.isOneDs,n=!!N.enableSendPromise,h=!!N.disableXhr,p=!!N.disableBeacon,f=!!N.disableBeaconSync,y=N.timeWrapper,v=!!N.addNoResponse,g=!!N.disableFetchKeepAlive,u={sendPOST:R},i||(S=!1),a){var Y=iy();Y&&Y.protocol&&Y.protocol[$_]()==="file:"&&(S=!1)}return!0}catch{}return!1},b.getSyncFetchPayload=function(){return e},b.getSenderInst=function(N,Y){return N&&N[vt]?_(N,Y):null},b.getFallbackInst=function(){return u},b[Cv]=function(N,Y){ie()};function E(N,Y){w(Y,200,{},N)}function I(N,Y){rn(o,2,26,"Failed to send telemetry.",{message:N}),w(Y,400,{})}function T(N){I("No endpoint url is provided for the batch",N)}function _(N,Y){for(var ue,j=0,U=null,te=0;U==null&&te<N[vt];)j=N[te],!h&&j===1?pie()?U=V:V4()&&(U=R):j===2&&z4(Y)&&(!Y||!g)?U=$:j===3&&H4()&&(Y?!f:!p)&&(U=M),te++;return U?(ue={_transport:j,_isSync:Y},ue[yR]=U,ue):null}function w(N,Y,ue,j){try{N&&N(Y,ue,j)}catch{}}function A(N,Y){var ue=Xi(),j=N[hh];if(!j)return T(Y),!0;j=N[hh]+(v?YR:yi);var U=N[eu],te=i?U:new Blob([U],{type:"text/plain;charset=UTF-8"}),Q=ue.sendBeacon(j,te);return Q}function M(N,Y,ue){var j=N[eu];try{if(j)if(A(N,Y))E(yi,Y);else{var U=s&&s.beaconOnRetry;U&&on(U)?U(N,Y,A):(u&&u[yR](N,Y,!0),rn(o,2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}catch(te){i&&nf(o,"Failed to send telemetry using sendBeacon API. Ex:"+jt(te)),w(Y,i?0:400,{},yi)}}function R(N,Y,ue){var j,U,te,Q=N[oS]||{};!ue&&n&&(j=zc(function(ye,Se){U=ye,te=Se})),i&&ue&&N.disableXhrSync&&(ue=!1);var re=N[hh];if(!re){T(Y),U&&U(!1);return}var Z=Zoe(xS,re,S,!0,ue,N[Ol]);i||Z[CR]("Content-type","application/json"),tt(bs(Q),function(ye){Z[CR](ye,Q[ye])}),Z.onreadystatechange=function(){i||(_e(Z),Z.readyState===4&&U&&U(!0))},Z.onload=function(){i&&_e(Z)};function _e(ye){var Se=s&&s.xhrOnComplete,Ne=Se&&on(Se);if(Ne)Se(ye,Y,N);else{var we=cd(ye);w(Y,ye[Oh],Zm(ye,i),we)}}return Z.onerror=function(ye){w(Y,i?Z[Oh]:400,Zm(Z,i),i?yi:AR(Z)),te&&te(ye)},Z.ontimeout=function(){w(Y,i?Z[Oh]:500,Zm(Z,i),i?yi:AR(Z)),U&&U(!1)},Z.send(N[eu]),j}function $(N,Y,ue){var j,U=N[hh],te=N[eu],Q=i?te:new Blob([te],{type:"application/json"}),re,Z,_e,ye=new Headers,Se=te[vt],Ne=!1,we=!1,Ke=N[oS]||{},de=(j={method:xS,body:Q},j[RR]=!0,j);N.headers&&bs(N.headers)[vt]>0&&(tt(bs(Ke),function(J){ye.append(J,Ke[J])}),de[oS]=ye),c?de.credentials=c:S&&i&&(de.credentials="include"),ue&&(de.keepalive=!0,e+=Se,i?N._sendReason===2&&(Ne=!0,v&&(U+=YR)):Ne=!0);var ge=new Request(U,de);try{ge[RR]=!0}catch{}if(!ue&&n&&(re=zc(function(J,Te){Z=J,_e=Te})),!U){T(Y),Z&&Z(!1);return}function $e(J){w(Y,i?0:400,{},i?yi:J)}function P(J,Te,O){var ce=J[Oh],se=s.fetchOnComplete;se&&on(se)?se(J,Y,O||yi,Te):w(Y,ce,{},O||yi)}try{ad(fetch(i?U:ge,i?de:null),function(J){if(ue&&(e-=Se,Se=0),!we)if(we=!0,J.rejected)$e(J.reason&&J.reason[vc]),_e&&_e(J.reason);else{var Te=J[ef];try{!i&&!Te.ok?($e(Te.statusText),Z&&Z(!1)):i&&!Te.body?(P(Te,null,yi),Z&&Z(!0)):ad(Te.text(),function(O){P(Te,N,O[ef]),Z&&Z(!0)})}catch(O){$e(jt(O)),_e&&_e(O)}}})}catch(J){we||($e(jt(J)),_e&&_e(J))}return Ne&&!we&&(we=!0,w(Y,200,{}),Z&&Z(!0)),i&&!we&&N[Ol]>0&&y&&y.set(function(){we||(we=!0,w(Y,500,{}),Z&&Z(!0))},N[Ol]),re}function V(N,Y,ue){var j=Ra(),U=new XDomainRequest,te=N[eu];U.onload=function(){var ye=cd(U),Se=s&&s.xdrOnComplete;Se&&on(Se)?Se(U,Y,N):w(Y,200,{},ye)},U.onerror=function(){w(Y,400,{},i?yi:Yoe(U))},U.ontimeout=function(){w(Y,500,{})},U.onprogress=function(){};var Q=j&&j.location&&j.location[A4]||"",re=N[hh];if(!re){T(Y);return}if(!i&&re.lastIndexOf(Q,0)!==0){var Z="Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.";rn(o,2,40,". "+Z),I(Z,Y);return}var _e=i?re:re[bc](/^(https?:)/,"");U.open(xS,_e),N[Ol]&&(U[Ol]=N[Ol]),U.send(te),i&&ue?y&&y.set(function(){U.send(te)},0):U.send(te)}function ie(){e=0,r=!1,n=!1,o=null,i=null,s=null,a=null,c=null,u=null,h=!1,p=!1,f=!1,g=!1,v=!1,y=null}})}return t.__ieDyn=1,t}(),m6="on",QR="attachEvent",JR="addEventListener",ZR="detachEvent",XR="removeEventListener",nE="events",Bf="visibilitychange",ay="pagehide",g6="pageshow",v6="unload",b6="beforeunload",y6=Dd("aiEvtPageHide"),C6=Dd("aiEvtPageShow"),Sse=/\.[\.]+/g,Ese=/[\.]+$/,Ise=1,Pv=Q4("events"),Tse=/^([^.]*)(?:\.(.+)|)/;function e2(t){return t&&t[bc]?t[bc](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Dt):t}function tw(t,e){var n;if(e){var r=Dt;kt(e)?(r=Dt,tt(e,function(i){i=e2(i),i&&(i[0]!=="."&&(i="."+i),r+=i)})):r=e2(e),r&&(r[0]!=="."&&(r="."+r),t=(t||Dt)+r)}var o=Tse.exec(t||Dt)||[];return n={},n[Cs]=o[1],n.ns=(o[2]||Dt).replace(Sse,".").replace(Ese,Dt)[oy](".").sort().join("."),n}function S6(t,e,n){n===void 0&&(n=!0);var r=Pv.get(t,nE,{},n),o=r[e];return o||(o=r[e]=[]),o}function E6(t,e,n,r){t&&e&&e[Cs]&&(t[XR]?t[XR](e[Cs],n,r):t[ZR]&&t[ZR](m6+e[Cs],n))}function _se(t,e,n,r){var o=!1;return t&&e&&e[Cs]&&n&&(t[JR]?(t[JR](e[Cs],n,r),o=!0):t[QR]&&(t[QR](m6+e[Cs],n),o=!0)),o}function t2(t,e,n,r){for(var o=e[vt];o--;){var i=e[o];i&&(!n.ns||n.ns===i.evtName.ns)&&(!r||r(i))&&(E6(t,i.evtName,i[G_],i.capture),e[bp](o,1))}}function wse(t,e,n){if(e[Cs])t2(t,S6(t,e[Cs]),e,n);else{var r=Pv.get(t,nE,{});sn(r,function(o,i){t2(t,i,e,n)}),bs(r)[vt]===0&&Pv.kill(t,nE)}}function Cp(t,e){var n;return e?(kt(e)?n=[t].concat(e):n=[t,e],n=tw("xx",n).ns[oy](".")):n=t,n}function RS(t,e,n,r,o){var i;o===void 0&&(o=!1);var s=!1;if(t)try{var a=tw(e,r);if(s=_se(t,a,n,o),s&&Pv.accept(t)){var c=(i={guid:Ise++,evtName:a},i[G_]=n,i.capture=o,i);S6(t,a.type)[Vt](c)}}catch{}return s}function NS(t,e,n,r,o){if(o===void 0&&(o=!1),t)try{var i=tw(e,r),s=!1;wse(t,i,function(a){return i.ns&&!n||a[G_]===n?(s=!0,!0):!1}),s||E6(t,i,n,o)}catch{}}function Ase(t,e,n){var r=!1,o=Ra();o&&(r=RS(o,t,e,n),r=RS(o.body,t,e,n)||r);var i=ws();return i&&(r=RS(i,t,e,n)||r),r}function kse(t,e,n){var r=Ra();r&&(NS(r,t,e,n),NS(r.body,t,e,n));var o=ws();o&&NS(o,t,e,n)}function ld(t,e,n,r){var o=!1;return e&&t&&t[vt]>0&&tt(t,function(i){i&&(!n||Do(n,i)===-1)&&(o=Ase(i,e,r)||o)}),o}function xse(t,e,n,r){var o=!1;return e&&t&&kt(t)&&(o=ld(t,e,n,r),!o&&n&&n[vt]>0&&(o=ld(t,e,null,r))),o}function Hf(t,e,n){t&&kt(t)&&tt(t,function(r){r&&kse(r,e,n)})}function Rse(t,e,n){return xse([b6,v6,ay],t,e,n)}function Nse(t,e){Hf([b6,v6,ay],t,e)}function I6(t,e,n){function r(s){var a=ws();t&&a&&a.visibilityState==="hidden"&&t(s)}var o=Cp(y6,n),i=ld([ay],t,e,o);return(!e||Do(e,Bf)===-1)&&(i=ld([Bf],r,e,o)||i),!i&&e&&(i=I6(t,null,n)),i}function Pse(t,e){var n=Cp(y6,e);Hf([ay],t,n),Hf([Bf],null,n)}function T6(t,e,n){function r(s){var a=ws();t&&a&&a.visibilityState==="visible"&&t(s)}var o=Cp(C6,n),i=ld([g6],t,e,o);return i=ld([Bf],r,e,o)||i,!i&&e&&(i=T6(t,null,n)),i}function Mse(t,e){var n=Cp(C6,e);Hf([g6],t,n),Hf([Bf],null,n)}var jd="",Ose="https://browser.events.data.microsoft.com/OneCollector/1.0/",n2="version",PS="properties",r2="initialize",o2="logger",ng="indexOf",ea="timings",i2="pollInternalLogs",Eo="value",s2="kind",nw="length",MS="processTelemetryStart",is,Lse="4.3.3",_6="1DS-Web-JS-"+Lse,w6=Cre.hasOwnProperty,Dse=(is={},is[0]=0,is[2]=6,is[1]=1,is[3]=7,is[4098]=6,is[4097]=1,is[4099]=7,is),OS=null;function ta(t){return!(t===jd||Zt(t))}function jse(t){if(t){var e=ny(t,"-");if(e>-1)return P_(t,e)}return jd}function sRe(){return OS===null&&(OS=!Jt(Uint8Array)&&!zse()&&!q1()),OS}function Use(t){return!!(t&&ba(t)&&t>=1&&t<=4)}function Fse(t,e,n){if(!e&&!ta(e)||typeof t!="string")return null;var r=typeof e;if(r==="string"||r==="number"||r==="boolean"||kt(e))e={value:e};else if(r==="object"&&!w6.call(e,"value"))e={value:n?JSON.stringify(e):e};else if(Zt(e[Eo])||e[Eo]===jd||!mr(e[Eo])&&!ba(e[Eo])&&!jc(e[Eo])&&!kt(e[Eo]))return null;if(kt(e[Eo])&&!Vse(e[Eo]))return null;if(!Zt(e[s2])){if(kt(e[Eo])||!Bse(e[s2]))return null;e[Eo]=e[Eo].toString()}return e}function A6(t,e,n){var r=-1;if(!Jt(t))if(e>0&&(e===32?r=8192:e<=13&&(r=e<<5)),Hse(n))r===-1&&(r=0),r|=n;else{var o=Dse[oE(t)]||-1;r!==-1&&o!==-1?r|=o:o===6&&(r=o)}return r}function ud(t,e,n){n===void 0&&(n=!0);var r;return t&&(r=t.get(e),n&&r&&decodeURIComponent&&(r=decodeURIComponent(r))),r||jd}function a2(t){t===void 0&&(t="D");var e=c6();return t==="B"?e="{"+e+"}":t==="P"?e="("+e+")":t==="N"&&(e=e.replace(/-/g,jd)),e}function Mv(t,e,n,r,o){var i={},s=!1,a=0,c=arguments[nw],u=arguments;for(jc(u[0])&&(s=u[0],a++);a<c;a++){var t=u[a];sn(t,function(p,f){s&&f&&rd(f)?kt(f)?(i[p]=i[p]||[],tt(f,function(g,v){g&&rd(g)?i[p][v]=Mv(!0,i[p][v],g):i[p][v]=g})):i[p]=Mv(!0,i[p],f):i[p]=f})}return i}var Ti=poe;function Bse(t){return t===0||t>0&&t<=13||t===32}function Hse(t){return t>=0&&t<=9}function zse(){var t=Xi();if(!Jt(t)&&t.userAgent){var e=t.userAgent.toLowerCase();if((e[ng]("safari")>=0||e[ng]("firefox")>=0)&&e[ng]("chrome")<0)return!0}return!1}function Vse(t){return t[nw]>0}function rE(t,e){var n=t;n[ea]=n[ea]||{},n[ea][MS]=n[ea][MS]||{},n[ea][MS][e]=Ti()}function oE(t){var e=0;if(t!=null){var n=typeof t;n==="string"?e=1:n==="number"?e=2:n==="boolean"?e=3:n===T_&&(e=4,kt(t)?(e=4096,t[nw]>0&&(e|=oE(t[0]))):w6.call(t,"value")&&(e=8192|oE(t[Eo])))}return e}function $se(){return!!Un("chrome")}function of(t){return t>0}var Gse=Md({endpointUrl:Ose,propertyStorageOverride:{isVal:Kse}});function Kse(t){return t&&(!t.getProperty||!t.setProperty)&&_o("Invalid property storage override passed."),!0}var qse=function(t){gp(e,t);function e(){var n=t.call(this)||this;return gn(e,n,function(r,o){r[r2]=function(i,s,a,c){zr(r,function(){return"AppInsightsCore.initialize"},function(){try{o[r2](mo(i,Gse,a||r[o2],!1).cfg,s,a,c)}catch(p){var u=r[o2],h=jt(p);h[ng]("channels")!==-1&&(h+=`
 - Channels must be provided through config.channels only!`),rn(u,1,514,"SDK Initialization Failed - no telemetry will be sent: "+h)}},function(){return{config:i,extensions:s,logger:a,notificationManager:c}})},r.track=function(i){zr(r,function(){return"AppInsightsCore.track"},function(){var s=i;if(s){s[ea]=s[ea]||{},s[ea].trackStart=Ti(),Use(s.latency)||(s.latency=1);var a=s.ext=s.ext||{};a.sdk=a.sdk||{},a.sdk.ver=_6;var c=s.baseData=s.baseData||{};c[PS]=c[PS]||{};var u=c[PS];u[n2]=u[n2]||r.pluginVersionString||jd}o.track(s)},function(){return{item:i}},!i.sync)},r[i2]=function(i){return o[i2](i||"InternalLog")}}),n}return e.__ieDyn=1,e}(bse),Wse="device",k6="locale",rw="ver",Yse="browser",Qse="browserVer",Jse="popSample",Zse="eventFlags",ow="name",Xse="serviceName",to=Qr({UserExt:[0,"user"],DeviceExt:[1,Wse],TraceExt:[2,"trace"],WebExt:[3,"web"],AppExt:[4,"app"],OSExt:[5,"os"],SdkExt:[6,"sdk"],IntWebExt:[7,"intweb"],UtcExt:[8,"utc"],LocExt:[9,"loc"],CloudExt:[10,"cloud"],DtExt:[11,"dt"]}),eae=Qr({id:[0,"id"],ver:[1,rw],appName:[2,ow],locale:[3,k6],expId:[4,"expId"],env:[5,"env"]}),tae=Qr({domain:[0,"domain"],browser:[1,Yse],browserVer:[2,Qse],screenRes:[3,"screenRes"],userConsent:[4,"userConsent"],consentDetails:[5,"consentDetails"]}),nae=Qr({locale:[0,k6],localId:[1,"localId"],id:[2,"id"]}),rae=Qr({osName:[0,ow],ver:[1,rw]}),oae=Qr({ver:[0,rw],seq:[1,"seq"],installId:[2,"installId"],epoch:[3,"epoch"]}),iae=Qr({msfpc:[0,"msfpc"],anid:[1,"anid"],serviceName:[2,Xse]}),sae=Qr({popSample:[0,Jse],eventFlags:[1,Zse]}),aae=Qr({tz:[0,"tz"]}),cae=Qr({sessionId:[0,"sesId"]}),lae=Qr({localId:[0,"localId"],deviceClass:[1,"deviceClass"],make:[2,"make"],model:[3,"model"]}),uae=Qr({role:[0,"role"],roleInstance:[1,"roleInstance"],roleVer:[2,"roleVer"]}),dae=Qr({traceId:[0,"traceID"],traceName:[1,ow],parentId:[2,"parentID"]}),hae=Qr({traceId:[0,"traceId"],spanId:[1,"spanId"],traceFlags:[2,"traceFlags"]}),sf;function x6(){return sf===void 0&&(sf=!!N6(0)),sf}function R6(){return x6()?N6(0):null}function N6(t){var e=null,n,r;try{var o=Od();if(!o)return null;r=new Date,e=t===0?o.localStorage:o.sessionStorage,e&&on(e.setItem)&&(e.setItem(r,r),n=e.getItem(r)!==r,e.removeItem(r),n&&(e=null))}catch{e=null}return e}function fae(t,e,n){var r=R6();if(r!==null)try{return r.setItem(e,n),!0}catch(o){sf=!1,rn(t,1,504,"Browser failed write to local storage. "+o)}return!1}function pae(t,e){var n=R6();if(n!==null)try{return n.getItem(e)}catch(r){sf=!1,rn(t,1,503,"Browser failed read of local storage. "+r)}return null}function mae(){return this.getId()}function gae(t){this.setId(t)}var P6=function(){function t(){gn(t,this,function(e){e.setId=function(n){e.customId=n},e.getId=function(){return mr(e.customId)?e.customId:e.automaticId}})}return t._staticInit=function(){Cn(t.prototype,"id",{g:mae,s:gae})}(),t}(),c2="ai_session",vae=function(){function t(e,n,r){var o,i=Y_(e),s=s6(e),a,c;gn(t,this,function(u){var h=vr(n,function(){c=n,u.config=c});r&&r.add(h),a=function(){return u.config.namePrefix?c2+u.config.namePrefix:c2},u.automaticSession=new P6,u.update=function(){u.automaticSession.getId()||p();var b=u.automaticSession,C=u.config,S=new Date().getTime(),E=S-b.acquisitionDate>C.sessionExpirationMs,I=S-b.renewalDate>C.sessionRenewalMs;if(E||I)g();else{var T=o;(!T||S-T>t.cookieUpdateInterval)&&(b.renewalDate=S,v(b.getId(),b.acquisitionDate,b.renewalDate))}},u.backup=function(){var b=u.automaticSession;y(b.getId(),b.acquisitionDate,b.renewalDate)};function p(){var b=s.get(a());if(b&&on(b.split))f(b);else{var C=pae(i,a());C&&f(C)}u.automaticSession.getId()||g()}function f(b){var C=u.automaticSession,S=b.split("|");S.length>0&&C.setId(S[0]);try{if(S.length>1){var E=+S[1];C.acquisitionDate=+new Date(E),C.acquisitionDate=C.acquisitionDate>0?C.acquisitionDate:0}if(S.length>2){var I=+S[2];C.renewalDate=+new Date(I),C.renewalDate=C.renewalDate>0?C.renewalDate:0}}catch(T){rn(i,1,510,"Error parsing ai_session cookie, session will be reset: "+T)}C.renewalDate===0&&rn(i,2,517,"AI session renewal date is 0, session will be reset.")}function g(){var b=u.automaticSession,C=new Date().getTime(),S=u.config.sessionAsGuid;!Jt(S)&&S?jc(S)?b.setId(a2()):b.setId(a2(S)):b.setId(q_(c.idLength||22)),b.acquisitionDate=C,b.renewalDate=C,v(b.getId(),b.acquisitionDate,b.renewalDate),x6()||rn(i,2,505,"Browser does not support local storage. Session durations will be inaccurate.")}function v(b,C,S){var E=C+u.config.sessionExpirationMs,I=S+u.config.sessionRenewalMs,T=new Date,_=[b,C,S];E<I?T.setTime(E):T.setTime(I);var w=u.config.cookieDomain||null;s.set(a(),_.join("|")+";expires="+T.toUTCString(),null,w),o=new Date().getTime()}function y(b,C,S){fae(i,a(),[b,C,S].join("|"))}})}return t.cookieUpdateInterval=6e4,t}(),iw=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];function l2(t,e){e===void 0&&(e=iw);var n=null;if(t)for(var r=t.split(","),o=0;o<r.length;o++)bae(r[o],e)&&(n?n+=","+r[o]:n=r[o]);return n}function bae(t,e){if(e===void 0&&(e=iw),!t||t.length<4)return!1;for(var n=!1,r=256,o=t.substring(0,3).toString().toUpperCase(),i=0;i<e.length;i++)if(e[i]+":"===o&&t.length<=r){n=!0;break}return n}function yae(){return this.getExpId()}var Cae=function(){function t(e,n,r){var o=null,i=iw.slice(0),s="Treatments",a,c=null;gn(t,this,function(u){if(y(e),v4()){var h=ws().documentElement;h&&(u.locale=h.lang)}u.getExpId=function(){return c.expId?v(c.expId):g()};function p(b){var C,S={},E=ws();if(E){C=E&&E.querySelectorAll("meta");for(var I=0;I<C.length;I++){var T=C[I];if(T.name){var _=T.name.toLowerCase();if(_.indexOf(b)===0){var w=T.name.replace(b,"");S[w]=T.content}}}}return S}function f(b){b!==o&&(o=l2(b,i))}function g(){var b=ud(a,s);return f(b),o}function v(b){return f(b),o}function y(b){var C=vr(b,function(){a=n&&n.getCookieMgr(),c=b||{},u.env=c.env||p("awa-").env});r&&r.add(C)}})}return t.validateAppExpId=l2,t._staticInit=function(){Cn(t.prototype,"expId",{g:yae})}(),t}(),Sae=function(){function t(){}return t}(),Eae=function(){function t(){}return t}();function Iae(){return this.getMsfpc()}function Tae(){return this.getAnid()}var _ae=function(){function t(e,n,r){var o;gn(t,this,function(i){s(e),i.getMsfpc=function(){return ud(o,"MSFPC")},i.getAnid=function(){return ud(o,"ANON").slice(0,34)};function s(a){var c=vr(a,function(){o=n&&n.getCookieMgr();var u=a||{};u.serviceName&&(i.serviceName=u.serviceName)});r&&r.add(c)}})}return t._staticInit=function(){var e=t.prototype;Cn(e,"msfpc",{g:Iae}),Cn(e,"anid",{g:Tae})}(),t}(),wae=function(){function t(){var e=new Date().getTimezoneOffset(),n=e%60,r=(e-n)/60,o="+";r>0&&(o="-"),r=Math.abs(r),n=Math.abs(n),this.tz=o+(r<10?"0"+r:r.toString())+":"+(n<10?"0"+n:n.toString())}return t}(),Gs={WIN:/(windows|win32)/i,WINRT:/ arm;/i,WINPHONE:/windows\sphone\s\d+\.\d+/i,OSX:/(macintosh|mac os x)/i,IOS:/(ipad|iphone|ipod)(?=.*like mac os x)/i,LINUX:/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,ANDROID:/android/i,CROS:/CrOS/i},u2={"5.1":"XP","6.0":"Vista","6.1":"7","6.2":"8","6.3":"8.1","10.0":"10"},Aae="([\\d,.]+)",M6="([\\d,_,.]+)",Ud="Unknown",d2=[{r:Gs.WINPHONE,os:"Windows Phone"},{r:Gs.WINRT,os:"Windows RT"},{r:Gs.WIN,os:"Windows"},{r:Gs.IOS,os:"iOS"},{r:Gs.ANDROID,os:"Android"},{r:Gs.LINUX,os:"Linux"},{r:Gs.CROS,os:"Chrome OS"},{s:"x11",os:"Unix"},{s:"blackberry",os:"BlackBerry"},{s:"symbian",os:"Symbian"},{s:"nokia",os:"Nokia"},{r:Gs.OSX,os:"Mac OS X"}];function kae(t){for(var e=0;e<d2.length;e++){var n=d2[e];if(n.r&&t.match(n.r))return n.os;if(n.s&&t.indexOf(n.s)!==-1)return n.os}return Ud}function xae(t,e){return e==="Windows"?h2(t,"Windows NT"):e==="Android"?h2(t,e):e==="Mac OS X"?Rae(t):e==="iOS"?Nae(t):Ud}function h2(t,e){var n=t.match(new RegExp(e+" "+Aae));return n?u2[n[1]]?u2[n[1]]:n[1]:Ud}function Rae(t){var e=t.match(new RegExp("Mac OS X "+M6));if(e){var n=e[1].replace(/_/g,".");if(n){var r=O6(n);if(r){var o=n.split(r);return o[0]}else return n}}return Ud}function Nae(t){var e=t.match(new RegExp("OS "+M6));if(e){var n=e[1].replace(/_/g,".");if(n){var r=O6(n);if(r){var o=n.split(r);return o[0]}else return n}}return Ud}function O6(t){return t.indexOf(".")>-1?".":t.indexOf("_")>-1?"_":null}var Pae=function(){function t(e,n){var r=this,o,i=null,s=null,a=null,c=null,u=function(v){a=v},h=function(v){c=v},p=function(){return a||i},f=function(){return c||s},g=vr(e,function(){if(o=e||{},o.populateOperatingSystemInfo){var v=Xi()||{},y=e.userAgent||v.userAgent||"",b=(e.userAgentData||{}).platform||(v.userAgentData||{}).platform;if(y){var C=kae(y.toLowerCase());i=C,s=xae(y,C)}(!i||i===Ud)&&mr(b)&&(i=b)}});n&&n.add(g),Cn(r,"name",{s:u,g:p}),Cn(r,"ver",{s:h,g:f})}return t}(),LS="MicrosoftApplicationsTelemetryDeviceId";function Mae(t,e,n,r){e?e.setProperty(n,r):t.set(n,r,31536e3)}function Oae(t,e,n){return e?e.getProperty(n)||"":ud(t,n)}var Lae=function(){function t(e,n,r){var o=0,i;gn(t,this,function(s){s.seq=o,s.epoch=Uf(!1).toString(),s.getSequenceId=function(){return++o};var a=vr(e,function(c){i=n&&n.getCookieMgr();var u=c.cfg,h=u.propertyStorageOverride,p=i.isEnabled();if(p||h){var f=Oae(i,h,LS);f||(f=c6()),Mae(i,h,LS,f),s.installId=f}else i.purge(LS)});r&&r.add(a)})}return t.__ieDyn=1,t}(),Dae=function(){function t(e,n,r,o,i){var s=this;s.traceId=n||eE();var a=vr(e,function(){var c=e;if(c.enableDistributedTracing&&!r&&(r=eE().substring(0,16)),s.parentId=s.parentId||r,c.enableApplicationInsightsTrace&&!o){var u=iy();u&&u.pathname&&(o=u.pathname)}s.name=s.name||o});i&&i.add(a)}return t}(),L6="setLocalId";function jae(){return this.getLocalId()}function Uae(t){this[L6](t)}var Fae=function(){function t(e,n,r,o){var i,s,a;gn(t,this,function(c){if(p(n),typeof navigator<"u"){var u=navigator;c.locale=u.userLanguage||u.language}c.getLocalId=function(){return s||h()},c[L6]=function(f){s=f};function h(){if(!i.hashIdentifiers&&!i.dropIdentifiers){var f=ud(a,"MUID");f&&(s="t:"+f)}return s}function p(f){var g=vr(f,function(){if(a=r&&r.getCookieMgr(),i=f,s=null,a&&a.isEnabled()&&(h(),i.enableApplicationInsightsUser)){var v=ud(a,t.userCookieName);if(v){var y=v.split(t.cookieSeparator);y.length>0&&(c.id=y[0])}if(!c.id){c.id=q_(e&&!Jt(e.idLength)?e.idLength:22);var b=K1(new Date);c.accountAcquisitionDate=b;var C=[c.id,b],S=i.cookieDomain?i.cookieDomain:void 0;a.set(t.userCookieName,C.join(t.cookieSeparator),31536e3,S)}}});o&&o.add(g)}})}return t.cookieSeparator="|",t.userCookieName="ai_user",t._staticInit=function(){Cn(t.prototype,"localId",{g:jae,s:Uae})}(),t}(),Bae=1048576,Hae=2097152,zae=4194304,Vae=function(){function t(e,n){var r=this;r.popSample=100;var o=vr(e,function(){r.eventFlags=0,e.hashIdentifiers&&(r.eventFlags=r.eventFlags|Bae),e.dropIdentifiers&&(r.eventFlags=r.eventFlags|Hae),e.scrubIpOnly&&(r.eventFlags=r.eventFlags|zae)});n&&n.add(o)}return t}(),f2=["Required","Analytics","SocialMedia","Advertising"],Ov="([\\d,.]+)",D6="Unknown",j6="Edg/",U6="EdgiOS/",DS=[{ua:"OPR/",b:"Opera"},{ua:"PhantomJS",b:"PhantomJS"},{ua:"Edge",b:"Edge"},{ua:j6,b:"Edge"},{ua:U6,b:"Edge"},{ua:"Electron",b:"Electron"},{ua:"Chrome",b:"Chrome"},{ua:"Trident",b:"MSIE"},{ua:"MSIE ",b:"MSIE"},{ua:"Firefox",b:"Firefox"},{ua:"Safari",b:"Safari"},{ua:"SkypeShell",b:"SkypeShell"}],jS=[{br:"Microsoft Edge",b:"Edge"},{br:"Google Chrome",b:"Chrome"},{br:"Opera",b:"Opera"}];function iE(t,e){return e.indexOf(t)>-1}function $ae(t,e){for(var n=0;n<e.length;n++)if(t==e[n].brand)return e[n].version;return null}function Gae(t){if(t)for(var e=0;e<DS.length;e++){var n=DS[e].ua;if(iE(n,t))return DS[e].b}return D6}function Kae(t,e){return e==="MSIE"?qae(t):Wae(e,t)}function qae(t){var e=t.match(new RegExp("MSIE "+Ov));if(e)return e[1];var n=t.match(new RegExp("rv:"+Ov));if(n)return n[1]}function Wae(t,e){t==="Safari"?t="Version":t==="Edge"&&(iE(j6,e)?t="Edg":iE(U6,e)&&(t="EdgiOS"));var n=e.match(new RegExp(t+"/"+Ov));return n||t==="Opera"&&(n=e.match(new RegExp("OPR/"+Ov)),n)?n[1]:D6}function Yae(){var t={h:0,w:0},e=Ra();return e&&e.screen&&(t.h=screen.height,t.w=screen.width),t}function Qae(){return this.getUserConsent()}var Jae=function(){function t(e,n,r){s6(n);var o=e||{},i=null,s=null,a=null,c=null,u=null,h=null,p=null;gn(t,this,function(f){w(e);var g=iy();if(g){var v=g.hostname;v&&(f.domain=g.protocol==="file:"?"local":v)}var y=Yae();f.screenRes=y.w+"X"+y.h,f.getUserConsent=function(){return!1},f.getUserConsentDetails=function(){var A=null;try{var M=o.callback;if(M&&M.userConsentDetails){var R=M.userConsentDetails();if(R){o.disableConsentDetailsSanitize?A=R:A={};for(var $=0;$<f2.length;$++){var V=f2[$];A[V]=R[V]||!1}}}return p!==null&&(A=A||{},A.GPC_DataSharingOptIn=!!p),A?JSON.stringify(A):null}catch{}};function b(A,M){if(kt(M))try{for(var R=0;R<jS.length;R++){var $=$ae(jS[R].br,M);if($){u=jS[R].b,h=$;return}}}catch{}if(A){var V=Gae(A);u=V,h=Kae(A,V)}}function C(A){a=A}function S(A){c=A}function E(){return a||u}function I(){return c||h}var T=function(){return p},_=function(A){p=jc(A)?A:null,o.gpcDataSharingOptIn=p};function w(A){var M=vr(A,function(){if(o=A,o.populateBrowserInfo){var R=o.userAgent,$=(o.userAgentData||{}).brands;if(R!==i||$!==s){if(!R||!$||$.length===0){var V=Xi();V&&(R=R||V.userAgent||"",$=$||(V.userAgentData||{}).brands)}b(R,$),i=R,s=$}}p=jc(o.gpcDataSharingOptIn)?o.gpcDataSharingOptIn:null});r&&r.add(M)}u4(f,{userConsent:{g:f.getUserConsent},browser:{s:C,g:E},browserVer:{s:S,g:I},gpcDataSharingOptIn:{g:T,s:_}})})}return t._staticInit=function(){Cn(t.prototype,"userConsent",{g:Qae})}(),t}();function Xr(t,e,n,r,o){var i=e.ext[to[t]];if(i)try{sn(r,function(s,a){if(mr(a)||ba(a)||jc(a)){var c=i[n[s]];!o&&(c||mr(c)||ba(c)||jc(c))&&(a=c),i[n[s]]=a}})}catch{}return i}var Zae=function(){function t(e,n,r,o){gn(t,this,function(i){i.app=new Cae(n,r,o),i.cloud=new Sae,i.user=new Fae(e,n,r,o),i.os=new Pae(n,o),i.web=new Jae(n,r,o);var s=new Lae(e,r,o),a=new _ae(n,r,o),c=new Vae(n,o);i.loc=new wae,i.device=new Eae;var u=new vae(r,n,o);i.session=new P6;var h=void 0,p=Xae(new Dae(n,h,h,h,o),v()),f=!(n||{}).eventContainExtFields;function g(){var y=i.session;if(y&&mr(y.customId))return y.customId;u.update();var b=u.automaticSession;if(b){var C=b.getId();C&&mr(C)&&(y.automaticId=C)}return y.automaticId}i.getTraceCtx=function(){return p},i.getSessionId=g,i.applyApplicationContext=function(y){var b,C=i.app;Xr(4,y,eae,(b={},b[0]=C.id,b[1]=C.ver,b[2]=C.name,b[3]=C.locale,b[4]=C.getExpId(),b[5]=C.env,b),f)},i.applyUserContext=function(y){var b,C=i.user;Xr(0,y,nae,(b={},b[1]=C.getLocalId(),b[0]=C.locale,b[2]=C.id,b),f)},i.applyWebContext=function(y){var b,C=i.web;Xr(3,y,tae,(b={},b[0]=C.domain,b[1]=C.browser,b[2]=C.browserVer,b[3]=C.screenRes,b[5]=C.getUserConsentDetails(),b[4]=!1,b),f)},i.applyOsContext=function(y){var b,C=i.os;Xr(5,y,rae,(b={},b[0]=C.name,b[1]=C.ver,b),f)},i.applySdkContext=function(y){var b;Xr(6,y,oae,(b={},b[2]=s.installId,b[1]=s.getSequenceId(),b[3]=s.epoch,b),f)},i.applyIntWebContext=function(y){var b;Xr(7,y,iae,(b={},b[0]=a.getMsfpc(),b[1]=a.getAnid(),b[2]=a.serviceName,b),f)},i.applyUtcContext=function(y){var b,C=(b={},b[0]=c.popSample,b);c.eventFlags>0&&(C[1]=c.eventFlags),Xr(8,y,sae,C,f)},i.applyLocContext=function(y){var b;Xr(9,y,aae,(b={},b[0]=i.loc.tz,b),f)},i.applySessionContext=function(y){var b;Xr(4,y,cae,(b={},b[0]=g(),b),f)},i.applyDeviceContext=function(y){var b,C=i.device;Xr(1,y,lae,(b={},b[0]=C.localId,b[2]=C.make,b[3]=C.model,b[1]=C.deviceClass,b),f)},i.applyCloudContext=function(y){var b,C=i.cloud;Xr(10,y,uae,(b={},b[0]=C.role,b[1]=C.roleInstance,b[2]=C.roleVer,b),f)},i.applyAITraceContext=function(y){var b;if(n.enableApplicationInsightsTrace){var C=v();C&&Xr(2,y,dae,(b={},b[0]=C.getTraceId(),b[1]=C.getName(),b[2]=C.getSpanId(),b),!1)}},i.applyDistributedTraceContext=function(y){var b,C=v();if(C){var S=(b={},b[0]=C.getTraceId(),b[1]=C.getSpanId(),b),E=C.getTraceFlags();Zt(E)||(S[2]=E),Xr(11,y,hae,S,!1)}};function v(){var y=p;return r&&r.getTraceCtx&&(y=r.getTraceCtx(!1)||p),y}})}return t.__ieDyn=1,t}();function Xae(t,e){var n=t||{};return{getName:function(){return n.name},setName:function(r){e&&e.setName(r),n.name=r},getTraceId:function(){return n.traceId},setTraceId:function(r){e&&e.setTraceId(r),u6(r)&&(n.traceId=r)},getSpanId:function(){return n.parentId},setSpanId:function(r){e&&e.setSpanId(r),d6(r)&&(n.parentId=r)},getTraceFlags:function(){return n.traceFlags},setTraceFlags:function(r){e&&e.setTraceFlags(r),n.traceFlags=r}}}var ym,ece=[to[4],to[0],to[3],to[5],to[6],to[7],to[8],to[9],to[1],to[2],to[11],to[10]],tce=Md({populateBrowserInfo:!1,populateOperatingSystemInfo:!1,userAgent:Fa(),userAgentData:Q1({brands:ym,mobile:ym,platform:ym}),userConsentCookieName:Fa(),userConsented:!1,serviceName:Fa(),env:Fa(),expId:Fa(),sessionRenewalMs:18e5,sessionExpirationMs:864e5,sessionAsGuid:null,cookieDomain:Fa(),namePrefix:Fa(),enableApplicationInsightsTrace:!1,enableApplicationInsightsUser:!1,hashIdentifiers:!1,dropIdentifiers:!1,scrubIpOnly:!1,callback:Q1({userConsentDetails:null}),gpcDataSharingOptIn:ym,idLength:22,enableDistributedTracing:!1,eventContainExtFields:!1}),nce=function(t){gp(e,t);function e(){var n=t.call(this)||this;n.identifier="SystemPropertiesCollector",n.priority=3,n.version="4.3.3";var r,o,i;return gn(e,n,function(s,a){c(),s.initialize=function(p,f,g){a.initialize(p,f,g),u(p)},s.processTelemetry=function(p,f){rE(p,s.identifier),f=s._getTelCtx(f);var g=p.ext=p.ext?p.ext:{};p.data=p.data?p.data:{},tt(ece,function(v){g[v]=g[v]||{}}),r&&(r.applyUtcContext(p),r.applyApplicationContext(p),r.applyUserContext(p),r.applyWebContext(p),r.applyOsContext(p),r.applySdkContext(p),r.applyIntWebContext(p),r.applyLocContext(p),r.applySessionContext(p),r.applyDeviceContext(p),i.enableApplicationInsightsTrace&&r.applyAITraceContext(p),i.enableDistributedTracing&&r.applyDistributedTraceContext(p),r.applyCloudContext(p)),tt(bs(g),function(v){bs(g[v]).length===0&&delete g[v]}),h(o,p.data),s.processNext(p,f)},s.getPropertiesContext=function(){return r},s.setProperty=function(p,f){o[p]=f},s._doTeardown=function(p,f){var g=(p||{}).core();if(g&&g.getTraceCtx&&r){var v=g.getTraceCtx(!1);v&&v===r.getTraceCtx()&&g.setTraceCtx(null)}c()},s._getDbgPlgTargets=function(){return[i]};function c(){r=null,o={}}function u(p){var f=s.identifier,g=s.core;s._addHook(vr(p,function(){var v=Vc(null,p,g);i=v.getExtCfg(f,tce)})),r=new Zae(p,i,g,s._unloadHooks),g&&g.setTraceCtx&&g.setTraceCtx(r.getTraceCtx())}function h(p,f){p&&sn(p,function(g,v){f[g]||(f[g]=v)})}}),n}return e.__ieDyn=1,e}(ew),Cm="REAL_TIME",rce="NEAR_REAL_TIME",oce="BEST_EFFORT",Js="",sE="drop",ice="send",p2="requeue",sce="rspFail",ace="oth",m2="no-cache, no-store",aE="application/x-json-stream",Sm="cache-control",Uh="content-type",cce="kill-tokens",lce="kill-duration",uce="time-delta-millis",cE="client-version",F6="client-id",lE="time-delta-to-apply-millis",uE="upload-time",dE="apikey",hE="AuthMsaDeviceTicket",g2="WebAuthToken",v2="AuthXToken",dce="NoResponseBody",Lv="msfpc",b2="trace",US="user",fE="allowRequestSending",B6="firstRequestSent",H6="shouldAddClockSkewHeaders",z6="getClockSkewHeaderValue",pE="setClockSkew",Et="length",Sc="concat",Li="iKey",zn="count",uc="events",Ir="push",Ru="split",cy="splice",mE="toLowerCase",ru="hdrs",gE="useHdrs",af="initialize",V6="setTimeoutOverride",$6="clearTimeoutOverride",hce="payloadPreprocessor",y2="overrideEndpointUrl",C2="avoidOptions",fce="disableEventTimings",pce="stringifyObjects",FS="enableCompoundKey",S2="disableXhrSync",E2="disableFetchKeepAlive",mce="addNoResponse",gce="excludeCsMetaData",I2="useSendBeacon",T2="fetchCredentials",_2="alwaysUseXhrOverride",vce="unloadTransports",G6="serializeOfflineEvt",K6="getOfflineRequestDetails",BS="createPayload",vE="createOneDSPayload",w2="payloadBlob",Ci="headers",mh="_thePayload",A2="urlString",Hr="batches",eo="sendType",bE="addHeader",yE="canSendRequest",Dv="sendQueuedRequests",q6="isCompletelyIdle",CE="setUnloading",bce="isTenantKilled",rg="resume",W6="sendSynchronousBatch",HS="_transport",jv="getWParam",k2="isBeacon",Em="timings",zS="isTeardown",VS="isSync",og="data",yce="timeout",$S="_sendReason",Y6="setKillSwitchTenants",Q6="_backOffTransmission",Im="identifier",Cce="disableOptimizeObj",Sce="ignoreMc1Ms0CookieProcessing",x2="eventsLimitInMem",R2="autoFlushEventsLimit",Ece="disableAutoBatchFlushLimit",Ice="overrideInstrumentationKey",Tce="disableTelemetry",GS="baseData",Tm="sendAttempt",Ha="latency",Ul="sync";function J6(t){var e=(t.ext||{}).intweb;return e&&ta(e[Lv])?e[Lv]:null}function N2(t){for(var e=null,n=0;e===null&&n<t[Et];n++)e=J6(t[n]);return e}var zf=function(){function t(e,n){var r=n?[][Sc](n):[],o=this,i=N2(r);o[Li]=function(){return e},o.Msfpc=function(){return i||Js},o[zn]=function(){return r[Et]},o[uc]=function(){return r},o.addEvent=function(s){return s?(r[Ir](s),i||(i=J6(s)),!0):!1},o[Ru]=function(s,a){var c;if(s<r[Et]){var u=r[Et]-s;Zt(a)||(u=a<u?a:u),c=r[cy](s,u),i=N2(r)}return new t(e,c)}}return t.create=function(e,n){return new t(e,n)},t}(),_ce=function(){function t(){var e=!0,n=!0,r=!0,o="use-collector-delta",i=!1;gn(t,this,function(s){s[fE]=function(){return e},s[B6]=function(){r&&(r=!1,i||(e=!1))},s[H6]=function(){return n},s[z6]=function(){return o},s[pE]=function(a){i||(a?(o=a,n=!0,i=!0):n=!1,e=!0)}})}return t.__ieDyn=1,t}(),wce=1e3,Ace=function(){function t(){var e={};function n(r){var o=[];return r&&tt(r,function(i){o[Ir](Gr(i))}),o}gn(t,this,function(r){r[Y6]=function(o,i){if(o&&i)try{var s=n(o[Ru](","));if(i==="this-request-only")return s;for(var a=parseInt(i,10)*wce,c=0;c<s[Et];++c)e[s[c]]=Ca()+a}catch{return[]}return[]},r[bce]=function(o){var i=e,s=Gr(o);return i[s]!==void 0&&i[s]>Ca()?!0:(delete i[s],!1)}})}return t.__ieDyn=1,t}(),kce=.8,xce=1.2,P2=3e3,Rce=6e5;function Nce(t){return!(t>=300&&t<500&&t!=429||t==501||t==505)}function Z6(t){var e=0,n=P2*kce,r=P2*xce,o=Math.floor(Math.random()*(r-n))+n;return e=Math.pow(2,t)*o,Math.min(e,Rce)}var Pce=20,Mce=3984588,X6=65e3,ej=2e6,Oce=Math.min(ej,X6),M2="metadata",_m="f",Lce=/\./,Dce=function(){function t(e,n,r,o,i,s){var a="data",c="baseData",u="ext",h=!!o,p=!0,f=n,g={},v=!!s,y=i||A6;gn(t,this,function(b){b.createPayload=function(E,I,T,_,w,A){return{apiKeys:[],payloadBlob:Js,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:E,isTeardown:I,isSync:T,isBeacon:_,sendType:A,sendReason:w}},b.appendPayload=function(E,I,T){var _=E&&I&&!E.overflow;return _&&zr(e,function(){return"Serializer:appendPayload"},function(){for(var w=I.events(),A=E.payloadBlob,M=E.numEvents,R=!1,$=[],V=[],ie=E.isBeacon,N=ie?X6:Mce,Y=ie?Oce:ej,ue=0,j=0;ue<w.length;){var U=w[ue];if(U){if(M>=T){E.overflow=I.split(ue);break}var te=b.getEventBlob(U);if(te&&te.length<=Y){var Q=te.length,re=A.length;if(re+Q>N){E.overflow=I.split(ue);break}A&&(A+=`
`),A+=te,j++,j>Pce&&(Xl(A,0,1),j=0),R=!0,M++}else te?$.push(U):V.push(U),w.splice(ue,1),ue--}ue++}if($.length>0&&E.sizeExceed.push(zf.create(I.iKey(),$)),V.length>0&&E.failedEvts.push(zf.create(I.iKey(),V)),R){E.batches.push(I),E.payloadBlob=A,E.numEvents=M;var Z=I.iKey();Do(E.apiKeys,Z)===-1&&E.apiKeys.push(Z)}},function(){return{payload:E,theBatch:{iKey:I.iKey(),evts:I.events()},max:T}}),_},b.getEventBlob=function(E){try{return zr(e,function(){return"Serializer.getEventBlob"},function(){var I={};I.name=E.name,I.time=E.time,I.ver=E.ver,I.iKey="o:"+jse(E.iKey);var T={},_;v||(_=function(R,$,V){jce(y,T,R,$,V)});var w=E[u];w&&(I[u]=T,sn(w,function(R,$){var V=T[R]={};S($,V,"ext."+R,!0,null,null,!0)}));var A=I[a]={};A.baseType=E.baseType;var M=A[c]={};return S(E.baseData,M,c,!1,[c],_,p),S(E.data,A,a,!1,[],_,p),JSON.stringify(I)},function(){return{item:E}})}catch{return null}};function C(E,I){var T=g[E];return T===void 0&&(E.length>=7&&(T=aR(E,"ext.metadata")||aR(E,"ext.web")),g[E]=T),T}function S(E,I,T,_,w,A,M){sn(E,function(R,$){var V=null;if($||ta($)){var ie=T,N=R,Y=w,ue=I;if(h&&!_&&Lce.test(R)){var j=R.split("."),U=j.length;if(U>1){Y&&(Y=Y.slice());for(var te=0;te<U-1;te++){var Q=j[te];ue=ue[Q]=ue[Q]||{},ie+="."+Q,Y&&Y.push(Q)}N=j[U-1]}}var re=_&&C(ie);if(!re&&f&&f.handleField(ie,N)?V=f.value(ie,N,$,r):V=Fse(N,$,r),V){var Z=V.value;if(ue[N]=Z,A&&A(Y,N,V),typeof Z=="object"&&!kt(Z)){var _e=Y;_e&&(_e=_e.slice(),_e.push(N)),S($,Z,ie+"."+N,_,_e,A)}}}})}})}return t.__ieDyn=1,t}();function jce(t,e,n,r,o){if(o&&e){var i=t(o.value,o.kind,o.propertyType);if(i>-1){var s=e[M2];s||(s=e[M2]={f:{}});var a=s[_m];if(a||(a=s[_m]={}),n)for(var c=0;c<n.length;c++){var u=n[c];a[u]||(a[u]={f:{}});var h=a[u][_m];h||(h=a[u][_m]={}),a=h}a=a[r]={},kt(o.value)?a.a={t:i}:a.t=i}}}function Uv(t,e){return{set:function(n,r){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];return Coe([t,e],n,r,o)}}}var za,KS="sendAttempt",Uce="&"+dce+"=true",Fce="?cors=true&"+Uh[mE]()+"="+aE,Bce=(za={},za[1]=p2,za[100]=p2,za[200]="sent",za[8004]=sE,za[8003]=sE,za),SE={},EE={};function dl(t,e,n){SE[t]=e,n!==!1&&(EE[e]=t)}dl(hE,hE,!1);dl(cE,cE);dl(F6,"Client-Id");dl(dE,dE);dl(lE,lE);dl(uE,uE);dl(v2,v2);function wm(t,e){var n=!1;if(t&&e){var r=bs(t);if(r&&r[Et]>0)for(var o=e[mE](),i=0;i<r[Et];i++){var s=r[i];if(s&&Lo(e,s)&&s[mE]()===o){n=!0;break}}}return n}function Fl(t,e,n,r){e&&n&&n[Et]>0&&(r&&SE[e]?(t[ru][SE[e]]=n,t[gE]=!0):t.url+="&"+e+"="+n)}function Hce(t,e,n){for(var r=0;r<t[Et];r++)if(t[r].name===e){t[r].value=n;return}t[Ir]({name:e,value:n})}function zce(t,e){for(var n=0;n<t[Et];n++)if(t[n].name===e){t[cy](n,1);return}}var Vce=function(){function t(e,n,r,o){var i,s,a,c,u=!1,h,p,f,g,v,y,b,C,S,E,I,T,_,w,A,M,R,$,V,ie,N,Y,ue,j,U,te,Q,re;gn(t,this,function(Z){we();var _e=!0;Z[af]=function(F,me,ve){j||(v=me,T=me.getCookieMgr(),p=ve,f=p.diagLog(),ia(ie,vr(F,function(je){var Ve,ct=je.cfg,Be=je.cfg.extensionConfig[ve.identifier];U=Uv(Be[V6],Be[$6]),ta(ct.anonCookieName)?Hce(b,"anoncknm",ct.anonCookieName):zce(b,"anoncknm"),N=Be[hce],Y=Be.payloadListener;var k=Be.httpXHROverride,G=Be[y2]?Be[y2]:ct.endpointUrl;i=G+Fce,w=Jt(Be[C2])?!0:!Be[C2],I=!Be[fce];var ee=Be.valueSanitizer,Ce=Be[pce],De=!!ct[FS];Jt(Be[FS])||(De=!!Be[FS]),A=Be.xhrTimeout,M=!!Be[S2],R=!!Be[E2],V=Be[mce]!==!1,te=!!Be[gce],me.getPlugin("LocalStorage")&&(R=!0),u=!q1(),E=new Dce(v,ee,Ce,De,A6,te),Zt(Be[I2])||(u=!!Be[I2]),Be[T2]&&(re=Be[T2]);var Qe=Se();Q?Q.SetConfig(Qe):(Q=new Cse,Q[af](Qe,f));var rt=k,lt=Be[_2]?k:null,yt=Be[_2]?k:null,Qt=[3,2];if(!k){y=!1;var ot=[];q1()?(ot=[2,1],Qt=[2,1,3]):ot=[1,2,3],ot=kR(ot,Be.transports),k=ye(ot,!1),k||nf(f,"No available transport to send events"),rt=ye(ot,!0)}lt||(Qt=kR(Qt,Be[vce]),lt=ye(Qt,!0)),$=!y&&(u&&H4()||!R&&z4(!0)),g=(Ve={},Ve[0]=k,Ve[1]=rt||ye([1,2,3],!0),Ve[2]=lt||rt||ye([1],!0),Ve[3]=yt||ye([2,3],!0)||rt||ye([1],!0),Ve)})),j=!0)},Z.addResponseHandler=function(F){return ue[Ir](F),{rm:function(){var me=ue.indexOf(F);me>=0&&ue[cy](me,1)}}},Z[G6]=function(F){try{if(E)return E.getEventBlob(F)}catch{}return Js},Z[K6]=function(){try{var F=E&&E[BS](0,!1,!1,!1,1,0);return K(F,w)}catch{}return null},Z[vE]=function(F,me){try{var ve=[];tt(F,function(k){me&&(k=nu(k));var G=zf.create(k[Li],[k]);ve[Ir](G)});for(var je=null;ve[Et]>0&&E;){var Ve=ve.shift();Ve&&Ve[zn]()>0&&(je=je||E[BS](0,!1,!1,!1,1,0),E.appendPayload(je,Ve,e))}var ct=K(je,w),Be={data:je[w2],urlString:ct.url,headers:ct[ru],timeout:A,disableXhrSync:M,disableFetchKeepAlive:R};return w&&(wm(Be[Ci],Sm)||(Be[Ci][Sm]=m2),wm(Be[Ci],Uh)||(Be[Ci][Uh]=aE)),Be}catch{}return null};function ye(F,me){try{return Q&&Q.getSenderInst(F,me)}catch{}return null}Z._getDbgPlgTargets=function(){return[g[0],s,E,g,Se(),i]};function Se(){try{var F={xdrOnComplete:Ne,fetchOnComplete:Ke,xhrOnComplete:de,beaconOnRetry:$e},me={enableSendPromise:!1,isOneDs:!0,disableCredentials:!_e,fetchCredentials:re,disableXhr:!1,disableBeacon:!u,disableBeaconSync:!u,disableFetchKeepAlive:R,timeWrapper:U,addNoResponse:V,senderOnCompleteCallBack:F};return me}catch{}return null}function Ne(F,me,ve){var je=cd(F);ge(me,200,{},je),Gt(je)}function we(){var F;i=null,s=new Ace,a=!1,c=new _ce,u=!1,h=0,p=null,f=null,g=null,v=null,y=!0,b=[],C={},S=[],E=null,I=!1,T=null,_=!1,w=!1,A=F,M=F,R=F,$=F,V=F,ie=[],N=F,Y=F,ue=[],j=!1,U=Uv(),te=!1,Q=null}function Ke(F,me,ve,je){var Ve=function(k,G,ee){ge(me,k,G,ee),Gt(ee)},ct={},Be=F[Ci];Be&&Be.forEach(function(k,G){ct[G]=k}),Ve(F.status,ct,ve||Js)}function de(F,me,ve){var je=cd(F);ge(me,F.status,Zm(F,!0),je),Gt(je)}function ge(F,me,ve,je){try{F(me,ve,je)}catch(Ve){rn(f,2,518,jt(Ve))}}function $e(F,me,ve){var je=F,Ve=200,ct=je[mh],Be=F[A2]+(V?Uce:Js);try{var k=Xi();if(ct){var G=!!v.getPlugin("LocalStorage"),ee=[],Ce=[];tt(ct[Hr],function(De){if(ee&&De&&De[zn]()>0)for(var Qe=De[uc](),rt=0;rt<Qe[Et];rt++)if(k.sendBeacon(Be,E.getEventBlob(Qe[rt])))Ce[Ir](De[rt]);else{ee[Ir](De[Ru](rt));break}else ee[Ir](De[Ru](0))}),Ce[Et]>0&&(ct.sentEvts=Ce),G||Kt(ee,8003,ct[eo],!0)}else Ve=0}catch(De){nf(f,"Failed to send telemetry using sendBeacon API. Ex:"+jt(De)),Ve=0}finally{ge(me,Ve,{},Js)}}function P(F){return F===2||F===3}function J(F){return _&&P(F)&&(F=2),F}Z[bE]=function(F,me){C[F]=me},Z.removeHeader=function(F){delete C[F]},Z[yE]=function(){return Te()&&c[fE]()},Z[Dv]=function(F,me){Jt(F)&&(F=0),_&&(F=J(F),me=2),ce(S,F,0)&&ne(O(),0,!1,F,me||0)},Z[q6]=function(){return!a&&h===0&&S[Et]===0},Z[CE]=function(F){_=F},Z.addBatch=function(F){if(F&&F[zn]()>0){if(s.isTenantKilled(F[Li]()))return!1;S[Ir](F)}return!0},Z.teardown=function(){S[Et]>0&&ne(O(),0,!0,2,2),tt(ie,function(F){F&&F.rm&&F.rm()}),ie=[]},Z.pause=function(){a=!0},Z[rg]=function(){a=!1,Z[Dv](0,4)},Z[W6]=function(F,me,ve){F&&F[zn]()>0&&(Zt(me)&&(me=1),_&&(me=J(me),ve=2),ne([F],0,!1,me,ve||0))};function Te(){return!a&&h<n}function O(){var F=S;return S=[],F}function ce(F,me,ve){var je=!1;return F&&F[Et]>0&&!a&&g[me]&&E&&(je=me!==0||Te()&&(ve>0||c[fE]())),je}function se(F){var me={};return F&&tt(F,function(ve,je){me[je]={iKey:ve[Li](),evts:ve[uc]()}}),me}function ne(F,me,ve,je,Ve){if(!(!F||F[Et]===0)){if(a){Kt(F,1,je);return}je=J(je);try{var ct=F,Be=je!==0;zr(v,function(){return"HttpManager:_sendBatches"},function(k){k&&(F=F.slice(0));for(var G=[],ee=null,Ce=Ti(),De=g[je]||(Be?g[1]:g[0]),Qe=De&&De[HS],rt=$&&(_||P(je)||Qe===3||De._isSync&&Qe===2);ce(F,je,me);){var lt=F.shift();lt&&lt[zn]()>0&&(s.isTenantKilled(lt[Li]())?G[Ir](lt):(ee=ee||E[BS](me,ve,Be,rt,Ve,je),E.appendPayload(ee,lt,e)?ee.overflow!==null&&(F=[ee.overflow][Sc](F),ee.overflow=null,He(ee,Ce,Ti(),Ve),Ce=Ti(),ee=null):(He(ee,Ce,Ti(),Ve),Ce=Ti(),F=[lt][Sc](F),ee=null)))}ee&&He(ee,Ce,Ti(),Ve),F[Et]>0&&(S=F[Sc](S)),Kt(G,8004,je)},function(){return{batches:se(ct),retryCount:me,isTeardown:ve,isSynchronous:Be,sendReason:Ve,useSendBeacon:P(je),sendType:je}},!Be)}catch(k){rn(f,2,48,"Unexpected Exception sending batch: "+jt(k))}}}function K(F,me){var ve={url:i,hdrs:{},useHdrs:!1};me?(ve[ru]=Mv(ve[ru],C),ve.useHdrs=bs(ve.hdrs)[Et]>0):sn(C,function(k,G){EE[k]?Fl(ve,EE[k],G,!1):(ve[ru][k]=G,ve[gE]=!0)}),Fl(ve,F6,"NO_AUTH",me),Fl(ve,cE,_6,me);var je=Js;tt(F.apiKeys,function(k){je[Et]>0&&(je+=","),je+=k}),Fl(ve,dE,je,me),Fl(ve,uE,Ca().toString(),me);var Ve=Ut(F);if(ta(Ve)&&(ve.url+="&ext.intweb.msfpc="+Ve),c[H6]()&&Fl(ve,lE,c[z6](),me),v[jv]){var ct=v[jv]();ct>=0&&(ve.url+="&w="+ct)}for(var Be=0;Be<b[Et];Be++)ve.url+="&"+b[Be].name+"="+b[Be].value;return ve}function pe(F,me,ve){F[me]=F[me]||{},F[me][p.identifier]=ve}function He(F,me,ve,je){if(F&&F.payloadBlob&&F.payloadBlob[Et]>0){var Ve=!!N,ct=g[F.sendType];!P(F[eo])&&F[k2]&&F.sendReason===2&&(ct=g[2]||g[3]||ct);var Be=w;(F.isBeacon||ct[HS]===3)&&(Be=!1);var k=K(F,Be);Be=Be||k[gE];var G=Ti();zr(v,function(){return"HttpManager:_doPayloadSend"},function(){for(var ee=0;ee<F.batches[Et];ee++)for(var Ce=F[Hr][ee],De=Ce[uc](),Qe=0;Qe<De[Et];Qe++){var rt=De[Qe];if(I){var lt=rt[Em]=rt[Em]||{};pe(lt,"sendEventStart",G),pe(lt,"serializationStart",me),pe(lt,"serializationCompleted",ve)}rt[KS]>0?rt[KS]++:rt[KS]=1}Kt(F[Hr],1e3+(je||0),F[eo],!0);var yt={data:F[w2],urlString:k.url,headers:k[ru],_thePayload:F,_sendReason:je,timeout:A,disableXhrSync:M,disableFetchKeepAlive:R};Be&&(wm(yt[Ci],Sm)||(yt[Ci][Sm]=m2),wm(yt[Ci],Uh)||(yt[Ci][Uh]=aE));var Qt=null;ct&&(Qt=function(ot){c[B6]();var xn=function($o,Il){ut($o,Il,F,je)},br=F[zS]||F[VS];try{ct.sendPOST(ot,xn,br),Y&&Y(yt,ot,br,F[k2])}catch($o){nf(f,"Unexpected exception sending payload. Ex:"+jt($o)),ge(xn,0,{})}}),zr(v,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(Qt)if(F[eo]===0&&h++,Ve&&!F.isBeacon&&ct[HS]!==3){var ot={data:yt[og],urlString:yt[A2],headers:Mv({},yt[Ci]),timeout:yt[yce],disableXhrSync:yt[S2],disableFetchKeepAlive:yt[E2]},xn=!1;zr(v,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{N(ot,function(br){xn=!0,!y&&!br[mh]&&(br[mh]=br[mh]||yt[mh],br[$S]=br[$S]||yt[$S]),Qt(br)},F.isSync||F[zS])}catch{xn||Qt(yt)}})}else Qt(yt)})},function(){return{thePayload:F,serializationStart:me,serializationCompleted:ve,sendReason:je}},F[VS])}F.sizeExceed&&F.sizeExceed[Et]>0&&Kt(F.sizeExceed,8003,F[eo]),F.failedEvts&&F.failedEvts[Et]>0&&Kt(F.failedEvts,8002,F[eo])}function at(F,me){I&&tt(F,function(ve){var je=ve[Em]=ve[Em]||{};pe(je,"sendEventCompleted",me)})}function ut(F,me,ve,je){var Ve=9e3,ct=null,Be=!1,k=!1;try{var G=!0;if(typeof F!==__){if(me){c[pE](me[uce]);var ee=me[lce]||me["kill-duration-seconds"];tt(s[Y6](me[cce],ee),function(De){tt(ve[Hr],function(Qe){if(Qe[Li]()===De){ct=ct||[];var rt=Qe[Ru](0);ve.numEvents-=rt[zn](),ct[Ir](rt)}})})}if(F==200||F==204){Ve=200;return}(!Nce(F)||ve.numEvents<=0)&&(G=!1),Ve=9e3+F%1e3}if(G){Ve=100;var Ce=ve.retryCnt;ve[eo]===0&&(Ce<r?(Be=!0,St(function(){ve[eo]===0&&h--,ne(ve[Hr],Ce+1,ve[zS],_?2:ve[eo],5)},_,Z6(Ce))):(k=!0,_&&(Ve=8001)))}}finally{Be||(c[pE](),Le(ve,Ve,je,k)),Kt(ct,8004,ve[eo])}}function Le(F,me,ve,je){try{je&&p[Q6]();var Ve=F[Hr];me===200&&(Ve=F.sentEvts||F[Hr],!je&&!F[VS]&&p._clearBackOff(),Xe(Ve)),Kt(Ve,me,F[eo],!0)}finally{F[eo]===0&&(h--,ve!==5&&Z.sendQueuedRequests(F[eo],ve))}}function Xe(F){if(I){var me=Ti();tt(F,function(ve){ve&&ve[zn]()>0&&at(ve[uc](),me)})}}function St(F,me,ve){me?F():U.set(F,ve)}function Ut(F){for(var me=0;me<F.batches[Et];me++){var ve=F[Hr][me].Msfpc();if(ve)return encodeURIComponent(ve)}return Js}function Gt(F){var me=ue;try{for(var ve=0;ve<me[Et];ve++)try{me[ve](F)}catch(Ve){rn(f,1,519,"Response handler failed: "+Ve)}if(F){var je=JSON.parse(F);ta(je.webResult)&&ta(je.webResult[Lv])&&T.set("MSFPC",je.webResult[Lv],365*86400)}}catch{}}function Kt(F,me,ve,je){if(F&&F[Et]>0&&o){var Ve=o[kn(me)];if(Ve){var ct=ve!==0;zr(v,function(){return"HttpManager:_sendBatchesNotification"},function(){St(function(){try{Ve.call(o,F,me,ct,ve)}catch(Be){rn(f,1,74,"send request notification failed: "+Be)}},je||ct,0)},function(){return{batches:se(F),reason:me,isSync:ct,sendSync:je,sendType:ve}},!ct)}}}function kn(F){var me=Bce[F];return ta(me)||(me=ace,F>=9e3&&F<=9999?me=sce:F>=8e3&&F<=8999?me=sE:F>=1e3&&F<=1999&&(me=ice)),me}})}return t.__ieDyn=1,t}(),$ce=.25,O2=500,Gce=20,tj=6,nj=2,Kce=4,L2=2,qce=1,IE=1e4,Va="eventsDiscarded",D2="",On=void 0,Wce=Md({eventsLimitInMem:{isVal:of,v:IE},immediateEventLimit:{isVal:of,v:500},autoFlushEventsLimit:{isVal:of,v:0},disableAutoBatchFlushLimit:!1,httpXHROverride:{isVal:Yce,v:On},overrideInstrumentationKey:On,overrideEndpointUrl:On,disableTelemetry:!1,ignoreMc1Ms0CookieProcessing:!1,setTimeoutOverride:On,clearTimeoutOverride:On,payloadPreprocessor:On,payloadListener:On,disableEventTimings:On,valueSanitizer:On,stringifyObjects:On,enableCompoundKey:On,disableOptimizeObj:!1,fetchCredentials:On,transports:On,unloadTransports:On,useSendBeacon:On,disableFetchKeepAlive:On,avoidOptions:!1,xhrTimeout:On,disableXhrSync:On,alwaysUseXhrOverride:!1,maxEventRetryAttempts:{isVal:ba,v:tj},maxUnloadEventRetryAttempts:{isVal:ba,v:nj},addNoResponse:On,excludeCsMetaData:On});function Yce(t){return t&&t.sendPOST}var Qce=function(t){gp(e,t);function e(){var n=t.call(this)||this;n.identifier="PostChannel",n.priority=1011,n.version="4.3.3";var r,o=!1,i=[],s,a=!1,c=0,u,h=0,p,f={},g=Cm,v,y,b,C,S,E,I,T,_,w,A,M,R,$,V,ie,N,Y,ue,j,U,te;return gn(e,n,function(Q,re){J(),Q._getDbgPlgTargets=function(){return[S,r]},Q[af]=function(k,G,ee){zr(G,function(){return"PostChannel:initialize"},function(){re[af](k,G,ee),ue=G.getNotifyMgr();try{V=Cp(Dd(Q[Im]),G.evtNamespace&&G.evtNamespace()),Q._addHook(vr(k,function(Ce){var De=Ce.cfg,Qe=Vc(null,De,G);r=Qe.getExtCfg(Q[Im],Wce),ie=Uv(r[V6],r[$6]),A=!r[Cce]&&$se(),N=r[Sce],_e(G),p=r[x2],u=r.immediateEventLimit,I=r[R2],R=r.maxEventRetryAttempts,$=r.maxUnloadEventRetryAttempts,Y=r[Ece],od(De.endpointUrl)?Q.pause():a&&Q[rg](),Be(),U=r[Ice],te=!!r[Tce],j&&Z();var rt=De.disablePageUnloadEvents||[];j=Rse(Ne,rt,V),j=I6(Ne,rt,V)||j,j=T6(we,De.disablePageShowEvents,V)||j})),S[af](k,Q.core,Q)}catch(Ce){throw Q.setInitialized(!1),Ce}},function(){return{theConfig:k,core:G,extensions:ee}})},Q.processTelemetry=function(k,G){rE(k,Q[Im]),G=G||Q._getTelCtx(G);var ee=k;!te&&!o&&(U&&(ee[Li]=U),de(ee,!0),M?ce(2,2):P()),Q.processNext(ee,G)},Q.getOfflineSupport=function(){try{var k=S&&S[K6]();if(S)return{getUrl:function(){return k?k.url:null},serialize:Se,batch:ye,shouldProcess:function(G){return!te},createPayload:function(G){return null},createOneDSPayload:function(G){if(S[vE])return S[vE](G,A)}}}catch{}return null},Q._doTeardown=function(k,G){ce(2,2),o=!0,S.teardown(),Z(),J()};function Z(){Nse(null,V),Pse(null,V),Mse(null,V)}function _e(k){var G=k[jv];k[jv]=function(){var ee=0;return N&&(ee=ee|2),ee|G.call(k)}}function ye(k){var G=D2;return k&&k[Et]&&tt(k,function(ee){G&&(G+=`
`),G+=ee}),G}function Se(k){var G=D2;try{Ke(k),G=S[G6](k)}catch{}return G}function Ne(k){var G=k||Ra().event;G.type!=="beforeunload"&&(M=!0,S[CE](M)),ce(2,2)}function we(k){M=!1,S[CE](M)}function Ke(k){k.ext&&k.ext[b2]&&delete k.ext[b2],k.ext&&k.ext[US]&&k.ext[US].id&&delete k.ext[US].id,A&&(k.ext=nu(k.ext),k[GS]&&(k[GS]=nu(k[GS])),k[og]&&(k[og]=nu(k[og])))}function de(k,G){if(k[Tm]||(k[Tm]=0),k[Ha]||(k[Ha]=1),Ke(k),k[Ul]){if(b||a)k[Ha]=3,k[Ul]=!1;else if(S){A&&(k=nu(k)),S[W6](zf.create(k[Li],[k]),k[Ul]===!0?1:k[Ul],3);return}}var ee=k[Ha],Ce=h,De=p;ee===4&&(Ce=c,De=u);var Qe=!1;if(Ce<De)Qe=!pe(k,G);else{var rt=1,lt=Gce;ee===4&&(rt=4,lt=1),Qe=!0,He(k[Li],k[Ha],rt,lt)&&(Qe=!pe(k,G))}Qe&&kn(Va,[k],Ua.QueueFull)}Q.setEventQueueLimits=function(k,G){r[x2]=p=of(k)?k:IE,r[R2]=I=of(G)?G:0,Be();var ee=h>k;if(!ee&&T>0)for(var Ce=1;!ee&&Ce<=3;Ce++){var De=E[Ce];De&&De[Hr]&&tt(De[Hr],function(Qe){Qe&&Qe[zn]()>=T&&(ee=!0)})}K(!0,ee)},Q.pause=function(){O(),a=!0,S&&S.pause()},Q[rg]=function(){a=!1,S&&S[rg](),P()},Q._loadTransmitProfiles=function(k){St(),sn(k,function(G,ee){var Ce=ee[Et];if(Ce>=2){var De=Ce>2?ee[2]:0;if(ee[cy](0,Ce-2),ee[1]<0&&(ee[0]=-1),ee[1]>0&&ee[0]>0){var Qe=ee[0]/ee[1];ee[0]=Math.ceil(Qe)*ee[1]}De>=0&&ee[1]>=0&&De>ee[1]&&(De=ee[1]),ee[Ir](De),f[G]=ee}})},Q.flush=function(k,G,ee){k===void 0&&(k=!0);var Ce;if(!a)if(ee=ee||1,k)G||(Ce=zc(function(Qe){G=Qe})),s==null?(O(),ut(1,0,ee),s=Te(function(){s=null,Le(G,ee)},0)):i[Ir](G);else{var De=O();ge(1,1,ee),G&&G(),De&&P()}return Ce},Q.setMsaAuthTicket=function(k){S[bE](hE,k)},Q.setAuthPluginHeader=function(k){S[bE](g2,k)},Q.removeAuthPluginHeader=function(){S.removeHeader(g2)},Q.hasEvents=$e,Q._setTransmitProfile=function(k){g!==k&&f[k]!==void 0&&(O(),g=k,P())},D4(Q,function(){return S},["addResponseHandler"]);function ge(k,G,ee){var Ce=ut(k,G,ee);return S[Dv](G,ee),Ce}function $e(){return h>0}function P(){if(_>=0&&ut(_,0,w)&&S[Dv](0,w),c>0&&!y&&!a){var k=f[g][2];k>=0&&(y=Te(function(){y=null,ge(4,0,1),P()},k))}var G=f[g][1];!v&&!s&&G>=0&&!a&&($e()?v=Te(function(){v=null,ge(C===0?3:1,0,1),C++,C%=2,P()},G):C=0)}Q[Q6]=function(){b<Kce&&(b++,O(),P())},Q._clearBackOff=function(){b&&(b=0,O(),P())};function J(){r=null,o=!1,i=[],s=null,a=!1,c=0,u=500,h=0,p=IE,f={},g=Cm,v=null,y=null,b=0,C=0,E={},I=0,j=!1,T=0,_=-1,w=null,A=!0,M=!1,R=tj,$=nj,V=null,U=null,te=!1,ie=Uv(),S=new Vce(O2,L2,qce,{requeue:Gt,send:me,sent:ve,drop:je,rspFail:Ve,oth:ct}),Ut(),se(),Be()}function Te(k,G){G===0&&b&&(G=1);var ee=1e3;return b&&(ee=Z6(b-1)),ie.set(k,G*ee)}function O(){return v!==null?(v.cancel(),v=null,C=0,!0):!1}function ce(k,G){O(),s&&(s.cancel(),s=null),a||ge(1,k,G)}function se(){E[4]={batches:[],iKeyMap:{}},E[3]={batches:[],iKeyMap:{}},E[2]={batches:[],iKeyMap:{}},E[1]={batches:[],iKeyMap:{}}}function ne(k,G,ee){var Ce=E[G];Ce||(G=1,Ce=E[G]);var De=Ce.iKeyMap[k];return!De&&ee&&(De=zf.create(k),Ce.batches[Ir](De),Ce.iKeyMap[k]=De),De}function K(k,G){S[yE]()&&!b&&(I>0&&h>I&&(G=!0),G&&s==null&&Q.flush(k,function(){},20))}function pe(k,G){A&&(k=nu(k));var ee=k[Ha],Ce=ne(k[Li],ee,!0);return Ce.addEvent(k)?(ee!==4?(h++,G&&k[Tm]===0&&K(!k.sync,T>0&&Ce[zn]()>=T)):c++,!0):!1}function He(k,G,ee,Ce){for(;ee<=G;){var De=ne(k,G,!0);if(De&&De[zn]()>0){var Qe=De[Ru](0,Ce),rt=Qe[zn]();if(rt>0)return ee===4?c-=rt:h-=rt,F(Va,[Qe],Ua.QueueFull),!0}ee++}return at(),!1}function at(){for(var k=0,G=0,ee=function(De){var Qe=E[De];Qe&&Qe[Hr]&&tt(Qe[Hr],function(rt){De===4?k+=rt[zn]():G+=rt[zn]()})},Ce=1;Ce<=4;Ce++)ee(Ce);h=G,c=k}function ut(k,G,ee){var Ce=!1,De=G===0;return!De||S[yE]()?zr(Q.core,function(){return"PostChannel._queueBatches"},function(){for(var Qe=[],rt=4;rt>=k;){var lt=E[rt];lt&&lt.batches&&lt.batches[Et]>0&&(tt(lt[Hr],function(yt){S.addBatch(yt)?Ce=Ce||yt&&yt[zn]()>0:Qe=Qe[Sc](yt[uc]()),rt===4?c-=yt[zn]():h-=yt[zn]()}),lt[Hr]=[],lt.iKeyMap={}),rt--}Qe[Et]>0&&kn(Va,Qe,Ua.KillSwitch),Ce&&_>=k&&(_=-1,w=0)},function(){return{latency:k,sendType:G,sendReason:ee}},!De):(_=_>=0?Math.min(_,k):k,w=Math.max(w,ee)),Ce}function Le(k,G){ge(1,0,G),at(),Xe(function(){k&&k(),i[Et]>0?s=Te(function(){s=null,Le(i.shift(),G)},0):(s=null,P())})}function Xe(k){S[q6]()?k():s=Te(function(){s=null,Xe(k)},$ce)}function St(){O(),Ut(),g=Cm,P()}function Ut(){f={},f[Cm]=[2,1,0],f[rce]=[6,3,0],f[oce]=[18,9,0]}function Gt(k,G){var ee=[],Ce=R;M&&(Ce=$),tt(k,function(De){De&&De[zn]()>0&&tt(De[uc](),function(Qe){Qe&&(Qe[Ul]&&(Qe[Ha]=4,Qe[Ul]=!1),Qe[Tm]<Ce?(rE(Qe,Q[Im]),de(Qe,!1)):ee[Ir](Qe))})}),ee[Et]>0&&kn(Va,ee,Ua.NonRetryableStatus),M&&ce(2,2)}function Kt(k,G){var ee=ue||{},Ce=ee[k];if(Ce)try{Ce.apply(ee,G)}catch(De){rn(Q.diagLog(),1,74,k+" notification failed: "+De)}}function kn(k,G){for(var ee=[],Ce=2;Ce<arguments.length;Ce++)ee[Ce-2]=arguments[Ce];G&&G[Et]>0&&Kt(k,[G][Sc](ee))}function F(k,G){for(var ee=[],Ce=2;Ce<arguments.length;Ce++)ee[Ce-2]=arguments[Ce];G&&G[Et]>0&&tt(G,function(De){De&&De[zn]()>0&&Kt(k,[De.events()][Sc](ee))})}function me(k,G,ee){k&&k[Et]>0&&Kt("eventsSendRequest",[G>=1e3&&G<=1999?G-1e3:0,ee!==!0])}function ve(k,G){F("eventsSent",k,G),P()}function je(k,G){F(Va,k,G>=8e3&&G<=8999?G-8e3:Ua.Unknown)}function Ve(k){F(Va,k,Ua.NonRetryableStatus),P()}function ct(k,G){F(Va,k,Ua.Unknown),P()}function Be(){Y?T=0:T=Math.max(O2*(L2+1),p/6)}}),n}return e.__ieDyn=1,e}(ew),Jce=Md({cookieCfg:{ref:!0,v:{}},extensions:{rdOnly:!0,ref:!0,v:[]},channels:{rdOnly:!0,ref:!0,v:[]},extensionConfig:{ref:!0,v:{}}}),rj=function(t){gp(e,t);function e(){var n=t.call(this)||this,r,o;return gn(e,n,function(i,s){i.initialize=function(a,c){var u=n;zr(n,function(){return"ApplicationInsights:initialize"},function(){a=mo(a,Jce,u.logger,!1).cfg,r=new Qce,o=new nce;var h=[o];c&&(h=h.concat(c)),a||_o("You must provide a config object!");var p=a.channels;if(p&&p.length>0){for(var f=!1,g=0;g<p[0].length;g++)if(p[0][g].identifier===r.identifier){f=!0;break}f||ia(p[0],r)}else a.channels.push([r]);var v=a.extensionConfig;v[r.identifier]=v[r.identifier]||a&&a.channelConfiguration||{},v[o.identifier]=v[o.identifier]||a&&a.propertyConfiguration||{};try{s.initialize(a,h),u.isInitialized()&&u4(a,{channelConfiguration:{g:function(){return a.extensionConfig[r.identifier]}},propertyConfiguration:{g:function(){return a.extensionConfig[o.identifier]}}})}catch(y){rn(u.logger,1,514,"Failed to initialize SDK."+jt(y))}},function(){return{config:a,extensions:c}})},i.getPropertyManager=function(){return o},i.getPostChannel=function(){return r}}),n}return e.__ieDyn=1,e}(qse);/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const oj="msal.request";function ig(t){var e;try{return new ov(((e=t.cache)==null?void 0:e.temporaryCacheLocation)||wn.SessionStorage)}catch{return new rv}}function TE(t){return`${oj}.${t}`}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const Zce="faab4ead691e451eb230afc98a28e0f2-698cf73d-7930-426b-87d8-d36936f6912f-7401",Xce="https://eu-mobile.events.data.microsoft.com/OneCollector/1.0/",j2=`${oj}.mats-telemetry-profile-id`;class ele{constructor(e,n,r,o){this.logger=e,this.appName=r,this.appVersion=o,this.eventsToEmit=new Set(n),this.sessionId=No();const i={instrumentationKey:Zce,endpointUrl:Xce,extensions:[],propertyConfiguration:{gpcDataSharingOptIn:!1},disableCookiesUsage:!0};this.appInsightsMATS=new rj,this.appInsightsMATS.initialize(i,[]),this.logger.verbose("MATSTelemetryReporter: Initialized");try{const s=new ov(wn.LocalStorage),a=s.getItem(j2);if(a!=null&&a.length)this.profileTelemetryId=a;else{const c=No();this.profileTelemetryId=c,s.setItem(j2,c)}}catch{e.warning("MATSTelemetryReporter: local storage is not available"),this.profileTelemetryId=""}}sendCustomEvent(e){if(!this.eventsToEmit.has(e.name)){this.logger.verbose(`MATSTelemetryReporter: Skipping telemetry for ${e.name}`,e.correlationId);return}const n={...e,appName:this.appName,appVersion:this.appVersion,libraryName:"MSAL-JS",profileTelemetryId:this.profileTelemetryId,sessionId:this.sessionId};delete n.context,delete n.errorStack;const r={name:"actionmsaljs".concat(e.name.toLowerCase()||""),data:n};this.logger.verbose(`MATSTelemetryReporter: Sending ${r.name} for tracking`),this.appInsightsMATS.track(r),e.name===It.AcquireTokenPreRedirect&&this.appInsightsMATS.flush()}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const tle="d634483c08244c1ca09af2b2d952c92e-ab2bba03-2ba3-49d8-a82c-ef6da750d8ab-7725";function nle(t){return Math.random()<=t}class rle{constructor(e,n,r){this.synthetic=!1,this.redactionRatio=.1,this.logger=e,this.eventsToEmit=new Set(n);const o={instrumentationKey:tle,extensions:[],propertyConfiguration:{gpcDataSharingOptIn:!1},disableCookiesUsage:!0};this.appInsights=new rj,this.appInsights.initialize(o,[]),this.synthetic=r||!1,this.logger.verbose("PerformanceTelemetryReporter: Initialized")}sendCustomEvent(e){if(!this.eventsToEmit.has(e.name)){this.logger.verbose(`PerformanceTelemetryReporter: Skipping telemetry for ${e.name}`,e.correlationId);return}let n;!e.success||nle(this.redactionRatio)?(n={...e,appName:void 0,synthetic:this.synthetic},this.logger.verbose(`PerformanceTelemetryReporter: Sending ${n.name} for tracking`)):(n={name:e.name,eventId:e.eventId,correlationId:e.correlationId,requestId:e.requestId,success:e.success,status:e.status,fromCache:e.fromCache,startPageVisibility:e.startPageVisibility,endPageVisibility:e.endPageVisibility,authority:e.authority,durationMs:e.durationMs,startTimeMs:e.startTimeMs,clientId:e.clientId,libraryName:e.libraryName,libraryVersion:e.libraryVersion,accountType:e.accountType,synthetic:this.synthetic,isBroker:e.isBroker,isBackground:e.isBackground},this.logger.verbose(`PerformanceTelemetryReporter: Sending redacted ${n.name} for tracking`));const r={name:e.name,data:n};this.appInsights.track(r),e.name===It.AcquireTokenPreRedirect&&this.appInsights.flush()}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const Am=new Set([It.AcquireTokenSilent,It.AcquireTokenByCode,It.AcquireTokenPopup,It.AcquireTokenRedirect,It.AcquireTokenPreRedirect,It.PairwiseBrokerApplicationInitializeBrokering,It.SsoSilent,It.EmbeddedClientApplicationSendSSOSilentRequest,It.EmbeddedClientApplicationSendPopupRequest,It.EmbeddedClientApplicationSendRedirectRequest,It.EmbeddedClientApplicationHandleRedirectRequest,It.EmbeddedClientApplicationSendSilentRefreshRequest]);class ole{constructor(e,n){var o;this.logger=e;const r=((o=n==null?void 0:n.eventsToEmit)==null?void 0:o.filter(i=>Am==null?void 0:Am.has(i)))||[...Am];this.matsTelemetryReporter=n!=null&&n.enableMATS?new ele(e,r,n==null?void 0:n.appName,n==null?void 0:n.appVersion):null,this.perfTelemetryReporter=new rle(e,r,n==null?void 0:n.synthetic)}sendCustomEvent(e){var n;this.perfTelemetryReporter.sendCustomEvent(e),(n=this.matsTelemetryReporter)==null||n.sendCustomEvent(e)}getTelemetryCallback(){this.logger.trace("TelemetryReporter: Attaching callback to send custom metrics.");const e=n=>{n.forEach(r=>{r.name===It.AcquireTokenByBroker&&(r.name=r.brokerEventName||r.name,r.isBroker=!0,delete r.brokerEventName,this.logger.verbosePii(`TelemetryReporter: Updated broker event ${JSON.stringify(r)}`,r.correlationId)),this.sendCustomEvent(r)})};return this.logger.verbose("TelemetryReporter: Returning callback as telemetry emitted."),e}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const ile=[Nf.AzurePublic,Nf.AzurePpe];function sle(t){return t.auth.authority?ile.some(e=>{var n;return((n=t.auth.authority)==null?void 0:n.indexOf(e.toString()))===0}):!0}class Sp extends pre{constructor(e,n){var i;let r;const o=typeof window<"u";if(!(n!=null&&n.disabled)&&sle(e)&&o?(r=((i=e.telemetry)==null?void 0:i.client)||new gre(e,new Set(bre),new Map(vre)),super({...e,telemetry:{...e.telemetry,client:r}})):(super(e),r=new h3),this.performanceClient=r,o){const s=new ole(this.getLogger(),n);this.addPerformanceCallback(s.getTelemetryCallback())}}static async createPublicClientApplication(e,n,r){const o=new Sp(e,n);return await o.initialize({correlationId:r}),o}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const Lt={BROKER_READY:"BrokerReady",HANDSHAKE_REQUEST:"BrokerHandshakeRequest",HANDSHAKE_RESPONSE:"BrokerHandshakeResponse",AUTH_REQUEST:"BrokerAuthRequest",REDIRECT_RESPONSE:"BrokerRedirectResponse",HANDLE_REDIRECT_REQUEST:"BrokerHandleRedirectRequest",AUTH_RESULT:"BrokerAuthResult",EMBEDDED_LOGOUT_REQUEST:"EmbeddedLogoutRequest",EMBEDDED_LOGOUT_RESPONSE:"EmbeddedLogoutResponse"},cs={BROKER_AUTH_ERROR_NAME:"BrokerAuthError",INTERACTION_REQ_ERROR_NAME:"InteractionRequiredAuthError",SERVER_ERROR_NAME:"ServerError",CLIENT_AUTH_ERR_NAME:"ClientAuthError",CLIENT_CONFIG_ERROR_NAME:"ClientConfigurationError",BROWSER_AUTH_ERROR_NAME:"BrowserAuthError",BROWSER_CONFIG_ERROR_NAME:"BrowserConfigurationError",AUTH_ERROR_NAME:"AuthError"},ale=2e3,cle=6e3,lle=3e5;/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class hi{constructor(e){this.messageType=e}static validateMessage(e){if(e.data&&e.data.messageType)switch(e.data.messageType){case Lt.HANDSHAKE_REQUEST:case Lt.HANDSHAKE_RESPONSE:case Lt.HANDLE_REDIRECT_REQUEST:case Lt.AUTH_REQUEST:case Lt.AUTH_RESULT:case Lt.REDIRECT_RESPONSE:case Lt.EMBEDDED_LOGOUT_REQUEST:return e;default:return null}else return null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class ly extends hi{constructor(e,n,r=!1,o){super(Lt.HANDSHAKE_REQUEST),this.embeddedClientId=e,this.version=n,this.allowTelemetry=r,this.nonce=o}static validate(e){return e.data&&e.data.messageType===Lt.HANDSHAKE_REQUEST&&e.data.embeddedClientId&&e.data.version?new ly(e.data.embeddedClientId,e.data.version,e.data.allowTelemetry,e.data.nonce):null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class uy extends hi{constructor(e,n,r){super(Lt.HANDSHAKE_RESPONSE),this.version=e,this.brokerOrigin=n,this.nonce=r}static validate(e,n){if(!n.includes(e.origin))return null;const r=hi.validateMessage(e);return r&&r.data.messageType===Lt.HANDSHAKE_RESPONSE&&r.data.version?new uy(r.data.version,r.origin,r.data.nonce):null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class dy extends hi{get embeddedAppOrigin(){return this._embeddedAppOrigin}constructor(e,n,r,o){super(Lt.AUTH_REQUEST),this.embeddedClientId=e,this._embeddedAppOrigin=o,this.interactionType=n,this.request=r}static validate(e,n){return e.data&&e.data.messageType===Lt.AUTH_REQUEST&&e.data.embeddedClientId&&e.data.interactionType&&e.data.request?new dy(e.data.embeddedClientId,e.data.interactionType,e.data.request,n):null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class hy extends hi{constructor(){super(Lt.REDIRECT_RESPONSE)}static validate(e){return e.data&&e.data.messageType===Lt.REDIRECT_RESPONSE?new hy:null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const Qn={noEmbeddedAppError:{code:"no_embedded_app",desc:"The embedded application object was not created. Please ensure you have configured your application correctly for an embedded application: https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/broker-v2/lib/msal-browser/docs/broker.md#brokered-application-configuration"},brokerResponseInvalidError:{code:"broker_response_invalid",desc:"The broker response did not have the expected values."},brokeredPopupRequestRedirecting:{code:"broker_popup_will_redirect",desc:"The request for a brokered popup requires a redirect by the broker. If your app does not perform the redirect, please check the broker's logs."},brokerTimeoutError:{code:"broker_timeout",desc:"Message broker timed out."},brokerHandshakeTimeoutError:{code:"broker_handshake_timeout",desc:"Broker handshake response timed out."},brokerHandshakeFailed:{code:"broker_handshake_failed",desc:"Broker handshake failed. Please see logs for details."},noTrustedBrokersProvided:{code:"no_trusted_brokers_provided",desc:"No trusted brokers provided."},brokeringDisabledError:{code:"brokering_disabled",desc:"Brokering is not enabled for the client application. Please check logs to see if handshake was performed."},shrGenerationError:{code:"shr_generation_error",desc:"Error generating SHRs. Kid is missing in the request."}};class hn extends _t{constructor(e,n){super(e,n),Object.setPrototypeOf(this,hn.prototype),this.name=cs.BROKER_AUTH_ERROR_NAME}static createNoEmbeddedAppError(){return new hn(Qn.noEmbeddedAppError.code,Qn.noEmbeddedAppError.desc)}static createBrokerResponseInvalidError(){return new hn(Qn.brokerResponseInvalidError.code,`${Qn.brokerResponseInvalidError.desc}`)}static createBrokerPopupRequestRedirectingError(){return new hn(Qn.brokeredPopupRequestRedirecting.code,Qn.brokeredPopupRequestRedirecting.desc)}static createNoTrustedBrokersProvidedError(){return new hn(Qn.noTrustedBrokersProvided.code,Qn.noTrustedBrokersProvided.desc)}static createBrokeringDisabledError(){return new hn(Qn.brokeringDisabledError.code,`${Qn.brokeringDisabledError.desc}`)}static createMessageBrokerTimeoutError(){return new hn(Qn.brokerTimeoutError.code,Qn.brokerTimeoutError.desc)}static createMessageBrokerHandshakeTimeoutError(){return new hn(Qn.brokerHandshakeTimeoutError.code,Qn.brokerHandshakeTimeoutError.desc)}static createBrokerHandshakeFailedError(){return new hn(Qn.brokerHandshakeFailed.code,Qn.brokerHandshakeFailed.desc)}static createShrGenerationError(){return new hn(Qn.shrGenerationError.code,Qn.shrGenerationError.desc)}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class Ao extends hi{constructor(e,n,r){if(super(Lt.AUTH_RESULT),this.interactionType=e,this.result=n,r){const{setCorrelationId:o,...i}=r;this.errorPayload=i}}static validate(e){return e.data&&e.data.messageType===Lt.AUTH_RESULT&&e.data.interactionType&&(e.data.result||e.data.errorPayload)?new Ao(e.data.interactionType,e.data.result,e.data.errorPayload):null}static detectError(e){let n;switch(e.name){case cs.INTERACTION_REQ_ERROR_NAME:n=new Rr(e.errorCode,e.errorMessage,e.subError);break;case cs.SERVER_ERROR_NAME:n=new qi(e.errorCode,e.errorMessage,e.subError);break;case cs.CLIENT_AUTH_ERR_NAME:n=new Rd(e.errorCode,e.errorMessage);break;case cs.CLIENT_CONFIG_ERROR_NAME:n=new Hb(e.errorCode);break;case cs.BROWSER_AUTH_ERROR_NAME:n=new Nd(e.errorCode);break;case cs.BROWSER_CONFIG_ERROR_NAME:n=new qb(e.errorCode,e.errorMessage);break;case cs.BROKER_AUTH_ERROR_NAME:n=new hn(e.errorCode,e.errorMessage);break;case cs.AUTH_ERROR_NAME:n=new _t(e.errorCode,e.errorMessage,e.subError);break;default:n=new _t(Nb,JSON.stringify(e));break}return n.setCorrelationId(e.correlationId),n}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class fy extends hi{constructor(e,n){super(Lt.HANDLE_REDIRECT_REQUEST),this.embeddedClientId=e,this.version=n}static validate(e){return e.data&&e.data.messageType===Lt.HANDLE_REDIRECT_REQUEST&&e.data.embeddedClientId&&e.data.version?new fy(e.data.embeddedClientId,e.data.version):null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */function ij(t){return{...{preferredInteractionType:null,brokerRedirectParams:{},actAsBroker:!1,allowBrokering:!1,trustedBrokerDomains:[],brokerHandshakeTimeout:(t==null?void 0:t.brokerHandshakeTimeout)||ale,brokerMessageTimeout:(t==null?void 0:t.brokerMessageTimeout)||cle,brokerInteractionTimeout:(t==null?void 0:t.brokerInteractionTimeout)||lle},...t}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class py extends hi{constructor(e,n){super(Lt.EMBEDDED_LOGOUT_REQUEST),this.version=e,this.correlationId=n}static validate(e){const n=hi.validateMessage(e);return n&&n.data&&n.data.version?new py(n.data.version,n.data.correlationId):null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */function ule(t,e){const n={userState:e,brokerState:{requestOrigin:t.embeddedAppOrigin,requestClientId:t.embeddedClientId}},r=JSON.stringify(n),o=new TextEncoder().encode(r);return window.btoa(Array.from(o,i=>String.fromCodePoint(i)).join(""))}function dle(t){if(!t)return null;try{const e=window.atob(t),n=new Uint8Array(e.length);for(let i=0;i<n.length;i++)n[i]=e.charCodeAt(i);const r=new TextDecoder().decode(n),o=JSON.parse(r);return o.hasOwnProperty("brokerState")?o:null}catch{return null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const hle="@azure/msal-browser-1p",Nu="3.26.0";/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */function sj(t){const e=t.split("-",1)[0].split(".",3);return{major:parseInt(e[0]),minor:parseInt(e[1]),patch:parseInt(e[2])}}function Bl(t){t.port1.close(),t.port2.close()}function aj(t,e,n,r=20){if(t.length===0||n>r)return[0,n-1];let o=n,i=t.length;for(let s=0;s<t.length;s++){t[s].postMessage(e,"*");const[a,c]=aj(t[s],e,n+1,r);i+=a,c>o&&(o=c)}return[i,o]}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class fle extends Sp{constructor(e,n,r){var o;super(e),this.currentBrokerRedirectResponse=void 0,this.hybridAuthPromise=void 0,this.pwbBrokerAppConfiguration=ij(n),this.redirectResponseMap=new Map,this.embeddedAppConfigMap=new Map,this.telemetryAllowedEmbeddedClients=new Set,this.logger=new di(((o=e.system)==null?void 0:o.loggerOptions)||{},hle,Nu),this.eventHandler=r,this.messageListener=this.handleBrokerMessage.bind(this)}getRedirectCorrelationId(){const e=`msal.${this.getConfiguration().auth.clientId}`,n=ig(this.getConfiguration()).getItem(`${e}.request.native`);try{if(n){const r=JSON.parse(n);return r&&typeof r=="object"?r.correlationId:null}}catch{this.logger.error("BrokerClientApplication.getRedirectCorrelationId: Unable to parse native request")}return ig(this.getConfiguration()).getItem(`${e}.request.correlationId`)||""}async handleRedirectPromise(e){const n=this.getRedirectCorrelationId(),r=this.performanceClient.startMeasurement(It.AcquireTokenByBroker,n);r.add({brokerEventName:It.AcquireTokenRedirect});try{const o=super.handleRedirectPromise(e);this.currentBrokerRedirectResponse=o;const i=await this.currentBrokerRedirectResponse;if(this.currentBrokerRedirectResponse=void 0,i){const s=dle(i.state);if(this.setActiveAccount(i.account),s){const a={...i,state:s.userState};this.redirectResponseMap.set(s.brokerState.requestOrigin,a),r.add({embeddedClientId:s.brokerState.requestClientId,embeddedRedirectUri:s.brokerState.requestOrigin}),this.endBrokerPerformanceEvent(s.brokerState.requestClientId,r)}else return r.end({success:!0}),i}else r.discard();return null}catch(o){throw o instanceof _t&&o.setCorrelationId(n),r.end({success:!1},o),o}}async listenForBrokerMessage(e,n){return this.logger.verbose("listening for child broker messages."),window.addEventListener("message",this.messageListener),this.broadcastBrokerReadyMessage(window.frames,e,n),e&&e.codeRequest&&(this.hybridAuthPromise=this.acquireTokenByCode(e.codeRequest)),this.hybridAuthPromise}broadcastBrokerReadyMessage(e,n,r){this.logger.trace("Broadcasting broker ready message to child frames.");const o={messageType:Lt.BROKER_READY};window.postMessage(o,"*");const[i,s]=aj(e,o,1,n==null?void 0:n.maxChildFrameDepth);r==null||r.add({maxFrameDepthReached:s,framesNotified:i,maxFrameDepthConfigured:n==null?void 0:n.maxChildFrameDepth}),this.logger.trace(`Broadcasted broker ready message to ${i} child frames with a max depth of ${s}`)}stopListeningForBrokerMessage(){this.logger.verbose("stop listening for child broker messages."),window.removeEventListener("message",this.messageListener),this.embeddedAppConfigMap.forEach(([e,n])=>{this.logger.verbose(`closing message port for ${e}`),n.close()}),this.embeddedAppConfigMap.clear()}async handleBrokerMessage(e){var r,o;const n=hi.validateMessage(e);if(!(!n||!n.data.messageType))switch(this.logger.verbose(`Broker received message with type: ${n.data.messageType}`),n.data.messageType){case Lt.HANDSHAKE_REQUEST:return this.handleBrokerHandshake(n);case Lt.HANDLE_REDIRECT_REQUEST:const i=fy.validate(n);return i?this.handleBrokerRedirectResponse(i,n):void 0;case Lt.AUTH_REQUEST:const s=dy.validate(n,((r=this.embeddedAppConfigMap.get(n.data.embeddedClientId))==null?void 0:r[0])||n.origin);if(!s)return;s.request.correlationId||(s.request.correlationId=No());const a=this.performanceClient.startMeasurement(It.AcquireTokenByBroker,s.request.correlationId),c=(o=n.ports)==null?void 0:o[0];try{await this.handleBrokerAuthRequest(s,c),this.endBrokerPerformanceEvent(s.embeddedClientId,a);return}catch(u){throw this.endBrokerPerformanceEvent(s.embeddedClientId,a,u),u}default:return}}isDescendantFrame(e){const n=[];for(n.push(e.sourceFrame);n.length>0;){const r=n.pop();if(r)for(let o=0;o<r.frames.length;o++){const i=r.frames[o];if(i===e.targetFrame)return!0;i!==r&&n.push(i)}}return!1}async handleBrokerHandshake(e){var s,a;if(!(e.source&&e.source.window&&e.source.window===e.source)){this.logger.warning("Broker handshake request validation failed. Message origin is not an iframe");return}const n=e.source;window!==n&&!this.isDescendantFrame({sourceFrame:window,targetFrame:n})&&this.logger.warning("Broker handshake request validation failed. Message origin is not a descendant iframe");const r=ly.validate(e);if(!r){this.logger.warning("Broker handshake request validation failed. Message may not have come from MSAL.js.");return}const o=No(),i=this.performanceClient.startMeasurement(It.BrokerClientApplicationHandleBrokerHandshake,o);try{if(i.add({embeddedClientId:r.embeddedClientId}),r.allowTelemetry&&this.telemetryAllowedEmbeddedClients.add(r.embeddedClientId),this.logger.verbose(`${r.messageType} validated for AppId: ${r.embeddedClientId}`),this.hybridAuthPromise)try{await this.hybridAuthPromise}catch(p){this.logger.error(`Broker could not obtain tokens using authorization code initializer: ${p}`)}const c=new uy(Nu,"",e.data.nonce);this.logger.verbose(`Sending handshake response to ${e.origin}`);const u=(s=e.ports)==null?void 0:s[0];u&&(u.onmessage=this.messageListener,this.embeddedAppConfigMap.set(e.data.embeddedClientId,[e.origin,u]));const h=sj(e.data.version);u&&h.major===3&&h.minor>=15&&h.minor<=19?u==null||u.postMessage(c):(a=e.source)==null||a.postMessage(c,e.origin)}catch(c){throw this.endBrokerPerformanceEvent(r.embeddedClientId,i,c),c}}async handleBrokerRedirectResponse(e,n){var r;if(e){const o=this.embeddedAppConfigMap.get(e.embeddedClientId);let i,s;o?[s,i]=o:(s=n.origin,i=(r=n.ports)==null?void 0:r[0]),this.currentBrokerRedirectResponse&&await this.currentBrokerRedirectResponse;const a=this.redirectResponseMap.get(s),c=new Ao(Ae.Redirect,a||null);this.logger.verbose("Sending auth response"),i==null||i.postMessage(c);const u=`msal.${this.getConfiguration().auth.clientId}`;ig(this.getConfiguration()).removeItem(`${u}.request.native`);return}}async handleBrokerAuthRequest(e,n){this.currentBrokerRedirectResponse&&await this.currentBrokerRedirectResponse,e.request.correlationId||(e.request.correlationId=No());const r=e.request.correlationId,o=e.request.account||this.getActiveAccount();let i;switch(e.interactionType){case Ae.Silent:if(o){this.performanceClient.addFields({brokerEventName:It.AcquireTokenSilent},r),i=this.brokeredSilentRequest(e,o,n);break}this.performanceClient.addFields({brokerEventName:It.SsoSilent},r),i=this.brokeredSsoSilentRequest(e,n);break;case Ae.Redirect:case Ae.Popup:default:const s=this.getInteractionType(e.interactionType);this.performanceClient.addFields({brokerEventName:s===Ae.Redirect?It.AcquireTokenRedirect:It.AcquireTokenPopup},r),i=this.interactiveBrokerRequest(s,e,n);break}return i}getInteractionType(e){const n=this.pwbBrokerAppConfiguration.preferredInteractionType;return n||e}async interactiveBrokerRequest(e,n,r){switch(e){case Ae.Redirect:return this.brokeredRedirectRequest(n,r);case Ae.Popup:return this.brokeredPopupRequest(n,r);case Ae.Silent:this.logger.error("Invalid code path. interactiveBrokerRequest() should only be called for interactive requests.");return;case Ae.None:this.logger.error("Broker is blocking interactive requests. Please attempt a silent request or sign into the broker first.");return;default:this.logger.error("Invalid code path. interactiveBrokerRequest() should only be called for interactive requests.");return}}async brokeredRedirectRequest(e,n){var i;this.logger.verbose("Brokered redirect request initiated.");const r=this.getAllAccounts();this.eventHandler.emitEvent(r.length===0?ae.LOGIN_START:ae.ACQUIRE_TOKEN_START,Ae.Redirect,e.request);const o=((i=this.embeddedAppConfigMap.get(e.embeddedClientId))==null?void 0:i[1])||n;try{const s=new hy;o==null||o.postMessage(s),this.logger.verbose(`Sending redirect response: ${s}`);const a=this.addBrokerRequestProperties(e);return a.state=ule(e,a.state),await super.acquireTokenRedirect(a)}catch(s){const a=new Ao(Ae.Redirect,null,s);this.logger.verbose(`Found auth error in redirect: ${s}`),o==null||o.postMessage(a),this.eventHandler.emitEvent(r.length===0?ae.LOGIN_FAILURE:ae.ACQUIRE_TOKEN_FAILURE,Ae.Redirect,null,s)}}async brokeredPopupRequest(e,n){var i;this.logger.verbose("Brokered popup request initiated.");const r=this.getAllAccounts();this.eventHandler.emitEvent(r.length===0?ae.LOGIN_START:ae.ACQUIRE_TOKEN_START,Ae.Popup,e.request);const o=((i=this.embeddedAppConfigMap.get(e.embeddedClientId))==null?void 0:i[1])||n;try{const s=this.addBrokerRequestProperties(e),a=await super.acquireTokenPopup(s),c=new Ao(Ae.Popup,a);this.logger.verbosePii("Sending auth response"),o==null||o.postMessage(c);const u=r.length<this.getAllAccounts().length;this.eventHandler.emitEvent(u?ae.LOGIN_SUCCESS:ae.ACQUIRE_TOKEN_SUCCESS,Ae.Popup,a)}catch(s){const a=new Ao(Ae.Popup,null,s);this.logger.verbose(`Found auth error in popup: ${s}`),o==null||o.postMessage(a),this.eventHandler.emitEvent(r.length===0?ae.LOGIN_FAILURE:ae.ACQUIRE_TOKEN_FAILURE,Ae.Popup,null,s)}}async brokeredSsoSilentRequest(e,n){var o;this.logger.verbose("Brokered SSO Silent request initiated."),this.eventHandler.emitEvent(ae.SSO_SILENT_START,Ae.Silent,e.request);const r=((o=this.embeddedAppConfigMap.get(e.embeddedClientId))==null?void 0:o[1])||n;try{const i=this.addBrokerRequestProperties(e),s=await super.ssoSilent(i),a=new Ao(Ae.Silent,s);this.logger.verbosePii("Sending auth response"),r==null||r.postMessage(a),this.eventHandler.emitEvent(ae.SSO_SILENT_SUCCESS,Ae.Silent,s)}catch(i){const s=new Ao(Ae.Silent,null,i);this.logger.verbose(`Found auth error in ssoSilent: ${i}`),r==null||r.postMessage(s),this.eventHandler.emitEvent(ae.SSO_SILENT_FAILURE,Ae.Silent,null,i)}}async brokeredSilentRequest(e,n,r){var i;this.logger.verbose("Brokered Silent request initiated."),this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_START,Ae.Silent,e.request);const o=((i=this.embeddedAppConfigMap.get(e.embeddedClientId))==null?void 0:i[1])||r;try{const s=this.addBrokerRequestProperties(e,n);s.cacheLookupPolicy=Vn.RefreshTokenAndNetwork;const a=await super.acquireTokenSilent(s),c=new Ao(Ae.Silent,a);o==null||o.postMessage(c),this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_SUCCESS,Ae.Silent,a)}catch(s){const a=new Ao(Ae.Silent,null,s);this.logger.verbose(`Found auth error in silent: ${s}`),o==null||o.postMessage(a),this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_FAILURE,Ae.Silent,null,s)}}getEmbeddedAppRedirectUri(e){const n=new At(e);return`brk-${this.getConfiguration().auth.clientId}://${n.getUrlComponents().HostNameAndPort}`}addBrokerRequestProperties(e,n){const r={...e.request};r.redirectUri=this.getEmbeddedAppRedirectUri(e.embeddedAppOrigin),r.extraQueryParameters={...r.extraQueryParameters,client_id:e.embeddedClientId,brk_client_id:this.getConfiguration().auth.clientId,brk_redirect_uri:this.getConfiguration().auth.redirectUri||ri()},r.tokenBodyParameters={...r.tokenBodyParameters,client_id:e.embeddedClientId,brk_client_id:this.getConfiguration().auth.clientId,brk_redirect_uri:this.getConfiguration().auth.redirectUri||ri()},r.storeInCache={idToken:!1,accessToken:!1};const o=n||this.getActiveAccount();return o&&(r.account=o),e.request.correlationId&&this.performanceClient.addFields({embeddedClientId:e.embeddedClientId,embeddedRedirectUri:e.embeddedAppOrigin},e.request.correlationId),r}async sendLogoutRequestToEmbeddedApps(e){this.logger.verbose("sendLogoutRequestToEmbeddedApps called"),await this.messageEmbeddedAppsToLogout(new py(Nu,(e==null?void 0:e.correlationId)||No()))}async messageEmbeddedAppsToLogout(e){const n=[];this.embeddedAppConfigMap.forEach(r=>{n.push(new Promise((o,i)=>{var a;const s=window.setTimeout(()=>{o()},200);try{(a=r[1])==null||a.postMessage(e),r[1].addEventListener("message",c=>{c.data.messageType===Lt.EMBEDDED_LOGOUT_RESPONSE&&(this.logger.info(`Received logout response from embedded app: ${c.data.embeddedClientId}`),o(),clearTimeout(s))})}catch(c){this.logger.error(`Could not logout application ${r[0]}. Error in message channel: ${c}`),i(c)}}))}),await Promise.all(n)}endBrokerPerformanceEvent(e,n,r){this.telemetryAllowedEmbeddedClients.has(e)||(this.logger.verbosePii(`TelemetryReporter: Skipping brokered event as not allowed by the client ${e}`,n.event.correlationId),n.discard()),r?n.end({success:!1},r):n.end({success:!0})}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class ple extends hi{constructor(e,n,r){super(Lt.EMBEDDED_LOGOUT_RESPONSE),this.version=e,this.correlationId=r,this.embeddedClientId=n}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const gh={Interaction:"brokerInteractionTimeoutMs",Message:"brokerMessageTimeoutMs",Iframe:"brokerIframeTimeoutMs"},vh={Interaction:"brokerInteractionTimedOut",Message:"brokerMessageTimedOut",Iframe:"brokerIframeTimedOut"};class mle{get trustedBrokersProvided(){return!!this.pwbBrokeredAppConfiguration.trustedBrokerDomains&&this.pwbBrokeredAppConfiguration.trustedBrokerDomains.length>=1}get brokerConnectionEstablished(){return!!this.brokerMetadata}constructor(e,n,r,o,i,s,a,c){this.pwbBrokeredAppConfiguration=r,this.clientId=e,this.logger=o,this.brokerMetadata=null,this.performanceClient=i,this.hydrateCache=a,this.clearCache=c,this.messageChannelList=[],this.messageChannel=new MessageChannel,this.resolvers=new Map,this.temporaryBrokerStorage=s,this.onWindowMessageCb=this.onWindowMessage.bind(this),this.handshakeMetadata={correlationId:n}}getAncestors(){var r;const e=[];let n=window;for(;n&&n.parent&&n.parent.window!==n;)n=(r=n.parent)==null?void 0:r.window,e.push(n);return this.logger.verbose(`Attempting to send handshake request to ${e.length} ancestors`),e}async initiateHandshake(e){if(!this.trustedBrokersProvided)throw hn.createNoTrustedBrokersProvidedError();return this.initMeasurement&&this.initMeasurement.discard(),this.initMeasurement=e,new Promise((n,r)=>{const o=setTimeout(()=>{this.logger.warning("Broker handshake timed out"),e==null||e.add({brokerHandshakeTimedOut:!0,brokerHandshakeTimeoutMs:this.pwbBrokeredAppConfiguration.brokerHandshakeTimeout}),r(hn.createMessageBrokerHandshakeTimeoutError())},this.pwbBrokeredAppConfiguration.brokerHandshakeTimeout);this.handshakeMetadata.resolve=n,this.handshakeMetadata.reject=r,this.handshakeMetadata.timeoutId=o,window.addEventListener("message",this.onWindowMessageCb);const i=[];i.push(window),i.push(...this.getAncestors());for(let s=0;s<i.length;s++){const a=i[s],c=i.length-s-1;this.logger.verbose(`Sending handshake request to frame with depth = ${c}`),this.sendHandshakeRequest(a,c,void 0,e)}}).catch(n=>{const r=n;this.logger.error(r.message)})}async onWindowMessage(e){if(e.data&&e.origin&&this.pwbBrokeredAppConfiguration.trustedBrokerDomains.includes(e.origin))if(e.data.messageType===Lt.BROKER_READY){this.logger.verbose("Broker is available.");const n=this.performanceClient.startMeasurement(It.PairwiseBrokerApplicationInitializeBrokering,this.handshakeMetadata.correlationId);return this.handshakeMetadata.performanceEvent&&this.handshakeMetadata.performanceEvent.discard(),this.handshakeMetadata.performanceEvent=n,n.add({isBackground:!0}),this.sendHandshakeRequest(e.source,this.getFrameDepth(e.source),e.origin,n)}else e.data.messageType===Lt.HANDSHAKE_RESPONSE&&(this.handshakeMetadata.performanceEvent=this.initMeasurement,this.onHandshakeResponse(e))}getFrameDepth(e){const n=[];n.push(window),n.push(...this.getAncestors());for(let r=0;r<n.length;r++)if(n[r]===e)return n.length-r-1;return 0}closeBrokerConnection(){this.logger.verbose("Closing broker connection."),this.brokerMetadata=null,Bl(this.messageChannel),this.messageChannelList.forEach(e=>Bl(e.channel)),window.removeEventListener("message",this.onWindowMessageCb)}async sendSsoSilentRequest(e){this.performanceEvent=this.performanceClient.startMeasurement(It.EmbeddedClientApplicationSendSSOSilentRequest,e.correlationId),gs(!0),this.performanceEvent.increment({visibilityChangeCount:0});const n=()=>{this.trackPageVisibility()};document.addEventListener("visibilitychange",n);try{const r=await this.sendRequest(e,Ae.Silent,{type:gh.Iframe,error:vh.Iframe,value:tv}),o=await this.handleResponse(r,e);if(o)this.performanceEvent.end({success:!0,fromCache:o.fromCache,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,isNativeBroker:o.fromNativeBroker,requestId:o.requestId},e.correlationId);else throw this.logger.errorPii(`Broker response is empty in brokered ssoSilent request: ${JSON.stringify(o)}`),hn.createBrokerResponseInvalidError();return o}catch(r){throw this.performanceEvent.end({success:!1},r),r}finally{document.removeEventListener("visibilitychange",n)}}async sendPopupRequest(e){this.performanceEvent=this.performanceClient.startMeasurement(It.EmbeddedClientApplicationSendPopupRequest,e.correlationId),gs(!0);try{const n=await this.sendRequest(e,Ae.Popup,{type:gh.Interaction,error:vh.Interaction,value:this.pwbBrokeredAppConfiguration.brokerInteractionTimeout}),r=await this.handleResponse(n,e);if(r)this.performanceEvent.end({success:!0,fromCache:r.fromCache,accessTokenSize:r.accessToken.length,idTokenSize:r.idToken.length,isNativeBroker:r.fromNativeBroker,requestId:r.requestId});else throw hy.validate(n)?(this.logger.verbose("popupRequest requires a redirect by the broker, this app will now redirect."),hn.createBrokerPopupRequestRedirectingError()):(this.logger.errorPii(`Broker response is empty in brokered popup request: ${JSON.stringify(r)}`),hn.createBrokerResponseInvalidError());return r}catch(n){throw this.performanceEvent.end({success:!1},n),n}}async sendHandleRedirectRequest(e){this.performanceEvent=this.performanceClient.startMeasurement(It.EmbeddedClientApplicationHandleRedirectRequest);try{const n=new fy(this.clientId,Nu),r=await this.messageBroker(n,e.correlationId,{type:gh.Message,error:vh.Message,value:this.pwbBrokeredAppConfiguration.brokerMessageTimeout}),o=await this.handleResponse(r,e);return this.performanceEvent.end({success:!0,fromCache:o==null?void 0:o.fromCache,accessTokenSize:o==null?void 0:o.accessToken.length,idTokenSize:o==null?void 0:o.idToken.length,isNativeBroker:o==null?void 0:o.fromNativeBroker}),o}catch(n){throw this.performanceEvent.end({success:!1},n),n}}async sendSilentRefreshRequest(e){this.performanceEvent=this.performanceClient.startMeasurement(It.EmbeddedClientApplicationSendSilentRefreshRequest,e.correlationId),gs(!0),this.performanceEvent.increment({visibilityChangeCount:0});const n=()=>this.trackPageVisibility();document.addEventListener("visibilitychange",n);try{const r=await this.sendRequest(e,Ae.Silent,{type:gh.Message,error:vh.Message,value:this.pwbBrokeredAppConfiguration.brokerMessageTimeout}),o=await this.handleResponse(r,e);if(o)this.performanceEvent.end({success:!0,fromCache:o.fromCache,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,isNativeBroker:o.fromNativeBroker,requestId:o.requestId});else throw this.logger.errorPii(`Broker response is empty in brokered silent refresh request: ${JSON.stringify(o)}`),hn.createBrokerResponseInvalidError();return o}catch(r){throw this.performanceEvent.end({success:!1},r),r}finally{document.removeEventListener("visibilitychange",n)}}async sendRequest(e,n,r){if(e.authenticationScheme===$t.POP){const i=new Jx(e);e.popKid=await i.generatePublicKeyThumbprint();const s=TE(this.clientId);this.temporaryBrokerStorage.containsKey(s)&&this.temporaryBrokerStorage.setItem(s,JSON.stringify(e))}const o=new dy(this.clientId,n,e,"");return this.messageBroker(o,e.correlationId,r)}getMessageChannelProperties(e){return e?this.messageChannelList.find(n=>n.nonce===e):this.getMessageChannelPropertiesByDepth(0)}getMessageChannelPropertiesByDepth(e){return this.messageChannelList.find(n=>n.depth===e)}onHandshakeResponse(e){const{resolve:n,reject:r,performanceEvent:o,timeoutId:i}=this.handshakeMetadata;try{const s=uy.validate(e,this.pwbBrokeredAppConfiguration.trustedBrokerDomains);if(s){const a=this.getMessageChannelProperties(s.nonce);if(!a){this.logger.trace("No MessageChannel found, ignoring this response"),o==null||o.increment({handshakeIgnoredCount:1});return}if(s.nonce&&s.nonce!==a.nonce){this.logger.trace("Received handshake response but there is a newer handshake request in flight, ignoring this one"),o==null||o.increment({handshakeIgnoredCount:1});return}i&&clearTimeout(i),this.logger.verbose("Received handshake response");const c=sj(s.version);this.brokerMetadata={origin:s.brokerOrigin,version:s.version,semver:c,frameDepth:a.depth},c.major<=3&&c.minor<15&&Bl(a.channel),Bl(this.messageChannel),this.messageChannel=a.channel,n&&n(),o==null||o.add({brokerFrameDepth:a.depth}),o==null||o.end({success:!0})}}catch(s){const a=s;r&&r(a),this.logger.error(a.message),o==null||o.end({success:!1},a)}}sendHandshakeRequest(e=window.top,n,r,o){if(this.logger.trace("Pairwise Broker - sendHandshakeRequest called."),!e)throw this.logger.error("Target frame is undefined."),hn.createBrokerHandshakeFailedError();let i=new MessageChannel;const s=No();i.port1.onmessage=async u=>{u.data&&(u.data.messageType===Lt.HANDSHAKE_RESPONSE?(this.logger.warning("Received handshake response but the broker app is using a version of MSAL.js that does not report its origin, attempting direct communication with each trusted broker domain to resolve. This is a known issue with versions 3.15.0-3.19.1, consider asking the broker app to upgrade."),this.pwbBrokeredAppConfiguration.trustedBrokerDomains.forEach(h=>{const p=new MessageChannel;p.port1.onmessage=f=>{Bl(i),i=p,this.onHandshakeResponse({...f,data:{...f.data},origin:h})},this.logger.verbose(`Sending handshake request to ${h}`),e==null||e.postMessage(a,h,[p.port2])})):await this.handleBrokerMessage(u))};const a=new ly(this.clientId,Nu,!0,s),c=this.getMessageChannelPropertiesByDepth(n);c?(Bl(c.channel),c.channel=i,c.nonce=s):this.messageChannelList.push({channel:i,nonce:s,depth:n}),this.logger.verbose("Sending handshake request"),o==null||o.increment({handshakeSentCount:1}),e==null||e.postMessage(a,r||"*",[i.port2])}async handleBrokerMessage(e){var s,a,c,u;const n=((a=(s=e.data)==null?void 0:s.result)==null?void 0:a.correlationId)||((u=(c=e.data)==null?void 0:c.errorPayload)==null?void 0:u.correlationId),r=e.data.messageType;if(this.logger.verbose(`Received message from broker of type: ${r} with correlationId: ${n}`),!r)return;let o;if(r===Lt.EMBEDDED_LOGOUT_REQUEST){this.logger.verbose("Received logout message from broker."),await this.handleLogoutMessageFromBroker(e),this.messageChannel.port1.postMessage(new ple(Nu,this.clientId,n));return}else if(r===Lt.AUTH_RESULT&&e.data.interactionType===Ae.Redirect)this.logger.verbose("Received redirect response from broker."),o=Ae.Redirect;else if(n)this.logger.verbose(`Resolving message for ${n}.`),o=n;else{this.logger.verbose(`No correlationId found in message: ${r}.`);return}const i=this.resolvers.get(o);i?(clearTimeout(i.timeoutId),i.resolve(e),this.resolvers.delete(o)):this.logger.warning(`Cannot resolve message for ${n}. Ignoring.`)}async messageBroker(e,n,r={type:gh.Message,error:vh.Message,value:this.pwbBrokeredAppConfiguration.brokerMessageTimeout}){return new Promise((o,i)=>{var h,p;if(!this.brokerMetadata){i(hn.createBrokeringDisabledError());return}const s=setTimeout(()=>{var v;const f={},g=r.error.toString();f[g]=!0,(v=this.performanceEvent)==null||v.add(f),i(hn.createMessageBrokerTimeoutError())},r.value),a={},c=r.type.toString();a[c]=r.value,(h=this.performanceEvent)==null||h.add(a);const u=e.messageType===Lt.HANDLE_REDIRECT_REQUEST?Ae.Redirect:n;if(this.resolvers.set(u,{resolve:o,reject:i,timeoutId:s}),this.brokerMetadata.semver.major>=3&&this.brokerMetadata.semver.minor>=15)this.messageChannel.port1.postMessage(e);else{const f=new MessageChannel;f.port1.onmessage=this.handleBrokerMessage.bind(this),(p=window.top)==null||p.postMessage(e,this.brokerMetadata.origin,[f.port2])}})}async handleResponse(e,n){const r=Ao.validate(e);if(!r)return null;if(r.errorPayload)throw Ao.detectError(r.errorPayload);if(!r.result)throw hn.createBrokerResponseInvalidError();await this.hydrateCache(r.result,n);let o;if(n.authenticationScheme===$t.POP){if(!n.popKid)throw hn.createShrGenerationError();o=await new Jx(n).signRequest(r.result.accessToken,n.popKid)}return{...r.result,accessToken:o||r.result.accessToken}}async handleLogoutMessageFromBroker(e){py.validate(e)&&(this.logger.verbose("Logout request received from broker and validated. Logging out embedded app."),await this.clearCache())}trackPageVisibility(){this.performanceEvent&&(this.logger.info("Embedded client: Visibility change detected"),this.performanceEvent.increment({visibilityChangeCount:1}))}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class gle extends Sp{constructor(e,n,r){super(e,r),this.pwbBrokerAppConfig=ij(n),this.temporaryBrokerStorage=ig(e),this.eventHandler=new Z3(this.getLogger()),this.redirectResponse=new Map,this.initialized=!1}async initialize(e){await super.initialize(e),this.initialized=!0}async initializeBrokering(e,n){if(typeof window>"u")return;const r={...n,correlationId:(n==null?void 0:n.correlationId)||No()},o=this.performanceClient.startMeasurement(It.PairwiseBrokerApplicationInitializeBrokering,r.correlationId);o.add({isBackground:!1});try{this.pwbBrokerAppConfig.actAsBroker?(this.pwbBrokerAppConfig.allowBrokering&&this.getLogger().verbose("Running in top frame and both actAsBroker, allowBrokering flags set to true. actAsBroker takes precedence."),this.broker=new fle(this.getConfiguration(),this.pwbBrokerAppConfig,this.eventHandler),this.getLogger().verbose("Acting as Broker"),this.getLogger().verbose("Initialize the extension for the new broker instance"),o.add({isBroker:!0}),await this.broker.initialize(r),await this.broker.listenForBrokerMessage(e,o),o.end({success:!0})):this.pwbBrokerAppConfig.allowBrokering&&(this.embeddedApp=new mle(this.getConfiguration().auth.clientId,r.correlationId,this.pwbBrokerAppConfig,this.getLogger(),this.performanceClient,this.temporaryBrokerStorage,this.hydrateCache.bind(this),this.clearCache.bind(this)),this.getLogger().verbose("Acting as child"),o.add({isBroker:!1}),await this.embeddedApp.initiateHandshake(o))}catch(i){throw o.end({success:!1},i),i}}async handleRedirectPromise(e){if(C_(this.initialized),typeof window<"u"){const n=e||"";let r=this.redirectResponse.get(n);if(typeof r>"u"){this.eventHandler.emitEvent(ae.HANDLE_REDIRECT_START,Ae.Redirect);const o=this.getAllAccounts();r=this.handleRedirectPromiseInternal(e).then(i=>{if(!i)return null;const s=o.length<this.getAllAccounts().length;return this.eventHandler.emitEvent(s?ae.LOGIN_SUCCESS:ae.ACQUIRE_TOKEN_SUCCESS,Ae.Redirect,i),i}).catch(i=>{throw this.eventHandler.emitEvent(o.length>0?ae.ACQUIRE_TOKEN_FAILURE:ae.LOGIN_FAILURE,Ae.Redirect,null,i),i}).finally(()=>{this.eventHandler.emitEvent(ae.HANDLE_REDIRECT_END,Ae.Redirect)}),this.redirectResponse.set(n,r)}return r}return null}async handleRedirectPromiseInternal(e){var n;if((n=this.embeddedApp)!=null&&n.brokerConnectionEstablished){const r=TE(this.controller.getConfiguration().auth.clientId),o=this.temporaryBrokerStorage.getItem(r);if(o){const i=JSON.parse(o);return await this.embeddedApp.sendHandleRedirectRequest(i).catch(a=>{throw a instanceof _t&&a.setCorrelationId(i.correlationId),a}).finally(()=>{this.temporaryBrokerStorage.removeItem(r)})}else return null}else return this.broker?this.broker.handleRedirectPromise(e):super.handleRedirectPromise(e)}async loginRedirect(e){return this.acquireTokenRedirect(e||{scopes:va})}async acquireTokenRedirect(e){const n=this.getAllAccounts().length===0;return this.eventHandler.emitEvent(n?ae.LOGIN_START:ae.ACQUIRE_TOKEN_START,Ae.Redirect,e),super.acquireTokenRedirect(e).catch(r=>(this.eventHandler.emitEvent(n?ae.LOGIN_FAILURE:ae.ACQUIRE_TOKEN_FAILURE,Ae.Redirect,null,r),Promise.reject(r)))}async loginPopup(e){return this.acquireTokenPopup(e||{scopes:va})}async acquireTokenPopup(e){gs(!0);const n={...e,correlationId:e.correlationId||No()},r=this.getAllAccounts();return this.eventHandler.emitEvent(r.length===0?ae.LOGIN_START:ae.ACQUIRE_TOKEN_START,Ae.Popup,n),this.acquireTokenPopupInternal(n).then(o=>{const i=r.length<this.getAllAccounts().length;return this.eventHandler.emitEvent(i?ae.LOGIN_SUCCESS:ae.ACQUIRE_TOKEN_SUCCESS,Ae.Popup,o),o}).catch(o=>{o instanceof _t&&o.setCorrelationId(n.correlationId);const i=r.length===0;return this.eventHandler.emitEvent(i?ae.LOGIN_FAILURE:ae.ACQUIRE_TOKEN_FAILURE,Ae.Popup,null,o),Promise.reject(o)})}async acquireTokenPopupInternal(e){var n;if((n=this.embeddedApp)!=null&&n.brokerConnectionEstablished){if(this.getLogger().verbose("pairwise broker (embedded app) acquireTokenPopup called",e.correlationId),!this.embeddedApp)throw hn.createNoEmbeddedAppError();const r=TE(this.controller.getConfiguration().auth.clientId);return this.temporaryBrokerStorage.setItem(r,JSON.stringify(e)),this.embeddedApp.sendPopupRequest(e).then(o=>(this.temporaryBrokerStorage.removeItem(r),o))}return super.acquireTokenPopup(e)}async ssoSilent(e){gs(!0);const n={...e,correlationId:e.correlationId||No()};return this.eventHandler.emitEvent(ae.SSO_SILENT_START,Ae.Silent,n),this.ssoSilentInternal(n).then(r=>(this.eventHandler.emitEvent(ae.SSO_SILENT_SUCCESS,Ae.Silent,r),r)).catch(r=>{throw r instanceof _t&&r.setCorrelationId(n.correlationId),this.eventHandler.emitEvent(ae.SSO_SILENT_FAILURE,Ae.Silent,null,r),r})}async ssoSilentInternal(e){return this.embeddedApp&&this.embeddedApp.brokerConnectionEstablished?(this.getLogger().verbose("ssoSilent called",e.correlationId),this.embeddedApp.sendSsoSilentRequest(e)):super.ssoSilent(e)}async acquireTokenSilent(e){gs(!0);const n={...e,correlationId:e.correlationId||No()};return this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_START,Ae.Silent,n),this.acquireTokenSilentInternal(n).then(r=>(this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_SUCCESS,Ae.Silent,r),r)).catch(r=>(r instanceof _t&&r.setCorrelationId(n.correlationId),this.eventHandler.emitEvent(ae.ACQUIRE_TOKEN_FAILURE,Ae.Silent,null,r),Promise.reject(r)))}async acquireTokenSilentInternal(e){var o;if(!((o=this.embeddedApp)!=null&&o.brokerConnectionEstablished))return super.acquireTokenSilent(e);this.getLogger().verbose("acquireTokenSilent - attempting to acquire token from web flow");const n={...e,cacheLookupPolicy:Vn.AccessToken};let r;return e.cacheLookupPolicy===Vn.RefreshToken||e.cacheLookupPolicy===Vn.RefreshTokenAndNetwork||e.cacheLookupPolicy===Vn.Skip||e.forceRefresh?r=Promise.reject(new Rd(ni)):r=super.acquireTokenSilent(n),r.catch(async i=>{if(e.cacheLookupPolicy===Vn.AccessToken)throw i;if(!this.embeddedApp)throw hn.createNoEmbeddedAppError();return this.embeddedApp.sendSilentRefreshRequest(e)})}async logoutRedirect(e){if(this.embeddedApp&&this.embeddedApp.brokerConnectionEstablished)this.getLogger().error("Embedded app is not allowed to logout while the broker app is logged in.");else if(this.broker)return await this.broker.sendLogoutRequestToEmbeddedApps(),super.logoutRedirect(e)}async logoutPopup(e){if(this.embeddedApp&&this.embeddedApp.brokerConnectionEstablished)this.getLogger().error("Embedded app is not allowed to logout while the broker app is logged in.");else if(this.broker)return await this.broker.sendLogoutRequestToEmbeddedApps(),super.logoutPopup(e)}setActiveAccount(e){this.broker&&this.broker.setActiveAccount(e),super.setActiveAccount(e)}addEventCallback(e,n=Object.values(ae)){const r=[ae.ACQUIRE_TOKEN_START,ae.ACQUIRE_TOKEN_SUCCESS,ae.ACQUIRE_TOKEN_FAILURE,ae.LOGIN_START,ae.LOGIN_SUCCESS,ae.LOGIN_FAILURE,ae.SSO_SILENT_START,ae.SSO_SILENT_SUCCESS,ae.SSO_SILENT_FAILURE,ae.HANDLE_REDIRECT_START,ae.HANDLE_REDIRECT_END],o=[],i=[];n.forEach(a=>{r.includes(a)?o.push(a):i.push(a)});const s=super.addEventCallback(e,i);return s?(this.eventHandler.addEventCallback(e,o,s),s):null}removeEventCallback(e){super.removeEventCallback(e),this.eventHandler.removeEventCallback(e)}}class vle{supportsNaa(){return!1}supportsPwBBroker(){return!1}async handleInteractionRequiredError(e,n){var r;fn(An,null),fn(Zo,{reason:"token-expired",provider:"microsoft",loginHint:(r=n.account)==null?void 0:r.username})}}class ble extends vle{supportsPwBBroker(){return be.instance().config().useMSALPwBApp??!1}async instantiateMsal(){const e=this.supportsPwBBroker();oD({apiName:ae.INITIALIZE_START,providerType:"microsoft",extraInfo:{eventInfo_isPwB:e}});let n;return e?(n=new gle(yk,jz,Sk),await n.initialize(),await n.initializeBrokering()):n=await Sp.createPublicClientApplication(yk,Sk),iD({apiName:ae.INITIALIZE_END,providerType:"microsoft",extraInfo:{eventInfo_isPwB:e}}),n}}const _E=new al(yle);async function yle(){return new ble}function Cle(t){return!(t instanceof Rr||t instanceof _t&&(t.errorMessage===SO||parseInt(t.errorCode,10)===LI))}const hr=new al(Sle);async function Sle(){const t=await _E.get(),e=await t.instantiateMsal(),n=new Map([["login",null],["graph",null],["oneDrive",null]]);async function r(i,s){const a=Dz(i),c={account:s,...a},u=Ju(dX,"any");try{if(!u)return{accessToken:(await e.acquireTokenSilent(c)).accessToken};const p={...JL(),shouldRetry:g=>Cle(g),onSuccess:g=>uD(g,i,"microsoft"),onFailure:g=>dD(g,i,"microsoft")};return await fD(async()=>({accessToken:(await e.acquireTokenSilent(c)).accessToken}),p)}catch(h){if(h instanceof Rr)return z.trackEvent({name:"system",data:{eventName:"copilotWebAcquireTokenRedirect",eventInfo_requestType:i,eventInfo_traceId:h.traceId,eventInfo_errorMessage:h.errorMessage,eventInfo_errorCode:h.errorCode,eventInfo_correlationId:h.correlationId,eventInfo_timeSinceStartMs:performance.now()-window.appStart,eventInfo_customData:JSON.stringify({eventInfo_accountId:s==null?void 0:s.homeAccountId})}}),t.handleInteractionRequiredError(e,c);if(h instanceof _t&&(h.errorMessage===SO||parseInt(h.errorCode,10)===LI))throw z.trackEvent({name:"system",data:{eventName:"copilotWebAcquireTokenUnderaged",eventInfo_requestType:i,eventInfo_errorMessage:h.errorMessage,eventInfo_errorCode:h.errorCode,eventInfo_correlationId:h.correlationId}}),new Error(DI);return}}return{msal:e,getMsalAccessToken:async i=>{const s=e.getActiveAccount();if(!s&&!t.supportsNaa())return;const a=n.get(i);if(!a){const c=r(i,s??void 0);n.set(i,c);const u=await c;return n.set(i,null),u}return a}}}function Ele(t){var n;const e=(n=t.payload)==null?void 0:n.scopes;return Array.isArray(e)?e.some(r=>typeof r!="string"?!1:r==="ConsumerStore.Purchase"||r.endsWith("purchase.create")):!1}function cj(t){const e=Ele(t);if(t.eventType===ae.LOGIN_START){const n=t.payload;sD({apiName:ae.LOGIN_START,authWorkflowAccountType:"microsoft",interactionType:t.interactionType??void 0,correlationId:n.correlationId,prompt:n.prompt,redirectUri:n.redirectUri,extraInfo:{eventInfo_isBrokered:e}})}else if(t.eventType===ae.LOGIN_SUCCESS||t.eventType===ae.SSO_SILENT_SUCCESS){const n=t.payload&&"account"in t.payload?t.payload.account:null,r=n?!Xo(n.tenantId):void 0,o=t.payload;v1({apiName:t.eventType,authWorkflowAccountType:"microsoft",interactionType:t.interactionType??void 0,correlationId:o.correlationId,authority:o.authority,isMSA:r,extraInfo:{eventInfo_isBrokered:e}})}else if(t.eventType===ae.LOGOUT_SUCCESS)aD({apiName:ae.LOGOUT_SUCCESS,providerType:"microsoft",extraInfo:{eventInfo_isBrokered:e}});else if(t.eventType===ae.ACQUIRE_TOKEN_START||t.eventType===ae.ACQUIRE_TOKEN_NETWORK_START){pa("msalAcquireTokenStartTime",Date.now().toString());const n=t.payload;ca({authWorkflowAccountType:"microsoft",apiName:t.eventType,extraInfo:{eventInfo_interactionType:t.interactionType??void 0,eventInfo_correlationId:n.correlationId,eventInfo_redirectUri:n.redirectUri,eventInfo_cacheLookupPolicy:n.cacheLookupPolicy,eventInfo_prompt:n.prompt,eventInfo_isBrokered:e}})}else if(t.eventType===ae.ACQUIRE_TOKEN_SUCCESS){const n=Date.now()-parseInt(ci("msalAcquireTokenStartTime")??"0",10);pa("msalAcquireTokenStartTime","");const r=t.payload;ca({authWorkflowAccountType:"microsoft",apiName:t.eventType,extraInfo:{eventInfo_interactionType:t.interactionType??void 0,eventInfo_correlationId:r.correlationId,eventInfo_expiresOn:r.expiresOn,eventInfo_extExpiresOn:r.extExpiresOn,eventInfo_refreshOn:r.refreshOn,eventInfo_duration:n,eventInfo_fromCache:r.fromCache,eventInfo_isBrokered:e}})}else if(t.eventType===ae.LOGIN_FAILURE||t.eventType===ae.ACQUIRE_TOKEN_FAILURE||t.eventType===ae.SSO_SILENT_FAILURE||t.eventType===ae.ACQUIRE_TOKEN_BY_CODE_FAILURE||t.eventType===ae.LOGOUT_FAILURE){let n;t.eventType===ae.ACQUIRE_TOKEN_FAILURE&&(n=Date.now()-parseInt(ci("msalAcquireTokenStartTime")??"0",10));const r=t.error;Xu({authWorkflowAccountType:"microsoft",apiName:t.eventType,errorType:(r==null?void 0:r.name)??"",errorMessage:(r==null?void 0:r.message)??"",extraInfo:{eventInfo_isBrokered:e},errorExtraInfo:{eventInfo_correlationId:r==null?void 0:r.correlationId,eventInfo_errorMessage:r==null?void 0:r.errorMessage,eventInfo_errorCode:r==null?void 0:r.errorCode,eventInfo_name:r==null?void 0:r.name,eventInfo_interactionType:t.interactionType??void 0,eventInfo_subError:r==null?void 0:r.subError,eventInfo_duration:n}})}else ca({authWorkflowAccountType:"microsoft",apiName:t.eventType,extraInfo:{eventInfo_interactionType:t.interactionType??void 0,eventInfo_isBrokered:e}})}function Xo(t){return t!==Eg}function Ile(t){ca({apiName:"msal:silentSSOCustomSuccess",authWorkflowAccountType:"microsoft",duration:t.duration,extraInfo:{eventInfo_accountUpdate:t.accountUpdate,eventInfo_accountType:t.accountType,eventInfo_message:t.message}})}function qS(t){Xu({apiName:"msal:silentSsoCustomError",authWorkflowAccountType:"microsoft",errorMessage:t.message,errorCode:t.errorCode})}class Tle{constructor(){W(this,"hasTrackedRedirectError",!1)}async handleRedirect(){var e;try{const{msal:n}=await hr.get();await n.handleRedirectPromise()&&cD({authWorkflowAccountType:"microsoft",apiName:"msal:reauthSuccess"});const o=await this.getAccount();return o?(n.setActiveAccount(o),{id:((e=o.idTokenClaims)==null?void 0:e.oid)??"",tenantId:o.tenantId,provider:"microsoft",accountType:Xo(o.tenantId)?"AAD":"MSA"}):null}catch(n){this.trackRedirectErrorOncePerSession(n)}return null}async handleRedirectWithoutAccount(){try{const{msal:e}=await hr.get(),n=await e.handleRedirectPromise();n&&e.setActiveAccount(n.account)}catch(e){this.trackRedirectErrorOncePerSession(e)}}async maybeInitializeAccountWithToken(){var s;const{msal:e}=await hr.get(),n=e.getActiveAccount(),r=e.getAllAccounts(),o=Ge(An);ca({authWorkflowAccountType:"microsoft",apiName:"msal:maybeInitializeAccountWithToken",extraInfo:{eventInfo_activeAccount:n==null?void 0:n.homeAccountId,eventInfo_tenantId:n==null?void 0:n.tenantId,eventInfo_isAadTenant:n!=null&&n.tenantId?Xo(n.tenantId):!1,eventInfo_accounts:r.map(a=>({id:a.homeAccountId,type:Xo(a.tenantId)?"AAD":"MSA"})),eventInfo_userAccount:o}});const i=await this.getAuthToken();if(i){const a=await this.getAccount();return a?(e.setActiveAccount(a),{userAccount:{id:((s=a.idTokenClaims)==null?void 0:s.oid)??"",tenantId:a.tenantId,provider:"microsoft",accountType:Xo(a.tenantId)?"AAD":"MSA"},authToken:i}):null}return null}async logIn(){const{msal:e}=await hr.get(),n={...II},r=this.buildRedirectUri();return r&&(n.redirectUri=r),e.loginRedirect(n)}buildRedirectUri(){const{surfaceQueryParam:e}=be.instance().config(),n=new URLSearchParams;let r;if(e!=null&&e.useForLoginRedirect)for(const[i,s]of Object.entries(e.params))n.set(i,s);const o=new URLSearchParams(window.location.search).get("back");return o&&n.set("back",o),n.toString()&&(r=`${window.location.origin}?${n}`),r}async logOut(){const{msal:e}=await hr.get(),n=e.getAllAccounts(),r=e.getActiveAccount();try{if(We("auth-rf-account-selection")){await e.logoutRedirect({account:r,onRedirectNavigate:()=>!1}),z.setPicassoId(null);return}for(const o of n)o.tenantId!==Eg&&(await e.logoutRedirect({account:o,onRedirectNavigate:()=>!1}),z.setPicassoId(null))}catch(o){console.error(o)}await e.logoutRedirect({account:r,onRedirectNavigate:()=>!1}),z.setPicassoId(null)}async getAuthToken(){return(await hr.get()).getMsalAccessToken("login")}async getUserInfo(){const e=await(await hr.get()).getMsalAccessToken("graph");if(e)return Ix(e.accessToken)}async getUserInfoFromToken(e){return Ix(e)}supportsTokenType(e){return e===void 0}trackRedirectErrorOncePerSession(e){this.hasTrackedRedirectError||z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"msalHandleRedirectPromise",eventInfo_details:"Error handling redirect promise",eventInfo_errorMessage:`${e}`}}),this.hasTrackedRedirectError=!0}async getAccount(){var o,i;const{msal:e}=await hr.get(),n=e.getAllAccounts(),r=e.getActiveAccount();if((n.length>1||n.length===1&&(r==null?void 0:r.homeAccountId)!==((o=n[0])==null?void 0:o.homeAccountId))&&ca({authWorkflowAccountType:"microsoft",apiName:"msal:getAllAccounts",extraInfo:{eventInfo_accountCount:n.length,eventInfo_accountTypes:n.map(s=>Xo(s.tenantId)?"AAD":"MSA"),eventInfo_accountIds:n.map(s=>s.homeAccountId),eventInfo_currentAccountId:(i=e.getActiveAccount())==null?void 0:i.homeAccountId}}),n.length!==0){if(We("auth-rf-account-selection"))return n.length===0?void 0:n.length===1?n[0]:n.length>1&&r?r:void 0;for(const s of n)if(s.tenantId===Eg)return s;return n[0]}}async getCurrentActiveUserAccount(){var n;const e=await this.getAccount();return e?{id:((n=e.idTokenClaims)==null?void 0:n.oid)??"",tenantId:e.tenantId,provider:"microsoft",accountType:Xo(e.tenantId)?"AAD":"MSA"}:null}}class jr{constructor(){W(this,"middlewares",[])}add(e){this.middlewares.push(e)}async run(e){let n={...e};for(const r of this.middlewares)try{n=await r(n)}catch{continue}return n}}const _le=new jr,U2=new jr,aRe=new jr,cRe=new jr,wle=new jr,Ale=new jr,kle=new jr,xle=new jr,Rle=new jr,Nle=new jr,Ple=new jr,Mle=new jr,Ole=new jr,Lle=new jr,Dle=new jr;var Mu;const rc=class rc{constructor(){W(this,"providers");this.providers={microsoft:new Tle,auth0:new OX}}async handleRedirect(){const e=await this.providers.microsoft.handleRedirect();if(e)return e;if(!be.instance().config().enableAuth0)return null;const n=await this.providers.auth0.handleRedirect();return n||null}async handleRedirectWithoutAccount(){await this.providers.microsoft.handleRedirectWithoutAccount(),be.instance().config().enableAuth0&&await this.providers.auth0.handleRedirectWithoutAccount()}async getCurrentActiveUserAccountAndSetGlobalUserAccount(){const e=await this.providers.microsoft.getCurrentActiveUserAccount();if(e){this.setUserAccount(e);return}if(!be.instance().config().enableAuth0)return;const n=await this.providers.auth0.getCurrentActiveUserAccount();n&&this.setUserAccount(n)}static instance(){return he(rc,Mu)||Bt(rc,Mu,new rc),he(rc,Mu)}getCurrentProvider(){const e=Ge(An);return e?this.providers[e.provider]:null}async getAccountFromProviders(){var e;return b1()?((e=this.getCurrentProvider())==null?void 0:e.getCurrentActiveUserAccount())??null:this.handleRedirect()}async maybeInitialize(){try{const e=await this.providers.microsoft.maybeInitializeAccountWithToken();if(e)return e;if(!be.instance().config().enableAuth0)return null;const n=await this.providers.auth0.maybeInitializeAccountWithToken();if(n)return n}catch(e){e instanceof Error&&xr({feature:"accountInitialization",errorType:e.name,errorMessage:e.message,exception:e.stack})}return null}setUserAccount(e){fn(An,e),z.setUserAccountType(e==null?void 0:e.accountType)}async getAuthToken(){var r;const e=await U2.run({type:"login"});if(e.isHandled){if(((r=e.authToken)==null?void 0:r.tokenType)!==void 0){const o=MX(e.authToken.tokenType);z.setUserAccountType(o)}return e.authToken}if(b1()){const o=this.getCurrentProvider();return o?o.getAuthToken():void 0}const n=this.getCurrentProvider();if(!n){const o=await this.handleRedirect();if(o)return this.setUserAccount(o),this.providers[o.provider].getAuthToken();const i=await this.maybeInitialize();if(i){const{authToken:s,userAccount:a}=i;return this.setUserAccount(a),s}return}return n.getAuthToken()}async getUserInfo(){const e=await U2.run({type:"graph"});if(e.isHandled){if(!e.authToken)return;const{tokenType:r,accessToken:o}=e.authToken,i=r!=="msa"?r:void 0;if(this.providers.microsoft.supportsTokenType(i))return this.providers.microsoft.getUserInfoFromToken(o);if(this.providers.auth0.supportsTokenType(i)){const s=await this.providers.auth0.getUserInfoFromToken(o);if(s)return s}return}const n=this.getCurrentProvider();if(n)return n.getUserInfo()}logIn(e,n){return this.providers[e].logIn(n)}async logOut(){const e=this.getCurrentProvider();return e&&(await e.logOut(),this.setUserAccount(null)),Promise.resolve()}async initAuthAccount(){await this.handleRedirectWithoutAccount(),await this.getCurrentActiveUserAccountAndSetGlobalUserAccount()}};Mu=new WeakMap,ln(rc,Mu,null);let ks=rc;function lj(){return null}function uj({featureOverrides:t,localFeatureOverrides:e,serverFeatures:n,surfaceConfig:r}){var i,s,a,c;const o=new Set([...n]);(i=r.settingsOverrides)!=null&&i.shouldHideShopping&&o.delete("shopping-card"),(s=r.settingsOverrides)!=null&&s.shouldHideMultipleCharacters&&o.delete("multiplecharacters"),r.startInVoice&&o.add("start-in-voice"),(a=r.pages)!=null&&a.enabled?o.add("pages"):((c=r.pages)==null?void 0:c.enabled)===!1&&o.delete("pages");for(const u of t)o.add(u);for(const u of e)o.add(u);return Array.from(o)}function dj(){return[]}async function sw(){const{msal:t}=await hr.get();return t.getActiveAccount()}async function aw(){const t=await sw();return t?Xo(t.tenantId):!1}async function F2(){const t=await sw();if(!(!t||!Xo(t.tenantId)))return t}async function jle(){const t=await sw();if(!(!t||Xo(t.tenantId)))return t}async function Ule(){return(await hr.get()).getMsalAccessToken("oneDrive")}async function Fle(){if(!await aw())return;const{msal:t}=await hr.get(),e=t.getActiveAccount();e&&t.clearCache({account:e})}const hj="urlFeatureOverrides";function Ble(){return typeof window>"u"?null:sessionStorage.getItem(hj)}function fj(){const t=Ble();return t?t.split(",").map(n=>n):[]}function Hle(){const t=yn("features");return t!=null&&t.trim()&&typeof window<"u"&&sessionStorage.setItem(hj,t.trim()),fj()}const zle={VITE_API_URL:"copilot.microsoft.com/c/api"},Vle="https://www.copilot.com",$le="https://www.copilot-stg.com";function pj(){return typeof window>"u"?!1:window.location.origin===Vle||window.location.origin===$le}async function Gle(t,e){try{return await t.json()}catch(n){throw(n instanceof SyntaxError||n instanceof TypeError||n instanceof DOMException)&&N$(n,t,e),n}}function mj(t={}){const{query:e={}}=t,n=new URLSearchParams;for(const[s,a]of Object.entries(e))n.append(s,a);const r=uj({featureOverrides:fj(),localFeatureOverrides:dj(),serverFeatures:[],surfaceConfig:be.instance().config()}).join(",");r&&(n.append("features",r),n.append("setflight",r));const o=lj();o&&n.append("promptBranch",o);const{surfaceQueryParam:i}=be.instance().config();if(i)for(const[s,a]of Object.entries(i.params))n.append(s,a);return n}function gj(t){return t!==void 0&&t.tokenType!==void 0&&t.tokenType!=="msa"}async function B2(t,e){const{VITE_API_URL:n}=zle;let r;if(pj()?r=`${window.location.host}/c/api`:r=n,!r)throw new Error("Cannot initialize websocket because the required env vars are not set: VITE_API_URL");const o={...e,"api-version":"2"},i=await ks.instance().getAuthToken(),s=await aw();i&&!s&&(o.accessToken=i.accessToken,gj(i)&&(o["X-UserIdentityType"]=i.tokenType)),i===void 0?nD(t,"getWssAPIUrl"):rD(t,"getWssAPIUrl"),Ge(qu)&&(o.appFlavor="beta");const a=mj({query:o});return`wss://${r}/${t}?${a}`}function Kle(t,e){let n="";pj()?n=`${window.location.origin}/c/api`:n="https://copilot.microsoft.com/c/api",n+=t;const r=mj({query:e});return r.toString()&&(n+=`?${r}`),n}async function Gc(t,e={}){const{options:n,query:r,analytics:o}=e,i=new Headers(n==null?void 0:n.headers);Nt.resolvedLanguage?i.set("X-Search-UILang",Nt.resolvedLanguage.toLowerCase()):Nt.language&&i.set("X-Search-UILang",Nt.language.toLowerCase());const s=await ks.instance().getAuthToken(),a=await aw();s&&!a&&(i.set("Authorization",`Bearer ${s.accessToken}`),gj(s)&&i.set("X-UserIdentityType",s.tokenType)),s===void 0?nD(t,"fetchApi"):rD(t,"fetchApi"),Ge(qu)&&i.set("X-Copilot-App-Flavor","beta");const c=performance.now(),u=await fetch(Kle(t,r),{...n,credentials:"include",headers:i}),h=performance.now();return tD((o==null?void 0:o.anonymousPath)??t,(n==null?void 0:n.method)??"GET",h-c,u.clone()),fb.trackLatestApiAssignment(u.clone()),u}async function Wr({path:t,args:e={}}){var r;const n={method:"POST",...e.options,headers:{"Content-Type":"application/json",...(r=e.options)==null?void 0:r.headers},body:e.body?JSON.stringify(e.body):void 0};return Gc(t,{...e,options:n})}async function qn(t,e,n={}){const{analytics:r,onFailedRequest:o}=n,i=(r==null?void 0:r.anonymousPath)??t,s=await Gc(t,n);let a=!0;if(!s.ok&&o&&(a=!!o(s)),!a)return{data:void 0,response:{ok:s.ok,status:s.status,headers:s.headers},zodError:void 0};const c=await Gle(s,i);let u,h;const{safe:p}=n.parseOptions??{};if(p){const f=e.safeParse(c);f.error&&Tf(f.error,i,!0),u=c,h=f.error}else try{u=e.parse(c)}catch(f){throw f instanceof vg&&Tf(f,i,!1),f}return{data:u,response:{ok:s.ok,status:s.status,headers:s.headers},zodError:h}}function qle(){return Sn(Ok)!==null?!1:($r(BI),$r(If),ar(Ok,"true"),!0)}function vj(){return parseInt(Sn(BI)??"0",10)}function Wle(){return new Date(Sn(If)??new Date().toISOString())}function Yle(t){Sn(If)||ar(If,t)}function Qle(){let t;try{t=vj()}catch{t=0}t<K0&&(t+=1,ar(BI,`${t}`),t===K0&&Yle(new Date().toISOString()))}const Jle={headers:{"content-type":"application/json"},body:JSON.stringify({type:"private"})};function bj(t,{arg:e}={}){const r=(e==null?void 0:e.isPrivate)??!1?Jle:void 0;return qn(t,gQ,{options:{method:"POST",...r}}).then(o=>o.data)}function my(){const t=L($I),{trigger:e}=NI("/conversations",bj),n=L(En),r=rp(En),o=Ee(mb),i=Ee(VI),s=Ee(GJ),a=fZ(),[c,u]=m.useState(!1);return{startConversationDisabled:c,createConversation:m.useCallback(async h=>{const{shouldNavigateToChat:p=!0,characterId:f,isPrivate:g=!1}=h??{};if(t){const v=n.get(t);if((v==null?void 0:v.characterId)===f)return a({id:t,shouldNavigateToChat:p}),t}if(!c)try{u(!0);const{id:v}=await e({isPrivate:g}),y={id:v,updatedAt:new Date().toISOString(),history:[],isNew:!0,characterId:f,streamingState:"idle",continuedAt:null};return g&&i(v),r(C=>{C.set(v,y)}),a({id:v,shouldNavigateToChat:!g&&p}),o(!0),Qle(),tZ(),s(),v}catch(v){console.error(v)}finally{u(!1)}},[t,c,n,a,e,r,i,o,s])}}function Ft(){return TM({select:e=>e.pathname})}function gy(){const[t,e]=it(K$),n=Ft();return m.useEffect(()=>{n.endsWith("/chats/new/talk")&&(z.setLandingPage("deepLinkVoiceCall"),e("audioCall"))},[n,e]),[t,()=>e(null)]}function Fd(){const t=Ft(),e=le("enable-private-chat");return t===IO&&e}function cw(t){const e=t!=null&&t.length?t.includes("enable-private-chat"):We("enable-private-chat");return window.location.pathname===IO&&e}const Zle=D(0),Xle=D(null),eue=D(null),Ep=D("center"),yj=D(void 0),Yr=D(null),tue=D(null),Ip=D(null),vy=D(null),nue=D(t=>{var r;const e=t(Zi),n=wT(e);return((r=n==null?void 0:n.part.task)==null?void 0:r.type)==="research"}),Cj=D(null),rue=D(!1);D(new Map);const lRe=D(!1),lw=D(null),Sj=D(!1),wE=D(!1),uw="shouldPerformUserMerge";function oue(t){pa(uw,String(t))}function iue(){_O(uw)}function sue(){return ci(uw)!=="false"}function uRe(){const t=L(Zi),e=Lr(),[n,r]=it(uX),o=le("user-conversation-merge"),i=o&&!e&&t.length>0;return m.useEffect(()=>{o&&oue(n)},[o,n]),{shouldShowMergeCheckbox:i,shouldMerge:n,setShouldMerge:r}}function Ej(t){try{return new URL(t,window.location.origin).origin!==window.location.origin}catch{return!1}}function Tp(t){Ge(Jc)&&Ej(t)?st().set(vb,t.toString()):window.location.href=t}function _p(){aue()}function aue(t){const{surfaceQueryParam:e}=be.instance().config(),n=new URL(window.location.href);if(e)for(const[r,o]of Object.entries(e.params))n.searchParams.delete(r),n.searchParams.append(r,o);Tp(n.href)}const Os=D(null),Ij=D([]);function dw(){var c;const[t,e]=it(Ij),n=m.useRef([]);m.useEffect(()=>{const u=n.current,h=t;if(u.length>h.length){const p=u.filter((g,v)=>v>=h.length),f=p.length;for(let g=f-1;g>=0;g-=1){const v=p[g];v!=null&&v.onPopPage&&v.onPopPage()}}n.current=t},[t]);const r=t.length>0?(c=t[t.length-1])==null?void 0:c.page:void 0,o=u=>i([u]),i=u=>{const h=u.map(p=>({page:p,onPopPage:void 0}));e(p=>[...p,...h])};return{currentPage:r,pushPage:o,pushPages:i,goBackOrClose:()=>{e(u=>u.length<=0?u:u.slice(0,-1))},closeSettings:()=>{e([])}}}function dRe(t,e){const n={page:t,onPopPage:e==null?void 0:e.onPopPageCallback};st().set(Ij,r=>[...r,n])}function by(t){const{pages:e,className:n,children:r,disableLink:o,clickSource:i,onClick:s}=t,{pushPages:a}=dw(),c=()=>{Mt.emit("disclaimer:open-settings"),a(e),s==null||s(),ht({source:i??"settingsLink",destination:e[e.length-1]})};return o?d.jsx("span",{children:r}):d.jsx("button",{className:n,type:"button",title:"",onClick:c,children:r})}function cue(){const t=Ee(Os);return d.jsx("p",{children:d.jsx(oo,{i18nKey:"settings.copilotBeta.announcementSubtitle",components:{settingsLink:d.jsx(by,{pages:["menu","copilot-beta"],className:"underline",clickSource:"disclaimerSettingsLink",onClick:()=>t(null)})}})})}function lue(){if(!We("copilot-beta-automatic-opt-in"))return;const t=Ge(qu);if(t===void 0)fn(EC,!0),fn(qu,!0),_p();else if(t&&Ge(EC)){const n={title:X("settings.copilotBeta.announcementTitle"),subtitle:d.jsx(cue,{})};fn(Os,n),fn(EC,void 0)}}function AE(t){if(window.clarity)for(const[e,n]of Object.entries(t))window.clarity("set",e,n)}function H2(t){if(window.clarity)for(const e of t)window.clarity("event",e)}function hw(t){const e=Zv(),n=m.useRef(t);n.current=t,m.useEffect(()=>e.subscribe("onBeforeNavigate",r=>{const{pathChanged:o}=r;o&&n.current(r)}),[e])}let Tj=!0,_j=!0;function uue(t){_j=t}function yy(){return Tj}function due(){hw(()=>{_j||(Tj=!1)})}const hue=(t,e,n)=>{const r=t[e];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((o,i)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+e+(e.split("/").length!==n?". Note that variables only represent file names one level deep.":""))))})},{slice:fue,forEach:pue}=[];function mue(t){return pue.call(fue.call(arguments,1),e=>{if(e)for(const n in e)t[n]===void 0&&(t[n]=e[n])}),t}const z2=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,gue=(t,e,n)=>{const r=n||{};r.path=r.path||"/";const o=encodeURIComponent(e);let i=`${t}=${o}`;if(r.maxAge>0){const s=r.maxAge-0;if(Number.isNaN(s))throw new Error("maxAge should be a Number");i+=`; Max-Age=${Math.floor(s)}`}if(r.domain){if(!z2.test(r.domain))throw new TypeError("option domain is invalid");i+=`; Domain=${r.domain}`}if(r.path){if(!z2.test(r.path))throw new TypeError("option path is invalid");i+=`; Path=${r.path}`}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");i+=`; Expires=${r.expires.toUTCString()}`}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return i},V2={create(t,e,n,r){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};n&&(o.expires=new Date,o.expires.setTime(o.expires.getTime()+n*60*1e3)),r&&(o.domain=r),document.cookie=gue(t,encodeURIComponent(e),o)},read(t){const e=`${t}=`,n=document.cookie.split(";");for(let r=0;r<n.length;r++){let o=n[r];for(;o.charAt(0)===" ";)o=o.substring(1,o.length);if(o.indexOf(e)===0)return o.substring(e.length,o.length)}return null},remove(t){this.create(t,"",-1)}};var vue={name:"cookie",lookup(t){let{lookupCookie:e}=t;if(e&&typeof document<"u")return V2.read(e)||void 0},cacheUserLanguage(t,e){let{lookupCookie:n,cookieMinutes:r,cookieDomain:o,cookieOptions:i}=e;n&&typeof document<"u"&&V2.create(n,t,r,o,i)}},bue={name:"querystring",lookup(t){var r;let{lookupQuerystring:e}=t,n;if(typeof window<"u"){let{search:o}=window.location;!window.location.search&&((r=window.location.hash)==null?void 0:r.indexOf("?"))>-1&&(o=window.location.hash.substring(window.location.hash.indexOf("?")));const s=o.substring(1).split("&");for(let a=0;a<s.length;a++){const c=s[a].indexOf("=");c>0&&s[a].substring(0,c)===e&&(n=s[a].substring(c+1))}}return n}};let bh=null;const $2=()=>{if(bh!==null)return bh;try{bh=window!=="undefined"&&window.localStorage!==null;const t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{bh=!1}return bh};var yue={name:"localStorage",lookup(t){let{lookupLocalStorage:e}=t;if(e&&$2())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupLocalStorage:n}=e;n&&$2()&&window.localStorage.setItem(n,t)}};let yh=null;const G2=()=>{if(yh!==null)return yh;try{yh=window!=="undefined"&&window.sessionStorage!==null;const t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{yh=!1}return yh};var Cue={name:"sessionStorage",lookup(t){let{lookupSessionStorage:e}=t;if(e&&G2())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupSessionStorage:n}=e;n&&G2()&&window.sessionStorage.setItem(n,t)}},Sue={name:"navigator",lookup(t){const e=[];if(typeof navigator<"u"){const{languages:n,userLanguage:r,language:o}=navigator;if(n)for(let i=0;i<n.length;i++)e.push(n[i]);r&&e.push(r),o&&e.push(o)}return e.length>0?e:void 0}},Eue={name:"htmlTag",lookup(t){let{htmlTag:e}=t,n;const r=e||(typeof document<"u"?document.documentElement:null);return r&&typeof r.getAttribute=="function"&&(n=r.getAttribute("lang")),n}},Iue={name:"path",lookup(t){var o;let{lookupFromPathIndex:e}=t;if(typeof window>"u")return;const n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(n)?(o=n[typeof e=="number"?e:0])==null?void 0:o.replace("/",""):void 0}},Tue={name:"subdomain",lookup(t){var o,i;let{lookupFromSubdomainIndex:e}=t;const n=typeof e=="number"?e+1:1,r=typeof window<"u"&&((i=(o=window.location)==null?void 0:o.hostname)==null?void 0:i.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(r)return r[n]}};function _ue(){return{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t}}class wj{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,n)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e||{languageUtils:{}},this.options=mue(n,this.options||{},_ue()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=o=>o.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=r,this.addDetector(vue),this.addDetector(bue),this.addDetector(yue),this.addDetector(Cue),this.addDetector(Sue),this.addDetector(Eue),this.addDetector(Iue),this.addDetector(Tue)}addDetector(e){return this.detectors[e.name]=e,this}detect(e){e||(e=this.options.order);let n=[];return e.forEach(r=>{if(this.detectors[r]){let o=this.detectors[r].lookup(this.options);o&&typeof o=="string"&&(o=[o]),o&&(n=n.concat(o))}}),n=n.map(r=>this.options.convertDetectedLanguage(r)),this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}cacheUserLanguage(e,n){n||(n=this.options.caches),n&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||n.forEach(r=>{this.detectors[r]&&this.detectors[r].cacheUserLanguage(e,this.options)}))}}wj.type="languageDetector";const Aj=[{name:"Arabic",i18nCode:"ar",direction:"rtl"},{name:"Basque",i18nCode:"eu",direction:"ltr"},{name:"Bengali",i18nCode:"bn-IN",direction:"ltr"},{name:"Bulgarian",i18nCode:"bg",direction:"ltr"},{name:"Catalan",i18nCode:"ca",direction:"ltr"},{name:"Chinese (Simplified)",i18nCode:"zh-Hans",direction:"ltr"},{name:"Chinese (Traditional)",i18nCode:"zh-Hant",direction:"ltr"},{name:"Croatian",i18nCode:"hr",direction:"ltr"},{name:"Czech",i18nCode:"cs",direction:"ltr"},{name:"Danish",i18nCode:"da",direction:"ltr"},{name:"Dutch",i18nCode:"nl",direction:"ltr"},{name:"English",i18nCode:"en-US",direction:"ltr"},{name:"English (United Kingdom)",i18nCode:"en-GB",direction:"ltr"},{name:"Estonian",i18nCode:"et",direction:"ltr"},{name:"Finnish",i18nCode:"fi",direction:"ltr"},{name:"French",i18nCode:"fr",direction:"ltr"},{name:"Galician",i18nCode:"gl",direction:"ltr"},{name:"German",i18nCode:"de",direction:"ltr"},{name:"Gujarati",i18nCode:"gu",direction:"ltr"},{name:"Hebrew",i18nCode:"he",direction:"rtl"},{name:"Hindi",i18nCode:"hi",direction:"ltr"},{name:"Hungarian",i18nCode:"hu",direction:"ltr"},{name:"Icelandic",i18nCode:"is",direction:"ltr"},{name:"Indonesian",i18nCode:"id",direction:"ltr"},{name:"Italian",i18nCode:"it",direction:"ltr"},{name:"Japanese",i18nCode:"ja",direction:"ltr"},{name:"Kannada",i18nCode:"kn",direction:"ltr"},{name:"Korean",i18nCode:"ko",direction:"ltr"},{name:"Latvian",i18nCode:"lv",direction:"ltr"},{name:"Lithuanian",i18nCode:"lt",direction:"ltr"},{name:"Malay",i18nCode:"ms",direction:"ltr"},{name:"Malayalam",i18nCode:"ml",direction:"ltr"},{name:"Marathi",i18nCode:"mr",direction:"ltr"},{name:"Norwegian (Bokmål)",i18nCode:"nb-NO",direction:"ltr"},{name:"Polish",i18nCode:"pl",direction:"ltr"},{name:"Portuguese (Brazil)",i18nCode:"pt-BR",direction:"ltr"},{name:"Portuguese (Portugal)",i18nCode:"pt-PT",direction:"ltr"},{name:"Punjabi",i18nCode:"pa",direction:"ltr"},{name:"Romanian",i18nCode:"ro",direction:"ltr"},{name:"Russian",i18nCode:"ru",direction:"ltr"},{name:"Serbian (Latin)",i18nCode:"sr-Latn-RS",direction:"ltr"},{name:"Slovak",i18nCode:"sk",direction:"ltr"},{name:"Slovenian",i18nCode:"sl",direction:"ltr"},{name:"Spanish",i18nCode:"es",direction:"ltr"},{name:"Swedish",i18nCode:"sv",direction:"ltr"},{name:"Tamil",i18nCode:"ta",direction:"ltr"},{name:"Telugu",i18nCode:"te",direction:"ltr"},{name:"Thai",i18nCode:"th",direction:"ltr"},{name:"Turkish",i18nCode:"tr",direction:"ltr"},{name:"Ukrainian",i18nCode:"uk",direction:"ltr"},{name:"Vietnamese",i18nCode:"vi",direction:"ltr"}],kj=Aj.map(t=>t.i18nCode);function wue(t){return fw(t)[0]??t}async function xj(t={}){const e=Nt.use(wj).use(HB);return be.instance().config().useI18nHttpApi&&H(()=>import("./index-CCeFp6kA.js"),__vite__mapDeps([218,2,1])).then(n=>{e.use(n.default)}),e.init({supportedLngs:Aj.map(({i18nCode:n})=>n),fallbackLng:fw,detection:{convertDetectedLanguage:wue,...t},interpolation:{escapeValue:!1}}).then(async n=>(await Aue(Nt.language),Nt.on("languageChanged",r=>{typeof document<"u"&&(document.body.dir=Nt.dir(r.toLowerCase()),document.documentElement.lang=r.toLowerCase())}),n))}async function Aue(t){t&&(await Promise.all(fw(t).map(async e=>{try{const n=await hue(Object.assign({"../../config/strings/af/strings.json":()=>H(()=>import("./strings-C4DfrpIH.js"),[]),"../../config/strings/am/strings.json":()=>H(()=>import("./strings-BpXVVsKb.js"),[]),"../../config/strings/ar/strings.json":()=>H(()=>import("./strings-CD2M07gQ.js"),[]),"../../config/strings/as/strings.json":()=>H(()=>import("./strings-BodKIxqd.js"),[]),"../../config/strings/az/strings.json":()=>H(()=>import("./strings-DCQ4jX19.js"),[]),"../../config/strings/bg/strings.json":()=>H(()=>import("./strings-DkAelXgr.js"),[]),"../../config/strings/bn-IN/strings.json":()=>H(()=>import("./strings-CSOd3ipW.js"),[]),"../../config/strings/bs/strings.json":()=>H(()=>import("./strings-TQ_hu9qy.js"),[]),"../../config/strings/ca-Es-VALENCIA/strings.json":()=>H(()=>import("./strings-B06EIKnV.js"),[]),"../../config/strings/ca/strings.json":()=>H(()=>import("./strings-Cma-gTtb.js"),[]),"../../config/strings/cs/strings.json":()=>H(()=>import("./strings-qKdyucSB.js"),[]),"../../config/strings/cy/strings.json":()=>H(()=>import("./strings-DrvKr0uH.js"),[]),"../../config/strings/da/strings.json":()=>H(()=>import("./strings-ClPX55Yn.js"),[]),"../../config/strings/de/strings.json":()=>H(()=>import("./strings-BpiyH06o.js"),[]),"../../config/strings/el/strings.json":()=>H(()=>import("./strings-C6puhnIU.js"),[]),"../../config/strings/en-GB/strings.json":()=>H(()=>import("./strings-4CXeAsGy.js"),[]),"../../config/strings/en-US/strings.json":()=>H(()=>import("./strings-DJO2jmkB.js"),[]),"../../config/strings/es-MX/strings.json":()=>H(()=>import("./strings-CKTzPYxv.js"),[]),"../../config/strings/es/strings.json":()=>H(()=>import("./strings-C_luxqXL.js"),[]),"../../config/strings/et/strings.json":()=>H(()=>import("./strings-KwikTMSS.js"),[]),"../../config/strings/eu/strings.json":()=>H(()=>import("./strings-BbryCM1t.js"),[]),"../../config/strings/fa/strings.json":()=>H(()=>import("./strings-DXR41M46.js"),[]),"../../config/strings/fi/strings.json":()=>H(()=>import("./strings-BtebariZ.js"),[]),"../../config/strings/fil/strings.json":()=>H(()=>import("./strings-NbiyZqdK.js"),[]),"../../config/strings/fr-CA/strings.json":()=>H(()=>import("./strings-A5uqI2qt.js"),[]),"../../config/strings/fr/strings.json":()=>H(()=>import("./strings-DX3cxPl2.js"),[]),"../../config/strings/ga/strings.json":()=>H(()=>import("./strings-_9S0orL1.js"),[]),"../../config/strings/gd/strings.json":()=>H(()=>import("./strings-BG9j7M4u.js"),[]),"../../config/strings/gl/strings.json":()=>H(()=>import("./strings-BTpnXuo5.js"),[]),"../../config/strings/gu/strings.json":()=>H(()=>import("./strings-BGr0SEJd.js"),[]),"../../config/strings/he/strings.json":()=>H(()=>import("./strings-CGZUwHcd.js"),[]),"../../config/strings/hi/strings.json":()=>H(()=>import("./strings-DU_zi3wO.js"),[]),"../../config/strings/hr/strings.json":()=>H(()=>import("./strings-CvPZwskf.js"),[]),"../../config/strings/hu/strings.json":()=>H(()=>import("./strings-BrZcevGm.js"),[]),"../../config/strings/hy/strings.json":()=>H(()=>import("./strings-BCkASrJ5.js"),[]),"../../config/strings/id/strings.json":()=>H(()=>import("./strings-BRu-hTKS.js"),[]),"../../config/strings/is/strings.json":()=>H(()=>import("./strings-BD3UpJYZ.js"),[]),"../../config/strings/it/strings.json":()=>H(()=>import("./strings-CkOB97PC.js"),[]),"../../config/strings/ja/strings.json":()=>H(()=>import("./strings-DR4fS5d6.js"),[]),"../../config/strings/ka/strings.json":()=>H(()=>import("./strings-DbhXnBbE.js"),[]),"../../config/strings/kk/strings.json":()=>H(()=>import("./strings-ePHdTRNU.js"),[]),"../../config/strings/km-KH/strings.json":()=>H(()=>import("./strings-C5Mn4pdb.js"),[]),"../../config/strings/kn/strings.json":()=>H(()=>import("./strings-tdNJW-9O.js"),[]),"../../config/strings/ko/strings.json":()=>H(()=>import("./strings-DcatI0Ga.js"),[]),"../../config/strings/kok/strings.json":()=>H(()=>import("./strings-EXmU_r0_.js"),[]),"../../config/strings/lb/strings.json":()=>H(()=>import("./strings-CHa3bkQM.js"),[]),"../../config/strings/lo/strings.json":()=>H(()=>import("./strings-_h769Kp7.js"),[]),"../../config/strings/lt/strings.json":()=>H(()=>import("./strings-Bps1wMik.js"),[]),"../../config/strings/lv/strings.json":()=>H(()=>import("./strings-SHug2P6X.js"),[]),"../../config/strings/mi/strings.json":()=>H(()=>import("./strings-B07jJVEu.js"),[]),"../../config/strings/mk/strings.json":()=>H(()=>import("./strings-wQuOZ9Ti.js"),[]),"../../config/strings/ml/strings.json":()=>H(()=>import("./strings-xmwSUwAx.js"),[]),"../../config/strings/mr/strings.json":()=>H(()=>import("./strings-Bmd6Z_0o.js"),[]),"../../config/strings/ms/strings.json":()=>H(()=>import("./strings-BHdaMIn9.js"),[]),"../../config/strings/mt/strings.json":()=>H(()=>import("./strings-00tD2-BW.js"),[]),"../../config/strings/nb-NO/strings.json":()=>H(()=>import("./strings-Dr4Fq7r-.js"),[]),"../../config/strings/ne/strings.json":()=>H(()=>import("./strings-EcYvmTnv.js"),[]),"../../config/strings/nl/strings.json":()=>H(()=>import("./strings-CXfRemly.js"),[]),"../../config/strings/nn-NO/strings.json":()=>H(()=>import("./strings-CFTFeRr7.js"),[]),"../../config/strings/or/strings.json":()=>H(()=>import("./strings-h9T6wmwS.js"),[]),"../../config/strings/pa/strings.json":()=>H(()=>import("./strings-9Mx6apt5.js"),[]),"../../config/strings/pl/strings.json":()=>H(()=>import("./strings-BeKc6rnS.js"),[]),"../../config/strings/pt-BR/strings.json":()=>H(()=>import("./strings-TaPgvaR8.js"),[]),"../../config/strings/pt-PT/strings.json":()=>H(()=>import("./strings-TjjS_8BR.js"),[]),"../../config/strings/quz/strings.json":()=>H(()=>import("./strings-oFLWMaVl.js"),[]),"../../config/strings/ro/strings.json":()=>H(()=>import("./strings-CbQbxERK.js"),[]),"../../config/strings/ru/strings.json":()=>H(()=>import("./strings-Ddd0xhWF.js"),[]),"../../config/strings/sk/strings.json":()=>H(()=>import("./strings-Csc3GfuC.js"),[]),"../../config/strings/sl/strings.json":()=>H(()=>import("./strings-CtcsOath.js"),[]),"../../config/strings/sq/strings.json":()=>H(()=>import("./strings-CAdh2XXG.js"),[]),"../../config/strings/sr-Cyrl-BA/strings.json":()=>H(()=>import("./strings-Blep6vy9.js"),[]),"../../config/strings/sr-Cyrl-RS/strings.json":()=>H(()=>import("./strings-CdBGAGEw.js"),[]),"../../config/strings/sr-Latn-RS/strings.json":()=>H(()=>import("./strings-C_E4_LHE.js"),[]),"../../config/strings/sv/strings.json":()=>H(()=>import("./strings-BgtfLdX3.js"),[]),"../../config/strings/ta/strings.json":()=>H(()=>import("./strings-B-RQxkDl.js"),[]),"../../config/strings/te/strings.json":()=>H(()=>import("./strings-lSFCcR76.js"),[]),"../../config/strings/th/strings.json":()=>H(()=>import("./strings-Cm-u5k-z.js"),[]),"../../config/strings/tr/strings.json":()=>H(()=>import("./strings-DU9YonXx.js"),[]),"../../config/strings/tt/strings.json":()=>H(()=>import("./strings-CpqS7F3v.js"),[]),"../../config/strings/ug/strings.json":()=>H(()=>import("./strings-Puuf7sNI.js"),[]),"../../config/strings/uk/strings.json":()=>H(()=>import("./strings-v7Lhb8Fc.js"),[]),"../../config/strings/ur/strings.json":()=>H(()=>import("./strings-DYC0mzhM.js"),[]),"../../config/strings/uz-Latn-UZ/strings.json":()=>H(()=>import("./strings-DwSCKolp.js"),[]),"../../config/strings/vi/strings.json":()=>H(()=>import("./strings-YfaUcEjf.js"),[]),"../../config/strings/zh-Hans/strings.json":()=>H(()=>import("./strings-CoZGSI1u.js"),[]),"../../config/strings/zh-Hant/strings.json":()=>H(()=>import("./strings-DsrKionv.js"),[])}),`../../config/strings/${e}/strings.json`,6);Nt.addResourceBundle(e,"translation",n,!0,!0)}catch{console.warn(`Translation file for '${e}' not found.`)}})),await Nt.changeLanguage(t))}function hRe(){return Nt.resolvedLanguage?Nt.resolvedLanguage.split("-")[0]==="en":!1}function fw(t){const e="en-US";if(!t)return[e];const n=kue(t),r=xue(t),o=Rue(t);return[n,r,o,e].filter(i=>!!i).filter((i,s,a)=>a.indexOf(i)===s)}function kue(t){return kj.find(e=>e.toLowerCase()===t.toLowerCase())}function xue(t){if(["en-AU","en-NZ","en-IE"].includes(t))return"en-GB";if(t.startsWith("zh-")){const e=t.toLocaleLowerCase();return e==="zh-TW".toLocaleLowerCase()||e==="zh-HK".toLocaleLowerCase()?"zh-Hant":"zh-Hans"}}function Rue(t){var n;const e=(n=t.split("-")[0])==null?void 0:n.toLowerCase();if(e){const r=kj.find(o=>o.toLowerCase()===e||o.toLowerCase().startsWith(`${e}-`));if(r)return r}}async function Nue(t){try{return(await qn(`/conversations/${t}/history`,X5,{analytics:{anonymousPath:"/conversations/*/history"}}).then(n=>n.data)).results.length>0}catch{return!1}}function Rj(){const t=Ft();return Nj(t)}function Nj(t){return/^\/shares\/[a-zA-Z0-9_-]+$/.test(t)}async function Pue(t){const{conversationIdFromUrl:e,conversationIdFromStart:n}=t;return e&&e!=="new"&&await Nue(e)?{conversationId:e,isNew:!1}:n?{conversationId:n,isNew:!0}:{conversationId:null,isNew:!0}}async function Mue(t){const{pathname:e,conversationIdFromUrl:n,conversationFromUrlExists:r,urlPrompt:o,features:i,isBanned:s,enablePageRedirect:a,deepLinkTarget:c,search:u}=t;if(!a||s||cw(i)||navigator.userAgent.toLowerCase().includes("googlebot")&&e==="/")return null;if(o||n==="new")return{to:c==="audioCall"?"/chats/$conversationId/talk":"/chats/$conversationId",from:e,needsConversationId:!0};if(e.startsWith("/shares"))return e.startsWith("/shares/pages")?i.includes("pages")&&!i.includes("kill-shared-page")?null:Ln(e):e.startsWith("/shares/podcasts")?null:i.includes("kill-share-conversation")||!Nj(e)?Ln(e):null;if(e.startsWith("/campaigns"))if(e.startsWith("/campaigns/gallery")){if(!i.includes("share-campaign-gallery"))return Ln(e)}else if(e.startsWith("/campaigns/image-expression-tool")){if(!i.includes("gallery-expression-tool"))return Ln(e)}else return i.includes("share-campaign")?null:Ln(e);if(["/pro/subscribe","/pro/ewallet/return"].includes(e)||e==="/fang")return null;if(e.startsWith("/referrals")&&!i.includes("user-referral")||e.startsWith("/subscription")&&!i.includes("cmc-m365-sku"))return Ln(e);if(e.startsWith("/memory/narrative"))return i.includes("memory-narrative")?null:Ln(e);if(e.endsWith("/talk"))return e.startsWith("/labs/experiments/portrait/talk")?{from:e,to:"/labs/experiments/portrait",needsConversationId:!1}:Ln(e);if(e.startsWith("/chats")&&!r)return Ln(e);if(e.startsWith("/pages"))return i.includes("pages")?null:Ln(e);if(e.startsWith("/labs")&&(e.startsWith("/labs/experiments")&&(e.startsWith("/labs/experiments/3d-generations")&&!i.includes("labs-3d-generations")||e.startsWith("/labs/experiments/portrait")&&!i.includes("labs-portrait-enabled"))||!i.includes("labs-landing"))||e.startsWith("/login"))return Ln(e);if(e.startsWith("/podcasts"))return e.startsWith("/podcasts/user")||e.startsWith("/podcasts/public")?null:Ln(e);if(e.startsWith("/library")&&!i.includes("library"))return Ln(e);if(e.includes("/w/landing"))return i.includes("cmc-landing")?null:Ln(e);if(e==="/"){if(i.includes("start-in-voice"))return null;const h=u==null?void 0:u.get("back");return Oue(h)&&be.instance().config().redirectBackEnabled?{from:"/login",to:new URL(h).pathname,needsConversationId:!1}:Ln(e)}return e.startsWith("/gallery")?i.includes("creator-gallery")?null:Ln(e):null}function Oue(t){if(!t)return!1;try{if(new URL(t).origin===window.location.origin)return!0;throw new Error("Invalid redirect URL: not from same origin")}catch{throw new Error("Invalid redirect URL, malformed URL")}}function Ln(t){return be.instance().config().neverStartInChat?{from:t,to:"/"}:{from:t,to:"/chats/$conversationId",needsConversationId:!0}}function Lue(){try{const{timeZone:t}=Intl.DateTimeFormat().resolvedOptions();return t}catch{return}}function Due(t){return e=>{const r=(t?Math[t]:Math.trunc)(e);return r===0?0:r}}const jue=864e5,fRe=6e4,Uue=36e5,pRe=43200,mRe=1440,gRe=60;function Fue(t,e){return+cn(t)-+cn(e)}function Bue(t,e,n){const r=Fue(t,e)/Uue;return Due(n==null?void 0:n.roundingMethod)(r)}function pw(t){if(!t)return null;let e=null;const n=new Date(t).toISOString(),r=new Date().toISOString(),o=Bue(n,r,{roundingMethod:"ceil"});return o>24?e="permanent":o>1&&o<=24?e="24-hr":o>0&&o<=1&&(e="1-hr"),e}function mw(t,e,n){if(!t){$r(Y0);return}const r=st();z.trackEvent({name:"system",data:{eventName:"copilotUserBan",eventInfo_banDuration:t,eventInfo_banSource:e,eventInfo_banExpiryTimestamp:n}}),r.set(fL,t),r.set(_f,"user-banned")}const Hue=o$(),K2=1e4;function zue(){return setTimeout(()=>{xr({feature:"start",scenario:"callStartTimeout",errorType:"timeout",errorMessage:`Start call exceeded ${K2}ms timeout`})},K2)}async function Vue(t){let e=ci("sessionId");const n=ci("referralCode");!e&&n&&(e=crypto.randomUUID(),pa("sessionId",e));const r=sue(),o={timeZone:Lue(),startNewConversation:!0,teenSupportEnabled:!0,deviceFingerprint:e??void 0,referralCode:n??void 0,correctPersonalizationSetting:!0,performUserMerge:r},i={};Hue&&(i.overrideFeatures="1");const{data:s,response:a,zodError:c}=await qn(t,zY,{options:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},parseOptions:{safe:!0},query:i});if(fb.trackClientExperimentationAssignment(a.headers),a.status===LI)throw new Error(DI);if(c)throw c;return s}function Pj(){const{i18n:t}=Oe(),{showBoundary:e}=UM(),n=Ee(_f),r=Ee(KM),o=Ee(En),i=Ee(VI),s=Ee(Ac),a=Ee(pt),c=Ee(mL),u=Ee(zI),h=pi(),[p]=gy(),f=Ft(),g=m.useRef(f);g.current=f;const v=cI({strict:!1}),y=m.useRef(v);y.current=v;const b=m.useRef(JV()),C=L(Ip),S=m.useRef(C);S.current=C;const E=m.useRef(!0),I=m.useRef(!1),{trigger:T}=NI("/start",Vue);return m.useCallback(async _=>{var R;if(!t.language||I.current&&!_.eventDriven)return!1;I.current=!0;const w=Hle(),{enablePageRedirect:A,overwriteData:M}=_;try{const $=zue(),{isNewUser:V,banExpiresAt:ie,remainingTurns:N,features:Y,currentConversationId:ue,allowBeta:j}=await T();clearTimeout($),await xj(),Mt.emit("app:start-complete"),z.setFeatures(Y),z.setIsNewUser(V),AE({isNewUser:V.toString()});const U=uj({featureOverrides:[],localFeatureOverrides:dj(),serverFeatures:Y,surfaceConfig:be.instance().config()});U.includes("eager-msal")&&(ei(Z0,l.boolean(),!0),U.includes("msal-silent-sso")&&ei(NO,l.boolean(),!0)),U.includes("kill-eager-msal")&&$r(Z0),U.includes("auth-module-refactor")?ei(Uk,l.boolean(),!0):$r(Uk),U.includes("auth-rf-init-auth-account")?ei(t1,l.boolean(),!0):$r(t1),U.includes("auth-rf-msal-event-removal")?ei(n1,l.boolean(),!0):$r(n1);const te=pw(ie),Q=cw(U),re=await Pue({conversationIdFromUrl:Q?void 0:y.current.conversationId,conversationIdFromStart:Q?void 0:ue});let{conversationId:Z}=re;if(!Z){const{id:ye}=await bj("/conversations",{arg:{isPrivate:Q}});Z=ye,Q&&i(ye)}const _e=await Mue({pathname:g.current,conversationIdFromUrl:y.current.conversationId,conversationFromUrlExists:y.current.conversationId===Z,urlPrompt:((R=S.current)==null?void 0:R.prompt)??null,features:U,enablePageRedirect:A,isBanned:!!te,deepLinkTarget:p,search:new URLSearchParams(window.location.search)});o(ye=>{if(!M&&ye.size>0)return ye;const Se=new Map([[Z,{id:Z,updatedAt:new Date().toISOString(),history:[],isNew:re.isNew,characterId:null,streamingState:"idle",continuedAt:null}]]);return!re.isNew&&ue&&Se.set(ue,{id:ue,updatedAt:new Date().toISOString(),history:[],isNew:!0,characterId:null,streamingState:"idle",continuedAt:null}),Se}),a(ye=>ye&&!M?ye:Z),r(ye=>ye.length>0&&!M?ye:U),s(N),c(V),u(j??!1),j&&lue(),mw(te,"start",ie),E.current&&(E.current=!1,_e&&await h({..._e,params:_e.needsConversationId?{conversationId:Z}:{},search:b.current}))}catch($){if(z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"StartEndpointError",eventInfo_errorMessage:$ instanceof Error?$.message:"",eventInfo_details:$ instanceof Error?$.stack??"":""}}),$ instanceof Error&&$.message===DI)return n("age-verification"),!0;console.error($),e($)}finally{uue(!1)}return!0},[T,o,a,i,n,r,s,c,u,h,t.language,e,p])}const q2=Yc.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)}),WS={dedupe:!0},$ue=(t,e,n)=>{const{cache:r,compare:o,suspense:i,fallbackData:s,revalidateOnMount:a,revalidateIfStale:c,refreshInterval:u,refreshWhenHidden:h,refreshWhenOffline:p,keepPreviousData:f}=n,[g,v,y,b]=ko.get(r),[C,S]=Es(t),E=m.useRef(!1),I=m.useRef(!1),T=m.useRef(C),_=m.useRef(e),w=m.useRef(n),A=()=>w.current,M=()=>A().isVisible()&&A().isOnline(),[R,$,V,ie]=xi(r,C),N=m.useRef({}).current,Y=Fe(s)?n.fallback[C]:s,ue=(P,J)=>{for(const Te in N){const O=Te;if(O==="data"){if(!o(P[O],J[O])&&(!Fe(P[O])||!o(Se,J[O])))return!1}else if(J[O]!==P[O])return!1}return!0},j=m.useMemo(()=>{const P=!C||!e?!1:Fe(a)?A().isPaused()||i?!1:Fe(c)?!0:c:a,J=K=>{const pe=ho(K);return delete pe._k,P?{isValidating:!0,isLoading:!0,...pe}:pe},Te=R(),O=ie(),ce=J(Te),se=Te===O?ce:J(O);let ne=ce;return[()=>{const K=J(R());return ue(K,ne)?(ne.data=K.data,ne.isLoading=K.isLoading,ne.isValidating=K.isValidating,ne.error=K.error,ne):(ne=K,K)},()=>se]},[r,C]),U=rb.useSyncExternalStore(m.useCallback(P=>V(C,(J,Te)=>{ue(Te,J)||P()}),[r,C]),j[0],j[1]),te=!E.current,Q=g[C]&&g[C].length>0,re=U.data,Z=Fe(re)?Y:re,_e=U.error,ye=m.useRef(Z),Se=f?Fe(re)?ye.current:re:Z,Ne=Q&&!Fe(_e)?!1:te&&!Fe(a)?a:A().isPaused()?!1:i?Fe(Z)?!1:c:Fe(Z)||c,we=!!(C&&e&&te&&Ne),Ke=Fe(U.isValidating)?we:U.isValidating,de=Fe(U.isLoading)?we:U.isLoading,ge=m.useCallback(async P=>{const J=_.current;if(!C||!J||I.current||A().isPaused())return!1;let Te,O,ce=!0;const se=P||{},ne=!y[C]||!se.dedupe,K=()=>Tc?!I.current&&C===T.current&&E.current:C===T.current,pe={isValidating:!1,isLoading:!1},He=()=>{$(pe)},at=()=>{const Le=y[C];Le&&Le[1]===O&&delete y[C]},ut={isValidating:!0};Fe(R().data)&&(ut.isLoading=!0);try{if(ne&&($(ut),n.loadingTimeout&&Fe(R().data)&&setTimeout(()=>{ce&&K()&&A().onLoadingSlow(C,n)},n.loadingTimeout),y[C]=[J(S),_c()]),[Te,O]=y[C],Te=await Te,ne&&setTimeout(at,n.dedupingInterval),!y[C]||y[C][1]!==O)return ne&&K()&&A().onDiscarded(C),!1;pe.error=mn;const Le=v[C];if(!Fe(Le)&&(O<=Le[0]||O<=Le[1]||Le[1]===0))return He(),ne&&K()&&A().onDiscarded(C),!1;const Xe=R().data;pe.data=o(Xe,Te)?Xe:Te,ne&&K()&&A().onSuccess(Te,C,n)}catch(Le){at();const Xe=A(),{shouldRetryOnError:St}=Xe;Xe.isPaused()||(pe.error=Le,ne&&K()&&(Xe.onError(Le,C,Xe),(St===!0||Tr(St)&&St(Le))&&(!A().revalidateOnFocus||!A().revalidateOnReconnect||M())&&Xe.onErrorRetry(Le,C,Xe,Ut=>{const Gt=g[C];Gt&&Gt[0]&&Gt[0](_r.ERROR_REVALIDATE_EVENT,Ut)},{retryCount:(se.retryCount||0)+1,dedupe:!0})))}return ce=!1,He(),!0},[C,r]),$e=m.useCallback((...P)=>ib(r,T.current,...P),[]);if(Mo(()=>{_.current=e,w.current=n,Fe(re)||(ye.current=re)}),Mo(()=>{if(!C)return;const P=ge.bind(mn,WS);let J=0;const O=RI(C,g,(ce,se={})=>{if(ce==_r.FOCUS_EVENT){const ne=Date.now();A().revalidateOnFocus&&ne>J&&M()&&(J=ne+A().focusThrottleInterval,P())}else if(ce==_r.RECONNECT_EVENT)A().revalidateOnReconnect&&M()&&P();else{if(ce==_r.MUTATE_EVENT)return ge();if(ce==_r.ERROR_REVALIDATE_EVENT)return ge(se)}});return I.current=!1,T.current=C,E.current=!0,$({_k:S}),Ne&&(Fe(Z)||Ss?P():wI(P)),()=>{I.current=!0,O()}},[C]),Mo(()=>{let P;function J(){const O=Tr(u)?u(R().data):u;O&&P!==-1&&(P=setTimeout(Te,O))}function Te(){!R().error&&(h||A().isVisible())&&(p||A().isOnline())?ge(WS).then(J):J()}return J(),()=>{P&&(clearTimeout(P),P=-1)}},[u,h,p,C]),m.useDebugValue(Se),i&&Fe(Z)&&C){if(!Tc&&Ss)throw new Error("Fallback data is required when using suspense in SSR.");_.current=e,w.current=n,I.current=!1;const P=b[C];if(!Fe(P)){const J=$e(P);q2(J)}if(Fe(_e)){const J=ge(WS);Fe(Se)||(J.status="fulfilled",J.value=!0),q2(J)}else throw _e}return{mutate:$e,get data(){return N.data=!0,Se},get error(){return N.error=!0,_e},get isValidating(){return N.isValidating=!0,Ke},get isLoading(){return N.isLoading=!0,de}}},hl=xI($ue);function Gue(){const{cache:t,mutate:e}=kI(),n=m.useCallback(async()=>{for(const o of t.keys())await e(o,void 0,{revalidate:!1})},[t,e]),r=m.useCallback(async o=>{await e(o,void 0,{revalidate:!1})},[e]);return{clearAllSWRCache:n,clearOneSWRCache:r}}function Kue(){$r(PO)}function Bd(){const t=Pj(),e=Ft(),n=pi(),{clearAllSWRCache:r}=Gue(),o=async a=>{const{provider:c,opts:u={},onAuthComplete:h,onAuthError:p}=a;await ks.instance().logIn(c,u).catch(f=>{console.error(f),p==null||p()})},i=async(a=!0)=>{await r(),Kue(),iue(),await ks.instance().logOut().then(async()=>{a&&(await n({to:"/",from:e}),await t({enablePageRedirect:!1,overwriteData:!0}))})};return{login:o,logout:i,switchMicrosoftAccount:async()=>{await i(),await o({provider:"microsoft"})}}}function que({accountActionRequired:t,onReload:e}){const{t:n}=Oe(),r=Qc(),{login:o}=Bd(),{reason:i,provider:s,loginHint:a}=t,c=async f=>{ht({source:"sessionExpired",scenario:"continueWithMicrosoftWithLoginHint",destination:"continueWithMicrosoftRedirect"}),MC({authWorkflowAccountType:"microsoft",apiName:"msal:reauthStart"});const{msal:g}=await hr.get();await g.acquireTokenRedirect({...II,loginHint:f,account:g.getAccountByUsername(f)??void 0,prompt:void 0})},u=async()=>{if(i==="token-expired"&&t.provider==="microsoft"){const{msal:f}=await hr.get();if(!We("auth-rf-logout-clear"))await f.clearCache();else{const g=f.getActiveAccount();await f.clearCache({account:g})}}},h=async(f,g)=>{await u();let v="";switch(f==="microsoft"?(v="MSA",MC({authWorkflowAccountType:"microsoft",apiName:"msal:reauthStart"})):f==="auth0"&&(v=(g==null?void 0:g.connection)==="apple"?"Apple":"Google",MC({authWorkflowAccountType:(g==null?void 0:g.connection)??"google",apiName:io.REAUTH_START})),ht({source:"sessionExpired",scenario:`continueWith${v}`,destination:`continueWith${v}Redirect`}),f){case"microsoft":o({provider:f});break;case"auth0":o({provider:f,opts:g});break}},p=async()=>{Tn({source:"signin",scenario:"sessionExpired"}),await u(),o({provider:"microsoft"})};return d.jsxs(d.Fragment,{children:[d.jsx("h1",{className:"pb-3 text-lg",children:n("authentication.sessionExpired")}),d.jsx("p",{className:"pb-7",children:n("authentication.sessionExpiredMessage")}),i==="token-expired"&&s==="microsoft"&&a&&d.jsx(Me,{onClick:()=>c(a),title:`${n("signInPrompt.continueAs",{name:a})}`,variant:"pill",size:"48-lg",className:"w-full",children:`${n("signInPrompt.continueAs",{name:a})}`}),r?d.jsxs(d.Fragment,{children:[d.jsxs(Me,{onClick:()=>h("microsoft"),title:n("signInPrompt.continueWithMicrosoft"),variant:"pill",size:"48-lg",className:"mt-3 w-full",children:[d.jsx(nb,{className:"size-6"}),n("signInPrompt.continueWithMicrosoft")]}),d.jsxs(Me,{onClick:()=>h("auth0",{connection:"apple"}),title:n("signInPrompt.continueWithApple"),variant:"pill",size:"48-lg",className:"mt-3 w-full",children:[d.jsx(SI,{className:"size-6 text-black dark:text-white"}),n("signInPrompt.continueWithApple")]}),d.jsxs(Me,{onClick:()=>h("auth0",{connection:"google"}),title:n("signInPrompt.continueWithGoogle"),variant:"pill",size:"48-lg",className:"mt-3 w-full",children:[d.jsx(EI,{className:"size-6"}),n("signInPrompt.continueWithGoogle")]})]}):d.jsx(Me,{onClick:p,title:n("common.loginText"),variant:"pill",size:"48-lg",className:"mt-3 w-full",children:n("common.loginText")}),d.jsx(Me,{onClick:e,title:n("signInPrompt.continueWithoutSignIn"),variant:"pill",color:"subtle-dimmed-inverted",size:"48-lg",className:"mt-3 w-full",children:n("signInPrompt.continueWithoutSignIn")})]})}const Cy={type:"spring",mass:2.8,stiffness:280,damping:40},Wue={type:"spring",mass:1.8,stiffness:320,damping:40},vRe={type:"spring",mass:1.8,stiffness:440,damping:40},kE={type:"spring",mass:1.4,stiffness:320,damping:40},Mj={type:"spring",mass:1,stiffness:1200,damping:40},Oj={type:"spring",mass:1.8,stiffness:640,damping:40},bRe={type:"spring",mass:3.2,stiffness:640,damping:40},jo={type:"spring",mass:1,stiffness:280,damping:40},W2={duration:1.2,ease:"easeInOut",repeat:3,repeatType:"reverse",type:"tween"},Lj=.2,Dj=.25,Yue=1.5,Que=[.16,1,.3,1];function Jue(t,e){const{children:n,id:r,role:o,className:i,mode:s="wait",duration:a=Oo.default,exitDuration:c=Oo.default,exitDelay:u=0,delay:h=0,delayChildren:p=0,onAnimationComplete:f,"data-testid":g,initial:v="initial"}=t;return d.jsx(Pn,{mode:s,children:n&&d.jsx(Re.div,{animate:"animate",exit:"exit",ref:e,role:o,initial:v,variants:{initial:dt,animate:Ot,exit:{...dt,transition:{duration:c,delay:u}}},transition:{duration:a,ease:"easeInOut",delay:h,delayChildren:p},className:i,onAnimationComplete:f,"data-testid":g,children:n},r)})}const Fn=m.forwardRef(Jue),wp=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M4.20889 10.7327C3.9232 11.0326 3.93475 11.5074 4.23467 11.7931C4.5346 12.0788 5.00933 12.0672 5.29502 11.7673L11.2495 5.516V20.25C11.2495 20.6642 11.5853 21 11.9995 21C12.4137 21 12.7495 20.6642 12.7495 20.25V5.51565L18.7043 11.7673C18.99 12.0672 19.4648 12.0788 19.7647 11.7931C20.0646 11.5074 20.0762 11.0326 19.7905 10.7327L12.7238 3.31379C12.5627 3.14474 12.3573 3.04477 12.1438 3.01386C12.0971 3.00477 12.0489 3 11.9995 3C11.9498 3 11.9012 3.00483 11.8543 3.01406C11.6412 3.04518 11.4363 3.14509 11.2756 3.31379L4.20889 10.7327Z"})),yRe=Object.freeze(Object.defineProperty({__proto__:null,default:wp},Symbol.toStringTag,{value:"Module"})),fo=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M4.39705 4.55379L4.46967 4.46967C4.73594 4.2034 5.1526 4.1792 5.44621 4.39705L5.53033 4.46967L12 10.939L18.4697 4.46967C18.7626 4.17678 19.2374 4.17678 19.5303 4.46967C19.8232 4.76256 19.8232 5.23744 19.5303 5.53033L13.061 12L19.5303 18.4697C19.7966 18.7359 19.8208 19.1526 19.6029 19.4462L19.5303 19.5303C19.2641 19.7966 18.8474 19.8208 18.5538 19.6029L18.4697 19.5303L12 13.061L5.53033 19.5303C5.23744 19.8232 4.76256 19.8232 4.46967 19.5303C4.17678 19.2374 4.17678 18.7626 4.46967 18.4697L10.939 12L4.46967 5.53033C4.2034 5.26406 4.1792 4.8474 4.39705 4.55379L4.46967 4.46967L4.39705 4.55379Z",fill:"currentColor"})),CRe=Object.freeze(Object.defineProperty({__proto__:null,default:fo},Symbol.toStringTag,{value:"Module"}));function Sy(){const[t,e]=m.useState(document.body.dir==="rtl");return m.useEffect(()=>{const n=new MutationObserver(()=>{e(document.body.dir==="rtl")});return n.observe(document.body,{attributes:!0,attributeFilter:["dir"]}),()=>n.disconnect()},[]),t}const YS=Oo.default,fi=m.forwardRef((t,e)=>{const{isOpen:n,onBack:r,headerText:o,children:i,onClose:s,className:a,disableCloseOutside:c,headerTextClassName:u,headerClassName:h,trapFocus:p=!1,variant:f="modal"}=t,{t:g}=Oe(),v=m.useId(),{modalAttributes:y}=_M({trapFocus:p,legacyTrapFocus:p,alwaysFocusable:p}),b=p?y:{},C=Sy()?-1:1,S=_=>{(c??!s)||_.target===_.currentTarget&&s()},E=_=>{_.stopPropagation()},I=f==="drawer",T=I?{initial:{x:`${C*100}%`},animate:{x:0,transition:kE},exit:{x:`${C*100}%`,transition:{duration:YS}}}:void 0;return d.jsx(Fn,{id:String(n),mode:"sync",duration:YS,exitDuration:YS,className:q("fixed inset-0",Xt.modal),children:n&&d.jsxs("div",{...b,role:"dialog","aria-modal":"true","aria-labelledby":o?v:void 0,children:[d.jsx("div",{className:q("fixed inset-0 bg-stone-850/30 backdrop-blur-[10px] dark:bg-midnight-850/70",Xt.modalBackground)}),d.jsx("div",{className:q("fixed inset-0 flex",I?"items-start justify-end":"items-center justify-center",Xt.modal),onClick:S,children:d.jsxs(Re.div,{...T,className:nt("t-custom-scrollbar flex flex-col gap-3 border border-white/10 bg-background-150 p-6 shadow-xl dark:bg-background-250",I?"h-full w-96":"min-h-[150px] rounded-4xl",a),onClick:E,ref:_=>{typeof e=="function"?e(_):e&&(e.current=_)},children:[d.jsxs("div",{className:q("flex items-center justify-between gap-2",h),children:[r&&d.jsx(Me,{variant:"square",color:"subtle-dimmed-inverted",size:"32-xs",title:g("common.backText"),"aria-label":g("common.backText"),onClick:r,children:d.jsx(wp,{className:"size-5 -rotate-90"})}),o&&d.jsx("h2",{id:v,className:q("text-foreground-800 text-md-strong",u),children:o}),s&&d.jsx(Me,{className:!r&&!o?"ms-auto":"",variant:"square",color:"subtle-dimmed-inverted",size:"32-xs",title:g("common.closeText"),"aria-label":g("common.closeText"),onClick:s,children:d.jsx(fo,{className:"size-5"})})]}),i]})})]})})});fi.displayName="Modal";function jj(t){const{accountActionRequired:e}=t;return d.jsx(fi,{isOpen:!0,children:d.jsx(Zue,{accountActionRequired:e})})}function Zue(t){const{accountActionRequired:e}=t,{reason:n}=e;m.useEffect(()=>{z.trackEvent({name:"system",data:{eventName:"copilotWebBackgroundAccountChange",eventInfo_action:"shown",eventInfo_reason:n}})},[n]);const r=async()=>{if(z.trackEvent({name:"system",data:{eventName:"copilotWebBackgroundAccountChange",eventInfo_action:"reload",eventInfo_reason:n}}),n==="token-expired"&&e.provider==="microsoft"){const{msal:o}=await hr.get();if(!We("auth-rf-logout-clear"))await o.clearCache();else{const i=o.getActiveAccount();await o.clearCache({account:i})}}_p()};return n==="login"||n==="logout"?d.jsx("div",{className:"flex max-w-72 flex-col items-center p-1 text-center",children:d.jsx(xz,{reason:n,onReload:r})}):d.jsx("div",{className:"flex max-w-96 flex-col items-center p-1 text-center",children:d.jsx(que,{accountActionRequired:e,onReload:r})})}function Xue(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function ede(t){if(!Xue(t)&&typeof t!="number")return!1;const e=cn(t);return!isNaN(Number(e))}function Uj(t,e){const n=cn(t);if(isNaN(e))return q0(t,NaN);if(!e)return n;const r=n.getDate(),o=q0(t,n.getTime());o.setMonth(n.getMonth()+e+1,0);const i=o.getDate();return r>=i?o:(n.setFullYear(o.getFullYear(),o.getMonth(),r),n)}function tde(t,e){return Uj(t,e*12)}function nde(t,e){return tde(t,-13)}function Ec(t,e,n="en-US"){var o,i;let r;if(t instanceof Date)r=t;else if(typeof t=="number")r=new Date(t<1e12?t*1e3:t);else if(typeof t=="string")r=new Date(t);else throw new Error(`Invalid date input: ${t}`);if(Number.isNaN(r.getTime()))throw new Error(`Invalid date: ${String(t)}`);switch(e){case"yyyyMMdd":{const s=r.getFullYear(),a=(r.getMonth()+1).toString().padStart(2,"0"),c=r.getDate().toString().padStart(2,"0");return`${s}${a}${c}`}case"yyyyMMdd_HHmmss":{const s=r.getFullYear(),a=(r.getMonth()+1).toString().padStart(2,"0"),c=r.getDate().toString().padStart(2,"0"),u=r.getHours().toString().padStart(2,"0"),h=r.getMinutes().toString().padStart(2,"0"),p=r.getSeconds().toString().padStart(2,"0");return`${s}${a}${c}_${u}${h}${p}`}case"h:mm aa":case"h:mm a":return new Intl.DateTimeFormat(n,{hour:"numeric",minute:"2-digit",hour12:!0}).format(r);case"h":return((o=new Intl.DateTimeFormat(n,{hour:"numeric",hour12:!0}).formatToParts(r).find(c=>c.type==="hour"))==null?void 0:o.value)??"";case"mm":return new Intl.DateTimeFormat(n,{minute:"2-digit"}).format(r).padStart(2,"0");case"a":return((i=new Intl.DateTimeFormat(n,{hour:"numeric",hour12:!0}).formatToParts(r).find(c=>c.type==="dayPeriod"))==null?void 0:i.value)??"";case"PP":return new Intl.DateTimeFormat(n,{year:"numeric",month:"short",day:"numeric"}).format(r);case"EEEE":return new Intl.DateTimeFormat(n,{weekday:"long"}).format(r);case"eeee":return new Intl.DateTimeFormat(n,{weekday:"long"}).format(r);case"MMMM":return new Intl.DateTimeFormat(n,{month:"long"}).format(r);case"d":return r.getDate().toString();case"MM/dd":{const s=(r.getMonth()+1).toString().padStart(2,"0"),a=r.getDate().toString().padStart(2,"0");return`${s}/${a}`}case"MMM d":return new Intl.DateTimeFormat(n,{month:"short",day:"numeric"}).format(r);case"MMM":return new Intl.DateTimeFormat(n,{month:"short"}).format(r);case"eee, MMM d":return new Intl.DateTimeFormat(n,{weekday:"short",month:"short",day:"numeric"}).format(r);case"eee":return new Intl.DateTimeFormat(n,{weekday:"short"}).format(r);case"EE":return new Intl.DateTimeFormat(n,{weekday:"short"}).format(r);case"h:mma":return new Intl.DateTimeFormat(n,{hour:"numeric",minute:"2-digit",hour12:!0}).format(r).replace(" ","");case"haaa":return new Intl.DateTimeFormat(n,{hour:"numeric",hour12:!0}).format(r).replace(/\s+/g,"").toLowerCase();case"yyyy":return r.getFullYear().toString();case"MM":return(r.getMonth()+1).toString().padStart(2,"0");case"dd":return r.getDate().toString().padStart(2,"0");case"HH":return r.getHours().toString().padStart(2,"0");case"HH:mm":{const s=r.getHours().toString().padStart(2,"0"),a=r.getMinutes().toString().padStart(2,"0");return`${s}:${a}`}case"HH:mm:ss":{const s=r.getHours().toString().padStart(2,"0"),a=r.getMinutes().toString().padStart(2,"0"),c=r.getSeconds().toString().padStart(2,"0");return`${s}:${a}:${c}`}case"ss":return r.getSeconds().toString().padStart(2,"0");default:return r.toLocaleString(n)}}function gw(t,e){if(t){if(t.indexOf("-")!==-1)return t;if(e)return`${t}-${e}`}else if(e)return e;return"en-US"}const Hd=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("g",{id:"Chevron"},m.createElement("path",{id:"Shape",d:"M8.46967 4.21967C8.17678 4.51256 8.17678 4.98744 8.46967 5.28033L15.1893 12L8.46967 18.7197C8.17678 19.0126 8.17678 19.4874 8.46967 19.7803C8.76256 20.0732 9.23744 20.0732 9.53033 19.7803L16.7803 12.5303C17.0732 12.2374 17.0732 11.7626 16.7803 11.4697L9.53033 4.21967C9.23744 3.92678 8.76256 3.92678 8.46967 4.21967Z",fill:"currentColor"}))),SRe=Object.freeze(Object.defineProperty({__proto__:null,default:Hd},Symbol.toStringTag,{value:"Module"})),rde={top:36,bottom:36,left:24,right:24};function km(t){const{ariaLabelId:e,options:n,renderOption:r,onSelect:o,value:i,id:s,actionLabel:a,placeholder:c,className:u,menuClassName:h,expandIconClassName:p,disabled:f=!1,isValid:g=!0,supportsBrowserAutofill:v,supportsTypeahead:y=!1,autoComplete:b,boundary:C,padding:S=rde}=t,[E,I]=m.useState(!1),[T,_]=m.useState(null),w=n.findIndex(Ne=>Ne.key===i),A=m.useRef([]),M=m.useRef([]),R=m.useCallback(Ne=>{var Ke;const we=(Ke=n[Ne])==null?void 0:Ke.key;we&&o(we)},[o,n]),{refs:$,floatingStyles:V,context:ie}=ep({placement:"bottom-start",strategy:"absolute",open:E,onOpenChange:I,whileElementsMounted:fd,middleware:[tp({padding:S}),wM({boundary:C,apply({rects:Ne,elements:we,availableHeight:Ke}){Object.assign(we.floating.style,{maxHeight:`${Ke}px`,minWidth:`${Ne.reference.width}px`})},padding:S})]}),N=lI(ie,{event:"mousedown",enabled:!f}),Y=uI(ie),ue=dI(ie,{role:"listbox"}),j=JF(ie,{listRef:A,activeIndex:T,selectedIndex:w,onNavigate:_,loop:!0,focusItemOnHover:!1,openOnArrowKeyDown:!f}),U=ZF(ie,{enabled:y,listRef:M,activeIndex:T,onMatch:E?_:R}),{getReferenceProps:te,getFloatingProps:Q,getItemProps:re}=hI([Y,ue,j,N,U]),Z=m.useCallback(Ne=>{o(Ne),I(!1)},[o]),_e=w>-1?r(n[w]):d.jsx("div",{className:"truncate text-foreground-550 dark:text-slate-400",children:c}),ye=m.useCallback(Ne=>{f||o(Ne.currentTarget.value)},[o,f]),Se=m.useRef(null);return d.jsxs(d.Fragment,{children:[v&&d.jsx("select",{"aria-hidden":!0,className:"hidden",onChange:ye,autoComplete:b,disabled:f,children:n.map(Ne=>d.jsx("option",{value:Ne.key,children:Ne.text},Ne.key))}),d.jsxs("button",{role:"combobox",type:"button",id:s,ref:$.setReference,"aria-labelledby":e,"aria-expanded":E,"aria-haspopup":"listbox","aria-autocomplete":"none","aria-invalid":!g,"aria-disabled":f,className:q("flex w-full cursor-pointer items-center justify-between gap-2 rounded-2xl bg-black/5 px-[1.125rem] py-4 dark:bg-midnight-550/25",u,f&&"pointer-events-none opacity-50"),...te(),children:[d.jsx("div",{className:"min-w-0",children:_e}),d.jsxs("div",{className:q("flex min-h-[26px] shrink-0 grow items-center justify-end gap-2",p),children:[a&&d.jsx("span",{children:a}),d.jsx(Hd,{className:"size-6 rotate-90"})]})]}),d.jsx("div",{ref:Se}),E&&d.jsx(Xv,{root:Se.current,children:d.jsx(eb,{context:ie,modal:!1,children:d.jsx("div",{ref:$.setFloating,style:V,className:q("flex overflow-hidden rounded-2xl shadow-md",h),...Q(),children:d.jsx("div",{className:q("flex w-full flex-col p-2",lz),children:d.jsx("div",{className:q("vertical-scrollbar overflow-y-auto py-1 pe-1"),children:n.map((Ne,we)=>d.jsx("div",{ref:Ke=>{A.current[we]=Ke,M.current[we]=Ne.text},role:"option",tabIndex:we===T?0:-1,"aria-selected":we===w&&we===T,className:"relative cursor-default rounded-xl px-3 py-2 -outline-offset-2 hover:bg-black/5 dark:hover:bg-white/8",...re({onClick(){Z(Ne.key)},onKeyDown(Ke){Ke.key==="Enter"&&(Ke.preventDefault(),Z(Ne.key))}}),children:r(Ne)},Ne.key))})})})})})]})}function Y2(t){const{htmlFor:e,content:n,required:r,className:o,afterContent:i}=t;return d.jsxs("div",{className:"flex items-center",children:[d.jsxs("label",{htmlFor:e,className:q("flex items-center gap-0.5 text-foreground-900",o),children:[n,r&&d.jsx("span",{className:"text-system-red-550 dark:text-system-red-350",children:"*"})]}),i]})}function Ey(){const t=Ft();return t==="/discover"||t==="/"}const Fv={CLOSE_BUTTON:"closeButton",ONE_LINE_COMPOSER:"oneLineComposer",IMAGE_VIEWER:"imageViewer"},vw=D(),ode=D(t=>{const e=t(vw);if(!(!e||!Array.isArray(e.media)||typeof e.currentMediaIndex!="number"))return e.media[e.currentMediaIndex]});function Fj(){return L(ode)}function ide(t){var e;Tn({source:"mediaViewerOpen",scenario:(e=t.media[t.currentMediaIndex])==null?void 0:e.type})}function sde(){var e,n;const t=bw();t&&Tn({source:"mediaViewerNext",scenario:(e=t.media[t.currentMediaIndex])==null?void 0:e.type,destination:(n=t.media[t.currentMediaIndex+1])==null?void 0:n.type})}function ade(){var e,n;const t=bw();t&&Tn({source:"mediaViewerPrevious",scenario:(e=t.media[t.currentMediaIndex])==null?void 0:e.type,destination:(n=t.media[t.currentMediaIndex-1])==null?void 0:n.type})}function Q2(){var e;const t=bw();t&&Tn({source:"mediaViewerClose",scenario:(e=t.media[t.currentMediaIndex])==null?void 0:e.type})}function bw(){return st().get(vw)}const cde=D();function Bj(){const[t,e]=it(cde);return{isPictureInPictureOpen:le("video-picture-in-picture")&&t!==void 0,openPictureInPicture:i=>{e(i),ht({source:"mediaViewer",scenario:"PictureInPictureOpen"})},closePictureInPicture:()=>e(void 0)}}function Na(){var p;const[t,e]=it(vw),{openPictureInPicture:n}=Bj(),r=le("video-picture-in-picture"),o=m.useCallback(()=>{const{onClose:f}=t??{};Q2(),e(void 0),f==null||f()},[e,t]),i=m.useCallback(()=>{sde(),e(f=>{if(!f)return f;if(f.currentMediaIndex<f.media.length-1){const g=f.currentMediaIndex+1;return{...f,currentMediaIndex:g,isCurrentMediaLoading:QS(f.media[g])}}return f})},[e]),s=m.useCallback(()=>{ade(),e(f=>{if(!f)return f;if(f.currentMediaIndex>0){const g=f.currentMediaIndex-1;return{...f,currentMediaIndex:g,isCurrentMediaLoading:QS(f.media[g])}}return f})},[e]),a=m.useCallback(f=>{ide(f),e({...f,isCurrentMediaLoading:QS(f.media[f.currentMediaIndex])})},[e]),c=r&&((p=t==null?void 0:t.media[t.currentMediaIndex])==null?void 0:p.type)==="video",u=m.useCallback(()=>{var g;const f=t==null?void 0:t.media[t.currentMediaIndex];if(f&&f.type==="video"){const{player:v}=f;n({url:f.url,title:((g=f.source)==null?void 0:g.title)??"",startTime:(v==null?void 0:v.getCurrentTime())??0}),Q2(),e(void 0)}},[t,n,e]),h=(t==null?void 0:t.contentComposerType)??Fv.CLOSE_BUTTON;return m.useMemo(()=>({openMediaViewer:a,closeMediaViewer:o,isMediaViewerOpen:t!==void 0,next:i,previous:s,isPictureInPictureSupported:c,triggerPictureInPicture:u,contentComposerType:h,showOneLineComposerWhenMediaViewerOpen:h===Fv.ONE_LINE_COMPOSER,contentPageType:t==null?void 0:t.contentPageType}),[a,o,t,i,s,c,u,h])}function QS(t){if(t&&"initLoading"in t)return t.initLoading}const J2="bg-gradient-discover-light dark:bg-gradient-discover-dark",lde="bg-gradient-authentication-light dark:bg-gradient-authentication-dark";function ude(t={}){const{forceGradient:e=!1,gradientType:n}=t,{isMediaViewerOpen:r,contentPageType:o}=Na(),i=Ey(),s=Ft()==="/login",a=o==="newsArticle"||o==="newsVideo"||o==="newsGem",c=()=>e?!0:r&&a?!1:i||s,u=()=>n==="discover"?J2:n==="authentication"||s?lde:J2;return{shouldShowGradient:c(),gradientClass:u()}}const Z2="absolute size-full";function fl(t){const{isBottomFade:e,forceGradient:n,isFixed:r,overrideGradientType:o,customColor:i}=t,s=Ft(),{shouldShowGradient:a,gradientClass:c}=ude({forceGradient:n,gradientType:o});return d.jsxs("div",{className:q(r?"fixed":"absolute",e?"-inset-x-4 bottom-0 h-dvh":"inset-0","overflow-hidden"),children:[d.jsx("div",{className:q(Z2,"bg-none",i??"bg-background-150")}),d.jsx(Pn,{children:a&&d.jsx(Re.div,{className:q(Z2,c),initial:"initial",animate:"animate",exit:"exit",variants:{initial:dt,animate:Ot,exit:dt},transition:Cy},s)})]})}const Hj=D(void 0);function dde(t){const{buttonClassName:e}=t,{t:n}=Oe(),{closeSettings:r}=dw(),o=Ee(Hj);function i(){o("more-options"),r()}return d.jsx(Me,{role:"menuitem",variant:"rect",size:"28-xxs",color:"subtle-dimmed-inverted",className:e,title:n("settings.cookies"),onClick:()=>i(),testId:"cookies-compliance-button",children:d.jsx("span",{children:n("settings.cookies")})})}function pl(t,e={}){const{preventReferrer:n=!1}=e,r=n?"noopener,noreferrer":"noopener";return window.open(t,"_blank",r)}const Vf="https://www.bing.com/new/termsofuse",dd="https://go.microsoft.com/fwlink/?LinkId=521839",Bv="https://www.microsoft.com/microsoft-copilot/learn/?form=MG0AUO&OCID=MG0AUO#faqs",sg="hover:underline focus:underline";function X2(t){var e,n;return((n=(e=be.instance().config()).textOverrides)==null?void 0:n.call(e,t))??t}function ERe(t){const{component:e="link",buttonClassName:n}=t,r=L(pt),{pushPage:o}=dw(),i=(a,c)=>{Tn({source:"complianceLinks",scenario:a,conversationId:r,destination:c})},s=le("manage-cookies");return d.jsxs("div",{className:q("flex w-full flex-wrap justify-center gap-x-3 gap-y-1 text-black/80 text-2xs dark:text-white/80",e==="button"?"flex-col p-0":"px-5 py-2"),children:[e==="link"?d.jsx(hde,{handleAnalytics:i}):d.jsx(fde,{handleAnalytics:i,className:n??"",setPage:o}),s&&d.jsx(dde,{buttonClassName:nt(sg,{"text-2xs p-0 min-h-0 mx-0 min-w-0 gap-x-0 safe-hover:bg-transparent dark:safe-hover:bg-transparent dark:text-white/80":e==="link",[n??""]:e==="button"})})]})}function hde(t){const{handleAnalytics:e}=t;return d.jsxs(d.Fragment,{children:[d.jsx(aa,{href:dd,title:X(X2("settings.privacyLink")),className:sg,onClick:()=>e("privacy",dd),children:X(X2("settings.privacyLink"))}),d.jsx(aa,{href:Vf,title:X("settings.termsOfServiceLink"),className:sg,onClick:()=>e("terms",Vf),children:X("settings.termsOfServiceLink")}),d.jsx(aa,{href:Bv,title:X("settings.faqLink"),className:sg,onClick:()=>e("faq",Bv),children:X("settings.faqLink")})]})}function fde(t){const{handleAnalytics:e,className:n,setPage:r}=t,o=(i,s)=>{var h;e(i,s);const c=(h=be.instance().config().settingsOverrides)==null?void 0:h.shouldShowPolicyTermsQRCodes,u={privacy:"privacyStatement",terms:"terms",faq:"faq"};c&&i in u?r==null||r(u[i]):pl(s)};return d.jsxs(d.Fragment,{children:[d.jsx(Me,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",className:n,title:X("settings.privacyLink"),onClick:()=>o("privacy",dd),children:d.jsx("span",{children:X("settings.privacyLink")})}),d.jsx(Me,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",className:n,title:X("settings.termsOfServiceLink"),onClick:()=>o("terms",Vf),children:d.jsx("span",{children:X("settings.termsOfServiceLink")})}),d.jsx(Me,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",className:n,title:X("settings.faqLink"),onClick:()=>o("faq",Bv),children:d.jsx("span",{children:X("settings.faqLink")})})]})}const eN={...op,"United Kingdom":"UK"},tN={termsLink:d.jsx(nN,{link:Vf}),privacyLink:d.jsx(nN,{link:dd})};function nN(t){const{children:e,link:n}=t;return d.jsx(aa,{className:"underline",href:n,title:"",children:e})}function pde(t,e,n){const r=new Date(n,e-1,t);return ede(r)&&r.getFullYear()===n&&r.getMonth()===e-1&&r.getDate()===t}function mde(t,e,n){const r=new Date(n,e-1,t),o=nde(new Date);return r<=o}const JS="border-2 border-system-red-550/50 bg-system-red-550/10 text-system-red-550 dark:text-system-red-350";function gde(){const[t,e]=m.useState(!1),[n,r]=m.useState(void 0),[o,i]=m.useState(void 0);m.useEffect(()=>{async function A(){const M=await PX();i(M)}A()},[]),m.useEffect(()=>{const A=new URLSearchParams(window.location.search);A.delete("code"),A.delete("state"),A.delete("error"),window.history.replaceState({},document.title,`${window.location.pathname}?${A}`)},[]),m.useEffect(()=>{o&&sl({page:"auth0AccountVerificationPage",scenario:"auth0Verification",customData:JSON.stringify({accountType:o})})},[o]);const[s,a]=m.useState(""),[c,u]=m.useState(""),[h,p]=m.useState(""),[f,g]=m.useState(eN["United States"]),{i18n:v}=Oe(),y=gw(v.resolvedLanguage),b=new Intl.NumberFormat(y,{minimumIntegerDigits:2,useGrouping:!1}),C=new Intl.NumberFormat(y,{minimumIntegerDigits:4,useGrouping:!1});m.useEffect(()=>{e(!!!(c&&h&&s&&f))},[c,h,s,f]);const S=[{key:"01",text:X("common.date.month.january")},{key:"02",text:X("common.date.month.february")},{key:"03",text:X("common.date.month.march")},{key:"04",text:X("common.date.month.april")},{key:"05",text:X("common.date.month.may")},{key:"06",text:X("common.date.month.june")},{key:"07",text:X("common.date.month.july")},{key:"08",text:X("common.date.month.august")},{key:"09",text:X("common.date.month.september")},{key:"10",text:X("common.date.month.october")},{key:"11",text:X("common.date.month.november")},{key:"12",text:X("common.date.month.december")}],E=Object.entries(eN).sort().map(([A,M])=>({key:M,text:A})),I=Array.from({length:31},(A,M)=>{const R=M+1,$=b.format(R);return{key:R.toString(),text:$}}),T=Array.from({length:125},(A,M)=>{const R=new Date().getFullYear()-M,$=C.format(R);return{key:`${new Date().getFullYear()-M}`,text:$}}),_=A=>d.jsx("p",{children:A.text}),w=async()=>{const A=parseInt(s,10),M=parseInt(c,10),R=parseInt(h,10);if(!pde(R,M,A)){ht({source:"auth0AccountVerificationPage",scenario:"auth0VerificationInvalidDate",destination:"auth0AccountVerificationPage",customData:JSON.stringify({accountType:o})}),r(!1);return}if(!mde(R,M,A)){ht({source:"auth0AccountVerificationPage",scenario:"auth0VerificationNotAdult",destination:"auth0AccountVerificationPage",customData:JSON.stringify({accountType:o})}),r(!1);return}const ie=Ec(new Date(A,M-1,R),"yyyy-MM-dd");r(!0);const N=await NX(ie,f);if(!N){ht({source:"auth0AccountVerificationPage",scenario:"auth0VerificationNotSuccessfulInvalidToken",destination:"auth0AccountVerificationPage",customData:JSON.stringify({accountType:o})}),r(!1);return}const{ageGroup:Y}=N,ue=Y===Za.NOT_ADULT,j=Y===Za.ADULT;if(!(ue||j)){ht({source:"auth0AccountVerificationPage",scenario:"auth0VerificationNotSuccessfulNotTeenOrAdult",destination:"auth0AccountVerificationPage",customData:JSON.stringify({accountType:o})}),r(!1);return}ht({source:"auth0AccountVerificationPage",scenario:"auth0VerificationSuccessful",destination:"auth0AccountVerificationPage",customData:JSON.stringify({accountType:o})}),_p()};return d.jsxs(d.Fragment,{children:[d.jsx(fl,{forceGradient:!0,overrideGradientType:"authentication"}),d.jsxs("section",{className:"relative m-auto flex min-h-dvh max-w-[500px] flex-col items-center justify-center gap-3 overflow-y-auto px-5 py-12 text-center",children:[d.jsx("h1",{className:"mb-4 text-center font-semibold text-xl sm:text-3xl",children:X("error.auth0VerificationTitle")}),d.jsx("p",{children:X("error.auth0VerificationDescription")}),d.jsxs("div",{className:"mt-12 w-full",children:[d.jsx(Y2,{className:"mb-2 text-base",htmlFor:"birthdate-month",content:X("error.auth0VerificationBirthdate"),required:!0}),d.jsxs("div",{id:"birthdate-group",className:"flex gap-2",children:[d.jsx("span",{id:"month-label",className:"sr-only",children:c||X("dates.month")}),d.jsx("span",{id:"day-label",className:"sr-only",children:h||X("dates.day")}),d.jsx("span",{id:"year-label",className:"sr-only",children:s||X("dates.year")}),d.jsx(km,{renderOption:_,options:S,onSelect:A=>u(A),id:"birthdate-month",ariaLabelId:"month-label",placeholder:X("dates.month"),className:q("flex-1",ra,n===!1&&JS),value:c,isValid:n,menuClassName:Xt.dropdownMenuOverModal}),d.jsx(km,{renderOption:_,options:I,onSelect:A=>p(A),id:"birthdate-day",ariaLabelId:"day-label",placeholder:X("dates.day"),className:q("flex-1",ra,n===!1&&JS),value:h,menuClassName:Xt.dropdownMenuOverModal}),d.jsx(km,{renderOption:_,options:T,onSelect:A=>a(A),id:"birthdate-year",ariaLabelId:"year-label",placeholder:X("dates.year"),className:q("flex-1",ra,n===!1&&JS),value:s,menuClassName:Xt.dropdownMenuOverModal})]}),n===!1&&d.jsx("div",{className:q("mt-2 text-start text-system-red-550 text-sm dark:text-system-red-350"),children:X("error.authh0VerificationAgeError")})]}),d.jsxs("div",{className:"mt-12 w-full",children:[d.jsx(Y2,{className:"mb-2 text-base",htmlFor:"country",content:X("error.auth0VerificationCountryRegion"),required:!0}),d.jsx(km,{renderOption:_,options:E,onSelect:A=>g(A),id:"country","aria-labelledby":"country-group",placeholder:X("error.auth0VerificationCountryRegion"),className:q("flex-1",ra),value:f,menuClassName:Xt.dropdownMenuOverModal})]}),d.jsxs("div",{className:"mt-12 w-full text-black text-2xs dark:text-white/90",children:[d.jsx(oo,{i18nKey:X("error.auth0VerificationDisclaimer"),components:{termsLink:tN.termsLink,privacyLink:tN.privacyLink}}),d.jsx(Me,{className:"mt-4 w-full",color:"strong",size:"56-xl",variant:"rect",onClick:w,title:X("common.continue"),disabled:t,children:X("common.continue")})]})]})]})}function rN(t){var e,n;return((n=(e=be.instance().config()).textOverrides)==null?void 0:n.call(e,t))??t}const ZS="w-full";function vde(){const{switchMicrosoftAccount:t,logout:e,login:n}=Bd(),{t:r}=Oe(),o=Qc(),i=async()=>{await t()},s=async(u,h)=>{switch(await e(),u){case"microsoft":n({provider:u});break;case"auth0":n({provider:u,opts:h});break}},a=be.instance().config().hideAgeVerificationButton!==!0,c=be.instance().config().hideAgeVerificationSwitchAccountButton!==!0;return d.jsxs(d.Fragment,{children:[d.jsx(fl,{forceGradient:!0}),d.jsxs("section",{className:"relative z-10 m-auto flex h-dvh max-w-96 flex-col items-center justify-center gap-3 px-5 text-center",children:[d.jsx("h1",{className:"text-3xl",children:r(rN("error.ageVerificationTitle"))}),d.jsx("h2",{className:"text-foreground-600",children:r(rN("error.ageVerification"))}),a&&d.jsx(Me,{className:"mt-6 w-full",color:"default",size:"56-xl",variant:"rect",title:r("error.ageVerificationVerifyAge"),onClick:()=>{Tp(FV)},children:r("error.ageVerificationVerifyAge")}),a&&d.jsx("div",{className:"text-balance text-foreground-600",children:r("error.ageVerificationOr")}),o?d.jsxs(d.Fragment,{children:[d.jsxs(Me,{onClick:()=>s("microsoft"),color:"default",title:r("signInPrompt.continueWithMicrosoft"),variant:"pill",size:"56-xl",className:q(ZS),children:[d.jsx(nb,{className:"size-6"}),r("signInPrompt.continueWithMicrosoft")]}),d.jsxs(Me,{onClick:()=>s("auth0",{connection:"apple"}),color:"default",variant:"pill",size:"56-xl",title:r("signInPrompt.continueWithApple"),className:q(ZS),children:[d.jsx(SI,{className:"size-6 text-black dark:text-white"}),r("signInPrompt.continueWithApple")]}),d.jsxs(Me,{onClick:()=>s("auth0",{connection:"google"}),color:"default",variant:"pill",size:"56-xl",title:r("signInPrompt.continueWithGoogle"),className:q(ZS),children:[d.jsx(EI,{className:"size-6"}),r("signInPrompt.continueWithGoogle")]})]}):c&&d.jsx(Me,{className:"w-full",color:"default",size:"56-xl",variant:"rect",title:r("error.ageVerificationSwitchAccount"),onClick:i,children:r("error.ageVerificationSwitchAccount")})]})]})}function bde(){const t=L(An);return(t==null?void 0:t.provider)==="auth0"?d.jsx(gde,{}):d.jsx(vde,{})}const zj=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M12 4.5C7.85786 4.5 4.5 7.85786 4.5 12C4.5 16.1421 7.85786 19.5 12 19.5C16.1421 19.5 19.5 16.1421 19.5 12C19.5 11.6236 19.4723 11.2538 19.4188 10.8923C19.3515 10.4382 19.6839 10 20.1429 10C20.5138 10 20.839 10.2562 20.8953 10.6228C20.9642 11.0718 21 11.5317 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C14.3051 3 16.4077 3.86656 18 5.29168V4.25C18 3.83579 18.3358 3.5 18.75 3.5C19.1642 3.5 19.5 3.83579 19.5 4.25V7.25C19.5 7.66421 19.1642 8 18.75 8H15.75C15.3358 8 15 7.66421 15 7.25C15 6.83579 15.3358 6.5 15.75 6.5H17.0991C15.7609 5.25883 13.9691 4.5 12 4.5Z",fill:"currentColor"})),IRe=Object.freeze(Object.defineProperty({__proto__:null,default:zj},Symbol.toStringTag,{value:"Module"}));function yde(t){const{t:e}=Oe(),{onBtnClick:n=()=>{}}=t;return d.jsxs("section",{className:"relative z-10 m-auto flex h-full max-w-96 flex-col items-center justify-center gap-3 px-5 text-center",children:[d.jsx("h1",{className:"text-3xl",children:e("error.unhandledErrorTitle")}),d.jsx("h2",{className:"text-foreground-600",children:e("error.unhandledError")}),d.jsxs(Me,{className:"mt-6 w-full",color:"default",size:"56-xl",variant:"rect",title:e("error.unhandledErrorReload"),onClick:n,children:[d.jsx(zj,{className:"size-6"}),e("error.unhandledErrorReload")]})]})}function yw(){return d.jsxs("main",{className:"relative size-full overflow-hidden",children:[d.jsx(fl,{forceGradient:!0}),d.jsx(yde,{onBtnClick:()=>{_p()}})]})}function Vj(t){const{deferred:e=!1}=t??{},n=TM(),[r,o]=it(VO),i=Ee(Ip);m.useEffect(()=>{const c=n$();c&&o(c)},[n.search,o]);const s=m.useCallback(()=>{o(null)},[o]),a=m.useCallback(c=>{c&&i({source:"promptInUrl",prompt:c})},[i]);return m.useEffect(()=>{r&&!e&&a(r)},[e,a,r]),{prompt:r,handler:e?a:void 0,clear:s}}function Cde(){const t=le("prompt-pt-learn-partial"),e=le("prompt-pt-learn-full"),n=le("prompt-pt-learn-fill"),r=le("prompt-pt-advice-partial"),o=le("prompt-pt-advice-full"),i=le("prompt-pt-advice-fill"),s=le("prompt-pt-ideas-partial"),a=le("prompt-pt-ideas-full"),c=le("prompt-pt-ideas-fill"),u=le("prompt-pt-msn-answers"),h=le("prompt-pt-msn-headlines"),p=le("prompt-pt-msn-events"),f=le("prompt-pt-msn-answers-full"),g=le("prompt-pt-msn-headlines-full"),v=le("prompt-pt-msn-events-full"),y=z.getFormCode();let b=null,C=!1,S=!1,E=!1;switch(y){case"NTPCHB":{t||e||n?b="teach":r||o||i?b="advice":(s||a||c)&&(b="ideas"),C=t||r||s,S=e||o||a,E=n||i||c;break}case"MSNCHB":{u||f?b="answers":h||g?b="headlines":(p||v)&&(b="events"),S=f||g||v,E=u||h||p;break}default:b=null}let I=null;C?I="prefix":(S||E)&&(I="complete");let T=null;return C||E?T="partial":S&&(T="full"),{formCode:y,treatment:b,lengthVariant:I,passthroughType:T}}function $j(t){var h;const{region:e,isUpsellFeatureEnabled:n,isAuthenticated:r,isTeenUser:o,isProUser:i,skipProUserCheck:s}=t,a=!e||UV.includes(e),c=((h=be.instance().config().actions)==null?void 0:h.overrideFreemiumActionsUpsellFeatureEnabled)??!1;return i||s||(n||c)&&r&&!o&&!a}function Sde(){const t=Ge(wd),e=We("labs-actions-skipprocheck"),n=We("freemium-actions-upsell")&&be.instance().config().proSubscription.enabled,r=Dg(),o=Ge(wb),i=Ge(Or);return $j({region:i,isUpsellFeatureEnabled:n,isAuthenticated:r,isTeenUser:o,isProUser:t,skipProUserCheck:e})}function Gj(t){const{actionsAvailableForAccount:e,actionsAvailableForSurface:n,overrideLabsActionsFeatureEnabled:r,labsFeatureEnabled:o}=t;return e&&(r?o||n:o&&n)}async function Ede(){var i,s;const t=We("labs-actions"),e=Sde(),n=((i=be.instance().config().actions)==null?void 0:i.overrideLabsActionsFeatureEnabled)??!1,o=await(((s=be.instance().config().actions)==null?void 0:s.enableActions)??(()=>Promise.resolve(!1)))();return Gj({actionsAvailableForAccount:e,actionsAvailableForSurface:o,overrideLabsActionsFeatureEnabled:n,labsFeatureEnabled:t})}function Ide(t,e,n){return t&&(n&&e)}function Kj(){const t=L(wd),e=le("labs-actions-skipprocheck"),n=le("freemium-actions-upsell")&&be.instance().config().proSubscription.enabled,r=Lr(),o=!!L(wb),i=L(Or);return $j({region:i,isUpsellFeatureEnabled:n,isAuthenticated:r,isTeenUser:o,isProUser:t,skipProUserCheck:e})}function qj(){const[t,e]=m.useState(!1),n=L($m);return m.useEffect(()=>{async function r(){var i;await(((i=be.instance().config().actions)==null?void 0:i.enableActions)??(()=>Promise.resolve(!1)))()&&e(!0)}r().catch(()=>{})},[e,n]),t}function Cw(){var o;const t=le("labs-actions"),e=Kj(),n=qj(),r=((o=be.instance().config().actions)==null?void 0:o.overrideLabsActionsFeatureEnabled)??!1;return Gj({actionsAvailableForAccount:e,actionsAvailableForSurface:n,overrideLabsActionsFeatureEnabled:r,labsFeatureEnabled:t})}function TRe(){var r;const t=Kj(),e=qj(),n=((r=be.instance().config().actions)==null?void 0:r.overrideLabsActionsFeatureEnabled)??!1;return Ide(t,e,n)}let ag=null;function Tde(){const t=Ee(_n),e=Cw();m.useEffect(()=>{const n=e$();ag===null&&(ag=n);const r=i=>i==="td"?"reasoning":e&&i==="ac"?"computerUse":null,o=r(n||ag);o&&t(o)},[t,e])}function _de(){return ag}function wde(t){var n;const e=[];for(const r of t){if(r.type!=="product"&&r.type!=="propertyPromotion"&&r.type!=="tourActivity")return null;if(!r.tags)continue;if(r.tags.length>1)return null;const o=r.tags[0];if(!(!o||!o.value))if(e.length===0)e.push(o);else{if(((n=e[0])==null?void 0:n.category)!==o.category)return null;e.find(i=>i.value===o.value)||e.push(o)}}return e}function _Re(t,e){var n;return t!=null&&t.length?JSON.stringify({tagCategory:(n=t[0])==null?void 0:n.category,tagValue:(e==null?void 0:e.value)??"recommended",tagPosition:e?t.indexOf(e)+1:null,tagCount:t.length}):""}function Ade(t){return t.every(e=>e.type==="product"||e.type==="propertyPromotion"||e.type==="tourActivity")}function wRe(t,e,n){let r=t;return e!=null&&e.length&&n?r=t.filter(o=>{var i;return o.tags&&((i=o.tags[0])==null?void 0:i.value)===n.value}):e!=null&&e.length&&!n&&(r=t.filter(o=>!o.tags)),r}class kde{constructor(e){W(this,"startTime",0);W(this,"timeToFirstToken",0);W(this,"receivedFirstToken",!1);W(this,"receivedLastToken",!1);W(this,"currentAdditionalData");W(this,"currentMessageId","");W(this,"receivedMessageTime",0);W(this,"startMessageTime",0);W(this,"mostRecentTokenTime",0);this.startTime=e}resetStartTime(e){this.startTime=e,this.timeToFirstToken=0}onBeforeSend(){this.receivedFirstToken=!1,this.receivedLastToken=!1}onSent(e){this.currentAdditionalData=e}onReceived(e){this.receivedMessageTime=performance.now(),z.trackEvent({name:"system",data:{eventName:"copilotChatRequest",eventInfo_additionalData:this.currentAdditionalData,eventInfo_duration:this.receivedMessageTime-this.startTime,eventInfo_conversationId:e.conversationId,eventInfo_messageId:this.currentMessageId,eventInfo_mode:e.chatMode}})}onStartMessage(e){this.startMessageTime=performance.now(),this.currentMessageId=e.messageId,this.receivedMessageTime||(this.receivedMessageTime=this.startTime),z.trackEvent({name:"system",data:{eventName:"copilotChatReqToResp",eventInfo_duration:this.startMessageTime-this.receivedMessageTime,eventInfo_additionalData:this.currentAdditionalData,eventInfo_conversationId:e.conversationId,eventInfo_messageId:e.messageId,eventInfo_mode:e.chatMode}})}onFirstToken(e,n,r){if(!this.receivedFirstToken&&e===this.currentMessageId){const o=performance.now()-this.startTime;this.timeToFirstToken=o,this.receivedFirstToken=!0,z.trackEvent({name:"system",data:{eventName:"copilotChatRespToReceived",eventInfo_additionalData:this.currentAdditionalData,eventInfo_conversationId:r,eventInfo_duration:performance.now()-this.receivedMessageTime,eventInfo_messageId:e,eventInfo_mode:n}}),z.trackEvent({name:"system",data:{eventName:"copilotFirstTokenReceived",eventInfo_conversationId:r,eventInfo_messageId:e,eventInfo_duration:o,eventInfo_mode:n,eventInfo_additionalData:this.currentAdditionalData}})}this.mostRecentTokenTime=performance.now()}onLastToken(e){const{citationCount:n,imageCount:r,messageId:o,inputMethod:i,conversationId:s,chatMode:a,chainOfThoughtCount:c}=e;if(!this.receivedLastToken&&o===this.currentMessageId){const u=this.mostRecentTokenTime-this.startTime;this.receivedLastToken=!0,z.trackEvent({name:"system",data:{eventName:"copilotResponseRender",eventInfo_conversationId:s,eventInfo_messageId:o,eventInfo_numCitations:n,eventInfo_numImagesGenerated:r,eventInfo_numChainOfThoughts:c,eventInfo_inputMethod:i,eventInfo_responseMethod:"text",eventInfo_mode:a,eventInfo_additionalData:this.currentAdditionalData,eventInfo_landingPage:z.getLandingPage(),eventInfo_firstToLastTokenDuration:u-this.timeToFirstToken}}),z.trackEvent({name:"system",data:{eventName:"copilotLastTokenReceived",eventInfo_conversationId:s,eventInfo_messageId:o,eventInfo_duration:u,eventInfo_mode:a,eventInfo_additionalData:this.currentAdditionalData}}),z.trackEvent({name:"system",data:{eventName:"copilotChatE2E",eventInfo_conversationId:s,eventInfo_messageId:o,eventInfo_duration:performance.now()-this.startTime,eventInfo_mode:a,eventInfo_additionalData:this.currentAdditionalData}}),this.currentAdditionalData=void 0}}onAdsRender(e){const n=performance.now()-this.startTime,{ads:r}=e,i=(r==null?void 0:r.find(c=>c.type==="miniShowroom"))??(r&&r.length>0?r[0]:void 0),s=r&&Ade(r)?wde(r):[],a=r==null?void 0:r.find(c=>c.type==="mainShowroom");z.trackEvent({name:"system",data:{eventName:"copilotAdsSignal",eventInfo_scenario:"render",eventInfo_adType:i==null?void 0:i.type,eventInfo_adCount:r==null?void 0:r.length,eventInfo_rguid:e.requestId,eventInfo_messageId:e.messageId,eventInfo_conversationId:e.conversationId,eventInfo_duration:n,eventInfo_additionalData:JSON.stringify({eventType:e.eventType,adTags:s!=null&&s.length?s:void 0,brandId:a==null?void 0:a.brandId})}})}onSubmitMessageBlocked(e,n,r){z.trackEvent({name:"interaction",data:{eventName:"copilotUserInputBlocked",eventInfo_inputMethod:n,eventInfo_mode:e,eventInfo_messageId:this.currentMessageId,eventInfo_conversationId:r,eventInfo_duration:performance.now()-this.startTime,eventInfo_additionalData:this.currentAdditionalData}})}onImageGenerationStart(e){const{messageId:n,conversationId:r,chatMode:o}=e,s=performance.now()-this.startTime;z.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"ImageGenStarted",eventInfo_messageId:n,eventInfo_conversationId:r,eventInfo_mode:o,eventInfo_duration:s}})}onImageReceived(e){const{messageId:n,conversationId:r,chatMode:o}=e,i=performance.now()-this.startTime;z.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"ImageGenReceived",eventInfo_messageId:n,eventInfo_conversationId:r,eventInfo_mode:o,eventInfo_duration:i}})}onPartialImageReceived(e){const{messageId:n,imageGenPhase:r,conversationId:o,chatMode:i}=e,s=performance.now()-this.startTime;z.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"PartialImageGenReceived",eventInfo_messageId:n,eventInfo_conversationId:o,eventInfo_mode:i,eventInfo_duration:s,eventInfo_customData:`${r}`}})}onMemorySignalReceived(e){const{messageId:n,conversationId:r}=e,i=performance.now()-this.startTime;z.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"MemorySignalReceived",eventInfo_messageId:n,eventInfo_conversationId:r,eventInfo_duration:i}})}onChainOfThoughtReceived(e){const{messageId:n,conversationId:r,chatMode:o}=e,i=performance.now()-this.startTime;z.trackEvent({name:"system",data:{eventName:"copilotCoTFirstTokenReceived",eventInfo_messageId:n,eventInfo_conversationId:r,eventInfo_mode:o,eventInfo_duration:i}})}}function xde(t,e,n){switch(t.type){case"research":return{type:"task",task:{id:t.id,type:t.type,contents:[],partialOutput:[],inlineCitations:[],status:"pending",prompt:t.prompt},partId:e};case"computerUse":return{type:"task",task:{id:t.id,conversationId:t.conversationId,type:t.type,status:"running",updatedAt:n},partId:e};case"podcast":return{type:"task",task:{id:t.id,type:t.type,status:t.status,podcast:t.podcast,updatedAt:t.updatedAt??n},partId:e};default:return null}}const Rde=D(t=>t(ml).isOpen||t(Wj)),ml=D({isOpen:!1,scenario:null}),Wj=D(t=>{const e=t(Ac);return e===null?!1:e===0||t(HO).includes(e)}),Nde=D(t=>{const e=t(Wj),n=t(Aa("location-prompt")),r=t(Zi).filter(({author:i})=>i==="human").length,o=!!Sn(g$);return e||!n||o?!1:r===AV});function Yj({path:t,args:e,onLoad:n,alt:r,...o}){const{data:i,isLoading:s}=hl(t,async a=>{const u=await(await Gc(a,e)).blob();return URL.createObjectURL(u)});return m.useEffect(()=>{!s&&n&&n()},[s,n]),s?d.jsx("div",{...o}):d.jsx("img",{...o,src:i,alt:r})}const oN=st();function Pde(t){var e,n;if(t.status==="completed"){const r=oN.get(pt);if(El.latestLocation.pathname.startsWith("/chats")&&r&&t.conversationId===r)return;oN.set(Os,{iconProvider:()=>{var o,i,s;return d.jsx(Yj,{path:`/podcasts/user/${(o=t.podcast)==null?void 0:o.id}/Files/${(s=(i=t.podcast)==null?void 0:i.thumbnail)==null?void 0:s.name}`,className:"rounded-xl object-cover"})},title:X("podcasts.generationNotification.title"),subtitle:((e=t.podcast)==null?void 0:e.title)??"",action:()=>{var o;xb({from:window.location.pathname,to:`/podcasts/user/${(o=t.podcast)==null?void 0:o.id}`})},trackingArgs:{scenario:"podcastGenerationNotification",customData:JSON.stringify({podcastId:(n=t.podcast)==null?void 0:n.id})},dismissAfter:3e4})}}const Mde=D(!1),Qj=D(void 0),Ode=D(!1),iN=D(new Set),Lde=D(void 0),Ch=st();function Dde(t,e){const n=Ch.get(pt);if(We("ds-new-progress")){if(t.status!=="completed")return;if(Ch.get(iN).has(t.id))Ch.set(iN,a=>Ar(a,c=>{c.delete(t.id)}));else return}else if(!Ng.includes(t.status)||(kL("chat"),!n||n===e))return;const o=t.id,i={title:X("research.generationNotification.title"),subtitle:X("research.generationNotification.subTitle"),link:X("research.generationNotification.subTitleLink"),action:()=>{xb({from:window.location.pathname,to:`/chats/${e}`})},onClick:()=>{Ch.set(Lde,o)},dismissable:!0,trackingArgs:{scenario:"researchCompletionNotification",customData:JSON.stringify({researchId:t.id,sourceConversationId:e})}};Ch.set(Os,i)}function jde(){const t=L(li),e=L(pt);return m.useMemo(()=>{if(e){for(const n of t.values())if(n.conversationId===e)return n}},[e,t])}function Ude(){const t=st(),e=t.get(li),n=t.get(pt);if(n){for(const r of e.values())if(r.conversationId===n)return r}}const Di=st(),Fde="MissingUrlFromApi";function Bde(t,e){const n=Di.get(li).get(t);return(n==null?void 0:n.type)==="computerUse"&&!n.lastUserCommand&&Hde(n)&&e.some(o=>o.op==="replace"&&o.path==="/status"&&o.value==="paused")?xE(e,["userTakeControl","pauseByClick"]):!1}function Jj(t){return t==="paused"||t==="running"||t==="pending"}function Hde(t){var e,n;return t.status==="paused"&&(((e=t.statusChange)==null?void 0:e.reason)==="safetyRiskDetected"||((n=t.statusChange)==null?void 0:n.reason)==="askUserInput")}function zde(t){var e;return t.status==="paused"&&((e=t.statusChange)==null?void 0:e.reason)==="safetyRiskDetected"}function Vde(t){var e;return t.status==="paused"&&((e=t.statusChange)==null?void 0:e.reason)==="userTakeControl"&&t.lastUserCommand==="takeTaskControl"}function XS(t,e=!1){return t.map(n=>({type:"chainOfThought",text:n.text,screenshotUrl:e?Fde:null,reaction:null,partId:Math.random().toString()}))}function xE(t,e){return t.some(n=>{if(n.op==="replace"&&n.path==="/statusChange"){const{value:r}=n;if(typeof r=="object"&&r!==null&&"reason"in r){const{reason:o}=r;if(typeof o=="string"){const i=l5.safeParse(o);return i.success&&e.includes(i.data)}}}return!1})}function $de(t,e){const n=Di.get(li).get(t);if((n==null?void 0:n.type)==="computerUse"){const{conversationId:r,status:o,statusChange:i}=n;if(!r)return;if(o==="cancelled"&&Ht(r,h=>{const p=sN(t,"cancelTask");h.push(p)}),xE(e,["giveBackControl"])?Ht(r,h=>{const p=sN(t,"takeTaskControl");h.push(p)}):(i==null?void 0:i.reason)==="giveBackControl"&&aN(t),xE(e,["taskCompleted"])&&Ht(r,h=>{const p={id:Math.random().toString(),createdAt:new Date().toISOString(),author:"ai",content:[{type:"card",partId:Math.random().toString(),card:{type:"computerUseFeedback"}}]};h.push(p)}),i)switch(i.reason){case"askUserInput":case"safetyRiskDetected":{o==="paused"?(i.reason==="askUserInput"&&ga({feature:"computerUse",scenario:"askUserInput",customData:JSON.stringify({id:n.id,conversationId:n.conversationId})}),r===Di.get(pt)||Di.set(Os,{title:n.title&&n.title!==""?X("actions.alertTitleTemplate",{conversationName:n.title}):X("actions.defaultAlertTitle"),subtitle:i.reason==="safetyRiskDetected"?X("actions.safetyRiskAlertSubTitle"):X("actions.askUserInputAlertSubTitle"),action:()=>PL({id:r}),dismissAfter:30*1e3,dismissable:!0}),AT(t,p=>{"lastUserCommand"in p&&(p.lastUserCommand=void 0)})):aN(t);break}}const c=e.filter(h=>h.op==="add"&&h.path==="/chainOfThought/-").map(h=>({text:"value"in h?h.value:""}));c.length>0&&Ht(r,h=>{if(h.length===0)return;const p=cN(h);if(p)p.push(...XS(c));else{const f={id:Math.random().toString(),createdAt:new Date().toISOString(),author:"ai",content:XS(c)};h.push(f)}}),e.filter(h=>h.op==="replace"&&h.path==="/computerAction").length>0&&Ht(r,h=>{const p=cN(h);p&&p.push(...XS([{text:n.computerAction??""}],!0))})}}function sN(t,e){return{id:Math.random().toString(),createdAt:new Date().toISOString(),author:"human",content:[{type:"command",command:{type:e,taskId:t}}]}}function aN(t){AT(t,e=>{"statusChange"in e&&(e.statusChange=void 0)})}function cN(t){const e=t.at(-1);if(e&&e.author==="ai"&&e.content.find(n=>n.type==="chainOfThought"))return e.content}function ARe(t){var n;const e=Ude();return(e==null?void 0:e.type)==="computerUse"?e.status!=="running"&&!((n=e.replay)!=null&&n.isRunning)?!0:!t:!0}function kRe(t){return!!(We("labs-actions-replay")&&t&&t.type==="computerUse"&&!Jj(t.status))}function xRe(t){return{cancelTask:"copilotActionsCancelTask",takeTaskControl:"copilotActionsTakeControl",startTask:void 0,pauseTask:void 0,resumeTask:void 0,releaseTaskControl:void 0}[t]}function Zj(t){return IL({tasks:Di.get(li),conversationId:t,taskType:"computerUse"})}function Gde(t,e){if(t===e&&(Di.set(kr,"side-by-side"),kL("chat")),!We("actions-auto-open-L2")||!t)return;const r=Di.get(pt);r&&Di.set(Ag,r),Di.set(pt,t),Di.set(kr,"side-by-side")}function RRe(t,e,n){z.trackEvent({name:"interaction",data:{eventName:"activityArtifactDrawerOpened",eventInfo_messageId:t,eventInfo_partId:e,eventInfo_messageType:n}})}function Kde(t){xr({feature:"activity",errorType:"handleActivityStart",errorMessage:"Could not find message with messageId to start activity",customData:JSON.stringify({messageId:t})})}function qde(t,e){xr({feature:"activity",errorType:"handleActivityUpdate",errorMessage:"Could not find activity message with partId in message with messageId",customData:JSON.stringify({messageId:t,partId:e})})}function Wde(t){xr({feature:"activity",errorType:"handleActivityUpdate",errorMessage:"Error updating activity",exception:JSON.stringify({error:t})})}function Yde(t){return t.filter(e=>e.type!=="miniShowroom").filter(e=>e.type!=="mainShowroom"||e.action).map(e=>{var r;let n="";return e.type==="mainShowroom"?n=((r=e.action)==null?void 0:r.url)??"":e.type==="product"?n=e.offer.link.url:n=e.link.url,{type:e.type,rLink:n}})}function Qde(t){return Yde(t).some(({rLink:e})=>e==="")}function Jde({entryAd:t,mainAd:e,messageId:n,partId:r,conversationId:o}){var g;const i=We("adsshowroomagent"),s=Ge(Zc);if(!(!!(!s&&t&&e)||!!(!s&&t&&(i||e))||(s==null?void 0:s.conversationId)===o&&!t&&e&&e.brandId===s.brandId))return z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"AdsError",eventInfo_details:JSON.stringify({messageId:n,partId:r,conversationId:o,hasEntryAd:!!t,hasMainAd:!!e,mainAdBrandId:e==null?void 0:e.brandId,isShowroomOpened:!!s,showroomBrandId:s==null?void 0:s.brandId}),eventInfo_errorMessage:`Unexpected showroom data received when showroom is ${s?"opened":"closed"}`}}),!1;if(Qde(((g=e==null?void 0:e.slotAds)==null?void 0:g.map(v=>v.ad))??[]))return!1;const c=(e==null?void 0:e.logo)??(t==null?void 0:t.logo)??(s==null?void 0:s.brandLogo),u=typeof(e==null?void 0:e.backgroundColor)=="number";return(i?!c:!c||!u)?(z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"AdsError",eventInfo_details:JSON.stringify({messageId:n,partId:r,conversationId:o,entryAdType:t==null?void 0:t.type,noBrandLogo:!c,noMainShowroomAd:!e,noBackgroundColor:!u}),eventInfo_errorMessage:"Unexpected data found in ads card"}}),!1):!0}function Zde({card:t,messageId:e,partId:n,conversationState:r,conversationId:o}){const{ads:i}=t;if(r.timing.onAdsRender({requestId:t.requestId,messageId:e,conversationId:o,eventType:"card",ads:i}),i!=null&&i.some(s=>s.type==="mainShowroom"||s.type==="miniShowroom")){const s=i[0],a=(s==null?void 0:s.type)==="miniShowroom",c=a?s:void 0,u=a?i[1]:s;if(!Jde({entryAd:c,partId:n,conversationId:o,messageId:e,mainAd:(u==null?void 0:u.type)==="mainShowroom"?u:void 0}))return}Ht(o,s=>{const a=Dn(s,e);a&&a.content.push({type:"card",partId:n,card:t})})}const Xde=eT.extend({actionName:l.literal("edge_get_page_content"),parameters:l.array(l.object({tabId:l.number(),windowId:l.number(),pageUrl:l.string().nullish(),pageTitle:l.string().nullish(),pageType:l.string().nullish(),lastAccessedTime:l.number().nullish()}))}),ehe=l.discriminatedUnion("actionName",[Xde,VK]),the=st();function nhe(t){the.set(En,e=>Ar(e,n=>{for(const{title:r,id:o,updatedAt:i,continuedAt:s}of t){const a=n.get(o);a?(a.title=r,a.id=o,a.updatedAt=i,a.continuedAt=s):n.set(o,{id:o,title:r,updatedAt:i,history:[],streamingState:"idle",continuedAt:s})}}))}const rhe=st();function ohe(t,e,n){she(t.map(r=>ihe(r,e,n)).filter(r=>r!==void 0))}function ihe(t,e,n){switch(t.type){case"research":return{id:t.id,conversationId:e,type:t.type,status:t.status,updatedAt:""};case"computerUse":return{id:t.id,conversationId:t.conversationId??"",type:t.type,status:t.status,updatedAt:t.updatedAt??"",title:t.title??"",lastScreenshot:t.lastScreenshot};case"podcast":return{id:t.id,conversationId:e,status:t.status==="completed"?"completed":"running",type:t.type,podcast:t.podcast,updatedAt:t.updatedAt??n};default:return}}function she(t){rhe.set(li,n=>Ar(n,r=>{for(const o of t){const i=r.get(o.id);if(i)i.title=o.title,i.conversationId=o.conversationId,i.updatedAt=o.updatedAt,i.status=o.status,i.type=o.type,i.type==="computerUse"&&o.type==="computerUse"&&(i.lastScreenshot=o.lastScreenshot);else{const s={id:o.id,title:o.title,conversationId:o.conversationId,updatedAt:o.updatedAt,status:o.status,type:o.type};s.type==="computerUse"&&o.type==="computerUse"&&(s.chainOfThought=[],s.lastScreenshot=o.lastScreenshot),o.type==="podcast"&&s.type==="podcast"&&(s.podcast=o.podcast),r.set(o.id,s)}}}));const e=t.filter(n=>n.type==="computerUse"&&n.conversationId).map(n=>{const{conversationId:r,title:o,updatedAt:i}=n;return{id:r??"",title:o,updatedAt:i,continuedAt:null,history:[],streamingState:"idle"}});nhe(e)}const Xj="cf-turnstile",ahe=`#${Xj}`;function che(){const t=L($h),e=L(Ns);return Fo("kill-cf-turnstile")?null:d.jsx(fi,{isOpen:t,className:"w-3/4 sm:w-[350px]",children:d.jsx("div",{id:Xj,className:"flex flex-1 items-center justify-center","data-theme":e})})}const lhe=new al(()=>new Promise((t,e)=>{const n=setTimeout(()=>{e(new Error("CF Turnstile script took too long to load"))},15e3),r=document.createElement("script");r.type="text/javascript",r.defer=!0,r.src="https://challenges.cloudflare.com/turnstile/v0/api.js",r.onload=()=>{clearTimeout(n),t()},r.onerror=()=>{clearTimeout(n),e(new Error("Failed to load turnstile script"))},document.body.appendChild(r)}));async function uhe(t){if(zi("kill-cf-turnstile")||Ge($h))return;const n=st();z.trackEvent({name:"system",data:{eventName:"copilotTurnstileEvent",eventInfo_stage:"attempt"}}),AM.flushSync(()=>{n.set($h,!0)});try{await lhe.get()}catch{n.set(_f,"cf-turnstile");return}try{window.turnstile.render(ahe,{sitekey:"0x4AAAAAAAg146IpY3lPNWte",callback:async r=>{t(r),window.turnstile.remove(),n.set($h,!1),z.trackEvent({name:"system",data:{eventName:"copilotTurnstileEvent",eventInfo_stage:"success"}})},"error-callback":r=>{z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"turnstileRenderErrorCallback",eventInfo_details:"Error rendering CF Turnstile.",eventInfo_errorMessage:r}})}})}catch(r){z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"turnstileRender",eventInfo_details:"Error rendering CF Turnstile",eventInfo_errorMessage:r instanceof Error?r.message:""}}),n.set(_f,"cf-turnstile")}}function dhe(t){const e=t.match(/^\*\*(.*?)\*\*\n\n$/);if(e){const[,n]=e;return{title:(n==null?void 0:n.trim())??"",text:""}}return{title:"",text:t}}function Hv(t,e){return t?Date.now()-parseInt(t,10)<=e:!1}function Sw(t,e){return!t||parseInt(t,10)<e}var mM;const yr=(mM=be.instance().config().crossPromotion)==null?void 0:mM.aggressive;var gM,vM,bM,yM,CM;const gl={"thumbs-up":{cardFeature:"cross-promo-card-thumbsup",popupFeature:"cross-promo-popup-thumbsup",cardConfig:(gM=yr==null?void 0:yr.card)==null?void 0:gM.thumbsUp,popupConfig:(vM=yr==null?void 0:yr.popup)==null?void 0:vM.thumbsUp},copied:{cardFeature:void 0,popupFeature:"cross-promo-popup-copied",cardConfig:void 0,popupConfig:(bM=yr==null?void 0:yr.popup)==null?void 0:bM.copied},engaging:{cardFeature:void 0,popupFeature:"cross-promo-popup-engaging",cardConfig:void 0,popupConfig:(yM=yr==null?void 0:yr.popup)==null?void 0:yM.engaging},"think-deeper":{cardFeature:void 0,popupFeature:"cross-promo-popup-think-deeper",cardConfig:void 0,popupConfig:(CM=yr==null?void 0:yr.popup)==null?void 0:CM.thinkDeeper}};function hhe(){return{type:"popup",title:X("crossSelling.aggressivePromotion.popup.thumbsUpTitle"),subTitle:X("crossSelling.aggressivePromotion.popup.thumbsUpSubTitle"),images:gl["thumbs-up"].popupConfig}}function fhe(){return{type:"card",title:X("crossSelling.aggressivePromotion.card.thumbsUpTitle"),subTitle:X("crossSelling.aggressivePromotion.card.thumbsUpSubTitle"),images:gl["thumbs-up"].cardConfig}}function phe(){return{type:"popup",title:X("crossSelling.aggressivePromotion.popup.copiedTitle"),subTitle:X("crossSelling.aggressivePromotion.popup.copiedSubTitle"),images:gl.copied.popupConfig}}function mhe(){return{type:"popup",title:X("crossSelling.aggressivePromotion.popup.engagingTitle"),subTitle:X("crossSelling.aggressivePromotion.popup.engagingSubTitle"),images:gl.engaging.popupConfig}}function ghe(){return{type:"popup",title:X("crossSelling.aggressivePromotion.popup.thinkDeeperTitle"),subTitle:X("crossSelling.aggressivePromotion.popup.thinkDeeperSubTitle"),images:gl["think-deeper"].popupConfig}}function e9(t){const n=st().get(QI),r=n===!0?!1:n!==void 0,o=Sn(HI),i=!Hv(o,2*Ig),s=Sn(wg),a=Sw(s,2);r&&bhe(t)&&i&&a&&yhe(t)}let lN=!1;function vhe(){const e=st().get(_n);!lN&&(e==="reasoning"||e==="research")&&(e9("think-deeper"),lN=!0)}function bhe(t){return Fh(t)||t9(t)}function Fh(t){const e=gl[t];return We(e.popupFeature)&&e.popupConfig!==void 0}function t9(t){const e=gl[t];return e.cardFeature!==void 0&&We(e.cardFeature)&&e.cardConfig!==void 0&&!xO()}function yhe(t){const e=st();t==="thumbs-up"&&Fh(t)?e.set(fs,hhe()):t==="thumbs-up"&&t9(t)?e.set(fs,fhe()):t==="copied"&&Fh(t)?e.set(fs,phe()):t==="engaging"&&Fh(t)?e.set(fs,mhe()):t==="think-deeper"&&Fh(t)&&e.set(fs,ghe())}const e0=D({counter:0,isActive:!0});function Che(){const t=st(),e=t.get(e0);if(!e.isActive)return;const n=e.counter+1;n===HV?(e9("engaging"),t.set(e0,{counter:n,isActive:!1})):t.set(e0,{counter:n,isActive:e.isActive})}const She="group/ai-message-item space-y-3 break-words",Ehe=new Map([["1c","1C:Enterprise"],["abnf","Augmented Backus-Naur Form"],["accesslog","Apache Access Log"],["actionscript","ActionScript"],["ada","Ada"],["ado","Stata"],["adoc","AsciiDoc"],["ahk","AutoHotkey"],["angelscript","AngelScript"],["apache","Apache config"],["apacheconf","Apache config"],["applescript","AppleScript"],["arcade","ArcGIS Arcade"],["arduino","Arduino"],["arm","ARM Assembly"],["armasm","ARM Assembly"],["as","ActionScript"],["asc","AngelScript"],["asciidoc","AsciiDoc"],["aspectj","AspectJ"],["atom","HTML, XML"],["autohotkey","AutoHotkey"],["autoit","AutoIt"],["avrasm","AVR Assembly"],["awk","Awk"],["axapta","X++"],["bash","Bash"],["basic","BASIC"],["bat","Batch file (DOS)"],["bf","Brainfuck"],["bind","DNS Zone"],["bnf","Backus–Naur Form"],["brainfuck","Brainfuck"],["c","C"],["c#","C#"],["c++","C++"],["cal","C/AL"],["capnp","Cap’n Proto"],["capnproto","Cap’n Proto"],["cc","C++"],["ceylon","Ceylon"],["cjs","JavaScript"],["clean","Clean"],["clj","Clojure"],["clojure","Clojure"],["clojure-repl","Clojure REPL"],["cls","Caché Object Script"],["cmake","CMake"],["cmake.in","CMake"],["cmd","Batch file (DOS)"],["coffee","CoffeeScript"],["coffeescript","CoffeeScript"],["console","Shell Session"],["coq","Coq"],["cos","Caché Object Script"],["cpp","C++"],["cr","Crystal"],["craftcms","Twig"],["crm","crmsh"],["crmsh","crmsh"],["crystal","Crystal"],["cs","C#"],["csharp","C#"],["cson","CoffeeScript"],["csp","CSP"],["css","CSS"],["cts","TypeScript"],["cxx","C++"],["d","D"],["dart","Dart"],["dcl","Clean"],["delphi","Delphi"],["dfm","Delphi"],["diff","Diff"],["django","Django"],["dns","DNS Zone"],["do","Stata"],["docker","Dockerfile"],["dockerfile","Dockerfile"],["dos","Batch file (DOS)"],["dpr","Delphi"],["dsconfig","dsconfig"],["dst","Dust"],["dts","Device Tree"],["dust","Dust"],["ebnf","Extended Backus-Naur Form"],["edn","Clojure"],["elixir","Elixir"],["elm","Elm"],["erb","ERB"],["erl","Erlang"],["erlang","Erlang"],["erlang-repl","Erlang REPL"],["ex","Elixir"],["excel","Excel formulae"],["exs","Elixir"],["f#","F#"],["f90","Fortran"],["f95","Fortran"],["feature","Gherkin"],["fix","FIX"],["flix","Flix"],["fortran","Fortran"],["fs","F#"],["fsharp","F#"],["gams","GAMS"],["gauss","GAUSS"],["gcode","G-code (ISO 6983)"],["gemspec","Ruby"],["gherkin","Gherkin"],["glsl","GLSL"],["gml","GML"],["gms","GAMS"],["go","Go"],["golang","Go"],["golo","Golo"],["gql","GraphQL"],["gradle","Gradle"],["graph","Roboconf"],["graphql","GraphQL"],["groovy","Groovy"],["gss","GAUSS"],["gyp","Python"],["h","C"],["h++","C++"],["haml","HAML"],["handlebars","Handlebars"],["haskell","Haskell"],["haxe","Haxe"],["hbs","Handlebars"],["hh","C++"],["hpp","C++"],["hs","Haskell"],["hsp","HSP"],["html","HTML, XML"],["html.handlebars","Handlebars"],["html.hbs","Handlebars"],["htmlbars","Handlebars"],["http","HTTP"],["https","HTTP"],["hx","Haxe"],["hxx","C++"],["hy","Hy"],["hylang","Hy"],["i7","Inform 7"],["iced","CoffeeScript"],["icl","Clean"],["inform7","Inform 7"],["ini","TOML, also INI"],["ino","Arduino"],["instances","Roboconf"],["ipython","Python"],["irb","Ruby"],["irpf90","IRPF90"],["isbl","ISBL"],["java","Java"],["javascript","JavaScript"],["jboss-cli","JBoss CLI"],["jinja","Django"],["jldoctest","Julia REPL"],["js","JavaScript"],["json","JSON"],["jsonc","JSON"],["jsp","Java"],["jsx","JavaScript"],["julia","Julia"],["julia-repl","Julia REPL"],["k","Q"],["kdb","Q"],["kotlin","Kotlin"],["kt","Kotlin"],["kts","Kotlin"],["lasso","Lasso"],["lassoscript","Lasso"],["latex","LaTeX"],["ldif","LDIF"],["leaf","Leaf"],["less","Less"],["lisp","Lisp"],["livecodeserver","LiveCode"],["livescript","LiveScript"],["llvm","LLVM IR"],["ls","Lasso"],["ls","LiveScript"],["lsl","LSL (Linden Scripting Language)"],["lua","Lua"],["m","Mercury"],["mak","Makefile"],["make","Makefile"],["makefile","Makefile"],["markdown","Markdown"],["mathematica","Mathematica"],["matlab","Matlab"],["maxima","Maxima"],["md","Markdown"],["mel","MEL"],["mercury","Mercury"],["mikrotik","MikroTik RouterOS script"],["mips","MIPS Assembly"],["mipsasm","MIPS Assembly"],["mizar","Mizar"],["mjs","JavaScript"],["mk","Makefile"],["mkd","Markdown"],["mkdown","Markdown"],["ml","OCaml"],["ml","SML (Standard ML)"],["mm","Objective-C"],["mma","Mathematica"],["mojolicious","Mojolicious"],["monkey","Monkey"],["moo","Mercury"],["moon","MoonScript"],["moonscript","MoonScript"],["mts","TypeScript"],["n1ql","N1QL"],["nc","G-code (ISO 6983)"],["nestedtext","Nested Text"],["nginx","Nginx config"],["nginxconf","Nginx config"],["nim","Nim"],["nix","Nix"],["nixos","Nix"],["node-repl","Node REPL"],["nsis","NSIS"],["nt","Nested Text"],["obj-c","Objective-C"],["obj-c++","Objective-C"],["objc","Objective-C"],["objective-c++","Objective-C"],["objectivec","Objective-C"],["ocaml","OCaml"],["openscad","OpenSCAD"],["osascript","AppleScript"],["oxygene","Oxygene"],["p21","STEP Part 21"],["parser3","Parser3"],["pas","Delphi"],["pascal","Delphi"],["patch","Diff"],["pb","PureBASIC"],["pbi","PureBASIC"],["pcmk","crmsh"],["pde","Processing"],["perl","Perl"],["pf","Packet Filter config"],["pf.conf","Packet Filter config"],["pgsql","PostgreSQL"],["php","php"],["php-template","PHP template"],["pl","Perl"],["plaintext","Plain text"],["plist","HTML, XML"],["pm","Perl"],["podspec","Ruby"],["pony","Pony"],["postgres","PostgreSQL"],["postgresql","PostgreSQL"],["powershell","PowerShell"],["pp","Puppet"],["processing","Processing"],["profile","Python profiler"],["prolog","Prolog"],["properties",".properties"],["proto","Protocol Buffers"],["protobuf","Protocol Buffers"],["ps","PowerShell"],["ps1","PowerShell"],["puppet","Puppet"],["purebasic","PureBASIC"],["pwsh","PowerShell"],["py","Python"],["pycon","python-repl"],["python","Python"],["python-repl","python-repl"],["q","Q"],["qml","QML"],["qt","QML"],["r","R"],["rb","Ruby"],["re","ReasonML"],["reasonml","ReasonML"],["rib","RenderMan RIB"],["roboconf","Roboconf"],["routeros","MikroTik RouterOS script"],["rs","Rust"],["rsl","RenderMan RSL"],["rss","HTML, XML"],["ruby","Ruby"],["ruleslanguage","Oracle Rules Language"],["rust","Rust"],["sas","SAS"],["scad","OpenSCAD"],["scala","Scala"],["scheme","Scheme"],["sci","Scilab"],["scilab","Scilab"],["scm","Scheme"],["scss","SCSS"],["sh","Bash"],["shell","Shell Session"],["shellsession","Shell Session"],["smali","Smali"],["smalltalk","Smalltalk"],["sml","SML (Standard ML)"],["sqf","SQF"],["sql","SQL"],["st","Smalltalk"],["stan","Stan"],["stanfuncs","Stan"],["stata","Stata"],["step","STEP Part 21"],["step21","STEP Part 21"],["stp","STEP Part 21"],["styl","Stylus"],["stylus","Stylus"],["subunit","SubUnit"],["sv","Verilog"],["svg","HTML, XML"],["svh","Verilog"],["swift","Swift"],["taggerscript","Tagger Script"],["tao","XL"],["tap","Test Anything Protocol"],["tcl","Tcl"],["tex","LaTeX"],["text","Plain text"],["thor","Ruby"],["thrift","Thrift"],["tk","Tcl"],["toml","TOML, also INI"],["tp","TP"],["ts","TypeScript"],["tsx","TypeScript"],["twig","Twig"],["txt","Plain text"],["typescript","TypeScript"],["v","Verilog"],["vala","Vala"],["vb","Visual Basic .NET"],["vbnet","Visual Basic .NET"],["vbs","VBScript"],["vbscript","VBScript"],["vbscript-html","VBScript in HTML"],["verilog","Verilog"],["vhdl","VHDL"],["vim","Vim Script"],["wasm","WebAssembly"],["wildfly-cli","JBoss CLI"],["wl","Mathematica"],["wren","Wren"],["wsf","HTML, XML"],["x++","X++"],["x86asm","Intel x86 Assembly"],["xhtml","HTML, XML"],["xjb","HTML, XML"],["xl","XL"],["xls","Excel formulae"],["xlsx","Excel formulae"],["xml","HTML, XML"],["xpath","XQuery"],["xq","XQuery"],["xqm","XQuery"],["xquery","XQuery"],["xsd","HTML, XML"],["xsl","HTML, XML"],["yaml","YAML"],["yml","YAML"],["zep","Zephir"],["zephir","Zephir"],["zone","DNS Zone"],["zsh","Bash"]]),Ap="&#95;{{{CITATION{{{&#95;",zv="{",Ihe=Object.freeze(Object.defineProperty({__proto__:null,AI_MESSAGE_CONTAINER_CLASS:She,ALIAS_TO_SUPPORTED_LANGUAGE:Ehe,CITATION_DIVIDER:zv,CITATION_PREFIX:Ap},Symbol.toStringTag,{value:"Module"}));function n9(t,e){return`[${Ap}${t}${zv}](${e})`}const The=new RegExp(`\\[${Ap}.*?\\)`,"g");function _he(t){return t.replace(The,"")}const whe=2500,Ahe=255,Iy=ub(new Map),NRe=D(null),khe=D(xV),xhe=D(Ahe),Rhe=D(whe);function Nhe(t,e,n){return`${t}_${e}_${n}`}function Phe(t,e){st().set(Iy,r=>{const o=r.get(t)??[],i=[];for(const s of e.editTargets){const a={id:Nhe(e.id,s.startIndex,s.endIndex),pageSuggestionId:e.id,startIndex:s.startIndex,endIndex:s.endIndex,text:e.text};i.push(a)}r.set(t,[...o,...i])})}function PRe(t,e){st().set(Iy,r=>{const o=r.get(t);o&&r.set(t,o.filter(i=>i.id!==e))})}function MRe(t){st().set(Iy,n=>{n.delete(t)})}function Mhe(t,e,n){st().set(Iy,o=>{const i=o.get(t);if(i){const s=i.filter(a=>a.pageSuggestionId===e);for(const a of s)a.text===void 0&&(a.text=""),a.text+=n}})}function Ohe(t){sl({scenario:"sideBySideMessages",page:"chat",customData:JSON.stringify({eventInfo_event:"receivedSxsEvent",eventInfo_sideBySideComparisonId:t})})}function Lhe(t){const{sideBySideComparisonId:e,isControlMessage:n}=t;ht({pageName:"chat",sectionName:"sideBySideMessages",source:"selectedSxs",customData:JSON.stringify({eventInfo_sideBySideComparisonId:e,eventInfo_isControlMessage:n})})}function r9(t){const{sideBySideComparisonId:e,reason:n}=t;ht({pageName:"chat",sectionName:"sideBySideMessages",source:"defaultedSxs",customData:JSON.stringify({eventInfo_sideBySideComparisonId:e,eventInfo_defaultReason:n})})}function Dhe(t){const{card:e,messageId:n,conversationId:r}=t,o={eventName:"copilotImpression",eventInfo_impressionPage:"chat",eventInfo_impressionScenario:"answerCardReceived",eventInfo_answerCardType:e.type,eventInfo_messageId:n,eventInfo_conversationId:r};switch(e.type){case"image":o.eventInfo_answerCardContentLength=e.images.length;break;case"localEntity":o.eventInfo_answerCardContentLength=e.entities.length;break;case"financeChart":o.eventInfo_answerCardScenario=e.instrument.securityType;break}z.trackEvent({name:"system",data:o})}function jhe(t){const{card:e,messageId:n,conversationId:r}=t,o=performance.now(),i=Ge(UO);if(!i)return;const s={eventName:"copilotAnswerCardReceived",eventInfo_messageId:n,eventInfo_conversationId:r,eventInfo_cardType:e.type,eventInfo_duration:o-i};z.trackEvent({name:"system",data:s})}function Uhe(t){const{message:e,conversationId:n}=t;for(const r of e.content)switch(r.type){case"card":Dhe({card:r.card,messageId:e.id,conversationId:n}),jhe({card:r.card,messageId:e.id,conversationId:n});break}}async function Fhe(t){z.setSettings({userConsentModelTraining:!t.optOutOfTraining,userConsentPersonalization:!t.optOutOfPersonalization,userSettingPhoneConnection:!t.optOutOfPhoneConnection,userSettingGenUI:!t.optInToGenerativeUI}),await Wr({path:"/user/settings",args:{options:{method:"PATCH"},body:{optOutOfTraining:t.optOutOfTraining,optOutOfPersonalization:t.optOutOfPersonalization,optInToVoiceTraining:t.optInToVoiceTraining,optOutOfPhoneConnection:t.optOutOfPhoneConnection,optInToGenerativeUI:t.optInToGenerativeUI,allowBiometricDataUse:t.allowBiometricDataUse,allowOneDriveAccess:t.allowOneDriveAccess,features:t.features}}})}async function Bhe(){var e,n;const t=await qn("/user",V5,{parseOptions:{safe:!0},query:{"api-version":"2"}}).then(r=>r.data);st().set(ST,((e=t.remainingCalls)==null?void 0:e.podcastGeneration)??null),st().set(Tb,((n=t.remainingCalls)==null?void 0:n.research)??null)}const Wt=st();function uN(t){return{chatMode:"chat",timing:new kde(t),citationCount:0,imageCount:0,chainOfThoughtCount:0,inputMethod:"text"}}let t0=null;async function dN(){return t0||(t0=H(()=>import("./index-DS1hydBz.js"),[]).then(t=>t.applyPatch)),t0}class Hhe{constructor(e){W(this,"ws");W(this,"conversationMetadata",new Map);W(this,"conversationIdByMessageId",new Map);W(this,"messageIdByTaskId",new Map);W(this,"latestMessagePartIdentifier",null);W(this,"pendingSideBySideMessages",new Map);this.ws=e,this.send=this.send.bind(this),this.regenerate=this.regenerate.bind(this),this.sendChallengeResponse=this.sendChallengeResponse.bind(this),this.resetConversationState=this.resetConversationState.bind(this),this.resetConversationTiming=this.resetConversationTiming.bind(this),this.setConversationIdByMessageId=this.setConversationIdByMessageId.bind(this),this.setMessageIdByTaskId=this.setMessageIdByTaskId.bind(this),this.onSubmitMessageBlocked=this.onSubmitMessageBlocked.bind(this),this.callBeforeSendForConversation=this.callBeforeSendForConversation.bind(this),this.callOnSentForConversation=this.callOnSentForConversation.bind(this),this.setChatModeForConversation=this.setChatModeForConversation.bind(this),this.setInputMethodForConversation=this.setInputMethodForConversation.bind(this),this.setUserMessageForConversation=this.setUserMessageForConversation.bind(this),this.processEvent=this.processEvent.bind(this),this.sendMessagePreview=this.sendMessagePreview.bind(this)}getConversationState(e){return this.conversationMetadata.has(e)||this.conversationMetadata.set(e,uN(performance.now())),this.conversationMetadata.get(e)}get latestMessagePartId(){return this.latestMessagePartIdentifier}resetConversationState(e,n){this.conversationMetadata.set(e,uN(n))}resetConversationTiming(e,n){this.getConversationState(e).timing.resetStartTime(n)}setConversationIdByMessageId(e){const{messageId:n,conversationId:r}=e;this.conversationIdByMessageId.set(n,r)}setMessageIdByTaskId(e){const{taskId:n,messageId:r}=e;this.messageIdByTaskId.set(n,r)}onSubmitMessageBlocked(e){const{timing:n,chatMode:r,inputMethod:o}=this.getConversationState(e);n.onSubmitMessageBlocked(r,o,e)}callBeforeSendForConversation(e){this.getConversationState(e).timing.onBeforeSend()}callOnSentForConversation(e,n){this.getConversationState(e).timing.onSent(n)}setChatModeForConversation(e,n){const r=this.getConversationState(e);r.chatMode=n}setInputMethodForConversation(e,n){const r=this.getConversationState(e);r.inputMethod=n}setUserMessageForConversation(e,n){const r=this.getConversationState(e);r.lastUserMessage=n}send(e){const{content:n,conversationId:r,data:o,mode:i,context:s}=e,a={event:"send",conversationId:r,content:Array.isArray(n)?n:[n],mode:i,context:s,...o};this.ws.send(JSON.stringify(a))}sendChallengeResponse(e){this.ws.send(JSON.stringify({event:"challengeResponse",token:e.token,method:e.method}))}regenerate(e){const{messageId:n,mode:r}=e,o={event:"regenerate",messageId:n,mode:r};this.ws.send(JSON.stringify(o))}sendMessagePreview(e){const{content:n,conversationId:r,data:o,mode:i,context:s}=e,a={event:"messagePreview",conversationId:r,content:Array.isArray(n)?n:[n],mode:i,context:s,...o};this.ws.send(JSON.stringify(a))}processEvent(e){switch("id"in e&&(this.latestMessagePartIdentifier=e.id??null),e.event){case"received":this.handleReceived(e);break;case"connected":this.handleConnected(e);break;case"emojiReaction":this.handleEmojiReaction(e);break;case"startMessage":this.handleStartMessage(e);break;case"appendText":this.handleAppendText(e);break;case"replaceText":this.handleReplaceText(e);break;case"invokeAction":this.handleInvokeAction(e);break;case"chainOfThought":this.handleChainOfThought(e);break;case"citation":this.handleCitation(e);break;case"generatingImage":this.handleGeneratingImage(e);break;case"imageGenerated":this.handleImageGenerated(e);break;case"partialImageGenerated":this.handlePartialImageGenerated(e);break;case"imageGenerationFailed":this.handleImageGenerationFailed(e);break;case"generatingCard":this.handleGeneratingCard(e);break;case"cardGenerationFailed":this.handleCardGenerationFailed(e);break;case"page":this.handlePage(e);break;case"titleUpdate":this.handleTitleUpdate(e);break;case"challenge":this.handleChallenge();break;case"card":this.handleCard(e);break;case"document":this.handleDocument(e);break;case"taskStart":this.handleTaskStart(e);break;case"taskUpdate":this.handleTaskUpdate(e);break;case"error":this.handleError(e);break;case"banned":this.handleBanned(e);break;case"suggestedFollowups":this.handleSuggestedFollowups(e);break;case"done":this.handleDone(e);break;case"startSuggestion":this.handleStartSuggestion(e);break;case"appendSuggestion":this.handleAppendSuggestion(e);break;case"activityStart":this.handleActivityStart(e);break;case"activityUpdate":this.handleActivityUpdate(e);break;case"memorySignal":this.handleMemorySignal(e);break;case"sideBySideComparison":this.handleSideBySideComparison(e);break;case"modeSelected":this.handleModeSelected(e);break}}handleMemorySignal(e){if(zi("kill-memory-edf-basic"))return;const{messageId:n,partId:r,text:o,signalType:i}=e,s=this.conversationIdByMessageId.get(n);if(!s)return;this.getConversationState(s).timing.onMemorySignalReceived({messageId:n,conversationId:s}),Ht(s,c=>{const u=Dn(c,n);u&&u.content.push({type:"memorySignal",partId:r,text:o,signalType:i})})}handleSideBySideComparison(e){if(!We("side-by-side-comparison"))return;const{sideBySideComparisonId:n,conversationId:r,options:o,defaultMessageId:i}=e;Ohe(n),_i(r,s=>{s.sideBySideComparisonId=n});for(const{messageId:s,position:a}of o)this.pendingSideBySideMessages.set(s,{position:a,isDefault:s===i})}handleModeSelected(e){const{messageId:n,mode:r}=e,o=this.conversationIdByMessageId.get(n),i=Ge(_n);if(!o)return;We("smart-mode-cot")&&i==="smart"&&r==="reasoning"&&Ht(o,a=>{const c=Dn(a,n);c&&c.content.push({type:"chainOfThought",text:X("chat.reasoningLoading.emptyCoTText"),partId:"-1"})})}clearAllStreamingStates(){const e=Wt.get(En);for(const n of e.values())_i(n.id,r=>{r.streamingState="idle"})}handleReceived(e){const{messageId:n,conversationId:r}=e;this.conversationIdByMessageId.set(n,r);const o=this.getConversationState(r);o.timing.onReceived({messageId:n,conversationId:r,chatMode:o.chatMode}),H2([`humanMessage_${n}`,`conversation_${r}`]),Wt.set(Ac,i=>i&&!Dg()?i-1:i),Ht(r,i=>{const s=i.at(-1);(s==null?void 0:s.author)==="human"&&(s.id=n)}),Che()}handleConnected(e){fb.trackLatestChatConnectedAssignment(e)}handleEmojiReaction(e){const{messageId:n,emoji:r}=e,o=this.conversationIdByMessageId.get(n);o&&Ht(o,i=>{const s=lZ(i,n);s&&(s.emojiReaction=r)})}handleStartMessage(e){const{messageId:n,conversationId:r,createdAt:o}=e;this.conversationIdByMessageId.set(n,r);const i=this.getConversationState(r),{chatMode:s}=i;i.citationCount=0,i.timing.onStartMessage({messageId:n,conversationId:r,chatMode:s}),We("multiplecharacters")&&Wt.set(fc,"responding"),H2([`aiMesssage_${n}`,`conversation_${r}`]);const a=this.pendingSideBySideMessages.get(n),c={id:n,createdAt:o,author:"ai",content:[],mode:s,sideBySideConfig:a};_i(r,u=>{u.streamingState="streaming"}),Ht(r,u=>{u.length===0&&TL(Wt.get(li),r)||u.push(c)})}handleAppendText(e){const{text:n,messageId:r,partId:o}=e,i=this.conversationIdByMessageId.get(r);if(!i)return;const s=this.getConversationState(i);s.timing.onFirstToken(r,s.chatMode,i),Ht(i,a=>{const c=Dn(a,r);if(c){Wl(i,c.id);let u=ja(c.content,o);if(!u)u={type:"text",text:"",partId:o},c.content.push(u);else if(u.type!=="text"){console.error(`appendText event with partId that is not a text item. Item is of type ${u.type}`,e);return}u.text=u.text.concat(n),dZ(c)}})}handleReplaceText(e){const{text:n,messageId:r,partId:o}=e,i=this.conversationIdByMessageId.get(r);i&&Ht(i,s=>{const a=Dn(s,r);if(a){Wl(i,a.id);let c=ja(a.content,o);if(!c)c={type:"text",text:"",partId:o},a.content.push(c);else if(c.type!=="text"){console.error("replaceText event with partId that is not a text item",e);return}c.text=n,c.citations=void 0}})}handleCitation(e){const{title:n,url:r,messageId:o,publisher:i,iconUrl:s}=e,a=this.conversationIdByMessageId.get(o);if(!a)return;const c=this.getConversationState(a);R$(r,a,o),Ht(a,u=>{const h=Dn(u,o);if(h){Wl(a,h.id);const p=uZ(h.content);if(p){p.citations||(p.citations=[]);const f=p.citations.find(v=>v.url===r);let g;f?g=f.index:(c.citationCount+=1,g=`${c.citationCount}`,p.citations.push({index:g,url:r,iconUrl:s,title:n,publisher:i})),p.text=p.text.concat(n9(g,r))}}})}handleGeneratingImage(e){const{prompt:n,messageId:r,partId:o,progressionText:i}=e,s=this.conversationIdByMessageId.get(r);if(!s)return;const a=this.getConversationState(s);a.timing.onImageGenerationStart({messageId:r,conversationId:s,chatMode:a.chatMode}),Ht(s,c=>{const u=Dn(c,r);u&&u.content.push({type:"image",prompt:n,partId:o,partialGenerationStep:0,status:"generating",progressionText:i})})}handleImageGenerated(e){const{url:n,partId:r,messageId:o}=e,i=this.conversationIdByMessageId.get(o);if(!i)return;const s=this.getConversationState(i);s.imageCount+=1,s.timing.onImageReceived({messageId:o,conversationId:i,chatMode:s.chatMode}),Ht(i,a=>{const c=Dn(a,o);if(c){const u=ja(c.content,r);(u==null?void 0:u.type)==="image"&&(u.isPartiallyLoading=!1,u.url=n,u.partialGenerationStep=void 0,u.status="generated",u.progressionText=void 0)}})}handlePartialImageGenerated(e){const{content:n,messageId:r,partId:o}=e,i=this.conversationIdByMessageId.get(r);if(!i)return;const s=this.getConversationState(i);Ht(i,a=>{const c=Dn(a,r);if(c){const u=ja(c.content,o);if((u==null?void 0:u.type)==="image"){u.isPartiallyLoading=!0,u.url=`data:image/png;base64,${n}`;const h=(u.partialGenerationStep??0)+1;u.partialGenerationStep=h,u.status="generating",s.timing.onPartialImageReceived({messageId:r,conversationId:i,chatMode:s.chatMode,imageGenPhase:h})}}})}getImageGenerationErrorMessage(e){switch(e){case"not-signed-in":return;case"throttled":return X("error.imageGenerationFailedThrottled");case"blocked":return;default:return X("error.imageGenerationFailed")}}handleImageGenerationFailed(e){const{messageId:n,partId:r,errorCode:o}=e,i=this.conversationIdByMessageId.get(n);if(!i)return;Ht(i,a=>{const c=Dn(a,n);c&&(c.content=c.content.filter(u=>u.type!=="image"||u.partId!==r))});const s=this.getImageGenerationErrorMessage(o);o==="not-signed-in"&&Wt.set(ml,{isOpen:!0,scenario:null,reason:"imageGeneration"}),s&&Ph(s,i)}handleCardGenerationFailed(e){const n=Wt.get(Nh);if(n&&this.isGeneratedCards(n)){Wt.set(Nh,void 0);const r=this.conversationIdByMessageId.get(e.messageId);if(!r)return;n==="quiz"&&Ph(X("quizCard.generatedQuizFailed"),r)}}handleGeneratingCard(e){const{type:n}=e;this.isGeneratedCards(n)&&Wt.set(Nh,n)}isGeneratedCards(e){return tL.safeParse(e).success}handleTitleUpdate(e){const{conversationId:n,title:r}=e;Wt.set(En,o=>Ar(o,i=>{const s=i.get(n);s&&(s.title=r)}))}handleCard(e){const{messageId:n,partId:r,card:o}=e,i=this.conversationIdByMessageId.get(n);if(!i)return;const s=this.getConversationState(i);if(o.type==="ads"){Zde({card:o,messageId:n,partId:r,conversationState:s,conversationId:i});return}Ht(i,a=>{const c=Dn(a,n);c&&c.content.push({type:"card",partId:r,card:o})})}handleDocument(e){const{messageId:n,partId:r,attachmentId:o,fileName:i,contentType:s}=e,a=this.conversationIdByMessageId.get(n);a&&Ht(a,c=>{const u=Dn(c,n);u&&u.content.push({type:"document",partId:r,attachmentId:o,fileName:i,contentType:s})})}handleBanned(e){const{expiresAt:n}=e,r=pw(n);r&&mw(r,"chat",n)}handlePage(e){const{messageId:n,page:r,partId:o}=e,i=this.conversationIdByMessageId.get(n);i&&(Ht(i,s=>{const a=Dn(s,n);a&&a.content.push({type:"page",partId:o,page:r})}),Mt.emit("pages:page-created",r))}handleStartSuggestion(e){const{pageId:n,suggestionId:r,editTargets:o}=e;Phe(n,{id:r,text:void 0,editTargets:o})}handleAppendSuggestion(e){const{pageId:n,suggestionId:r,text:o}=e;Mhe(n,r,o)}handleActivityStart(e){if(!Pg())return;const{messageId:n,partId:r,activity:o}=e,i=this.conversationIdByMessageId.get(n);i&&Ht(i,s=>{const a=Dn(s,n);a?(Wl(i,a.id),a.content.push({activity:o,type:"activity",partId:r})):Kde(n)})}async handleActivityUpdate(e){if(!Pg())return;const{messageId:n,partId:r,update:o}=e,i=this.conversationIdByMessageId.get(n);if(i)try{const s=await dN();Ht(i,a=>{const c=Dn(a,n);if(!c)return;const u=ja(c.content,r);if(!u||u.type!=="activity"){qde(n,r);return}s(u.activity,o)})}catch(s){Wde(s)}}processInvokeAction(e){const n=Wt.get(pt);if(n)switch(e.actionName){case"phone_send_message":{Ht(n,r=>{const o=wL(r);o&&o.content.push({type:"card",partId:Math.random().toString(),card:{type:"phoneSendMessage",actionId:e.actionId,contactName:e.parameters.contactName,text:e.parameters.text,phoneNumber:e.parameters.phoneNumber}})});break}case"edge_get_page_content":{const r=e.parameters.map(o=>({tabId:o.tabId,windowId:o.windowId,pageUrl:o.pageUrl??""}));Nle.run({actionId:e.actionId,tabs:r});break}}}handleInvokeAction(e){const{success:n,data:r}=ehe.safeParse(e);n?this.processInvokeAction(r):console.error("Invalid action data:",e)}handleTaskStart(e){const{messageId:n,task:r,partId:o}=e,i=this.conversationIdByMessageId.get(n);this.messageIdByTaskId.set(r.id,n);const s=new Date().toISOString();if(i){ohe([r],i,s),Wt.set(Eu,!1),Ht(i,c=>{const u=Dn(c,n);if(u){const h=xde(r,o,s);h&&u.content.push(h)}}),xle.run({task:r,action:"startTask"});const a=Wt.get(pt);r.type==="computerUse"&&i===a&&Gde(r.conversationId,i),(r.type==="podcast"||r.type==="research")&&Bhe()}}async handleTaskUpdate(e){const{taskId:n,update:r}=e;if(Bde(n,r))return;let o=!1;const i=this.messageIdByTaskId.get(n),s=i?this.conversationIdByMessageId.get(i):void 0;try{const a=await dN();i&&s&&Ht(s,c=>{const u=We("ds-new-progress")||We("multiple-research-tasks-in-conversation")&&EO,h=Dn(c,i,u);if(h){const p=sZ(h.content),f=p==null?void 0:p.task;f&&f.type==="research"&&(a(f,r),Dde(f,s))}}),AT(n,c=>{var u;if(c.type==="computerUse"&&a(c,r),c.type==="podcast"){const h=((u=c.podcast)==null?void 0:u.id)??"";a(c,r),c.podcast&&(c.podcast.id=h)}}),o=!0}catch(a){console.error("Error applying task update patch:",a)}if(o){const a=Wt.get(li).get(n);switch(a==null?void 0:a.type){case"computerUse":$de(n,r);break;case"podcast":Pde(a);break}}}handleSuggestedFollowups(e){const{disableMultiturn:n}=be.instance().config();if(!n){const{suggestions:r,messageId:o}=e,i=this.conversationIdByMessageId.get(o);i&&_i(i,s=>{s.suggestedFollowup={messageId:o,suggestions:r}})}}handleError(e){const{errorCode:n}=e;if(n==="over-turn-limit")Wt.set(Ac,0);else if(n==="over-reasoning-quota"){!Wt.get(wd)&&Dg()&&be.instance().config().thinkDeeperFreemiumEnabled&&(Wt.set(Y$,"chat-over-reasoning-quota"),Wt.set(Yr,"reasoning-mode-pro-subscription")),Wt.set(_n,"chat");for(const[o]of this.conversationMetadata.entries())Ph(X("chat.overCapacity"),o)}else if(n==="over-task-quota"||n==="over-lifetime-task-quota")Wt.set(Q$,n),Wt.set(Yr,"over-task-quota");else if(n==="unknown-error")for(const[r]of this.conversationMetadata.entries())_i(r,o=>{o.streamingState="idle"});else if(n==="page-content-length-exceeded"||n==="page-count-exceeded"){Mt.emit("page:message-error",n);for(const[r]of this.conversationMetadata.entries())_i(r,o=>{o.streamingState="idle"})}else for(const[r]of this.conversationMetadata.entries())Ph(X("error.eventNotRecognized"),r);Wt.set(Eu,!1)}handleChainOfThought(e){const{messageId:n,partId:r,text:o}=e,i=this.conversationIdByMessageId.get(n);i&&Ht(i,s=>{const a=Dn(s,n);if(a){Wl(i,a.id);let c=ja(a.content,r);const u=this.getConversationState(i);if(c)c.type!=="chainOfThought"?console.error(`chainOfThought event with partId that is not a chainOfThought item. Item is of type ${c.type}`,e):c.text=c.text.concat(o);else{c={type:"chainOfThought",text:"",title:"",partId:r},a.content.push(c);const{title:h,text:p}=dhe(o);c.title=h,c.text=p,u.timing.onChainOfThoughtReceived({messageId:n,conversationId:i,chatMode:u.chatMode}),u.chainOfThoughtCount+=1}}})}handleChallenge(){if(!zi("kill-cf-turnstile")){const e=Wt.get(pt);if(!e)return;const{lastUserMessage:n}=this.getConversationState(e);uhe(r=>{this.sendChallengeResponse({token:r,method:"cloudflare"}),n&&this.send(n)})}}handleDone(e){var u;We("multiplecharacters")&&Wt.get(fc)==="responding"&&Wt.set(fc,"idle");const{messageId:n}=e,r=this.conversationIdByMessageId.get(n);if(!r)return;const o=this.getConversationState(r);o.timing.onLastToken({messageId:n,conversationId:r,citationCount:o.citationCount,imageCount:o.imageCount,chainOfThoughtCount:o.chainOfThoughtCount,chatMode:o.chatMode,inputMethod:o.inputMethod});const s=((u=Wt.get(En).get(r))==null?void 0:u.history)??[],a=Dn(s,n);Ht(r,h=>{if(!a)return;const p=Dn(h,a.id),f=a.content.find(g=>g.type==="image"&&g.partialGenerationStep!==void 0);if(p&&f){const g=ja(p.content,f.partId);g&&(g.partialGenerationStep===0?g.type="deleted":g.type==="image"&&(g.isPartiallyLoading=!1,g.partialGenerationStep=void 0,g.status="non-complete"))}}),this.pendingSideBySideMessages.get(n)&&this.pendingSideBySideMessages.delete(n),this.pendingSideBySideMessages.size===0&&_i(r,h=>{h.streamingState="idle"}),Wt.set(Nh,void 0),Wt.set(Eu,!1),window.setTimeout(()=>{Wt.set(GI,h=>Ar(h,p=>{const f=p.get(r);f!=null&&f.has(n)&&(f.delete(n),f.size===0&&p.delete(r))}))},3e3),Wt.set($O,!0),a&&Uhe({message:a,conversationId:r}),Mle.run({conversationMessages:s})}}const zhe="eval/chat";function Vhe(t,e){return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}function Ew(t){const e=typeof window<"u"?window.matchMedia(t):null,[n,r]=m.useState(e==null?void 0:e.matches);return m.useEffect(()=>{e&&Vhe(e,o=>r(o.matches))},[t,e]),!!n}const o9={sm:"640",md:"768",lg:"1024",xl:"1280",xxl:"1920"};function pr(t){const{breakpoint:e}=t,n=o9[e];return!Ew(`(min-width: ${n}px)`)}function Iw(t){const{breakpoint:e}=t,r=`(min-width: ${o9[e]}px)`,o=typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia(r):null;return!(o!=null&&o.matches)}function $he(){const t=We("weather-cards"),e=!zi("kill-image-cards"),n=We("local-cards"),r=We("sports-cards"),o=!zi("kill-video-cards"),i=We("shopping-card"),s=We("shopping-curated"),a=We("media-spotlight-card"),c=We("job-cards"),u=We("safetycards"),h=We("quiz-cards"),p=We("generateads"),f=We("generateadsint"),g=We("adsparity"),v=!zi("kill-finance-cards"),y=We("adstags"),b=We("product-ads-dynamic-filter"),C=We("property-promotion-ads-dynamic-filter"),S=We("tour-activity-ads-dynamic-filter"),E=We("adsshowroom")||We("adsshowroomagent"),I=We("emoji-reactions"),T=We("imagegenv3");We("turn-telemetry");const _=We("recipe-card"),w=We("file-cards"),A=We("side-by-side-comparison"),M=cw(),{adsEnabled:R,adsShowroomEnabled:$,disableAnswerCards:V,enforceAdsOptOutOfPersonalization:ie,answerCardOverrides:N}=be.instance().config(),Y=!!st().get(wd),ue=(p||f||g)&&R&&!Y&&!M,j=a&&(N==null?void 0:N.shouldEnableMediaSpotlightCard),U=[];V||(t&&U.push("weather"),n&&U.push("local"),e&&U.push("image"),r&&U.push("sports"),o&&U.push("video"),i&&U.push("shopping"),c&&U.push("job"),ue&&U.push("ads"),u&&U.push("safetyHelpline"),h&&U.push("quiz"),v&&U.push("finance"),s&&U.push("shoppingCurated"),_&&U.push("recipe"),w&&U.push("file"),j&&U.push("mediaSpotlight"));const te={supportedTypes:["text","product","multimedia","tourActivity","propertyPromotion"]};ie&&(te.optOutOfPersonalization=!0),E&&R&&$&&te.supportedTypes.push("showroom"),(b||y)&&(te.product={tagsSupported:!0}),C&&(te.propertyPromotion={tagsSupported:!0}),S&&(te.tourActivity={tagsSupported:!0});const Q=[];I&&Q.push("emoji-reactions"),T&&Q.push("partial-generated-images");const re=!Iw({breakpoint:"lg"});return A&&re&&Q.push("side-by-side-comparison"),{supportedFeatures:Q,supportedCards:U.length>0?U:void 0,ads:ue?te:null}}const hN=1e3,Ghe=3e4,Khe=5e3;class qhe{constructor({autoReconnect:e=!1}={}){W(this,"connection");W(this,"autoReconnect");W(this,"reconnectInterval");W(this,"maxReconnectInterval");W(this,"reconnectTimeout");W(this,"sendQueue",[]);W(this,"connecting",!1);W(this,"state",null);W(this,"cachedSendData",null);W(this,"pongTimeout",null);W(this,"boundReconnectIfNeeded");W(this,"boundDisconnect");W(this,"boundVisibilityChange");W(this,"getUrl",null);W(this,"onopen");W(this,"onmessage");W(this,"onclose");W(this,"onerror");this.connection=null,this.autoReconnect=e,this.reconnectInterval=hN,this.maxReconnectInterval=e?Ghe:0,this.reconnectTimeout=null,this.onopen=null,this.onmessage=null,this.onclose=null,this.onerror=null,this.connect=this.connect.bind(this),this.reconnect=this.reconnect.bind(this),this.processSendQueue=this.processSendQueue.bind(this)}async initialize(){this.state=null,await this.connect(),this.autoReconnect&&(this.boundReconnectIfNeeded=this.reconnectIfNeeded.bind(this),this.boundDisconnect=this.disconnect.bind(this),this.boundVisibilityChange=()=>{document.visibilityState==="visible"&&this.reconnectIfNeeded()},window.addEventListener("online",this.boundReconnectIfNeeded),window.addEventListener("offline",this.boundDisconnect),document.addEventListener("visibilitychange",this.boundVisibilityChange))}async connect(){var n;if(((n=this.connection)==null?void 0:n.readyState)===WebSocket.CONNECTING||this.connecting||this.pongTimeout)return;if(!this.getUrl)throw new Error("getUrl function is not set");this.connecting=!0;const e=await this.getUrl();this.connection=new WebSocket(e),this.connecting=!1,this.connection.onopen=r=>{this.state=null,this.onopen&&this.onopen(r),this.processSendQueue(),this.reconnectInterval=hN,this.reconnectTimeout&&(window.clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null)},this.connection.onmessage=r=>{if(this.state!=="destroyed")try{const o=JSON.parse(r.data);this.onmessage&&this.onmessage(o),o.event==="pong"&&(this.removePongTimeout(),this.processSendQueue())}catch{}},this.connection.onclose=r=>{this.connection&&this.connection.bufferedAmount>0&&this.cachedSendData&&(this.sendQueue.push(this.cachedSendData),this.cachedSendData=null),this.onclose&&this.onclose(r),this.autoReconnect&&this.state===null&&this.reconnect(),this.removePongTimeout()},this.connection.onerror=r=>{this.onerror&&this.onerror(r),this.connection&&this.connection.close(),this.removePongTimeout()}}reconnect(){this.reconnectTimeout&&window.clearTimeout(this.reconnectTimeout),this.reconnectTimeout=window.setTimeout(this.connect,this.reconnectInterval),this.reconnectInterval=Math.min(this.reconnectInterval*2,this.maxReconnectInterval)}processSendQueue(){if(this.sendQueue.length>0){const e=this.sendQueue;this.sendQueue=[];for(const n of e)this.send(n)}}reconnectIfNeeded(){if(this.state!=="destroyed"){if(!this.connection||this.connection.readyState!==WebSocket.OPEN){this.reconnect();return}this.pongTimeout===null&&(this.connection.send(JSON.stringify({event:"ping"})),this.pongTimeout=window.setTimeout(()=>{var e;this.pongTimeout=null,(e=this.connection)==null||e.close(),this.reconnect()},Khe))}}removePongTimeout(){this.pongTimeout!==null&&(window.clearTimeout(this.pongTimeout),this.pongTimeout=null)}send(e){if(this.state!=="destroyed")if(this.connection&&this.connection.readyState===WebSocket.OPEN&&this.pongTimeout===null)try{this.cachedSendData=e,this.connection.send(e)}catch{this.sendQueue.push(e),this.connect()}else this.sendQueue.push(e),this.connect()}cleanup(){this.boundReconnectIfNeeded&&window.removeEventListener("online",this.boundReconnectIfNeeded),this.boundDisconnect&&window.removeEventListener("offline",this.boundDisconnect),this.boundVisibilityChange&&document.removeEventListener("visibilitychange",this.boundVisibilityChange)}disconnect(){this.connection&&(this.state="disconnected",this.connection.close())}destroy(){this.connection&&(this.state="destroyed",this.cleanup(),this.connection.close(),this.connection=null)}}async function es({useMockConnection:t}={}){const e=async({cursor:n})=>{const r=lj()?zhe:"chat";return n?B2(r,{cursor:n}):B2(r)};return cg.get({getUrl:e})}async function Whe({getUrl:t}){return typeof WebSocket>"u"?{destroy:()=>{},send:()=>{},regenerate:()=>{},sendContext:()=>{},sendAudioStart:()=>{},sendAudio:()=>{},sendAudioEnd:()=>{},setCallType:()=>{},stop:()=>{},setOnEvent:()=>()=>{},sendChallengeResponse:()=>{},sendActionResult:()=>{},sendMessagePreview:()=>{},selectSxSMessage:()=>{},resetConversationState:()=>{},resetConversationTiming:()=>{},setConversationIdByMessageId:()=>{},setMessageIdByTaskId:()=>{},setChatModeForConversation:()=>{},setInputMethodForConversation:()=>{},callBeforeSendForConversation:()=>{},callOnSentForConversation:()=>{},setUserMessageForConversation:()=>{},onSubmitMessageBlocked:()=>{}}:new Promise((e,n)=>{const r=zi("kill-chat-auto-reconnect"),o=new qhe({autoReconnect:!r}),i=new Hhe(o);o.getUrl=()=>t({cursor:i.latestMessagePartId}),o.onopen=()=>{const a={event:"setOptions",...$he()};o.send(JSON.stringify(a)),o.onmessage=c=>{try{Xk.parse(c)}catch(u){u instanceof vg&&Tf(u,"/chat")}i.processEvent(c)},e({destroy:()=>{o.destroy(),i.clearAllStreamingStates()},stop:(c={})=>{const{conversationId:u,taskId:h}=c;o.send(JSON.stringify({event:"stop",conversationId:u})),h&&o.send(JSON.stringify({event:"send",conversationId:u,content:[{type:"command",command:{type:"cancelTask",taskId:h}}],mode:"research"})),u&&_i(u,p=>{p.streamingState="idle"})},send:i.send,regenerate:i.regenerate,sendContext:c=>{o.send(JSON.stringify({event:"sendContext",context:c}))},sendAudioStart:(c,u,h)=>{const p={event:"audioStart",conversationId:c,options:u,clientType:h};o.send(JSON.stringify(p))},sendAudio:c=>{const u={event:"audio",audio:c};o.send(JSON.stringify(u))},sendAudioEnd:()=>{const c={event:"audioEnd"};o.send(JSON.stringify(c))},setCallType:c=>{const u={event:"setCallType",callType:c};o.send(JSON.stringify(u))},sendChallengeResponse:i.sendChallengeResponse,setOnEvent:c=>{o.onmessage=u=>{try{Xk.parse(u),i.processEvent(u)}catch(h){h instanceof vg&&Tf(h,"/chat")}c(u)}},sendActionResult:c=>{o.send(JSON.stringify({event:"actionResult",actionId:c.actionId,result:c.result}))},selectSxSMessage:c=>{const{sideBySideComparisonId:u,selectedMessageId:h}=c,p={event:"selectMessage",sideBySideComparisonId:u,selectedMessageId:h};o.send(JSON.stringify(p))},resetConversationState:i.resetConversationState,resetConversationTiming:i.resetConversationTiming,setConversationIdByMessageId:i.setConversationIdByMessageId,setMessageIdByTaskId:i.setMessageIdByTaskId,setChatModeForConversation:i.setChatModeForConversation,setInputMethodForConversation:i.setInputMethodForConversation,callBeforeSendForConversation:i.callBeforeSendForConversation,callOnSentForConversation:i.callOnSentForConversation,setUserMessageForConversation:i.setUserMessageForConversation,onSubmitMessageBlocked:i.onSubmitMessageBlocked,sendMessagePreview:i.sendMessagePreview.bind(i)})},o.onclose=()=>{},o.onerror=s=>{const a=s instanceof ErrorEvent?s.message:"Unknown WebSocket error";z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"ChatWebsocketError",eventInfo_errorMessage:a,eventInfo_details:JSON.stringify(s)}}),n(new Error(`WebSocket connection error: ${a}`))},o.initialize().catch(s=>{const a=s instanceof Error?s.message:"Unknown WebSocket error";z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"ChatWebsocketInitializationError",eventInfo_errorMessage:a,eventInfo_details:s instanceof Error?s.stack??"":""}}),n(new Error(`WebSocket initialization error: ${a}`))})})}async function Tw(){if(cg.isInstantiated){const t=Ge(go),e=(t==null?void 0:t.streamingState)==="streaming",n=await cg.get();n.stop(),n.destroy(),n.stop({conversationId:t==null?void 0:t.id}),cg.reset();try{z.trackEvent({name:"system",data:{eventName:"chatClientReset",eventInfo_isMessageStreaming:e}})}catch{}}}const cg=new al(t=>Whe(t));function Yhe(t,e,n,r={text:"",atTimestamp:0,files:[]}){return n?e.length!==r.files.length?!0:!!!(t&&t.length>=n.minTextLength)||r.atTimestamp&&r.atTimestamp+n.debounceInMilliseconds>=Date.now()?!1:t&&r.text&&(t.includes(r.text)||r.text.includes(t))?Math.abs((t.length-r.text.length)/r.text.length)>=n.textDeltaPercent/100:!0:!1}const fa=D(null),i9=D(t=>{const e=t(fa);return(e==null?void 0:e.type)==="attachments"?e.uploadAttachments:[]},(t,e,n,r)=>{const o=t(fa),i=t(i9),s=typeof n=="function"?n(i):n;s.length===0&&(o==null?void 0:o.type)!=="attachments"||e(fa,{type:"attachments",uploadAttachments:s,source:r})}),Ia=D(t=>{const e=t(fa);return(e==null?void 0:e.type)==="tabs"?e.userAddedTabs:new Map},(t,e,n)=>{const r=t(fa),o=t(Ia),i=typeof n=="function"?n(o):n;i.size===0&&(r==null?void 0:r.type)!=="tabs"||e(fa,{type:"tabs",userAddedTabs:i})}),Qhe=D(t=>{const e=t(fa);return(e==null?void 0:e.type)==="attachments"&&e.uploadAttachments.length>0}),Jhe=D(t=>{const e=t(fa);return(e==null?void 0:e.type)==="tabs"&&e.userAddedTabs.size>0});function Zhe(){var e;const t=Ge(lL);if(t)return{character:{id:t.id,locationId:(e=t.location)==null?void 0:e.id}}}function s9(){const t=rp(En),e=Ee(mb);return m.useCallback((n,r)=>{t(o=>{const i=o.get(n);if(i){const{history:s}=i;r(s);const a=s.at(-1);if(a){const c=new Date(i.updatedAt),u=new Date(a.createdAt);c<u&&(i.updatedAt=a.createdAt)}s.length>2&&(i.isNew=!1,e(!0))}return o})},[t,e])}const Xhe=st();function a9(t,e){st().set(En,n=>Ar(n,r=>{const o=r.get(t);if(o){const{history:i}=o;e(i);const s=i.at(-1);if(s){const a=new Date(o.updatedAt),c=new Date(s.createdAt);a<c&&(o.updatedAt=s.createdAt)}i.length>2&&(o.isNew=!1,Xhe.set(mb,!0))}}))}function _w(t){const e=le("force-cookie-banner-location");return(t&&db.includes(t))===!0||e}const efe=5e3,tfe="largest-contentful-paint";function nfe(t,e=efe){if(!rfe())return RE(t,e);try{return ife(t,e)}catch{return RE(t,e)}}function rfe(){return"PerformanceObserver"in window}function RE(t,e){const n=setTimeout(t,e);return()=>clearTimeout(n)}function ofe(t){typeof window.requestIdleCallback<"u"?window.requestIdleCallback(t):setTimeout(t,0)}function ife(t,e){let n=!1;const r=new PerformanceObserver(a=>{if(n)return;a.getEntries().length>0&&i()});try{r.observe({type:tfe,buffered:!0})}catch{return RE(t,e)}const o=setTimeout(()=>{n||i()},e);function i(){n=!0,r.disconnect(),ofe(t)}function s(){n||(n=!0,r.disconnect(),clearTimeout(o))}return s}function sfe(){const t=le("bing-uet"),e=L(Or),n=_w(e);m.useEffect(()=>{const r=bd(),o=!!FI(),i=n?o&&r.advertising:!0;if(!t||!i||!e)return;const s=document.createElement("script");s.src="https://bat.bing.com/bat.js",s.defer=!0,s.onload=()=>{if(!window.UET)return;window.uetq=window.uetq??[];const u={ti:"355045625",enableAutoSpaTracking:!0};window.uetq=new window.UET(u),window.uetq.push("pageLoad")};const c=nfe(()=>{document.querySelector('script[src="https://bat.bing.com/bat.js"]')||document.head.appendChild(s)});return()=>{c();try{const u=document.querySelector('script[src="https://bat.bing.com/bat.js"]');u&&document.head.removeChild(u)}catch{}}},[t,e,n])}let fN=!1;function afe(){fN||(fN=!0,window.uetq=window.uetq??[],window.uetq.push("event","outbound_click",{}))}const Ie=" -a9zG(3jQ)bLNM5R6XucY2KThV7S01deFoWJEtAkIgHpms4xCDvZy8nUrPiql.";function c9(){const t=le("smart-mode-6e0b4c6f"),e=le("smart-mode-cd0c997b"),{titleKey:n,descriptionKey:r}=u9(t,e),o=t||e?[Ie[56],Ie[46],Ie[32],Ie[46],Ie[0],Ie[5],Ie[58],Ie[24],Ie[1],Ie[15],Ie[0],Ie[38],Ie[34],Ie[0],Ie[38],Ie[25],Ie[59],Ie[55],Ie[40],Ie[0],Ie[31],Ie[32],Ie[32],Ie[44],Ie[61],Ie[53],Ie[0],Ie[34],Ie[57],Ie[0],Ie[60],Ie[19],Ie[59],Ie[20],Ie[40],Ie[61],Ie[53],Ie[0],Ie[11],Ie[2],Ie[46],Ie[32],Ie[31],Ie[0],Ie[34],Ie[55],Ie[0],Ie[38],Ie[25],Ie[32],Ie[0],Ie[38],Ie[2],Ie[46],Ie[40],Ie[62]].join(""):X("composer.chatModes.smart.description");return{title:X(n),description:X(r),coachmarkDescription:o}}function l9(){const t=We("smart-mode-6e0b4c6f"),e=We("smart-mode-cd0c997b"),{titleKey:n,descriptionKey:r}=u9(t,e);return{title:X(n),description:X(r)}}function u9(t,e){let n="composer.chatModes.smart.title",r="composer.chatModes.smart.description";return t&&(n=[Ie[28],Ie[45],Ie[2],Ie[57],Ie[38],Ie[0],Ie[6],Ie[5],Ie[58],Ie[24],Ie[1],Ie[15],Ie[10]].join("")),e&&(r=[Ie[56],Ie[46],Ie[32],Ie[46],Ie[0],Ie[5],Ie[58],Ie[24],Ie[1],Ie[15],Ie[0],Ie[38],Ie[34],Ie[0],Ie[38],Ie[25],Ie[59],Ie[55],Ie[40],Ie[0],Ie[60],Ie[19],Ie[59],Ie[20],Ie[40],Ie[61],Ie[53],Ie[0],Ie[34],Ie[57],Ie[0],Ie[31],Ie[32],Ie[32],Ie[44],Ie[61],Ie[53]].join("")),{titleKey:n,descriptionKey:r}}function d9(t){return t?t.startsWith("!"):!1}function $f(t){const e=l9();let n=X(`composer.chatModes.${t}.title`);return t==="reasoning"?n=BV:t==="smart"&&(n=e.title),n}function cfe(t){const e=l9();return t==="smart"?e.description:X(`composer.chatModes.${t}.description`)}const pN={global:["https://ad.doubleclick.net/ddm/activity/src=8406097;type=ofco;cat=lrn_uni;u1={REGION};u2={LANG_LOCALE};u6=CMC;u50=submit_message;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1;num={CACHE_BUSTER}"],us:["https://px.ads.linkedin.com/collect/?fmt=gif&pid=7850&url=copilot.microsoft.com/ChatSend","https://secure.adnxs.com/px?id=1869141&t=2","https://servedby.flashtalking.com/spot/1/5155;147512;16638/?spotName=USA_FY25H2_Copilot_Consumer_Chat_Send_button_FT_2_7_25&cachebuster={CACHE_BUSTER}","https://alb.reddit.com/rp.gif?id=a2_gi5vc4m557wn&event=Custom&m.customEventName=COPChatSend&integration=noscript","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=SendMessage&event_id={CACHE_BUSTER}","https://tr.snapchat.com/p?pid=68db1ef4-2290-4224-a91a-df01d273a994&ev=START_CHECKOUT&v=2.3&rand={CACHE_BUSTER}&pl=https://copilot.microsoft.com/","https://tr.snapchat.com/cm/s?pnid=140","https://www.facebook.com/tr?id=1770559986549030&ev=COPChatSend&noscript=1","https://insight.adsrvr.org/track/pxl/?adv=tq5ketp&ct=0:e8n8utj&fmt=3&td1={td1}&td2={td2}&td3={td3}&td4={td4}&td5={td5}&td6={td6}"],gb:["https://secure.adnxs.com/px?id=1869542&t=2&seg=39793132&consent={CONSENT}","https://px.ads.linkedin.com/collect/?fmt=gif&pid=7850&url=copilot.microsoft.com/ChatSend","https://servedby.flashtalking.com/spot/1/3360;147492;16970/?spotName=GBR_FY25H2_Copilot_Consumer_Chat_Send_FT_2_7_25&cachebuster={CACHE_BUSTER}","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=SendMessage&event_id={CACHE_BUSTER}","https://www.facebook.com/tr?id=1770559986549030&ev=COPChatSend&noscript=1","https://tr.snapchat.com/p?pid=68db1ef4-2290-4224-a91a-df01d273a994&ev=START_CHECKOUT&v=2.3&rand={CACHE_BUSTER}&pl=https://copilot.microsoft.com/","https://tr.snapchat.com/cm/s?pnid=140","https://insight.adsrvr.org/track/pxl/?adv=csnj4o5&ct=0:7s8ltxf&fmt=3&td1={td1}&td2={td2}&td3={td3}&td4={td4}&td5={td5}&td6={td6}"],other:["https://www.facebook.com/tr?id=1770559986549030&ev=COPChatSend&noscript=1","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=SendMessage&event_id={CACHE_BUSTER}"]},lg={onPageLoad:{global:["https://ad.doubleclick.net/ddm/activity/src=8406097;type=ofco;cat=lp_uniq;u1={REGION};u2={LANG_LOCALE};u6=CMC;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1;num={CACHE_BUSTER}"],us:["https://www.facebook.com/tr?id=1770559986549030&ev=PageView&noscript=1","https://px.ads.linkedin.com/collect/?fmt=gif&pid=7850&url=copilot.microsoft.com/custom-pageload","https://secure.adnxs.com/px?id=1869069&t=2","https://servedby.flashtalking.com/spot/1/5155;147507;16638/?spotName=USA_FY25H2_Copilot_Consumer_Page_Load_FT_2_7_25&cachebuster={CACHE_BUSTER}","https://alb.reddit.com/rp.gif?id=a2_gi5vc4m557wn&event=PageVisit&integration=noscript","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=ViewContent&event_id={CACHE_BUSTER}","https://tr.snapchat.com/p?pid=68db1ef4-2290-4224-a91a-df01d273a994&ev=PAGE_VIEW&v=2.3&rand={CACHE_BUSTER}&pl=https://copilot.microsoft.com","https://tr.snapchat.com/cm/s?pnid=140","https://insight.adsrvr.org/track/pxl/?adv=tq5ketp&ct=0:tzodkxv&fmt=3&td1={td1}&td2={td2}&td3={td3}&td4={td4}&td5={td5}&td6={td6}"],gb:["https://www.facebook.com/tr?id=1770559986549030&ev=PageView&noscript=1","https://px.ads.linkedin.com/collect/?fmt=gif&pid=7850&url=copilot.microsoft.com/custom-pageload","https://secure.adnxs.com/px?id=1869539&seg=39793125&t=2&consent={CONSENT}","https://servedby.flashtalking.com/spot/1/3360;147490;16970/?spotName=GBR_FY25H2_Copilot_Consumer_Page_Load_FT_2_7_25&cachebuster={CACHE_BUSTER}","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=ViewContent&event_id={CACHE_BUSTER}","https://tr.snapchat.com/p?pid=68db1ef4-2290-4224-a91a-df01d273a994&ev=PAGE_VIEW&v=2.3&rand={CACHE_BUSTER}&pl=https://copilot.microsoft.com","https://tr.snapchat.com/cm/s?pnid=140","https://insight.adsrvr.org/track/pxl/?adv=csnj4o5&ct=0:2slc99p&fmt=3&td1={td1}&td2={td2}&td3={td3}&td4={td4}&td5={td5}&td6={td6}"],other:["https://www.facebook.com/tr?id=1770559986549030&ev=PageView&noscript=1","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=ViewContent&event_id={CACHE_BUSTER}"]},onMessageSend:pN,onStartVoiceChat:pN,onSuggestionChipClicked:{global:[],us:[],gb:[],other:[]},onDiscoverCardClicked:{global:[],us:[],gb:[],other:[]},onQueryParamSubmit:{global:[],us:[],gb:[],other:[]}},lfe={onPageLoad:{behavior:20,Content:{Id:"CMCChatLoaded",cN:"CMC Chat Loaded"}},onMessageSend:{behavior:63,Content:{Id:"ChatManualMessage",cN:"Chat Manual Message"}},onStartVoiceChat:{behavior:300,Content:{Id:"VoiceMessageClick",cN:"Voice Message Click"}},onSuggestionChipClicked:{behavior:60,Content:{Id:"SuggestionChipClicked",cN:"Suggestion Chip Clicked"}},onDiscoverCardClicked:{behavior:144,Content:{Id:"DiscoverCardClicked",cN:"Discover Card Clicked"}},onQueryParamSubmit:{behavior:141,Content:{Id:"QueryParamMessageSubmit",cN:"Query Param Message Submit"}}};function ufe(t,e){return e==="US"?lg[t].us:e==="GB"?lg[t].gb:e&&["AU","CA","DE","FR","JP"].includes(e)?lg[t].other:[]}function dfe(t){if(!We("ads-pixels"))return;const e=st().get(Or),n=Nt.language,r=Date.now().toString(),o=lg[t].global,i=ufe(t,e),{set:s}=st();s(YO,a=>{for(const c of o.concat(i))a[c]||(a[c]={url:c.replace("{CACHE_BUSTER}",r).replace("{REGION}",e??"").replace("{LANG_LOCALE}",n).replace("{CONSENT}",pfe(e)).replace("{td1}",e??"").replace("{td2}",n).replace("{td3}","CMC").replace("{td4}","").replace("{td5}","").replace("{td6}",mfe(t)),isMounted:!0,timestamp:Date.now()});return{...a}})}function hfe(t){We("custom-1ds")&&(window.OneDsAzureAnalytics.capturePageAction(null,lfe[t]),wO())}function mu(t){try{dfe(t),hfe(t)}catch{xr({feature:"sendIdeasTelemetry",customData:JSON.stringify({eventName:t})})}}function ffe(t){mu(t==="suggestion"?"onSuggestionChipClicked":t==="discover"?"onDiscoverCardClicked":t==="queryParam"?"onQueryParamSubmit":"onMessageSend")}function pfe(t){return(t&&db.includes(t))===!0?bd().advertising?"1":"0":""}function mfe(t){switch(t){case"onPageLoad":return"page_load";case"onMessageSend":return"submit_message";case"onStartVoiceChat":return"voice_message";case"onSuggestionChipClicked":return"suggestion_chip";case"onDiscoverCardClicked":return"discover_card";case"onQueryParamSubmit":return"query_param_submit";default:return""}}const ls=st(),mN={};async function h9(t){const{text:e,filesWithAttachment:n=[],command:r}=t,o=Ge(_n),i=Ge(pt),{result:s}=await Ole.run({chatMode:o,message:e??""}),a=n.length===0||n.every(({error:p,attachment:f})=>!!p||!f);return{isSubmittable:!!i&&!(!e&&a&&!r),shouldDropAccordingToMiddleware:!!s}}async function f9(t,e=!1){const{text:n,filesWithAttachment:r=[],inputMethod:o,command:i,context:s,reference:a,galleryImageUrl:c}=t,u=Zhe(),h=Ge(_n),p=Ge(pt),f=Ge(Zc),g=Ge(Ia);if(!p)throw new Error("No conversation ID found");let v=0,y=0;const b=[];for(const w of r)w.attachment&&(w.attachment.item.type==="image"?v+=1:w.attachment.item.type==="document"&&(w.attachment.item.partId=`${y}`,y+=1),b.push(w));if(c){const w=Efe(c);b.push(w)}const C=[],S={id:"",createdAt:new Date().toISOString(),author:"human",content:[],inputMethod:o};f&&f.conversationId===p&&(S.brand=f);for(const{attachment:w}of b)w&&(S.content.push(w.item),C.push(w.content));if(g.size>0&&(o!=="askCopilot"?S.content.push({type:"browserTabs",tabs:Array.from(g.values()).map(w=>({id:w.id,title:w.title,url:w.url,windowId:w.windowId,favIconUrl:w.favIconUrl}))}):ls.set(Ia,new Map)),n){S.content.push({type:"text",text:n});let{textToSend:w}=await Lle.run({textToSend:n,chatMode:h});g.size>0&&!w.startsWith("/")&&(w=`${X("composer.multiTabs.multitabsprompt",{CountOfAddTabs:g.size})} ${w}`),C.push({type:"text",text:w})}i&&C.push({type:"command",command:i}),a&&C.push({type:"reference",reference:a}),!(i&&tl.safeParse(i.type).success)&&!e&&a9(p,w=>{w.push(S)});const{sendData:I,additionalData:T}=await _le.run(S);return{sendMessageParams:{content:C,conversationId:p,data:I,mode:h,context:{...u,...s,ads:f?{showroom:{brandId:f.brandId,brandName:f.brandLogo.businessName,adId:f.adId??void 0}}:void 0}},newMessage:S,filesToSubmit:b,additionalData:T,imagesUploaded:v,documentsUploaded:y}}async function gfe(t){var C,S,E,I;const{text:e,inputMethod:n,scenario:r,customData:o,entryPoint:i}=t,s=Ge(_n),a=Ge(pt),c=Ge(Zc),u=Ge(Ia),h=We("multi-file-upload"),{isSubmittable:p,shouldDropAccordingToMiddleware:f}=await h9(t);if(f){s==="computerUse"&&ls.set(_n,"chat");return}const g=performance.now();if(ls.set(UO,g),ls.set(Ep,"bottom"),!p||!a)return;await Ede()&&(s==="computerUse"?(ht({source:"copilotActionsStartTask",customData:JSON.stringify({conversationId:a})}),ls.set(Eu,!0)):ls.set(Eu,!1)),r9({sideBySideComparisonId:a,reason:"sentNewMessage"}),NL(a);const v=await f9(t);ls.set(En,T=>Ar(T,_=>{const w=_.get(a);w&&(w.suggestedFollowup=void 0)}));const y=await es({useMockConnection:d9(e)});u.size>0&&ls.set(Ia,new Map),y.send(v.sendMessageParams),y.resetConversationState(a,g),y.setChatModeForConversation(a,s),y.setInputMethodForConversation(a,n),y.callBeforeSendForConversation(a),y.callOnSentForConversation(a,v.additionalData),y.setUserMessageForConversation(a,v.sendMessageParams);const b={eventName:"copilotCompose",eventInfo_conversationId:a,eventInfo_inputMethod:n,eventInfo_numImagesUploaded:v.imagesUploaded,eventInfo_numDocumentsUploaded:v.documentsUploaded,eventInfo_mode:s,eventInfo_landingPage:z.getLandingPage(),...v.filesToSubmit.length>0?{eventInfo_uploadFileSize:((S=(C=v.filesToSubmit[0])==null?void 0:C.file)==null?void 0:S.size)??0,eventInfo_uploadFileType:(I=(E=v.filesToSubmit[0])==null?void 0:E.attachment)==null?void 0:I.type}:{}};h&&(b.eventInfo_uploadFilesInfo=JSON.stringify(v.filesToSubmit.map(({file:T,attachment:_,scenario:w})=>({scenario:w,type:(_==null?void 0:_.type)??"",size:(T==null?void 0:T.size)??""})))),v.additionalData&&(b.eventInfo_additionalData=v.additionalData),r&&(b.eventInfo_scenario=r),o&&(b.eventInfo_customData=o),c&&(b.eventInfo_adsContext=JSON.stringify({showroomBrandId:c.brandId,showroomBrandName:c.brandLogo.businessName})),i&&(b.eventInfo_entryPoint=i),z.trackEvent({name:"interaction",data:b}),afe(),ffe(n),vhe(),s==="computerUse"&&ls.set(_n,"chat")}async function vfe(){const t=Ge(pt);t&&(await es()).onSubmitMessageBlocked(t)}async function bfe(){var r,o;const t=await es(),e=Ge(pt),n=(o=(r=AL(e))==null?void 0:r.part.task)==null?void 0:o.id;e&&(NL(e),r9({sideBySideComparisonId:e,reason:"stoppedMessage"})),t.stop({conversationId:e,taskId:n})}async function yfe(t){const{messageId:e}=t,n=performance.now(),r=Ge(pt);if(!r)return;a9(r,i=>{const s=wL(i);s&&s.id===e&&i.pop()});const o=await es();o.regenerate(t),o.resetConversationTiming(r,n),o.setChatModeForConversation(r,Ge(_n)),o.callBeforeSendForConversation(r)}async function Cfe(t){const{text:e,filesWithAttachment:n=[]}=t,r=Ge(pt),o=Ge(zO),{isSubmittable:i}=await h9(t);if(!i||!r)return;if(Yhe(e??"",n,o,mN[r])){const a=await es({useMockConnection:d9(e)}),c=await f9(t,!0);a.sendMessagePreview(c.sendMessageParams),mN[r]={text:e??"",atTimestamp:Date.now(),files:n}}}async function Sfe(t){(await es()).selectSxSMessage(t)}const ps={submitMessage:gfe,stopMessage:bfe,onSubmitMessageBlocked:vfe,regenerateMessage:yfe,sendMessagePreview:Cfe,selectSideBySideMessage:Sfe};function ORe(t,e){return t.find(n=>n.partId===e)}function Efe(t){return{attachment:{item:{type:"image",url:t},content:{type:"image",url:t},size:0,type:"image/png"}}}function p9(t){const{deferred:e=!1}=t??{},n=!!L(pt),r=L(Ib),[o,i]=it(YI),s=Ee(Ip),a=Ee(_n);m.useEffect(()=>{const h=_de()==="ac"?null:t$();if(h){const p=d$();i({prompt:h,inputMethod:p}),s({source:"queryInUrl",prompt:h})}},[a,s,i]);const c=m.useCallback(()=>{i(null)},[i]),u=m.useCallback(h=>{h&&(s({source:"queryInUrl",prompt:h}),(async()=>{if(n&&r&&h){const f=(o==null?void 0:o.inputMethod)??"queryParam",g=ps.submitMessage({text:h,inputMethod:f});c(),await g}})().catch(console.error))},[s,n,r,c,o]);return m.useEffect(()=>{!e&&o&&u(o.prompt)},[e,u,o]),{prompt:(o==null?void 0:o.prompt)??null,handler:e?u:void 0,clear:c}}function m9(){const t=Ife(),e=Tfe();return t.prompt?t:e}function Ife(){const{t}=Oe(),{formCode:e,lengthVariant:n,treatment:r,passthroughType:o}=Cde();if(e&&n&&r){const i=t(`promptsByFormCode.${e}.${r}.${n}`,"");return{passthroughType:o,prompt:i,source:i?{type:"formCode",formCode:e}:void 0}}return{passthroughType:null}}function Tfe(){const{prompt:t}=Vj({deferred:!0}),{prompt:e}=p9({deferred:!0});let n=null,r;return t?(n="partial",r=t):e&&(n="full",r=e),{passthroughType:n,prompt:r,source:r?{type:"query"}:void 0}}function g9(){const t=L(YI),{passthroughType:e}=m9();return!!(t!=null&&t.prompt)&&e==="full"}function _fe(){var u,h;const t=Ft(),e=L(kr),n=L(JI),{isMediaViewerOpen:r}=Na(),{disableMultiturn:o}=be.instance().config(),i=((u=be.instance().config().composer)==null?void 0:u.largeScreen)===!0&&((h=be.instance().config().composer)==null?void 0:h.voiceOnly)===!0,s=["/pro/subscribe","/pro/ewallet/return","/referrals","/referrals/rules","/subscription/manage","/subscription/start"],a=g9(),c=!t.startsWith("/labs")||t==="/labs/experiments/portrait/talk";return!s.includes(t)&&!t.startsWith("/topic-selection")&&(!t.startsWith("/fang")||r)&&!t.startsWith("/login")&&!t.startsWith("/pro/redeem")&&!t.startsWith("/gaming")&&!t.startsWith("/library")&&!t.startsWith("/memory/narrative")&&!t.startsWith("/conversations")&&!t.startsWith("/campaigns")&&!t.startsWith("/pages")&&!t.startsWith("/shares/pages")&&!t.startsWith("/gallery")&&c&&e!=="detail-only"&&!n&&!i&&!o&&!a}function wfe(){var r,o;const t=Ft(),e=Ey();return((r=be.instance().config().composer)==null?void 0:r.largeScreen)===!0&&((o=be.instance().config().composer)==null?void 0:o.voiceOnly)===!0&&!t.startsWith("/login-dcf")&&!e}function Afe(t){const{showSettings:e,showSettingsRelyOnChatDetailLayout:n}=t,r=L(kr);return m.useMemo(()=>n?e&&r!=="side-by-side"&&r!=="detail-only":e,[n,e,r])}function v9(){const t=Object.assign({"../../assets/lottie/chain-of-thought-dark.json":()=>H(()=>import("./chain-of-thought-dark-DAdrbVMG.js"),[]).then(e=>e.default),"../../assets/lottie/chain-of-thought-light.json":()=>H(()=>import("./chain-of-thought-light-Cr0oOWNN.js"),[]).then(e=>e.default),"../../assets/lottie/character-thinking-cloud-animation.json":()=>H(()=>import("./character-thinking-cloud-animation-BPHslFRh.js"),[]).then(e=>e.default),"../../assets/lottie/image-gen-dark.json":()=>H(()=>import("./image-gen-dark-Xe9QwJfO.js"),[]).then(e=>e.default),"../../assets/lottie/image-gen-light.json":()=>H(()=>import("./image-gen-light-CvTKvF-o.js"),[]).then(e=>e.default),"../../assets/lottie/loader-gradient.json":()=>H(()=>import("./loader-gradient-nOUtNO79.js"),[]).then(e=>e.default),"../../assets/lottie/loader-image-generating.json":()=>H(()=>import("./loader-image-generating-CXsAaCuT.js"),[]).then(e=>e.default),"../../assets/lottie/loader-reasoning-dark.json":()=>H(()=>import("./loader-reasoning-dark-BWb0u6bB.js"),[]).then(e=>e.default),"../../assets/lottie/loader-reasoning-light.json":()=>H(()=>import("./loader-reasoning-light-DeS5Bpum.js"),[]).then(e=>e.default),"../../assets/lottie/loader-spinner-dark.json":()=>H(()=>import("./loader-spinner-dark-OIzWyRIV.js"),[]).then(e=>e.default),"../../assets/lottie/loader-spinner-light.json":()=>H(()=>import("./loader-spinner-light-DwSZ3tXn.js"),[]).then(e=>e.default),"../../assets/lottie/loader-spinner-white.json":()=>H(()=>import("./loader-spinner-white-B1ATuHTQ.js"),[]).then(e=>e.default),"../../assets/lottie/pages-welcome-dark.json":()=>H(()=>import("./pages-welcome-dark-r64A2mUI.js"),[]).then(e=>e.default),"../../assets/lottie/pages-welcome-light.json":()=>H(()=>import("./pages-welcome-light-DDUDcHxX.js"),[]).then(e=>e.default),"../../assets/lottie/voicemail-dark.json":()=>H(()=>import("./voicemail-dark-BtARQIb1.js"),[]).then(e=>e.default),"../../assets/lottie/voicemail-light.json":()=>H(()=>import("./voicemail-light-DeMSWjpH.js"),[]).then(e=>e.default)});return{load:e=>{const n=t[e];return n?n():Promise.reject(new Error(`Lottie animation not found: ${e}`))},exists:e=>e in t,getPaths:()=>Object.keys(t)}}const kfe=m.lazy(()=>H(()=>import("./index.es-BjL6LrIc.js"),__vite__mapDeps([219,2,1]))),xfe=v9();function Rt(t){const{type:e,className:n,rendererSettings:r,colorTheme:o}=t,i=L(Ns),s=o??i,[a,c]=m.useState(null),h=`../../assets/lottie/${m.useMemo(()=>{switch(e){case"gradient":return"loader-gradient.json";case"reasoning":return s==="dark"?"loader-reasoning-dark.json":"loader-reasoning-light.json";case"chainOfThought":return s==="dark"?"chain-of-thought-dark.json":"chain-of-thought-light.json";case"spinnerWhite":return"loader-spinner-white.json";case"imageGen":return s==="dark"?"image-gen-dark.json":"image-gen-light.json";case"spinnerThemed":default:return s==="dark"?"loader-spinner-dark.json":"loader-spinner-light.json"}},[e,s])}`;return m.useEffect(()=>{xfe.load(h).then(c).catch(()=>c(null))},[h]),a?d.jsx(m.Suspense,{fallback:d.jsx("div",{}),children:d.jsx(kfe,{animationData:a,loop:!0,className:n,rendererSettings:r})}):d.jsx("div",{})}const ww=Object.freeze(Object.defineProperty({__proto__:null,default:Rt},Symbol.toStringTag,{value:"Module"})),Rfe=16/9,Nfe=48,b9=296,Pfe=b9/Rfe,Mfe=Pfe+Nfe;function Ofe(){return d.jsx("div",{className:"pointer-events-none absolute inset-0 mb-[calc(var(--composer-container-height)+20px)] me-4 ms-2 mt-[72px]",children:d.jsx("div",{className:"absolute bottom-0 end-4",style:{width:`${b9}px`,height:`${Mfe}px`},children:d.jsx("div",{className:q("relative flex h-full flex-col overflow-hidden rounded-4xl","bg-acrylic-default-fallback-light/[98] dark:bg-acrylic-default-fallback-dark/[98]"),style:{boxShadow:"0px 16px 24px -2px rgba(0, 0, 0, 0.12)"},children:d.jsx("div",{className:"flex h-full items-center justify-center",children:d.jsx(Rt,{className:"size-12"})})})})})}function NE(t){xr({feature:"fileDownload",errorType:"DownloadFileError",errorMessage:t})}const Aw=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M18.2498 20.5009C18.664 20.5008 19 20.8365 19 21.2507C19 21.6649 18.6644 22.0008 18.2502 22.0009L5.25022 22.0047C4.836 22.0048 4.5 21.6691 4.5 21.2549C4.5 20.8407 4.83557 20.5048 5.24978 20.5047L18.2498 20.5009ZM11.6482 2.01271L11.75 2.00586C12.1297 2.00586 12.4435 2.28801 12.4932 2.65409L12.5 2.75586L12.499 16.4409L16.2208 12.7205C16.4871 12.4543 16.9038 12.4301 17.1974 12.648L17.2815 12.7206C17.5477 12.9869 17.5719 13.4036 17.354 13.6972L17.2814 13.7813L12.2837 18.7779C12.0176 19.044 11.6012 19.0683 11.3076 18.8507L11.2235 18.7782L6.22003 13.7816C5.92694 13.4889 5.92661 13.014 6.21931 12.7209C6.48539 12.4545 6.90204 12.43 7.1958 12.6477L7.27997 12.7202L10.999 16.4339L11 2.75586C11 2.37616 11.2822 2.06237 11.6482 2.01271L11.75 2.00586L11.6482 2.01271Z",fill:"currentColor"})),LRe=Object.freeze(Object.defineProperty({__proto__:null,default:Aw},Symbol.toStringTag,{value:"Module"})),Lfe=10*1024*1024,Dfe=5*1024*1024,jfe=50*1024*1024,PE=3,Ufe={"image/png":["png"],"image/jpeg":["jpg","jpeg"]},Ty={"application/pdf":["pdf"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/json":["json"],"text/csv":["csv"],"text/markdown":["md"],"text/plain":["txt"]},Ta={...Ufe,...Ty};function kp(t){return t in Ty}function kw(t,e={supportedMimeTypes:Ta}){if(!t)return!1;const n=xs(t);return n===""?!1:n in e.supportedMimeTypes}const DRe=Object.keys(Ta).map(t=>{const e=Ta[t].map(n=>`.${n}`);return[t,...e]}).flat();function Ffe(t){return Object.values(t).flat().map(e=>`.${e}`)}const Bfe=Object.values(Ty).flat().map(t=>`.${t}`);function y9(){return{documentMaxSize:We("fileasyncprocessing")?jfe:Dfe,imageMaxSize:Lfe}}function xw(t){var r;const e=(r=t.split(".").pop())==null?void 0:r.toLowerCase(),n=Object.entries(Ta).find(([,o])=>o.includes(e??""));return n?n[0]:""}function xs(t){return t?t.type!==""?t.type:xw(t.name):""}function Hfe(t,e={supportedMimeTypes:Ta}){let n,r=null;const o=We("multi-file-upload"),i=y9();if(!kw(t,e))n={title:X("composer.errors.unsupportedAttachmentTypeV2.title"),message:X("composer.errors.unsupportedAttachmentTypeV2.message")},r="fileType";else if(!C9(t)){const s=xs(t);n=o?{title:X("composer.errors.multi.attachmentTooLarge.title"),message:X("composer.errors.multi.attachmentTooLarge.message",{limit:kp(s)?i.documentMaxSize/1024/1024:i.imageMaxSize/1024/1024})}:{title:X("composer.errors.attachmentTooLargeV2.title"),message:X("composer.errors.attachmentTooLargeV2.message")},r="fileSize"}return z.trackEvent({name:"system",data:{eventName:"clientFileValidation",eventInfo_errorType:r,eventInfo_fileType:xs(t),eventInfo_fileSize:t.size}}),n}function zfe(t){return t.type==="text/x-markdown"?new File([t],t.name,{type:"text/markdown"}):t}function C9(t){const e=y9(),n=xs(t),r=kp(n)?e.documentMaxSize:e.imageMaxSize;return t.size<=r}function Vfe(t){var n;const e=(n=t.clipboardData)==null?void 0:n.items;if(e)for(let r=0;r<e.length;r+=1){const o=e[r];if((o==null?void 0:o.kind)==="file"){const i=o.getAsFile();if(!kw(i))continue;const s=xs(i);if(i!==null)return C9(i)?{file:i,error:void 0}:(z.trackEvent({name:"system",data:{eventName:"clientFileValidation",eventInfo_errorType:"fileType",eventInfo_fileSize:i.size,eventInfo_fileType:s,eventInfo_errorMessage:"File size too large in paste"}}),{file:void 0,error:{title:X("composer.errors.attachmentTooLargeV2.title"),message:X("composer.errors.attachmentTooLargeV2.message")}})}}return{file:void 0,error:void 0}}function S9(t){switch(t){case"unsupported-content-type":return{title:X("composer.errors.unsupportedAttachmentTypeV2.title"),message:X("composer.errors.unsupportedAttachmentTypeV2.message")};case"attachment-too-large":return{title:X("composer.errors.attachmentTooLargeV2.title"),message:X("composer.errors.attachmentTooLargeV2.message")};case"empty-attachment":return{title:X("composer.errors.emptyAttachmentV2.title"),message:X("composer.errors.emptyAttachmentV2.message")};case"content-blocked":return{title:X("composer.errors.attachmentContentBlockedV2.title"),message:X("composer.errors.attachmentContentBlockedV2.message")};case"rate-limit-exceeded":return{title:X("composer.errors.attachmentRateLimitExceededV2.title"),message:X("composer.errors.attachmentRateLimitExceededV2.message")};default:return{title:X("composer.errors.attachmentDefault.title"),message:X("composer.errors.attachmentDefault.message")}}}function E9(t,e){const n=window.URL.createObjectURL(t),r=document.createElement("a");r.style.display="none",r.href=n,r.download=e,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(n),r.remove()}function jRe(t,e,n){const r=new Blob([n],{type:e});E9(r,t)}async function I9(t){const{url:e,fileName:n,args:r}=t,o=qM(e)?await fetch(e,r==null?void 0:r.options):await Gc(e,r);if(!o.ok)throw new Error(`Failed to fetch file: ${n} from ${e} (status: ${o.status})`);const i=await o.blob();E9(i,n)}function $fe({name:t,size:e,message:n,kind:r}){z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitMessage",eventInfo_errorMessage:n,eventInfo_details:`Error uploading ${r} attachment`,eventInfo_uploadFileSize:e,eventInfo_uploadFileType:t,eventInfo_numDocumentsUploaded:1}})}const Gfe=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"none",...t},m.createElement("path",{d:"M10 6.5V2H5.5C4.67157 2 4 2.67157 4 3.5V16.5C4 17.3284 4.67157 18 5.5 18H14.5C15.3284 18 16 17.3284 16 16.5V8H11.5C10.6716 8 10 7.32843 10 6.5ZM6.5 10H13.5C13.7761 10 14 10.2239 14 10.5C14 10.7761 13.7761 11 13.5 11H6.5C6.22386 11 6 10.7761 6 10.5C6 10.2239 6.22386 10 6.5 10ZM6.5 12H13.5C13.7761 12 14 12.2239 14 12.5C14 12.7761 13.7761 13 13.5 13H6.5C6.22386 13 6 12.7761 6 12.5C6 12.2239 6.22386 12 6.5 12ZM6.5 14H13.5C13.7761 14 14 14.2239 14 14.5C14 14.7761 13.7761 15 13.5 15H6.5C6.22386 15 6 14.7761 6 14.5C6 14.2239 6.22386 14 6.5 14ZM11 6.5V2.25L15.75 7H11.5C11.2239 7 11 6.77614 11 6.5Z",fill:"currentColor"})),Kfe=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",...t},m.createElement("path",{d:"M12 2V8C12 9.10457 12.8954 10 14 10H20V20C20 21.1046 19.1046 22 18 22H6C4.89543 22 4 21.1046 4 20V4C4 2.89543 4.89543 2 6 2H12ZM13.5 2.5V8C13.5 8.27614 13.7239 8.5 14 8.5H19.5L13.5 2.5Z",fill:"currentColor"})),qfe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/pdf-DuUY2RJ0.svg",Wfe=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"none",...t},m.createElement("path",{d:"M3 2.5C3 2.22386 3.22386 2 3.5 2H11.5C11.7761 2 12 2.22386 12 2.5V4.5C12 4.77614 11.7761 5 11.5 5C11.2238 5 11 4.77614 11 4.5V3H7.99997L7.99998 13H9C9.27614 13 9.5 13.2239 9.5 13.5C9.5 13.7761 9.27614 14 9 14H6C5.72386 14 5.5 13.7761 5.5 13.5C5.5 13.2239 5.72386 13 6 13H6.99998L6.99997 3H4V4.5C4 4.77614 3.77614 5 3.5 5C3.22386 5 3 4.77614 3 4.5V2.5Z",fill:"currentColor"}));function rr(t){const{url:e,className:n}=t;return d.jsx("div",{className:nt("bg-current forced-color-adjust-none",n),style:{WebkitMaskImage:`url(${e})`,maskImage:`url(${e})`,WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskPosition:"center",maskPosition:"center",WebkitMaskSize:"contain",maskSize:"contain"}})}function Yfe(t){const{fileType:e,className:n}=t;switch(e){case"application/pdf":return d.jsx(rr,{url:qfe,className:n});case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/msword":return d.jsx(Gfe,{className:n});case"text/plain":return d.jsx(Wfe,{className:n});case"application/json":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":case"text/csv":case"text/markdown":default:return d.jsx(Kfe,{className:n})}}function Qfe(t){switch(t){case"application/pdf":return"bg-system-red-350";case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/msword":return"bg-midnight-300";case"text/plain":return"bg-spot-blue-300";case"application/json":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":case"text/csv":case"text/markdown":default:return"bg-neutral-300"}}function Jfe(t){const{t:e}=Oe();switch(t){case"application/pdf":return e("fileUpload.fileTypeDisplayPdf");case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/msword":return e("fileUpload.fileTypeDisplayDoc");case"text/plain":return e("fileUpload.fileTypeDisplayTxt");case"application/json":return e("fileUpload.fileTypeDisplayJson");case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.ms-excel":return e("fileUpload.fileTypeDisplayXlsx");case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":return e("fileUpload.fileTypeDisplayPptx");case"text/csv":return e("fileUpload.fileTypeDisplayCsv");case"text/markdown":return e("fileUpload.fileTypeDisplayMarkdown");default:return e("fileUpload.fileTypeDisplayDefault")}}const Zfe=100,Vv=D([]);function Xfe(){const t=L(Vv),[e,n]=m.useState(!1),r=e?t:[];return d.jsxs("div",{className:"sr-only",ref:()=>setTimeout(()=>n(!0),Zfe),children:[d.jsx(gN,{messages:r.filter(o=>o.type==="polite"),type:"polite"}),d.jsx(gN,{messages:r.filter(o=>o.type==="assertive"),type:"assertive"})]})}function gN({messages:t,type:e}){return d.jsx("div",{"aria-live":e,"aria-atomic":"true",children:t.map(n=>d.jsx("div",{"aria-label":n.msg,children:n.msg},n.id))})}function ME(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.floor(Math.random()*16);return(t==="x"?e:Math.floor(Math.random()*4+8)).toString(16)})}const T9=7e3;function hd(t={}){return epe(t),null}function epe(t={}){const{msg:e,id:n,type:r="polite",timeout:o=T9}=t,i=Ee(Vv),s=m.useRef(n??ME());m.useEffect(()=>{e&&i(a=>{if(a.some(u=>u.id===s.current&&u.msg===e&&u.type===r))return a;s.current=n??ME();const c={msg:e,id:s.current,type:r};return window.setTimeout(()=>{i(u=>u.filter(h=>h.id!==c.id))},o),[...a,c]})},[n,e,r,i,o])}function Rw(t){const{msg:e,id:n,type:r="polite",timeout:o=T9}=t;if(!e)return;const i=st();i.set(Vv,s=>{const a={msg:e,id:n??ME(),type:r};return window.setTimeout(()=>{i.set(Vv,c=>c.filter(u=>u.id!==a.id))},o),[...s,a]})}const tpe=m.lazy(()=>H(()=>Promise.resolve().then(()=>ww),void 0));function Nw(t){var u;const{onRemove:e,filename:n,fileType:r,isUploading:o}=t,{t:i}=Oe(),s=Qfe(r),a=Jfe(r),c=(u=be.instance().config().composer)==null?void 0:u.smallAttachmentCard;return d.jsxs(Re.div,{className:q("relative flex justify-center gap-2 overflow-hidden rounded-xl border border-black/8 bg-acrylic-thin-fallback-light/60 p-3 dark:border-white/8 dark:bg-midnight-800/80 sm:w-56",{"mx-1 mt-2 h-[58px] w-auto flex-row":c,"h-32 w-44 flex-col":!c}),layout:"position",initial:dt,animate:Ot,exit:dt,children:[d.jsx("div",{className:q("grid aspect-square size-8 place-items-center self-start rounded-full text-black",s),children:d.jsx(Yfe,{fileType:r,className:"size-5"})}),d.jsxs("div",{className:q({"min-w-0 flex-1":c}),children:[d.jsx("p",{className:q("font-ligatures-none truncate text-xs",{"overflow-hidden whitespace-nowrap":c}),children:n}),d.jsx("p",{className:"text-foreground-600 text-2xs",children:a})]}),e&&!o&&d.jsx("button",{type:"button",title:i("fileUpload.removeFile"),"aria-label":i("fileUpload.removeFile"),onClick:e,className:"absolute end-0.5 top-0.5 m-1 rounded-full border border-black/20 p-1 text-foreground-850 dark:border-white/20",children:d.jsx(fo,{className:"size-3"})}),d.jsx(Fn,{className:"absolute inset-0 grid place-items-center bg-white/80 dark:bg-white/45",children:o?d.jsxs(d.Fragment,{children:[d.jsx(m.Suspense,{fallback:d.jsx("div",{"aria-hidden":!0}),children:d.jsx(tpe,{type:"spinnerThemed",className:"size-11"})}),d.jsx(hd,{msg:i("fileUpload.uploadingFile"),type:"polite"})]}):null})]})}function npe(t){const{contentType:e,name:n,url:r}=t,{t:o}=Oe(),i=Ee(Os),s=L(pt),a=m.useCallback(()=>{const c={url:r,fileName:n};ht({source:"fileDownloadButton",scenario:"fileDownload",conversationId:s,customData:JSON.stringify(c)}),I9(c).catch(u=>{const h=u instanceof Error?u.message:"unknown file card error";NE(h),h.includes("status: 404")?i({title:o("common.fileUnavailable"),subtitle:o("common.fileUnavailableDetails"),dismissAfter:3e3}):i({title:o("common.downloadFailed"),subtitle:o("common.downloadFailedDetails",{fileName:n}),dismissAfter:3e3})})},[r,n,o,i,s]);return r?d.jsxs("div",{className:"flex w-fit max-w-full items-center gap-4 md:max-w-96",children:[d.jsx(Nw,{filename:n,fileType:e}),d.jsx(Me,{title:o("common.download"),size:"36-sm",variant:"circle",color:"subtle-dimmed-inverted",onClick:a,"aria-label":o("common.download"),className:"shrink-0 border border-stroke-350",children:d.jsx(Aw,{className:"size-5"})})]}):(NE("No URL provided"),null)}const _9=1.2;function Pa(t={},e={}){return{start:{...t,opacity:0},end:n=>({...e,opacity:1,transition:{delay:n,ease:"easeInOut",duration:_9}})}}const rpe=Pa();function ope(t){const{items:e,shouldAnimate:n,BlockRenderer:r,delay:o}=t;return d.jsx(Re.blockquote,{className:"flex flex-col gap-3 border-s-2 border-foreground-300 ps-3",variants:rpe,initial:n?"start":"end",animate:"end",custom:o,children:d.jsx(r,{blocks:e,shouldAnimate:n})})}function vl(t){m.useEffect(()=>(window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}),[t])}function ipe(t){const e=L(Zi),{openMediaViewer:n}=Na(),r=m.useCallback(()=>{if(!t)return[];const s=e.find(c=>c.id===t);if(!s||s.author!=="ai")return[];const a=[];for(const c of s.content)if(c.type==="card"){if(c.card.type==="image"){const u=c.card;a.push(...u.images)}else if(c.card.type==="video"){const u=c.card;a.push(...u.videos)}}return a},[e,t]),o=m.useCallback(s=>r().some(c=>c.source.url===s),[r]),i=m.useCallback(s=>{const a=r(),c=a.findIndex(h=>h.source.url===s);if(c===-1)return;const u=a.map(h=>"image"in h?{type:"image",url:h.image.url,thumbnailUrl:h.image.thumbnailUrl,altText:h.image.altText,initLoading:!0,source:{title:h.source.title,url:h.source.url,iconUrl:h.source.iconUrl??void 0}}:{type:"video",url:h.video.url,isShort:h.video.isShort,bestMomentIndex:h.bestMomentIndex,moments:h.moments,source:{title:h.video.title,url:h.source.url,iconUrl:h.source.iconUrl??void 0}});n({currentMediaIndex:c,media:u})},[r,n]);return{checkMediaLink:o,openMediaLink:i}}function Kc({onOutsideEvent:t,elements:e,shouldAttachListeners:n=!0,includeScroll:r=!0,invokeOnce:o=!0,includeFocus:i=!0}){m.useEffect(()=>{const s=a=>{const c=a.target,u=e.some(p=>{var f;return(f=p.current)==null?void 0:f.contains(c)}),h=c instanceof Element&&c.closest("[data-outside-events-ignore]")!==null;!u&&!h&&t()};return n&&(document.addEventListener("mousedown",s,{once:o}),r&&document.addEventListener("scroll",s,!0),i&&document.addEventListener("focusin",s,!0)),()=>{document.removeEventListener("mousedown",s),r&&document.removeEventListener("scroll",s,!0),i&&document.removeEventListener("focusin",s,!0)}},[n,r,e,o,i,t])}const _y=m.createContext(void 0),spe=Pa();function ape(t){const{url:e,title:n,index:r,shouldAnimate:o,delay:i,onCitationClick:s}=t,a=m.useContext(_y),c=le("citation-media-open"),u=m.useId(),h=m.useId(),{checkMediaLink:p,openMediaLink:f}=ipe(a??null),g=mI(),v=L(pt),[y,b]=m.useState(!1),[C,S]=m.useState(null),{refs:E,floatingStyles:I}=kM({placement:"top",elements:{reference:C},middleware:[pd(8),tp(),md()]});Kc({onOutsideEvent:()=>b(!1),elements:[E.floating],includeScroll:!0,invokeOnce:!0}),vl(A=>{(A.key==="Escape"||A.key==="Control")&&b(M=>(M&&C instanceof HTMLElement&&C.focus(),!1))});const T=()=>{if(c&&p(e)){f(e);return}b(!0)},_=()=>{Tn({source:"citationLink",conversationId:v,messageId:a,destination:$u(e)}),b(!1),s&&s()},w=Vu(e);return d.jsxs(Re.span,{initial:o?"start":"end",animate:"end",variants:spe,custom:i,className:"mx-0.5 inline-block h-5 w-4 pb-1 align-middle","data-copy":"false",children:[d.jsx("button",{id:h,"aria-expanded":y,"aria-controls":u,"aria-label":X("chat.citationPopoverButtonLabel",{citationNumber:r}),ref:S,type:"button",className:q("mx-px flex size-full items-center justify-center rounded-md bg-accent-200 pt-px text-foreground-800 text-3xs hover:bg-accent-250 focus:bg-accent-250 dark:bg-slate-700 hover:dark:bg-background-400 focus:dark:bg-background-400",y&&"pointer-events-none"),onClick:T,children:r}),y&&d.jsx("span",{id:u,role:"dialog","aria-labelledby":h,className:q("absolute w-screen px-4 max-sm:mb-2 sm:w-[350px] sm:px-0",Xt.citations),style:I,ref:E.setFloating,children:d.jsx(Re.span,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{scale:{duration:.2},opacity:{duration:.15}},className:"origin-top-left",style:OI,children:d.jsx("a",{onClick:_,className:"flex w-full rounded-2xl border border-stroke-100 bg-background-100 p-3 shadow-lg dark:bg-background-250",href:$u(e),target:"_blank",rel:g,children:d.jsxs("span",{className:"w-full flex-1 space-y-0.5",children:[d.jsx("span",{className:"line-clamp-1 text-xs-strong",children:n}),d.jsx("span",{className:"line-clamp-1 flex items-center gap-1.5 text-foreground-600 text-2xs",children:w})]})})})})]},"citation")}const cpe="https://#timestamp-",lpe="https://#settings:privacy";function w9(t){return t?t.startsWith(cpe)?"VideoCitation":t.startsWith(lpe)?"PrivacySettings":"Unknown":"Unknown"}function upe(t){return w9(t)!=="Unknown"}function dpe(t){if(!/^\d{2}:\d{2}:\d{2}$/.test(t))return t;const[n,r,o]=t.split(":");return n==="00"?(r==null?void 0:r.charAt(0))==="0"?`${r.substring(1)}:${o}`:`${r}:${o}`:(n==null?void 0:n.charAt(0))==="0"?`${n.substring(1)}:${r}:${o}`:t}const hpe=Pa(),vN="font-bold text-accent-550 dark:text-accent-600 hover:underline text-start align-top";function fpe(t){const{url:e,text:n,shouldAnimate:r,delay:o}=t,i=m.useContext(_y),s=L(pt),a=w9(e),c=async()=>{switch(a){case"VideoCitation":await Rle.run({url:e});break;case"PrivacySettings":await Ple.run({url:e});break}z.trackEvent({name:"interaction",data:{eventName:"localCitationClick",eventInfo_messageId:i??"",eventInfo_conversationId:s??"",eventInfo_citationType:a}})};m.useEffect(()=>{z.trackEvent({name:"interaction",data:{eventName:"localCitationImpression",eventInfo_messageId:i??"",eventInfo_conversationId:s??"",eventInfo_citationType:a}})},[i,s,a]);const u=dpe(n);return r?d.jsx(Re.button,{className:vN,onClick:c,"data-url":e,initial:"start",animate:"end",variants:hpe,custom:o,children:u}):d.jsx("button",{type:"button",className:vN,onClick:c,"data-url":e,children:u})}const bN=Pa(),yN="font-bold text-accent-550 dark:text-accent-600 hover:underline text-start align-top";function ts(t){const{items:e,shouldAnimate:n,dangerouslyUseHtml:r,shouldTestForUrl:o=!0}=t,i=Ee(yj),s=Ee(Yr);return d.jsx(d.Fragment,{children:e.map((a,c)=>{var b;if(a.type==="citation"){const{title:C,url:S,index:E,delay:I}=a;return d.jsx(ape,{title:C,url:S,index:E,shouldAnimate:n,delay:I},c)}if(a.type==="italic"||a.type==="bold"||a.type==="strikethrough"||a.type==="sup"||a.type==="sub"||a.type==="code"){const C=d.jsx(ts,{items:a.items,shouldAnimate:n,dangerouslyUseHtml:r});return a.type==="italic"?d.jsx("em",{children:C},c):a.type==="bold"?d.jsx("strong",{children:C},c):a.type==="strikethrough"?d.jsx("del",{children:C},c):a.type==="sup"?d.jsx("sup",{children:C},c):a.type==="sub"?d.jsx("sub",{children:C},c):d.jsx(Re.code,{className:"font-ligatures-none mx-0.5 rounded-[4px] border border-stroke-300 bg-accent-200/60 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-accent-200",initial:n?"start":"end",animate:"end",variants:bN,custom:a.delay,children:C},c)}if(a.type!=="word")return null;const{word:u,url:h,delay:p,format:f}=a,v=ppe({word:u,url:h,testForUrl:!f&&o}),y={initial:"start",animate:"end",variants:bN,custom:p,...r===!0||f==="latexAsHtml"?{dangerouslySetInnerHTML:{__html:((b=window.copilotTrustedTypesPolicy)==null?void 0:b.createHTML(u))??""}}:{children:u}};if(v.url){if(upe(v.url))return d.jsx(fpe,{url:v.url,text:v.word,shouldAnimate:n,delay:p},c);const C=()=>{i(v.url),s("confirm-link-navigation")};return d.jsxs(m.Fragment,{children:[n?d.jsx(Re.button,{className:yN,onClick:C,"data-url":v.url,...y}):d.jsx("button",{type:"button",className:yN,onClick:C,"data-url":v.url,...y}),v.suffix&&v.suffix]},c)}return n?d.jsx(Re.span,{...y},c):r===!0||f==="latexAsHtml"?d.jsx("span",{...y},c):d.jsx(m.Fragment,{children:u},c)})})}function ppe({word:t,url:e,testForUrl:n}){return e?{url:e,word:t}:n?CH(t):{word:t}}function Qi(t){var e,n;return(n=(e=be.instance().config().styleOverrides)==null?void 0:e.typography)==null?void 0:n[t]}function Gf(t){var e,n;return(n=(e=be.instance().config().styleOverrides)==null?void 0:e.padding)==null?void 0:n[t]}function mpe(t){const{shouldAnimate:e,items:n}=t;return d.jsx("h1",{className:q(Qi("h1")??"text-2xl-medium","[&:not(:first-child)]:pt-6"),children:d.jsx(ts,{shouldAnimate:e,items:n})})}function gpe(t){const{shouldAnimate:e,items:n}=t;return d.jsx("h2",{className:q(Qi("h2")??"text-xl-medium","[&:not(:first-child)]:pt-3.5","pb-1"),children:d.jsx(ts,{shouldAnimate:e,items:n})})}function vpe(t){const{shouldAnimate:e,items:n}=t;return d.jsx("h3",{className:q(Qi("h3")??"text-lg-medium","pb-1","[&:not(:first-child)]:pt-3.5"),children:d.jsx(ts,{shouldAnimate:e,items:n})})}function bpe(t){const{shouldAnimate:e,items:n}=t;return d.jsx("h4",{className:q(Qi("h4")??"text-md-medium"),children:d.jsx(ts,{shouldAnimate:e,items:n})})}function ype(t){const{shouldAnimate:e,items:n}=t;return d.jsx("h5",{className:q(Qi("h5")??"text-base-medium"),children:d.jsx(ts,{shouldAnimate:e,items:n})})}function Cpe(t){const{shouldAnimate:e,items:n}=t;return d.jsx("h6",{className:q(Qi("h6")??"text-base"),children:d.jsx(ts,{shouldAnimate:e,items:n})})}const Spe=[mpe,gpe,vpe,bpe,ype,Cpe];function Epe(t){const{shouldAnimate:e,items:n,level:r}=t,o=Spe[r-1];return o?d.jsx(o,{shouldAnimate:e,items:n}):null}const Ipe=Pa(),CN="relative pb-6 w-full after:border-b after:border-stroke-300 after:w-full after:absolute after:mt-3";function Tpe(t){const{delay:e,shouldAnimate:n}=t;return n?d.jsx(Re.div,{className:CN,initial:"start",animate:"end",variants:Ipe,custom:e}):d.jsx("div",{className:CN})}const _pe=Pa();function wpe(t){const{content:e,shouldAnimate:n,delay:r,dangerouslyUseHtml:o}=t;return d.jsx(Re.div,{initial:n?"start":"end",animate:"end",custom:r,variants:_pe,children:d.jsx("div",{className:"horizontal-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 text-center",children:d.jsx(ts,{items:e,shouldAnimate:n,dangerouslyUseHtml:o})})})}const SN="relative list-outside marker:text-foreground-750 dark:marker:text-foreground-600 flex flex-col",Ape=Pa();function kpe(t){const{items:e,ordered:n,start:r,shouldAnimate:o,BlockRenderer:i}=t,s=e.map(({items:a,delay:c},u)=>d.jsx(Re.li,{initial:o?"start":"end",animate:"end",variants:Ape,custom:c,className:"ps-2",children:d.jsx(i,{blocks:a,shouldAnimate:o})},u));return n?d.jsx("ol",{start:r,className:q(SN,"ms-5 marker:normal-nums marker:text-sm-strong"),children:s}):d.jsx("ul",{className:q(SN,"ms-4 px-1"),children:s})}function xpe(t){const{items:e,shouldAnimate:n}=t;return d.jsx("p",{children:d.jsx("span",{className:q("font-ligatures-none",Qi("aiMessageDefault")),children:d.jsx(ts,{items:e,shouldAnimate:n})})})}const Rpe=Pa();function Npe(t){const{columns:e,data:n,shouldAnimate:r}=t;return d.jsxs("div",{className:"relative max-w-full",children:[d.jsx("div",{className:"my-6 max-w-full overflow-x-auto rounded-lg bg-white/25 dark:bg-black/25",children:d.jsxs("table",{className:"t-table",style:{borderSpacing:0},children:[d.jsx("thead",{children:d.jsx("tr",{children:e.map((o,i)=>d.jsx(EN,{type:"head",items:o,shouldAnimate:r},i))})}),d.jsx("tbody",{children:n.map((o,i)=>d.jsx("tr",{children:o.map((s,a)=>d.jsx(EN,{type:"data",items:s,shouldAnimate:r},a))},i))})]})}),d.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-lg border border-stroke-300 dark:border-stroke-450"})]})}function EN(t){var i;const{type:e,items:n,shouldAnimate:r}=t,o=e==="head"?Re.th:Re.td;return d.jsx(o,{variants:Rpe,initial:r?"start":"end",animate:"end",custom:((i=n[0])==null?void 0:i.delay)??0,children:d.jsx(ts,{shouldAnimate:r,items:n})})}const Ppe=m.lazy(()=>H(()=>import("./code-DRCDwlgv.js"),__vite__mapDeps([220,1,2,221])));function Kf(t){const{blocks:e,shouldAnimate:n}=t;return d.jsx(d.Fragment,{children:e.map((r,o)=>{const i=`${r.type}-${o}`;switch(r.type){case"paragraph":return d.jsx(xpe,{items:r.items,shouldAnimate:n},i);case"list":return d.jsx(kpe,{ordered:r.ordered,start:r.start,items:r.items,BlockRenderer:Kf,shouldAnimate:n},i);case"heading":return d.jsx(Epe,{items:r.items,level:r.level,shouldAnimate:n},i);case"code":return d.jsx(Ppe,{content:r.content,original:r.original,delay:r.delay,shouldAnimate:n,language:r.language,dangerouslyUseHtml:r.dangerouslyUseHtml},i);case"latex":return d.jsx(wpe,{content:r.content,delay:r.delay,shouldAnimate:n,dangerouslyUseHtml:r.dangerouslyUseHtml},i);case"table":return d.jsx(Npe,{columns:r.columns,data:r.data,shouldAnimate:n},i);case"blockquote":return d.jsx(ope,{items:r.items,delay:r.delay,shouldAnimate:n,BlockRenderer:Kf},i);case"hr":return d.jsx(Tpe,{delay:r.delay,shouldAnimate:n},i);default:return null}})})}let gu=null;async function Mpe(t){return gu||(gu=(await H(async()=>{const{default:e}=await import("./katex-CfZphoad.js");return{default:e}},[])).default,t==null||t(),gu)}function A9(t,e,n){return gu?gu.renderToString(t,{output:"mathml",displayMode:e,throwOnError:!1}):(Mpe(n),t)}var $a={},Sh={},Ga={},IN;function k9(){if(IN)return Ga;IN=1,Object.defineProperty(Ga,"__esModule",{value:!0}),Ga.Node=Ga.NodeType=void 0;var t;(function(i){i[i.element=1]="element",i[i.text=3]="text"})(t||(Ga.NodeType=t={}));let e=class{constructor({nodeType:s,namespace:a,selfCloseTag:c,text:u,nodeName:h,childNodes:p,parentNode:f,attributes:g}){this.namespace=a||null,this.nodeType=s,this.isSelfCloseTag=!!c,this.text=u||null,this.nodeName=s===t.element?h:"#text",this.childNodes=p||[],this.parentNode=f,this.attributes=g||[]}get firstChild(){return this.childNodes[0]||null}get lastChild(){return this.childNodes[this.childNodes.length-1]||null}get innerHTML(){return this.childNodes.reduce((s,a)=>s+(a.nodeType===t.text?a.text:a.outerHTML),"")}get outerHTML(){if(this.nodeType===t.text)return this.textContent;const s=o(this.attributes),a=`<${this.nodeName}${s.length?" ":""}${s}${this.isSelfCloseTag?"/":""}>`;if(this.isSelfCloseTag)return a;const c=this.childNodes.map(h=>h.outerHTML).join(""),u=`</${this.nodeName}>`;return[a,c,u].join("")}get textContent(){return this.nodeType===t.text?this.text:this.childNodes.map(s=>s.textContent).join("").replace(/\x20+/g," ")}getAttribute(s){const a=this.attributes.find(c=>c.name===s);return a?a.value:null}getElementsByTagName(s){return n(this,a=>a.nodeName.toUpperCase()===s.toUpperCase())}getElementsByClassName(s){const a=new RegExp(`^(.*?\\s)?${s}(\\s.*?)?$`);return n(this,c=>!!(c.attributes.length&&a.test(c.getAttribute("class")||"")))}getElementsByName(s){return n(this,a=>!!(a.attributes.length&&a.getAttribute("name")===s))}getElementById(s){return r(this,a=>!!(a.attributes.length&&a.getAttribute("id")===s))}};Ga.Node=e,e.ELEMENT_NODE=t.element,e.TEXT_NODE=t.text;function n(i,s){return i.nodeType===t.text?[]:i.childNodes.reduce((a,c)=>c.nodeType!==t.text&&s(c)?[...a,c,...n(c,s)]:[...a,...n(c,s)],[])}function r(i,s){for(let a=0,c=i.childNodes.length;a<c;a++){const u=i.childNodes[a];if(s(u))return u;const h=r(u,s);if(h)return h}return null}function o(i){return i.map(s=>s.name+(s.value?`="${s.value}"`:"")).join(" ")}return Ga}var Eh={},TN;function Ope(){if(TN)return Eh;TN=1,Object.defineProperty(Eh,"__esModule",{value:!0}),Eh.NodeAttribute=void 0;let t=class{constructor({name:n,value:r}){this.name=n,this.value=r}};return Eh.NodeAttribute=t,Eh}var _N;function wN(){if(_N)return Sh;_N=1,Object.defineProperty(Sh,"__esModule",{value:!0}),Sh.Dom=void 0;const t=k9(),e=Ope(),n=/(<\/?(?:[a-z][a-z0-9]*:)?[a-z][a-z0-9-_.]*?[a-z0-9]*\s*(?:\s+[a-z0-9-_:]+(?:=(?:(?:'[\s\S]*?')|(?:"[\s\S]*?")))?)*\s*\/?>)|([^<]|<(?![a-z/]))*/gi,r=/\s[a-z0-9-_:]+\b(\s*=\s*('|")[\s\S]*?\2)?/gi,o=/(\s[a-z0-9-_:]+\b\s*)(?:=(\s*('|")[\s\S]*?\3))?/gi,i=/^<[a-z]/,s=/\/>$/,a=/^<\//,c=/^[^<]/,u=/<\/?((?:([a-z][a-z0-9]*):)?(?:[a-z](?:[a-z0-9-_.]*[a-z0-9])?))/i,h=/^('|")|('|")$/g,p=/^(?:area|base|br|col|command|embed|hr|img|input|link|meta|param|source)/i;let f=class{constructor(_){this.rawHTML=_}find(_,w){const A=g(this.rawHTML,_,w);return w?A[0]||null:A}getElementsByClassName(_){const w=new RegExp(`^(.*?\\s)?${_}(\\s.*?)?$`);return this.find(A=>!!(A.attributes.length&&w.test(A.getAttribute("class")||"")))}getElementsByTagName(_){return this.find(w=>w.nodeName.toUpperCase()===_.toUpperCase())}getElementById(_){return this.find(w=>w.getAttribute("id")===_,!0)}getElementsByName(_){return this.find(w=>w.getAttribute("name")===_)}getElementsByAttribute(_,w){return this.find(A=>A.getAttribute(_)===w)}};Sh.Dom=f;function g(T,_,w=!1){const A=v(T),M=[];for(const R of A)if(R&&_(R)&&(M.push(R),w))return M;return M}function*v(T){const _=b(T);let w=null;for(let A=0,M=_.length;A<M;A++){const R=_[A];w=C(R,w)||w,y(w,R)&&(yield w,w=w.parentNode)}for(;w;)yield w,w=w.parentNode}function y(T,_){if(!_)return!1;const w=a.test(_),[,A]=_.match(u)||[];return w&&T.nodeName===A||T.isSelfCloseTag||T.nodeType===t.NodeType.text}function b(T){return T.match(n)||[]}function C(T,_){const w=c.test(T),A=i.test(T);return w?I(T,_):A?S(T,_):null}function S(T,_){var w;const[,A,M]=T.match(u)||[],R=s.test(T)||p.test(A),$=E(T),V=new t.Node({nodeType:t.NodeType.element,nodeName:A,namespace:M,attributes:$,childNodes:[],parentNode:_,selfCloseTag:R});return(w=_==null?void 0:_.childNodes)===null||w===void 0||w.push(V),V}function E(T){return(T.match(r)||[]).map(_=>{o.lastIndex=0;const w=o.exec(_)||[],[,A="",M=""]=w;return new e.NodeAttribute({name:A.trim(),value:M.trim().replace(h,"")})})}function I(T,_){var w;const A=new t.Node({nodeType:t.NodeType.text,nodeName:"#text",text:T,parentNode:_});return(w=_==null?void 0:_.childNodes)===null||w===void 0||w.push(A),A}return Sh}var AN;function Lpe(){return AN||(AN=1,function(t){var e=$a&&$a.__createBinding||(Object.create?function(i,s,a,c){c===void 0&&(c=a);var u=Object.getOwnPropertyDescriptor(s,a);(!u||("get"in u?!s.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(i,c,u)}:function(i,s,a,c){c===void 0&&(c=a),i[c]=s[a]}),n=$a&&$a.__exportStar||function(i,s){for(var a in i)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&e(s,i,a)};Object.defineProperty(t,"__esModule",{value:!0}),t.parseFromString=void 0;const r=wN();function o(i){return new r.Dom(i)}t.parseFromString=o,n(wN(),t),n(k9(),t)}($a)),$a}var kN=Lpe();function Pw(t){const e=[];let n="",r=!1;for(const o of t)o===" "||o===`
`?r=!0:r&&(e.push(n),n="",r=!1),n+=o;return n.length>0&&e.push(n),e}function Dpe(t){const n=kN.parseFromString(`<html>${t}</html>`).getElementsByTagName("html")[0];let r=[];for(const o of n.childNodes)o.nodeType===kN.NodeType.text?o.textContent&&(r=r.concat(Pw(o.textContent))):r.push(o.outerHTML);return r}function jpe(t){return t===" "||t===`
`||t==="	"}function x9(t,e,n={}){if(t.length<=e)return t;function r(a){const c=a.trim();return n.ellipsis?`${c}...`:c}const o=t.indexOf(`
`,0);if(o>=0&&o<e){const a=t.slice(0,o);return r(a)}let i=e;for(;i>0;){const a=t[i];if(a&&!jpe(a))i-=1;else break}let s=t.slice(0,e);return i>0&&(s=t.slice(0,i)),r(s)}let ji=null;function R9(t){return ji||(H(()=>import("./core-BiIOkrJH.js"),__vite__mapDeps([222,2])).then(e=>e.default).then(e=>{ji=e,t==null||t()}),null)}async function Upe(t){const[{ALIAS_TO_SUPPORTED_LANGUAGE:e},{loadLanguageModule:n}]=await Promise.all([H(()=>Promise.resolve().then(()=>Ihe),void 0),H(()=>import("./language-loader-BzJv311v.js"),__vite__mapDeps([223,1,2]))]),r=e.get(t);if(!r)return!1;const o=await n(r);return o?ji?(ji.registerLanguage(t,o),!0):(R9(()=>{ji==null||ji.registerLanguage(t,o)}),!1):!1}const Fpe={jsx:["xml"],tsx:["xml"]};async function Bpe(t){const e=t.map(async r=>ji?ji.getLanguage(r)?!1:Upe(r):!1);return(await Promise.allSettled(e)).some(r=>r.status==="fulfilled"&&r.value)}async function Hpe(t){const e=Fpe[t]??[];return Bpe([...e,t])}const ou=.018;function Hl({items:t,delay:e,isHtml:n,forceRender:r}){var i;const o=[];for(const s of t){if(s.type==="citation"){const f=e.getValue();e.queueUpdate(ou),o.push({type:"citation",delay:f,...s.props});continue}if(s.type==="latex"){const f=A9(s.props.content,!1,r),g=e.getValue();e.queueUpdate(ou),o.push({type:"word",word:f,delay:g,format:"latexAsHtml"});continue}if(s.props.link){const f=s.props.text,{url:g}=s.props.link,v=e.getValue();e.queueUpdate(ou),o.push({type:"word",word:f,delay:v,url:g});continue}let a=null,c=null;if(s.props.annotations){for(const f of["italic","bold","strikethrough","code","sub","sup"])if(s.props.annotations[f]){const v={type:f,items:[]};(f==="code"||f==="sup"||f==="sub")&&(v.delay=e.getValue(),e.queueUpdate(ou)),c?(c.items.push(v),c=v):(a=v,c=v)}}const u=[],h=(i=s.props.annotations)==null?void 0:i.code;let p;n?p=Dpe(s.props.text):p=Pw(s.props.text);for(let f=0;f<p.length;f+=1)u.push({type:"word",word:p[f],delay:e.getValue(),format:h?"code":void 0}),e.queueUpdate(ou);c&&a?(c.items.push(...u),o.push(a)):o.push(...u)}return o}function qf(t,e,n){const r=[];for(const o of t)switch(o.type){case"paragraph":{r.push({type:"paragraph",items:Hl({items:o.props.items,delay:e,forceRender:n})});continue}case"list":{r.push({type:"list",ordered:o.props.ordered,start:o.props.start,items:o.props.items.map(i=>({delay:e.getValue(),items:qf(i,e,n)}))});continue}case"heading":{r.push({type:"heading",level:o.props.level,items:Hl({items:o.props.items,delay:e})});continue}case"hr":{r.push({type:"hr",delay:e.getValue()}),e.queueUpdate(ou);continue}case"code":{const{language:i,content:s}=o.props;if(s.type!=="text")continue;let a=s.props.text,c=!1;if(i){const h=R9(n);if(Hpe(i).then(p=>{p&&n()}),h!=null&&h.getLanguage(i)){const{value:p}=h.highlight(s.props.text,{language:i});p&&(a=p,c=!0)}}const u={...s,props:{...s.props,text:a}};r.push({type:"code",content:Hl({items:[u],delay:e,isHtml:c}),original:s.props.text,language:i,delay:e.getValue(),dangerouslyUseHtml:c});continue}case"latex":{const{content:i}=o.props;if(i.type!=="text")continue;i.props.text=A9(i.props.text,!0,n),r.push({type:"latex",content:Hl({items:[i],isHtml:!0,delay:e}),delay:e.getValue(),dangerouslyUseHtml:!0});continue}case"table":{r.push({type:"table",columns:o.props.columns.map(i=>Hl({items:i,delay:e})),data:o.props.data.map(i=>i.map(s=>Hl({items:s,delay:e})))});continue}case"blockquote":{r.push({type:"blockquote",delay:e.getValue(),items:qf(o.props.items,e,n)});continue}default:{console.log(`Unhandled block type: ${o.type}`);continue}}return r}var xm;function N9(t){return xm=xm||document.createElement("textarea"),xm.innerHTML="&"+t+";",xm.value}var zpe=Object.prototype.hasOwnProperty;function Vpe(t,e){return t?zpe.call(t,e):!1}function P9(t){var e=[].slice.call(arguments,1);return e.forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){t[r]=n[r]})}}),t}var $pe=/\\([\\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function Wf(t){return t.indexOf("\\")<0?t:t.replace($pe,"$1")}function M9(t){return!(t>=55296&&t<=57343||t>=64976&&t<=65007||(t&65535)===65535||(t&65535)===65534||t>=0&&t<=8||t===11||t>=14&&t<=31||t>=127&&t<=159||t>1114111)}function OE(t){if(t>65535){t-=65536;var e=55296+(t>>10),n=56320+(t&1023);return String.fromCharCode(e,n)}return String.fromCharCode(t)}var Gpe=/&([a-z#][a-z0-9]{1,31});/gi,Kpe=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i;function qpe(t,e){var n=0,r=N9(e);return e!==r?r:e.charCodeAt(0)===35&&Kpe.test(e)&&(n=e[1].toLowerCase()==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10),M9(n))?OE(n):t}function qc(t){return t.indexOf("&")<0?t:t.replace(Gpe,qpe)}var Wpe=/[&<>"]/,Ype=/[&<>"]/g,Qpe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function Jpe(t){return Qpe[t]}function qr(t){return Wpe.test(t)?t.replace(Ype,Jpe):t}var Ye={};Ye.blockquote_open=function(){return`<blockquote>
`};Ye.blockquote_close=function(t,e){return"</blockquote>"+bl(t,e)};Ye.code=function(t,e){return t[e].block?"<pre><code>"+qr(t[e].content)+"</code></pre>"+bl(t,e):"<code>"+qr(t[e].content)+"</code>"};Ye.fence=function(t,e,n,r,o){var i=t[e],s="",a=n.langPrefix,c="",u,h,p;if(i.params){if(u=i.params.split(/\s+/g),h=u.join(" "),Vpe(o.rules.fence_custom,u[0]))return o.rules.fence_custom[u[0]](t,e,n,r,o);c=qr(qc(Wf(h))),s=' class="'+a+c+'"'}return n.highlight?p=n.highlight.apply(n.highlight,[i.content].concat(u))||qr(i.content):p=qr(i.content),"<pre><code"+s+">"+p+"</code></pre>"+bl(t,e)};Ye.fence_custom={};Ye.heading_open=function(t,e){return"<h"+t[e].hLevel+">"};Ye.heading_close=function(t,e){return"</h"+t[e].hLevel+`>
`};Ye.hr=function(t,e,n){return(n.xhtmlOut?"<hr />":"<hr>")+bl(t,e)};Ye.bullet_list_open=function(){return`<ul>
`};Ye.bullet_list_close=function(t,e){return"</ul>"+bl(t,e)};Ye.list_item_open=function(){return"<li>"};Ye.list_item_close=function(){return`</li>
`};Ye.ordered_list_open=function(t,e){var n=t[e],r=n.order>1?' start="'+n.order+'"':"";return"<ol"+r+`>
`};Ye.ordered_list_close=function(t,e){return"</ol>"+bl(t,e)};Ye.paragraph_open=function(t,e){return t[e].tight?"":"<p>"};Ye.paragraph_close=function(t,e){var n=!(t[e].tight&&e&&t[e-1].type==="inline"&&!t[e-1].content);return(t[e].tight?"":"</p>")+(n?bl(t,e):"")};Ye.link_open=function(t,e,n){var r=t[e].title?' title="'+qr(qc(t[e].title))+'"':"",o=n.linkTarget?' target="'+n.linkTarget+'"':"";return'<a href="'+qr(t[e].href)+'"'+r+o+">"};Ye.link_close=function(){return"</a>"};Ye.image=function(t,e,n){var r=' src="'+qr(t[e].src)+'"',o=t[e].title?' title="'+qr(qc(t[e].title))+'"':"",i=' alt="'+(t[e].alt?qr(qc(Wf(t[e].alt))):"")+'"',s=n.xhtmlOut?" /":"";return"<img"+r+i+o+s+">"};Ye.table_open=function(){return`<table>
`};Ye.table_close=function(){return`</table>
`};Ye.thead_open=function(){return`<thead>
`};Ye.thead_close=function(){return`</thead>
`};Ye.tbody_open=function(){return`<tbody>
`};Ye.tbody_close=function(){return`</tbody>
`};Ye.tr_open=function(){return"<tr>"};Ye.tr_close=function(){return`</tr>
`};Ye.th_open=function(t,e){var n=t[e];return"<th"+(n.align?' style="text-align:'+n.align+'"':"")+">"};Ye.th_close=function(){return"</th>"};Ye.td_open=function(t,e){var n=t[e];return"<td"+(n.align?' style="text-align:'+n.align+'"':"")+">"};Ye.td_close=function(){return"</td>"};Ye.strong_open=function(){return"<strong>"};Ye.strong_close=function(){return"</strong>"};Ye.em_open=function(){return"<em>"};Ye.em_close=function(){return"</em>"};Ye.del_open=function(){return"<del>"};Ye.del_close=function(){return"</del>"};Ye.ins_open=function(){return"<ins>"};Ye.ins_close=function(){return"</ins>"};Ye.mark_open=function(){return"<mark>"};Ye.mark_close=function(){return"</mark>"};Ye.sub=function(t,e){return"<sub>"+qr(t[e].content)+"</sub>"};Ye.sup=function(t,e){return"<sup>"+qr(t[e].content)+"</sup>"};Ye.hardbreak=function(t,e,n){return n.xhtmlOut?`<br />
`:`<br>
`};Ye.softbreak=function(t,e,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};Ye.text=function(t,e){return qr(t[e].content)};Ye.htmlblock=function(t,e){return t[e].content};Ye.htmltag=function(t,e){return t[e].content};Ye.abbr_open=function(t,e){return'<abbr title="'+qr(qc(t[e].title))+'">'};Ye.abbr_close=function(){return"</abbr>"};Ye.footnote_ref=function(t,e){var n=Number(t[e].id+1).toString(),r="fnref"+n;return t[e].subId>0&&(r+=":"+t[e].subId),'<sup class="footnote-ref"><a href="#fn'+n+'" id="'+r+'">['+n+"]</a></sup>"};Ye.footnote_block_open=function(t,e,n){var r=n.xhtmlOut?`<hr class="footnotes-sep" />
`:`<hr class="footnotes-sep">
`;return r+`<section class="footnotes">
<ol class="footnotes-list">
`};Ye.footnote_block_close=function(){return`</ol>
</section>
`};Ye.footnote_open=function(t,e){var n=Number(t[e].id+1).toString();return'<li id="fn'+n+'"  class="footnote-item">'};Ye.footnote_close=function(){return`</li>
`};Ye.footnote_anchor=function(t,e){var n=Number(t[e].id+1).toString(),r="fnref"+n;return t[e].subId>0&&(r+=":"+t[e].subId),' <a href="#'+r+'" class="footnote-backref">↩</a>'};Ye.dl_open=function(){return`<dl>
`};Ye.dt_open=function(){return"<dt>"};Ye.dd_open=function(){return"<dd>"};Ye.dl_close=function(){return`</dl>
`};Ye.dt_close=function(){return`</dt>
`};Ye.dd_close=function(){return`</dd>
`};function O9(t,e){return++e>=t.length-2?e:t[e].type==="paragraph_open"&&t[e].tight&&t[e+1].type==="inline"&&t[e+1].content.length===0&&t[e+2].type==="paragraph_close"&&t[e+2].tight?O9(t,e+2):e}var bl=Ye.getBreak=function(e,n){return n=O9(e,n),n<e.length&&e[n].type==="list_item_close"?"":`
`};function Mw(){this.rules=P9({},Ye),this.getBreak=Ye.getBreak}Mw.prototype.renderInline=function(t,e,n){for(var r=this.rules,o=t.length,i=0,s="";o--;)s+=r[t[i].type](t,i++,e,n,this);return s};Mw.prototype.render=function(t,e,n){for(var r=this.rules,o=t.length,i=-1,s="";++i<o;)t[i].type==="inline"?s+=this.renderInline(t[i].children,e,n):s+=r[t[i].type](t,i,e,n,this);return s};function bo(){this.__rules__=[],this.__cache__=null}bo.prototype.__find__=function(t){for(var e=this.__rules__.length,n=-1;e--;)if(this.__rules__[++n].name===t)return n;return-1};bo.prototype.__compile__=function(){var t=this,e=[""];t.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){e.indexOf(r)<0&&e.push(r)})}),t.__cache__={},e.forEach(function(n){t.__cache__[n]=[],t.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||t.__cache__[n].push(r.fn))})})};bo.prototype.at=function(t,e,n){var r=this.__find__(t),o=n||{};if(r===-1)throw new Error("Parser rule not found: "+t);this.__rules__[r].fn=e,this.__rules__[r].alt=o.alt||[],this.__cache__=null};bo.prototype.before=function(t,e,n,r){var o=this.__find__(t),i=r||{};if(o===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(o,0,{name:e,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};bo.prototype.after=function(t,e,n,r){var o=this.__find__(t),i=r||{};if(o===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(o+1,0,{name:e,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};bo.prototype.push=function(t,e,n){var r=n||{};this.__rules__.push({name:t,enabled:!0,fn:e,alt:r.alt||[]}),this.__cache__=null};bo.prototype.enable=function(t,e){t=Array.isArray(t)?t:[t],e&&this.__rules__.forEach(function(n){n.enabled=!1}),t.forEach(function(n){var r=this.__find__(n);if(r<0)throw new Error("Rules manager: invalid rule name "+n);this.__rules__[r].enabled=!0},this),this.__cache__=null};bo.prototype.disable=function(t){t=Array.isArray(t)?t:[t],t.forEach(function(e){var n=this.__find__(e);if(n<0)throw new Error("Rules manager: invalid rule name "+e);this.__rules__[n].enabled=!1},this),this.__cache__=null};bo.prototype.getRules=function(t){return this.__cache__===null&&this.__compile__(),this.__cache__[t]||[]};function Zpe(t){t.inlineMode?t.tokens.push({type:"inline",content:t.src.replace(/\n/g," ").trim(),level:0,lines:[0,1],children:[]}):t.block.parse(t.src,t.options,t.env,t.tokens)}function yl(t,e,n,r,o){this.src=t,this.env=r,this.options=n,this.parser=e,this.tokens=o,this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache=[],this.isInLabel=!1,this.linkLevel=0,this.linkContent="",this.labelUnmatchedScopes=0}yl.prototype.pushPending=function(){this.tokens.push({type:"text",content:this.pending,level:this.pendingLevel}),this.pending=""};yl.prototype.push=function(t){this.pending&&this.pushPending(),this.tokens.push(t),this.pendingLevel=this.level};yl.prototype.cacheSet=function(t,e){for(var n=this.cache.length;n<=t;n++)this.cache.push(0);this.cache[t]=e};yl.prototype.cacheGet=function(t){return t<this.cache.length?this.cache[t]:0};function Yf(t,e){var n,r,o,i=-1,s=t.posMax,a=t.pos,c=t.isInLabel;if(t.isInLabel)return-1;if(t.labelUnmatchedScopes)return t.labelUnmatchedScopes--,-1;for(t.pos=e+1,t.isInLabel=!0,n=1;t.pos<s;){if(o=t.src.charCodeAt(t.pos),o===91)n++;else if(o===93&&(n--,n===0)){r=!0;break}t.parser.skipToken(t)}return r?(i=t.pos,t.labelUnmatchedScopes=0):t.labelUnmatchedScopes=n-1,t.pos=a,t.isInLabel=c,i}function Xpe(t,e,n,r){var o,i,s,a,c,u;if(t.charCodeAt(0)!==42||t.charCodeAt(1)!==91||t.indexOf("]:")===-1||(o=new yl(t,e,n,r,[]),i=Yf(o,1),i<0||t.charCodeAt(i+1)!==58))return-1;for(a=o.posMax,s=i+2;s<a&&o.src.charCodeAt(s)!==10;s++);return c=t.slice(2,i),u=t.slice(i+2,s).trim(),u.length===0?-1:(r.abbreviations||(r.abbreviations={}),typeof r.abbreviations[":"+c]>"u"&&(r.abbreviations[":"+c]=u),s)}function eme(t){var e=t.tokens,n,r,o,i;if(!t.inlineMode){for(n=1,r=e.length-1;n<r;n++)if(e[n-1].type==="paragraph_open"&&e[n].type==="inline"&&e[n+1].type==="paragraph_close"){for(o=e[n].content;o.length&&(i=Xpe(o,t.inline,t.options,t.env),!(i<0));)o=o.slice(i).trim();e[n].content=o,o.length||(e[n-1].tight=!0,e[n+1].tight=!0)}}}function LE(t){var e=qc(t);try{e=decodeURI(e)}catch{}return encodeURI(e)}function L9(t,e){var n,r,o,i=e,s=t.posMax;if(t.src.charCodeAt(e)===60){for(e++;e<s;){if(n=t.src.charCodeAt(e),n===10)return!1;if(n===62)return o=LE(Wf(t.src.slice(i+1,e))),t.parser.validateLink(o)?(t.pos=e+1,t.linkContent=o,!0):!1;if(n===92&&e+1<s){e+=2;continue}e++}return!1}for(r=0;e<s&&(n=t.src.charCodeAt(e),!(n===32||n<32||n===127));){if(n===92&&e+1<s){e+=2;continue}if(n===40&&(r++,r>1)||n===41&&(r--,r<0))break;e++}return i===e||(o=Wf(t.src.slice(i,e)),!t.parser.validateLink(o))?!1:(t.linkContent=o,t.pos=e,!0)}function D9(t,e){var n,r=e,o=t.posMax,i=t.src.charCodeAt(e);if(i!==34&&i!==39&&i!==40)return!1;for(e++,i===40&&(i=41);e<o;){if(n=t.src.charCodeAt(e),n===i)return t.pos=e+1,t.linkContent=Wf(t.src.slice(r+1,e)),!0;if(n===92&&e+1<o){e+=2;continue}e++}return!1}function j9(t){return t.trim().replace(/\s+/g," ").toUpperCase()}function tme(t,e,n,r){var o,i,s,a,c,u,h,p,f;if(t.charCodeAt(0)!==91||t.indexOf("]:")===-1||(o=new yl(t,e,n,r,[]),i=Yf(o,0),i<0||t.charCodeAt(i+1)!==58))return-1;for(a=o.posMax,s=i+2;s<a&&(c=o.src.charCodeAt(s),!(c!==32&&c!==10));s++);if(!L9(o,s))return-1;for(h=o.linkContent,s=o.pos,u=s,s=s+1;s<a&&(c=o.src.charCodeAt(s),!(c!==32&&c!==10));s++);for(s<a&&u!==s&&D9(o,s)?(p=o.linkContent,s=o.pos):(p="",s=u);s<a&&o.src.charCodeAt(s)===32;)s++;return s<a&&o.src.charCodeAt(s)!==10?-1:(f=j9(t.slice(1,i)),typeof r.references[f]>"u"&&(r.references[f]={title:p,href:h}),s)}function nme(t){var e=t.tokens,n,r,o,i;if(t.env.references=t.env.references||{},!t.inlineMode){for(n=1,r=e.length-1;n<r;n++)if(e[n].type==="inline"&&e[n-1].type==="paragraph_open"&&e[n+1].type==="paragraph_close"){for(o=e[n].content;o.length&&(i=tme(o,t.inline,t.options,t.env),!(i<0));)o=o.slice(i).trim();e[n].content=o,o.length||(e[n-1].tight=!0,e[n+1].tight=!0)}}}function rme(t){var e=t.tokens,n,r,o;for(r=0,o=e.length;r<o;r++)n=e[r],n.type==="inline"&&t.inline.parse(n.content,t.options,t.env,n.children)}function ome(t){var e,n,r,o,i,s,a,c,u,h=0,p=!1,f={};if(t.env.footnotes&&(t.tokens=t.tokens.filter(function(g){return g.type==="footnote_reference_open"?(p=!0,c=[],u=g.label,!1):g.type==="footnote_reference_close"?(p=!1,f[":"+u]=c,!1):(p&&c.push(g),!p)}),!!t.env.footnotes.list)){for(s=t.env.footnotes.list,t.tokens.push({type:"footnote_block_open",level:h++}),e=0,n=s.length;e<n;e++){for(t.tokens.push({type:"footnote_open",id:e,level:h++}),s[e].tokens?(a=[],a.push({type:"paragraph_open",tight:!1,level:h++}),a.push({type:"inline",content:"",level:h,children:s[e].tokens}),a.push({type:"paragraph_close",tight:!1,level:--h})):s[e].label&&(a=f[":"+s[e].label]),t.tokens=t.tokens.concat(a),t.tokens[t.tokens.length-1].type==="paragraph_close"?i=t.tokens.pop():i=null,o=s[e].count>0?s[e].count:1,r=0;r<o;r++)t.tokens.push({type:"footnote_anchor",id:e,subId:r,level:h});i&&t.tokens.push(i),t.tokens.push({type:"footnote_close",level:--h})}t.tokens.push({type:"footnote_block_close",level:--h})}}var xN=` 
()[]'".,!?-`;function n0(t){return t.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1")}function ime(t){var e,n,r,o,i,s,a,c,u,h,p,f,g=t.tokens;if(t.env.abbreviations){for(t.env.abbrRegExp||(f="(^|["+xN.split("").map(n0).join("")+"])("+Object.keys(t.env.abbreviations).map(function(v){return v.substr(1)}).sort(function(v,y){return y.length-v.length}).map(n0).join("|")+")($|["+xN.split("").map(n0).join("")+"])",t.env.abbrRegExp=new RegExp(f,"g")),h=t.env.abbrRegExp,n=0,r=g.length;n<r;n++)if(g[n].type==="inline"){for(o=g[n].children,e=o.length-1;e>=0;e--)if(i=o[e],i.type==="text"){for(c=0,s=i.content,h.lastIndex=0,u=i.level,a=[];p=h.exec(s);)h.lastIndex>c&&a.push({type:"text",content:s.slice(c,p.index+p[1].length),level:u}),a.push({type:"abbr_open",title:t.env.abbreviations[":"+p[2]],level:u++}),a.push({type:"text",content:p[2],level:u}),a.push({type:"abbr_close",level:--u}),c=h.lastIndex-p[3].length;a.length&&(c<s.length&&a.push({type:"text",content:s.slice(c),level:u}),g[n].children=o=[].concat(o.slice(0,e),a,o.slice(e+1)))}}}}var sme=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,ame=/\((c|tm|r|p)\)/ig,cme={c:"©",r:"®",p:"§",tm:"™"};function lme(t){return t.indexOf("(")<0?t:t.replace(ame,function(e,n){return cme[n.toLowerCase()]})}function ume(t){var e,n,r,o,i;if(t.options.typographer){for(i=t.tokens.length-1;i>=0;i--)if(t.tokens[i].type==="inline")for(o=t.tokens[i].children,e=o.length-1;e>=0;e--)n=o[e],n.type==="text"&&(r=n.content,r=lme(r),sme.test(r)&&(r=r.replace(/\+-/g,"±").replace(/\.{2,}/g,"…").replace(/([?!])…/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---([^-]|$)/mg,"$1—$2").replace(/(^|\s)--(\s|$)/mg,"$1–$2").replace(/(^|[^-\s])--([^-\s]|$)/mg,"$1–$2")),n.content=r)}}var dme=/['"]/,RN=/['"]/g,hme=/[-\s()\[\]]/,NN="’";function PN(t,e){return e<0||e>=t.length?!1:!hme.test(t[e])}function zl(t,e,n){return t.substr(0,e)+n+t.substr(e+1)}function fme(t){var e,n,r,o,i,s,a,c,u,h,p,f,g,v,y,b,C;if(t.options.typographer){for(C=[],y=t.tokens.length-1;y>=0;y--)if(t.tokens[y].type==="inline"){for(b=t.tokens[y].children,C.length=0,e=0;e<b.length;e++)if(n=b[e],!(n.type!=="text"||dme.test(n.text))){for(a=b[e].level,g=C.length-1;g>=0&&!(C[g].level<=a);g--);C.length=g+1,r=n.content,i=0,s=r.length;e:for(;i<s&&(RN.lastIndex=i,o=RN.exec(r),!!o);){if(c=!PN(r,o.index-1),i=o.index+1,v=o[0]==="'",u=!PN(r,i),!u&&!c){v&&(n.content=zl(n.content,o.index,NN));continue}if(p=!u,f=!c,f){for(g=C.length-1;g>=0&&(h=C[g],!(C[g].level<a));g--)if(h.single===v&&C[g].level===a){h=C[g],v?(b[h.token].content=zl(b[h.token].content,h.pos,t.options.quotes[2]),n.content=zl(n.content,o.index,t.options.quotes[3])):(b[h.token].content=zl(b[h.token].content,h.pos,t.options.quotes[0]),n.content=zl(n.content,o.index,t.options.quotes[1])),C.length=g;continue e}}p?C.push({token:e,pos:o.index,single:v,level:a}):f&&v&&(n.content=zl(n.content,o.index,NN))}}}}}var r0=[["block",Zpe],["abbr",eme],["references",nme],["inline",rme],["footnote_tail",ome],["abbr2",ime],["replacements",ume],["smartquotes",fme]];function U9(){this.options={},this.ruler=new bo;for(var t=0;t<r0.length;t++)this.ruler.push(r0[t][0],r0[t][1])}U9.prototype.process=function(t){var e,n,r;for(r=this.ruler.getRules(""),e=0,n=r.length;e<n;e++)r[e](t)};function Cl(t,e,n,r,o){var i,s,a,c,u,h,p;for(this.src=t,this.parser=e,this.options=n,this.env=r,this.tokens=o,this.bMarks=[],this.eMarks=[],this.tShift=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.parentType="root",this.ddIndent=-1,this.level=0,this.result="",s=this.src,h=0,p=!1,a=c=h=0,u=s.length;c<u;c++){if(i=s.charCodeAt(c),!p)if(i===32){h++;continue}else p=!0;(i===10||c===u-1)&&(i!==10&&c++,this.bMarks.push(a),this.eMarks.push(c),this.tShift.push(h),p=!1,h=0,a=c+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.lineMax=this.bMarks.length-1}Cl.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};Cl.prototype.skipEmptyLines=function(e){for(var n=this.lineMax;e<n&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};Cl.prototype.skipSpaces=function(e){for(var n=this.src.length;e<n&&this.src.charCodeAt(e)===32;e++);return e};Cl.prototype.skipChars=function(e,n){for(var r=this.src.length;e<r&&this.src.charCodeAt(e)===n;e++);return e};Cl.prototype.skipCharsBack=function(e,n,r){if(e<=r)return e;for(;e>r;)if(n!==this.src.charCodeAt(--e))return e+1;return e};Cl.prototype.getLines=function(e,n,r,o){var i,s,a,c,u,h=e;if(e>=n)return"";if(h+1===n)return s=this.bMarks[h]+Math.min(this.tShift[h],r),a=o?this.eMarks[h]+1:this.eMarks[h],this.src.slice(s,a);for(c=new Array(n-e),i=0;h<n;h++,i++)u=this.tShift[h],u>r&&(u=r),u<0&&(u=0),s=this.bMarks[h]+u,h+1<n||o?a=this.eMarks[h]+1:a=this.eMarks[h],c[i]=this.src.slice(s,a);return c.join("")};function pme(t,e,n){var r,o;if(t.tShift[e]-t.blkIndent<4)return!1;for(o=r=e+1;r<n;){if(t.isEmpty(r)){r++;continue}if(t.tShift[r]-t.blkIndent>=4){r++,o=r;continue}break}return t.line=r,t.tokens.push({type:"code",content:t.getLines(e,o,4+t.blkIndent,!0),block:!0,lines:[e,t.line],level:t.level}),!0}function mme(t,e,n,r){var o,i,s,a,c,u=!1,h=t.bMarks[e]+t.tShift[e],p=t.eMarks[e];if(h+3>p||(o=t.src.charCodeAt(h),o!==126&&o!==96)||(c=h,h=t.skipChars(h,o),i=h-c,i<3)||(s=t.src.slice(h,p).trim(),s.indexOf("`")>=0))return!1;if(r)return!0;for(a=e;a++,!(a>=n||(h=c=t.bMarks[a]+t.tShift[a],p=t.eMarks[a],h<p&&t.tShift[a]<t.blkIndent));)if(t.src.charCodeAt(h)===o&&!(t.tShift[a]-t.blkIndent>=4)&&(h=t.skipChars(h,o),!(h-c<i)&&(h=t.skipSpaces(h),!(h<p)))){u=!0;break}return i=t.tShift[e],t.line=a+(u?1:0),t.tokens.push({type:"fence",params:s,content:t.getLines(e+1,a,i,!0),lines:[e,t.line],level:t.level}),!0}function gme(t,e,n,r){var o,i,s,a,c,u,h,p,f,g,v,y=t.bMarks[e]+t.tShift[e],b=t.eMarks[e];if(y>b||t.src.charCodeAt(y++)!==62||t.level>=t.options.maxNesting)return!1;if(r)return!0;for(t.src.charCodeAt(y)===32&&y++,c=t.blkIndent,t.blkIndent=0,a=[t.bMarks[e]],t.bMarks[e]=y,y=y<b?t.skipSpaces(y):y,i=y>=b,s=[t.tShift[e]],t.tShift[e]=y-t.bMarks[e],p=t.parser.ruler.getRules("blockquote"),o=e+1;o<n&&(y=t.bMarks[o]+t.tShift[o],b=t.eMarks[o],!(y>=b));o++){if(t.src.charCodeAt(y++)===62){t.src.charCodeAt(y)===32&&y++,a.push(t.bMarks[o]),t.bMarks[o]=y,y=y<b?t.skipSpaces(y):y,i=y>=b,s.push(t.tShift[o]),t.tShift[o]=y-t.bMarks[o];continue}if(i)break;for(v=!1,f=0,g=p.length;f<g;f++)if(p[f](t,o,n,!0)){v=!0;break}if(v)break;a.push(t.bMarks[o]),s.push(t.tShift[o]),t.tShift[o]=-1337}for(u=t.parentType,t.parentType="blockquote",t.tokens.push({type:"blockquote_open",lines:h=[e,0],level:t.level++}),t.parser.tokenize(t,e,o),t.tokens.push({type:"blockquote_close",level:--t.level}),t.parentType=u,h[1]=t.line,f=0;f<s.length;f++)t.bMarks[f+e]=a[f],t.tShift[f+e]=s[f];return t.blkIndent=c,!0}function vme(t,e,n,r){var o,i,s,a=t.bMarks[e],c=t.eMarks[e];if(a+=t.tShift[e],a>c||(o=t.src.charCodeAt(a++),o!==42&&o!==45&&o!==95))return!1;for(i=1;a<c;){if(s=t.src.charCodeAt(a++),s!==o&&s!==32)return!1;s===o&&i++}return i<3?!1:(r||(t.line=e+1,t.tokens.push({type:"hr",lines:[e,t.line],level:t.level})),!0)}function MN(t,e){var n,r,o;return r=t.bMarks[e]+t.tShift[e],o=t.eMarks[e],r>=o||(n=t.src.charCodeAt(r++),n!==42&&n!==45&&n!==43)||r<o&&t.src.charCodeAt(r)!==32?-1:r}function ON(t,e){var n,r=t.bMarks[e]+t.tShift[e],o=t.eMarks[e];if(r+1>=o||(n=t.src.charCodeAt(r++),n<48||n>57))return-1;for(;;){if(r>=o)return-1;if(n=t.src.charCodeAt(r++),!(n>=48&&n<=57)){if(n===41||n===46)break;return-1}}return r<o&&t.src.charCodeAt(r)!==32?-1:r}function bme(t,e){var n,r,o=t.level+2;for(n=e+2,r=t.tokens.length-2;n<r;n++)t.tokens[n].level===o&&t.tokens[n].type==="paragraph_open"&&(t.tokens[n+2].tight=!0,t.tokens[n].tight=!0,n+=2)}function yme(t,e,n,r){var o,i,s,a,c,u,h,p,f,g,v,y,b,C,S,E,I,T,_=!0,w,A,M,R;if((p=ON(t,e))>=0)b=!0;else if((p=MN(t,e))>=0)b=!1;else return!1;if(t.level>=t.options.maxNesting)return!1;if(y=t.src.charCodeAt(p-1),r)return!0;for(S=t.tokens.length,b?(h=t.bMarks[e]+t.tShift[e],v=Number(t.src.substr(h,p-h-1)),t.tokens.push({type:"ordered_list_open",order:v,lines:I=[e,0],level:t.level++})):t.tokens.push({type:"bullet_list_open",lines:I=[e,0],level:t.level++}),o=e,E=!1,w=t.parser.ruler.getRules("list");o<n&&(C=t.skipSpaces(p),f=t.eMarks[o],C>=f?g=1:g=C-p,g>4&&(g=1),g<1&&(g=1),i=p-t.bMarks[o]+g,t.tokens.push({type:"list_item_open",lines:T=[e,0],level:t.level++}),a=t.blkIndent,c=t.tight,s=t.tShift[e],u=t.parentType,t.tShift[e]=C-t.bMarks[e],t.blkIndent=i,t.tight=!0,t.parentType="list",t.parser.tokenize(t,e,n,!0),(!t.tight||E)&&(_=!1),E=t.line-e>1&&t.isEmpty(t.line-1),t.blkIndent=a,t.tShift[e]=s,t.tight=c,t.parentType=u,t.tokens.push({type:"list_item_close",level:--t.level}),o=e=t.line,T[1]=o,C=t.bMarks[e],!(o>=n||t.isEmpty(o)||t.tShift[o]<t.blkIndent));){for(R=!1,A=0,M=w.length;A<M;A++)if(w[A](t,o,n,!0)){R=!0;break}if(R)break;if(b){if(p=ON(t,o),p<0)break}else if(p=MN(t,o),p<0)break;if(y!==t.src.charCodeAt(p-1))break}return t.tokens.push({type:b?"ordered_list_close":"bullet_list_close",level:--t.level}),I[1]=o,t.line=o,_&&bme(t,S),!0}function Cme(t,e,n,r){var o,i,s,a,c,u=t.bMarks[e]+t.tShift[e],h=t.eMarks[e];if(u+4>h||t.src.charCodeAt(u)!==91||t.src.charCodeAt(u+1)!==94||t.level>=t.options.maxNesting)return!1;for(a=u+2;a<h;a++){if(t.src.charCodeAt(a)===32)return!1;if(t.src.charCodeAt(a)===93)break}return a===u+2||a+1>=h||t.src.charCodeAt(++a)!==58?!1:(r||(a++,t.env.footnotes||(t.env.footnotes={}),t.env.footnotes.refs||(t.env.footnotes.refs={}),c=t.src.slice(u+2,a-2),t.env.footnotes.refs[":"+c]=-1,t.tokens.push({type:"footnote_reference_open",label:c,level:t.level++}),o=t.bMarks[e],i=t.tShift[e],s=t.parentType,t.tShift[e]=t.skipSpaces(a)-a,t.bMarks[e]=a,t.blkIndent+=4,t.parentType="footnote",t.tShift[e]<t.blkIndent&&(t.tShift[e]+=t.blkIndent,t.bMarks[e]-=t.blkIndent),t.parser.tokenize(t,e,n,!0),t.parentType=s,t.blkIndent-=4,t.tShift[e]=i,t.bMarks[e]=o,t.tokens.push({type:"footnote_reference_close",level:--t.level})),!0)}function Sme(t,e,n,r){var o,i,s,a=t.bMarks[e]+t.tShift[e],c=t.eMarks[e];if(a>=c||(o=t.src.charCodeAt(a),o!==35||a>=c))return!1;for(i=1,o=t.src.charCodeAt(++a);o===35&&a<c&&i<=6;)i++,o=t.src.charCodeAt(++a);return i>6||a<c&&o!==32?!1:(r||(c=t.skipCharsBack(c,32,a),s=t.skipCharsBack(c,35,a),s>a&&t.src.charCodeAt(s-1)===32&&(c=s),t.line=e+1,t.tokens.push({type:"heading_open",hLevel:i,lines:[e,t.line],level:t.level}),a<c&&t.tokens.push({type:"inline",content:t.src.slice(a,c).trim(),level:t.level+1,lines:[e,t.line],children:[]}),t.tokens.push({type:"heading_close",hLevel:i,level:t.level})),!0)}function Eme(t,e,n){var r,o,i,s=e+1;return s>=n||t.tShift[s]<t.blkIndent||t.tShift[s]-t.blkIndent>3||(o=t.bMarks[s]+t.tShift[s],i=t.eMarks[s],o>=i)||(r=t.src.charCodeAt(o),r!==45&&r!==61)||(o=t.skipChars(o,r),o=t.skipSpaces(o),o<i)?!1:(o=t.bMarks[e]+t.tShift[e],t.line=s+1,t.tokens.push({type:"heading_open",hLevel:r===61?1:2,lines:[e,t.line],level:t.level}),t.tokens.push({type:"inline",content:t.src.slice(o,t.eMarks[e]).trim(),level:t.level+1,lines:[e,t.line-1],children:[]}),t.tokens.push({type:"heading_close",hLevel:r===61?1:2,level:t.level}),!0)}var F9={};["article","aside","button","blockquote","body","canvas","caption","col","colgroup","dd","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","iframe","li","map","object","ol","output","p","pre","progress","script","section","style","table","tbody","td","textarea","tfoot","th","tr","thead","ul","video"].forEach(function(t){F9[t]=!0});var Ime=/^<([a-zA-Z]{1,15})[\s\/>]/,Tme=/^<\/([a-zA-Z]{1,15})[\s>]/;function _me(t){var e=t|32;return e>=97&&e<=122}function wme(t,e,n,r){var o,i,s,a=t.bMarks[e],c=t.eMarks[e],u=t.tShift[e];if(a+=u,!t.options.html||u>3||a+2>=c||t.src.charCodeAt(a)!==60)return!1;if(o=t.src.charCodeAt(a+1),o===33||o===63){if(r)return!0}else if(o===47||_me(o)){if(o===47){if(i=t.src.slice(a,c).match(Tme),!i)return!1}else if(i=t.src.slice(a,c).match(Ime),!i)return!1;if(F9[i[1].toLowerCase()]!==!0)return!1;if(r)return!0}else return!1;for(s=e+1;s<t.lineMax&&!t.isEmpty(s);)s++;return t.line=s,t.tokens.push({type:"htmlblock",level:t.level,lines:[e,t.line],content:t.getLines(e,s,0,!0)}),!0}function o0(t,e){var n=t.bMarks[e]+t.blkIndent,r=t.eMarks[e];return t.src.substr(n,r-n)}function Ame(t,e,n,r){var o,i,s,a,c,u,h,p,f,g,v;if(e+2>n||(c=e+1,t.tShift[c]<t.blkIndent)||(s=t.bMarks[c]+t.tShift[c],s>=t.eMarks[c])||(o=t.src.charCodeAt(s),o!==124&&o!==45&&o!==58)||(i=o0(t,e+1),!/^[-:| ]+$/.test(i))||(u=i.split("|"),u<=2))return!1;for(p=[],a=0;a<u.length;a++){if(f=u[a].trim(),!f){if(a===0||a===u.length-1)continue;return!1}if(!/^:?-+:?$/.test(f))return!1;f.charCodeAt(f.length-1)===58?p.push(f.charCodeAt(0)===58?"center":"right"):f.charCodeAt(0)===58?p.push("left"):p.push("")}if(i=o0(t,e).trim(),i.indexOf("|")===-1||(u=i.replace(/^\||\|$/g,"").split("|"),p.length!==u.length))return!1;if(r)return!0;for(t.tokens.push({type:"table_open",lines:g=[e,0],level:t.level++}),t.tokens.push({type:"thead_open",lines:[e,e+1],level:t.level++}),t.tokens.push({type:"tr_open",lines:[e,e+1],level:t.level++}),a=0;a<u.length;a++)t.tokens.push({type:"th_open",align:p[a],lines:[e,e+1],level:t.level++}),t.tokens.push({type:"inline",content:u[a].trim(),lines:[e,e+1],level:t.level,children:[]}),t.tokens.push({type:"th_close",level:--t.level});for(t.tokens.push({type:"tr_close",level:--t.level}),t.tokens.push({type:"thead_close",level:--t.level}),t.tokens.push({type:"tbody_open",lines:v=[e+2,0],level:t.level++}),c=e+2;c<n&&!(t.tShift[c]<t.blkIndent||(i=o0(t,c).trim(),i.indexOf("|")===-1));c++){for(u=i.replace(/^\||\|$/g,"").split("|"),t.tokens.push({type:"tr_open",level:t.level++}),a=0;a<u.length;a++)t.tokens.push({type:"td_open",align:p[a],level:t.level++}),h=u[a].substring(u[a].charCodeAt(0)===124?1:0,u[a].charCodeAt(u[a].length-1)===124?u[a].length-1:u[a].length).trim(),t.tokens.push({type:"inline",content:h,level:t.level,children:[]}),t.tokens.push({type:"td_close",level:--t.level});t.tokens.push({type:"tr_close",level:--t.level})}return t.tokens.push({type:"tbody_close",level:--t.level}),t.tokens.push({type:"table_close",level:--t.level}),g[1]=v[1]=c,t.line=c,!0}function Rm(t,e){var n,r,o=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];return o>=i||(r=t.src.charCodeAt(o++),r!==126&&r!==58)||(n=t.skipSpaces(o),o===n)||n>=i?-1:n}function kme(t,e){var n,r,o=t.level+2;for(n=e+2,r=t.tokens.length-2;n<r;n++)t.tokens[n].level===o&&t.tokens[n].type==="paragraph_open"&&(t.tokens[n+2].tight=!0,t.tokens[n].tight=!0,n+=2)}function xme(t,e,n,r){var o,i,s,a,c,u,h,p,f,g,v,y,b,C;if(r)return t.ddIndent<0?!1:Rm(t,e)>=0;if(h=e+1,t.isEmpty(h)&&++h>n||t.tShift[h]<t.blkIndent||(o=Rm(t,h),o<0)||t.level>=t.options.maxNesting)return!1;u=t.tokens.length,t.tokens.push({type:"dl_open",lines:c=[e,0],level:t.level++}),s=e,i=h;e:for(;;){for(C=!0,b=!1,t.tokens.push({type:"dt_open",lines:[s,s],level:t.level++}),t.tokens.push({type:"inline",content:t.getLines(s,s+1,t.blkIndent,!1).trim(),level:t.level+1,lines:[s,s],children:[]}),t.tokens.push({type:"dt_close",level:--t.level});;){if(t.tokens.push({type:"dd_open",lines:a=[h,0],level:t.level++}),y=t.tight,f=t.ddIndent,p=t.blkIndent,v=t.tShift[i],g=t.parentType,t.blkIndent=t.ddIndent=t.tShift[i]+2,t.tShift[i]=o-t.bMarks[i],t.tight=!0,t.parentType="deflist",t.parser.tokenize(t,i,n,!0),(!t.tight||b)&&(C=!1),b=t.line-i>1&&t.isEmpty(t.line-1),t.tShift[i]=v,t.tight=y,t.parentType=g,t.blkIndent=p,t.ddIndent=f,t.tokens.push({type:"dd_close",level:--t.level}),a[1]=h=t.line,h>=n||t.tShift[h]<t.blkIndent)break e;if(o=Rm(t,h),o<0)break;i=h}if(h>=n||(s=h,t.isEmpty(s))||t.tShift[s]<t.blkIndent||(i=s+1,i>=n)||(t.isEmpty(i)&&i++,i>=n)||t.tShift[i]<t.blkIndent||(o=Rm(t,i),o<0))break}return t.tokens.push({type:"dl_close",level:--t.level}),c[1]=h,t.line=h,C&&kme(t,u),!0}function Rme(t,e){var n,r,o,i,s,a=e+1,c;if(n=t.lineMax,a<n&&!t.isEmpty(a)){for(c=t.parser.ruler.getRules("paragraph");a<n&&!t.isEmpty(a);a++)if(!(t.tShift[a]-t.blkIndent>3)){for(o=!1,i=0,s=c.length;i<s;i++)if(c[i](t,a,n,!0)){o=!0;break}if(o)break}}return r=t.getLines(e,a,t.blkIndent,!1).trim(),t.line=a,r.length&&(t.tokens.push({type:"paragraph_open",tight:!1,lines:[e,t.line],level:t.level}),t.tokens.push({type:"inline",content:r,level:t.level+1,lines:[e,t.line],children:[]}),t.tokens.push({type:"paragraph_close",tight:!1,level:t.level})),!0}var Nm=[["code",pme],["fences",mme,["paragraph","blockquote","list"]],["blockquote",gme,["paragraph","blockquote","list"]],["hr",vme,["paragraph","blockquote","list"]],["list",yme,["paragraph","blockquote"]],["footnote",Cme,["paragraph"]],["heading",Sme,["paragraph","blockquote"]],["lheading",Eme],["htmlblock",wme,["paragraph","blockquote"]],["table",Ame,["paragraph"]],["deflist",xme,["paragraph"]],["paragraph",Rme]];function Ow(){this.ruler=new bo;for(var t=0;t<Nm.length;t++)this.ruler.push(Nm[t][0],Nm[t][1],{alt:(Nm[t][2]||[]).slice()})}Ow.prototype.tokenize=function(t,e,n){for(var r=this.ruler.getRules(""),o=r.length,i=e,s=!1,a,c;i<n&&(t.line=i=t.skipEmptyLines(i),!(i>=n||t.tShift[i]<t.blkIndent));){for(c=0;c<o&&(a=r[c](t,i,n,!1),!a);c++);if(t.tight=!s,t.isEmpty(t.line-1)&&(s=!0),i=t.line,i<n&&t.isEmpty(i)){if(s=!0,i++,i<n&&t.parentType==="list"&&t.isEmpty(i))break;t.line=i}}};var Nme=/[\n\t]/g,Pme=/\r[\n\u0085]|[\u2424\u2028\u0085]/g,Mme=/\u00a0/g;Ow.prototype.parse=function(t,e,n,r){var o,i=0,s=0;if(!t)return[];t=t.replace(Mme," "),t=t.replace(Pme,`
`),t.indexOf("	")>=0&&(t=t.replace(Nme,function(a,c){var u;return t.charCodeAt(c)===10?(i=c+1,s=0,a):(u="    ".slice((c-i-s)%4),s=c-i+1,u)})),o=new Cl(t,this,e,n,r),this.tokenize(o,o.line,o.lineMax)};function Ome(t){switch(t){case 10:case 92:case 96:case 42:case 95:case 94:case 91:case 93:case 33:case 38:case 60:case 62:case 123:case 125:case 36:case 37:case 64:case 126:case 43:case 61:case 58:return!0;default:return!1}}function Lme(t,e){for(var n=t.pos;n<t.posMax&&!Ome(t.src.charCodeAt(n));)n++;return n===t.pos?!1:(e||(t.pending+=t.src.slice(t.pos,n)),t.pos=n,!0)}function Dme(t,e){var n,r,o=t.pos;if(t.src.charCodeAt(o)!==10)return!1;if(n=t.pending.length-1,r=t.posMax,!e)if(n>=0&&t.pending.charCodeAt(n)===32)if(n>=1&&t.pending.charCodeAt(n-1)===32){for(var i=n-2;i>=0;i--)if(t.pending.charCodeAt(i)!==32){t.pending=t.pending.substring(0,i+1);break}t.push({type:"hardbreak",level:t.level})}else t.pending=t.pending.slice(0,-1),t.push({type:"softbreak",level:t.level});else t.push({type:"softbreak",level:t.level});for(o++;o<r&&t.src.charCodeAt(o)===32;)o++;return t.pos=o,!0}var Lw=[];for(var LN=0;LN<256;LN++)Lw.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(t){Lw[t.charCodeAt(0)]=1});function jme(t,e){var n,r=t.pos,o=t.posMax;if(t.src.charCodeAt(r)!==92)return!1;if(r++,r<o){if(n=t.src.charCodeAt(r),n<256&&Lw[n]!==0)return e||(t.pending+=t.src[r]),t.pos+=2,!0;if(n===10){for(e||t.push({type:"hardbreak",level:t.level}),r++;r<o&&t.src.charCodeAt(r)===32;)r++;return t.pos=r,!0}}return e||(t.pending+="\\"),t.pos++,!0}function Ume(t,e){var n,r,o,i,s,a=t.pos,c=t.src.charCodeAt(a);if(c!==96)return!1;for(n=a,a++,r=t.posMax;a<r&&t.src.charCodeAt(a)===96;)a++;for(o=t.src.slice(n,a),i=s=a;(i=t.src.indexOf("`",s))!==-1;){for(s=i+1;s<r&&t.src.charCodeAt(s)===96;)s++;if(s-i===o.length)return e||t.push({type:"code",content:t.src.slice(a,i).replace(/[ \n]+/g," ").trim(),block:!1,level:t.level}),t.pos=s,!0}return e||(t.pending+=o),t.pos+=o.length,!0}function Fme(t,e){var n,r,o,i=t.posMax,s=t.pos,a,c;if(t.src.charCodeAt(s)!==126||e||s+4>=i||t.src.charCodeAt(s+1)!==126||t.level>=t.options.maxNesting||(a=s>0?t.src.charCodeAt(s-1):-1,c=t.src.charCodeAt(s+2),a===126)||c===126||c===32||c===10)return!1;for(r=s+2;r<i&&t.src.charCodeAt(r)===126;)r++;if(r>s+3)return t.pos+=r-s,e||(t.pending+=t.src.slice(s,r)),!0;for(t.pos=s+2,o=1;t.pos+1<i;){if(t.src.charCodeAt(t.pos)===126&&t.src.charCodeAt(t.pos+1)===126&&(a=t.src.charCodeAt(t.pos-1),c=t.pos+2<i?t.src.charCodeAt(t.pos+2):-1,c!==126&&a!==126&&(a!==32&&a!==10?o--:c!==32&&c!==10&&o++,o<=0))){n=!0;break}t.parser.skipToken(t)}return n?(t.posMax=t.pos,t.pos=s+2,e||(t.push({type:"del_open",level:t.level++}),t.parser.tokenize(t),t.push({type:"del_close",level:--t.level})),t.pos=t.posMax+2,t.posMax=i,!0):(t.pos=s,!1)}function Bme(t,e){var n,r,o,i=t.posMax,s=t.pos,a,c;if(t.src.charCodeAt(s)!==43||e||s+4>=i||t.src.charCodeAt(s+1)!==43||t.level>=t.options.maxNesting||(a=s>0?t.src.charCodeAt(s-1):-1,c=t.src.charCodeAt(s+2),a===43)||c===43||c===32||c===10)return!1;for(r=s+2;r<i&&t.src.charCodeAt(r)===43;)r++;if(r!==s+2)return t.pos+=r-s,e||(t.pending+=t.src.slice(s,r)),!0;for(t.pos=s+2,o=1;t.pos+1<i;){if(t.src.charCodeAt(t.pos)===43&&t.src.charCodeAt(t.pos+1)===43&&(a=t.src.charCodeAt(t.pos-1),c=t.pos+2<i?t.src.charCodeAt(t.pos+2):-1,c!==43&&a!==43&&(a!==32&&a!==10?o--:c!==32&&c!==10&&o++,o<=0))){n=!0;break}t.parser.skipToken(t)}return n?(t.posMax=t.pos,t.pos=s+2,e||(t.push({type:"ins_open",level:t.level++}),t.parser.tokenize(t),t.push({type:"ins_close",level:--t.level})),t.pos=t.posMax+2,t.posMax=i,!0):(t.pos=s,!1)}function Hme(t,e){var n,r,o,i=t.posMax,s=t.pos,a,c;if(t.src.charCodeAt(s)!==61||e||s+4>=i||t.src.charCodeAt(s+1)!==61||t.level>=t.options.maxNesting||(a=s>0?t.src.charCodeAt(s-1):-1,c=t.src.charCodeAt(s+2),a===61)||c===61||c===32||c===10)return!1;for(r=s+2;r<i&&t.src.charCodeAt(r)===61;)r++;if(r!==s+2)return t.pos+=r-s,e||(t.pending+=t.src.slice(s,r)),!0;for(t.pos=s+2,o=1;t.pos+1<i;){if(t.src.charCodeAt(t.pos)===61&&t.src.charCodeAt(t.pos+1)===61&&(a=t.src.charCodeAt(t.pos-1),c=t.pos+2<i?t.src.charCodeAt(t.pos+2):-1,c!==61&&a!==61&&(a!==32&&a!==10?o--:c!==32&&c!==10&&o++,o<=0))){n=!0;break}t.parser.skipToken(t)}return n?(t.posMax=t.pos,t.pos=s+2,e||(t.push({type:"mark_open",level:t.level++}),t.parser.tokenize(t),t.push({type:"mark_close",level:--t.level})),t.pos=t.posMax+2,t.posMax=i,!0):(t.pos=s,!1)}function DN(t){return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122}function jN(t,e){var n=e,r,o,i,s=!0,a=!0,c=t.posMax,u=t.src.charCodeAt(e);for(r=e>0?t.src.charCodeAt(e-1):-1;n<c&&t.src.charCodeAt(n)===u;)n++;return n>=c&&(s=!1),i=n-e,i>=4?s=a=!1:(o=n<c?t.src.charCodeAt(n):-1,(o===32||o===10)&&(s=!1),(r===32||r===10)&&(a=!1),u===95&&(DN(r)&&(s=!1),DN(o)&&(a=!1))),{can_open:s,can_close:a,delims:i}}function zme(t,e){var n,r,o,i,s,a,c,u=t.posMax,h=t.pos,p=t.src.charCodeAt(h);if(p!==95&&p!==42||e)return!1;if(c=jN(t,h),n=c.delims,!c.can_open)return t.pos+=n,e||(t.pending+=t.src.slice(h,t.pos)),!0;if(t.level>=t.options.maxNesting)return!1;for(t.pos=h+n,a=[n];t.pos<u;){if(t.src.charCodeAt(t.pos)===p){if(c=jN(t,t.pos),r=c.delims,c.can_close){for(i=a.pop(),s=r;i!==s;){if(s<i){a.push(i-s);break}if(s-=i,a.length===0)break;t.pos+=i,i=a.pop()}if(a.length===0){n=i,o=!0;break}t.pos+=r;continue}c.can_open&&a.push(r),t.pos+=r;continue}t.parser.skipToken(t)}return o?(t.posMax=t.pos,t.pos=h+n,e||((n===2||n===3)&&t.push({type:"strong_open",level:t.level++}),(n===1||n===3)&&t.push({type:"em_open",level:t.level++}),t.parser.tokenize(t),(n===1||n===3)&&t.push({type:"em_close",level:--t.level}),(n===2||n===3)&&t.push({type:"strong_close",level:--t.level})),t.pos=t.posMax+n,t.posMax=u,!0):(t.pos=h,!1)}var Vme=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function $me(t,e){var n,r,o=t.posMax,i=t.pos;if(t.src.charCodeAt(i)!==126||e||i+2>=o||t.level>=t.options.maxNesting)return!1;for(t.pos=i+1;t.pos<o;){if(t.src.charCodeAt(t.pos)===126){n=!0;break}t.parser.skipToken(t)}return!n||i+1===t.pos||(r=t.src.slice(i+1,t.pos),r.match(/(^|[^\\])(\\\\)*\s/))?(t.pos=i,!1):(t.posMax=t.pos,t.pos=i+1,e||t.push({type:"sub",level:t.level,content:r.replace(Vme,"$1")}),t.pos=t.posMax+1,t.posMax=o,!0)}var Gme=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function Kme(t,e){var n,r,o=t.posMax,i=t.pos;if(t.src.charCodeAt(i)!==94||e||i+2>=o||t.level>=t.options.maxNesting)return!1;for(t.pos=i+1;t.pos<o;){if(t.src.charCodeAt(t.pos)===94){n=!0;break}t.parser.skipToken(t)}return!n||i+1===t.pos||(r=t.src.slice(i+1,t.pos),r.match(/(^|[^\\])(\\\\)*\s/))?(t.pos=i,!1):(t.posMax=t.pos,t.pos=i+1,e||t.push({type:"sup",level:t.level,content:r.replace(Gme,"$1")}),t.pos=t.posMax+1,t.posMax=o,!0)}function qme(t,e){var n,r,o,i,s,a,c,u,h=!1,p=t.pos,f=t.posMax,g=t.pos,v=t.src.charCodeAt(g);if(v===33&&(h=!0,v=t.src.charCodeAt(++g)),v!==91||t.level>=t.options.maxNesting||(n=g+1,r=Yf(t,g),r<0))return!1;if(a=r+1,a<f&&t.src.charCodeAt(a)===40){for(a++;a<f&&(u=t.src.charCodeAt(a),!(u!==32&&u!==10));a++);if(a>=f)return!1;for(g=a,L9(t,a)?(i=t.linkContent,a=t.pos):i="",g=a;a<f&&(u=t.src.charCodeAt(a),!(u!==32&&u!==10));a++);if(a<f&&g!==a&&D9(t,a))for(s=t.linkContent,a=t.pos;a<f&&(u=t.src.charCodeAt(a),!(u!==32&&u!==10));a++);else s="";if(a>=f||t.src.charCodeAt(a)!==41)return t.pos=p,!1;a++}else{if(t.linkLevel>0)return!1;for(;a<f&&(u=t.src.charCodeAt(a),!(u!==32&&u!==10));a++);if(a<f&&t.src.charCodeAt(a)===91&&(g=a+1,a=Yf(t,a),a>=0?o=t.src.slice(g,a++):a=g-1),o||(typeof o>"u"&&(a=r+1),o=t.src.slice(n,r)),c=t.env.references[j9(o)],!c)return t.pos=p,!1;i=c.href,s=c.title}return e||(t.pos=n,t.posMax=r,h?t.push({type:"image",src:i,title:s,alt:t.src.substr(n,r-n),level:t.level}):(t.push({type:"link_open",href:i,title:s,level:t.level++}),t.linkLevel++,t.parser.tokenize(t),t.linkLevel--,t.push({type:"link_close",level:--t.level}))),t.pos=a,t.posMax=f,!0}function Wme(t,e){var n,r,o,i,s=t.posMax,a=t.pos;return a+2>=s||t.src.charCodeAt(a)!==94||t.src.charCodeAt(a+1)!==91||t.level>=t.options.maxNesting||(n=a+2,r=Yf(t,a+1),r<0)?!1:(e||(t.env.footnotes||(t.env.footnotes={}),t.env.footnotes.list||(t.env.footnotes.list=[]),o=t.env.footnotes.list.length,t.pos=n,t.posMax=r,t.push({type:"footnote_ref",id:o,level:t.level}),t.linkLevel++,i=t.tokens.length,t.parser.tokenize(t),t.env.footnotes.list[o]={tokens:t.tokens.splice(i)},t.linkLevel--),t.pos=r+1,t.posMax=s,!0)}function Yme(t,e){var n,r,o,i,s=t.posMax,a=t.pos;if(a+3>s||!t.env.footnotes||!t.env.footnotes.refs||t.src.charCodeAt(a)!==91||t.src.charCodeAt(a+1)!==94||t.level>=t.options.maxNesting)return!1;for(r=a+2;r<s;r++){if(t.src.charCodeAt(r)===32||t.src.charCodeAt(r)===10)return!1;if(t.src.charCodeAt(r)===93)break}return r===a+2||r>=s||(r++,n=t.src.slice(a+2,r-1),typeof t.env.footnotes.refs[":"+n]>"u")?!1:(e||(t.env.footnotes.list||(t.env.footnotes.list=[]),t.env.footnotes.refs[":"+n]<0?(o=t.env.footnotes.list.length,t.env.footnotes.list[o]={label:n,count:0},t.env.footnotes.refs[":"+n]=o):o=t.env.footnotes.refs[":"+n],i=t.env.footnotes.list[o].count,t.env.footnotes.list[o].count++,t.push({type:"footnote_ref",id:o,subId:i,level:t.level})),t.pos=r,t.posMax=s,!0)}var Qme=["coap","doi","javascript","aaa","aaas","about","acap","cap","cid","crid","data","dav","dict","dns","file","ftp","geo","go","gopher","h323","http","https","iax","icap","im","imap","info","ipp","iris","iris.beep","iris.xpc","iris.xpcs","iris.lwz","ldap","mailto","mid","msrp","msrps","mtqp","mupdate","news","nfs","ni","nih","nntp","opaquelocktoken","pop","pres","rtsp","service","session","shttp","sieve","sip","sips","sms","snmp","soap.beep","soap.beeps","tag","tel","telnet","tftp","thismessage","tn3270","tip","tv","urn","vemmi","ws","wss","xcon","xcon-userid","xmlrpc.beep","xmlrpc.beeps","xmpp","z39.50r","z39.50s","adiumxtra","afp","afs","aim","apt","attachment","aw","beshare","bitcoin","bolo","callto","chrome","chrome-extension","com-eventbrite-attendee","content","cvs","dlna-playsingle","dlna-playcontainer","dtn","dvb","ed2k","facetime","feed","finger","fish","gg","git","gizmoproject","gtalk","hcp","icon","ipn","irc","irc6","ircs","itms","jar","jms","keyparc","lastfm","ldaps","magnet","maps","market","message","mms","ms-help","msnim","mumble","mvn","notes","oid","palm","paparazzi","platform","proxy","psyc","query","res","resource","rmi","rsync","rtmp","secondlife","sftp","sgn","skype","smb","soldat","spotify","ssh","steam","svn","teamspeak","things","udp","unreal","ut2004","ventrilo","view-source","webcal","wtai","wyciwyg","xfire","xri","ymsgr"],Jme=/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/,Zme=/^<([a-zA-Z.\-]{1,25}):([^<>\x00-\x20]*)>/;function Xme(t,e){var n,r,o,i,s,a=t.pos;return t.src.charCodeAt(a)!==60||(n=t.src.slice(a),n.indexOf(">")<0)?!1:(r=n.match(Zme),r?Qme.indexOf(r[1].toLowerCase())<0||(i=r[0].slice(1,-1),s=LE(i),!t.parser.validateLink(i))?!1:(e||(t.push({type:"link_open",href:s,level:t.level}),t.push({type:"text",content:i,level:t.level+1}),t.push({type:"link_close",level:t.level})),t.pos+=r[0].length,!0):(o=n.match(Jme),o?(i=o[0].slice(1,-1),s=LE("mailto:"+i),t.parser.validateLink(s)?(e||(t.push({type:"link_open",href:s,level:t.level}),t.push({type:"text",content:i,level:t.level+1}),t.push({type:"link_close",level:t.level})),t.pos+=o[0].length,!0):!1):!1))}function wy(t,e){return t=t.source,e=e||"",function n(r,o){return r?(o=o.source||o,t=t.replace(r,o),n):new RegExp(t,e)}}var ege=/[a-zA-Z_:][a-zA-Z0-9:._-]*/,tge=/[^"'=<>`\x00-\x20]+/,nge=/'[^']*'/,rge=/"[^"]*"/,oge=wy(/(?:unquoted|single_quoted|double_quoted)/)("unquoted",tge)("single_quoted",nge)("double_quoted",rge)(),ige=wy(/(?:\s+attr_name(?:\s*=\s*attr_value)?)/)("attr_name",ege)("attr_value",oge)(),sge=wy(/<[A-Za-z][A-Za-z0-9]*attribute*\s*\/?>/)("attribute",ige)(),age=/<\/[A-Za-z][A-Za-z0-9]*\s*>/,cge=/<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->/,lge=/<[?].*?[?]>/,uge=/<![A-Z]+\s+[^>]*>/,dge=/<!\[CDATA\[[\s\S]*?\]\]>/,hge=wy(/^(?:open_tag|close_tag|comment|processing|declaration|cdata)/)("open_tag",sge)("close_tag",age)("comment",cge)("processing",lge)("declaration",uge)("cdata",dge)();function fge(t){var e=t|32;return e>=97&&e<=122}function pge(t,e){var n,r,o,i=t.pos;return!t.options.html||(o=t.posMax,t.src.charCodeAt(i)!==60||i+2>=o)||(n=t.src.charCodeAt(i+1),n!==33&&n!==63&&n!==47&&!fge(n))||(r=t.src.slice(i).match(hge),!r)?!1:(e||t.push({type:"htmltag",content:t.src.slice(i,i+r[0].length),level:t.level}),t.pos+=r[0].length,!0)}var mge=/^&#((?:x[a-f0-9]{1,8}|[0-9]{1,8}));/i,gge=/^&([a-z][a-z0-9]{1,31});/i;function vge(t,e){var n,r,o,i=t.pos,s=t.posMax;if(t.src.charCodeAt(i)!==38)return!1;if(i+1<s){if(n=t.src.charCodeAt(i+1),n===35){if(o=t.src.slice(i).match(mge),o)return e||(r=o[1][0].toLowerCase()==="x"?parseInt(o[1].slice(1),16):parseInt(o[1],10),t.pending+=M9(r)?OE(r):OE(65533)),t.pos+=o[0].length,!0}else if(o=t.src.slice(i).match(gge),o){var a=N9(o[1]);if(o[1]!==a)return e||(t.pending+=a),t.pos+=o[0].length,!0}}return e||(t.pending+="&"),t.pos++,!0}var i0=[["text",Lme],["newline",Dme],["escape",jme],["backticks",Ume],["del",Fme],["ins",Bme],["mark",Hme],["emphasis",zme],["sub",$me],["sup",Kme],["links",qme],["footnote_inline",Wme],["footnote_ref",Yme],["autolink",Xme],["htmltag",pge],["entity",vge]];function Ay(){this.ruler=new bo;for(var t=0;t<i0.length;t++)this.ruler.push(i0[t][0],i0[t][1]);this.validateLink=bge}Ay.prototype.skipToken=function(t){var e=this.ruler.getRules(""),n=e.length,r=t.pos,o,i;if((i=t.cacheGet(r))>0){t.pos=i;return}for(o=0;o<n;o++)if(e[o](t,!0)){t.cacheSet(r,t.pos);return}t.pos++,t.cacheSet(r,t.pos)};Ay.prototype.tokenize=function(t){for(var e=this.ruler.getRules(""),n=e.length,r=t.posMax,o,i;t.pos<r;){for(i=0;i<n&&(o=e[i](t,!1),!o);i++);if(o){if(t.pos>=r)break;continue}t.pending+=t.src[t.pos++]}t.pending&&t.pushPending()};Ay.prototype.parse=function(t,e,n,r){var o=new yl(t,this,e,n,r);this.tokenize(o)};function bge(t){var e=["vbscript","javascript","file","data"],n=t.trim().toLowerCase();return n=qc(n),!(n.indexOf(":")!==-1&&e.indexOf(n.split(":")[0])!==-1)}var yge={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","replacements","smartquotes","references","abbr2","footnote_tail"]},block:{rules:["blockquote","code","fences","footnote","heading","hr","htmlblock","lheading","list","paragraph","table"]},inline:{rules:["autolink","backticks","del","emphasis","entity","escape","footnote_ref","htmltag","links","newline","text"]}}},Cge={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{},block:{},inline:{}}},Sge={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","abbr2"]},block:{rules:["blockquote","code","fences","heading","hr","htmlblock","lheading","list","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","htmltag","links","newline","text"]}}},Ege={default:yge,full:Cge,commonmark:Sge};function B9(t,e,n){this.src=e,this.env=n,this.options=t.options,this.tokens=[],this.inlineMode=!1,this.inline=t.inline,this.block=t.block,this.renderer=t.renderer,this.typographer=t.typographer}function Ma(t,e){typeof t!="string"&&(e=t,t="default"),e&&e.linkify!=null&&console.warn(`linkify option is removed. Use linkify plugin instead:

import Remarkable from 'remarkable';
import linkify from 'remarkable/linkify';
new Remarkable().use(linkify)
`),this.inline=new Ay,this.block=new Ow,this.core=new U9,this.renderer=new Mw,this.ruler=new bo,this.options={},this.configure(Ege[t]),this.set(e||{})}Ma.prototype.set=function(t){P9(this.options,t)};Ma.prototype.configure=function(t){var e=this;if(!t)throw new Error("Wrong `remarkable` preset, check name/content");t.options&&e.set(t.options),t.components&&Object.keys(t.components).forEach(function(n){t.components[n].rules&&e[n].ruler.enable(t.components[n].rules,!0)})};Ma.prototype.use=function(t,e){return t(this,e),this};Ma.prototype.parse=function(t,e){var n=new B9(this,t,e);return this.core.process(n),n.tokens};Ma.prototype.render=function(t,e){return e=e||{},this.renderer.render(this.parse(t,e),this.options,e)};Ma.prototype.parseInline=function(t,e){var n=new B9(this,t,e);return n.inlineMode=!0,this.core.process(n),n.tokens};Ma.prototype.renderInline=function(t,e){return e=e||{},this.renderer.render(this.parseInline(t,e),this.options,e)};function Ige(t){const e="\\(",n="\\)";function r(a,c){const u=a.pos,h=a.posMax;let p=u;if(a.src.charAt(p)!==e[0]||a.src.charAt(p+1)!==e[1])return!1;p+=e.length;const f=a.src.slice(u,p);if(f.length>2)return!1;const g=p;let v=0;for(;p<h;){const y=a.src.charAt(p),b=y===n[0]&&a.src.charAt(p+1)===n[1];if(y==="{"&&(p===0||a.src.charAt(p-1)!=="\\"))v+=1;else if(y==="}"&&(p===0||a.src.charAt(p-1)!=="\\")){if(v-=1,v<0)return!1}else if(b&&v===0){const C=p,S=p+n.length;if(S-C===f.length){if(!c){const E=a.src.slice(g,C).replace(/[ \n]+/g," ").trim();a.push({type:"latex",content:E,block:!1,level:a.level})}return a.pos=S,!0}}p+=1}return c||(a.pending+=f),a.pos+=f.length,!0}const o={start:"$$",end:"$$"},i={start:"\\[",end:"\\]"};function s(a,c,u,h){const p=a.tShift[c],f=a.bMarks[c]+p;let g=a.src.slice(f,a.eMarks[c]),v=null;if(g.startsWith(o.start)?v=o:g.startsWith(i.start)&&(v=i),!v)return!1;let y=c,b=!1;for(;y<=u;){const S=a.tShift[y],E=a.bMarks[y]+S;if(g=a.src.slice(E,a.eMarks[y]),g.endsWith(v.end)&&(y>c||g!==v.end)){b=!0;break}y+=1}if(!b)return!1;if(h)return!0;const C=a.src.slice(f+v.start.length,a.eMarks[y]-v.end.length);return a.tokens.push({type:"latex_block",content:C.trim(),lines:[c,y],level:a.level}),a.line=y+1,!0}t.inline.ruler.push("latex",r,{}),t.block.ruler.after("fences","latex_block",s,{})}function Tge(t){return t.replaceAll(/(\n\n\$\$.*?\$\$) *(\n\n)/g,"$1$2")}function _ge(t){return[wge,zi("kill-post-process-latex-double-dollar")?null:Tge].filter(n=>n!==null).reduce((n,r)=>r(n),t)}const s0="\\[",UN="\\]";function wge(t){return t.includes(s0)?t.replaceAll(s0,`

${s0}`).replaceAll(UN,`${UN}

`):t}const xp=new Ma;xp.use(Ige);xp.inline.ruler.enable(["text","emphasis","links","backticks","sup","sub","latex","del"],!0);xp.block.ruler.enable(["list","paragraph","heading","hr","fences","table","blockquote","latex_block"],!0);xp.core.ruler.enable(["block","inline","references"],!0);function Age(t){const[e="",...n]=t.replace(Ap,"").split(zv);return{index:e,title:n.join(zv)}}function H9(t,e={}){const n=[];let r=null,o=!1,i=!1,s=!1;for(const a of t)switch(a.type){case"text":case"sup":case"sub":if("content"in a&&a.content){const c={},u=a.content.startsWith(Ap)?{type:"citation",props:{index:"",title:"",url:"",iconUrl:null,publisher:null}}:{type:"text",props:{text:a.content}};if(u.type==="text"&&(r&&(u.props.link=r),o&&(c.bold=!0),i&&(c.italic=!0),s&&(c.strikethrough=!0),a.type==="text"&&(u.props.text=u.props.text.replaceAll("\\$","$")),a.type==="sup"&&(c.sup=!0),a.type==="sub"&&(c.sub=!0),Object.keys(c).length>0&&(u.props.annotations=c)),u.type==="citation"&&r){const{citations:h}=e,{index:p,title:f}=Age(a.content),g=h==null?void 0:h.find(v=>v.index===p);u.props={index:p,title:(g==null?void 0:g.title)??f,url:r.url,iconUrl:null,publisher:null}}n.push(u)}break;case"code":"content"in a&&n.push({type:"text",props:{text:a.content,annotations:{code:!0}}});break;case"latex":"content"in a&&n.push({type:"latex",props:{content:a.content}});break;case"strong_open":o=!0;break;case"strong_close":o=!1;break;case"em_open":i=!0;break;case"em_close":i=!1;break;case"del_open":s=!0;break;case"del_close":s=!1;break;case"link_open":r="href"in a?{url:sa(a.href)}:null;break;case"link_close":r=null;break}return n}function Pm(t,e){return t!==void 0&&t.type==="inline"&&"children"in t?H9(Array.isArray(t.children)?t.children:[],e):null}function kge(t,e){let n=0;function r(){var s;let i=t[n];if(!i)return null;if(i.type==="hr")return n+=1,i=t[n],{type:"hr"};if(i.type==="latex_block")return n+=1,"content"in i?{type:"latex",props:{content:{type:"text",props:{text:i.content}}}}:null;if(i.type==="paragraph_open"){n+=1,i=t[n],n+=1;const a=Pm(i,e);return a?{type:"paragraph",props:{items:a}}:null}if(i.type==="blockquote_open"){const a={type:"blockquote",props:{items:[]}};for(n+=1,i=t[n];(i==null?void 0:i.type)!=="blockquote_close";){const c=r();c&&"type"in c&&a.props.items.push(c),i=t[n]}return n+=1,a}if(i.type==="ordered_list_open"||i.type==="bullet_list_open"){const a={type:"list",props:{items:[],ordered:i.type==="ordered_list_open"}};"order"in i&&(a.props.start=i.order);const c=i.type==="ordered_list_open"?"ordered_list_close":"bullet_list_close";for(n+=1,i=t[n];(i==null?void 0:i.type)!==c;){const u=r(),h=[];if(u&&Array.isArray(u)){for(const p of u)(p.type==="paragraph"||p.type==="list"||p.type==="code"||p.type==="heading")&&h.push(p);a.props.items.push(h)}i=t[n]}return n+=1,a}if(i.type==="list_item_open"){const a=[];for(n+=1,i=t[n];(i==null?void 0:i.type)!=="list_item_close";){const c=r();if(c)for(const u of[c].flat())(u.type==="paragraph"||u.type==="list"||u.type==="code"||u.type==="heading")&&a.push(u);i=t[n]}return n+=1,a}if(i.type==="heading_open"){const a="hLevel"in i?i.hLevel:1;n+=1,i=t[n],n+=1;const c=Pm(i,e);return c?{type:"heading",props:{level:a,items:c}}:null}if(i.type==="fence"&&"content"in i){const a={type:"code",props:{content:{type:"text",props:{text:_he(i.content)}},language:"params"in i?i.params:void 0}};return n+=1,a}if(i.type==="table_open"){const a=[],c=[];for(;(i==null?void 0:i.type)!=="table_close";){if((i==null?void 0:i.type)==="th_open"){n+=1,i=t[n];const u=Pm(i,e);u&&a.push(u)}if((i==null?void 0:i.type)==="tr_open"&&!i.lines&&c.push([]),(i==null?void 0:i.type)==="td_open"){n+=1,i=t[n];const u=Pm(i,e);u&&((s=c[c.length-1])==null||s.push(u))}n+=1,i=t[n]}return{type:"table",props:{columns:a,data:c}}}return i.type==="inline"&&"children"in i?(n+=1,H9(i.children??[])):(n+=1,null)}const o=[];for(;n<t.length;){const i=r();i&&!Array.isArray(i)&&o.push(i)}return o}function Dw(t,e={}){const n=xp.parse(_ge(t),{});return kge(n,e)}const xge={getValue:()=>0,queueUpdate:()=>{}};function Rge(){}function Nge(t){const{text:e}=t,n=Dw(e),r=qf(n,xge,Rge);return d.jsx(Kf,{blocks:r,shouldAnimate:!1})}function Pge(t){const{artifact:e}=t;switch(e.type){case"code":{const{language:n,content:r}=e,o=`\`\`\`${n}
${r}
\`\`\``;return d.jsx(Nge,{text:o})}case"file":{const{contentType:n,name:r,url:o}=e;return d.jsx(npe,{name:r,contentType:n,url:o})}default:return null}}function Mge(t){const{activities:e}=t;return d.jsx("div",{className:"flex flex-col gap-4 overflow-y-auto",children:e.map((n,r)=>d.jsxs("div",{className:"flex flex-col gap-4 pt-3",children:[d.jsx("h3",{children:n.title}),n.artifacts.map((o,i)=>d.jsx(Pge,{artifact:o},i))]},r))})}const Oge=D(void 0);function Lge(){const[t,e]=it(Oge),n=!!t,r=()=>{e(void 0)};return!t||t.length===0?null:d.jsx(fi,{className:"w-full max-w-[606px] p-4 pb-6",isOpen:n,variant:"drawer",onClose:r,children:d.jsx(Mge,{activities:t})})}function zd(t){const e=m.useRef(null),{isOpen:n,headerText:r,fullBleed:o,children:i,onClose:s,className:a,closeButtonTestId:c,backdropOpacity:u="default"}=t,h=m.useRef(null),{t:p}=Oe(),f=m.useId(),g=u==="none"?"backdrop:bg-transparent":"backdrop:bg-stone-850/30 dark:backdrop:bg-midnight-850/70";Kc({onOutsideEvent:n&&s!==void 0?s:()=>{},elements:[h],includeScroll:!1,includeFocus:!1});const{modalAttributes:v}=_M({trapFocus:!0,legacyTrapFocus:!0,alwaysFocusable:!0});return m.useEffect(()=>{var y,b;n?(y=e.current)==null||y.showModal():(b=e.current)==null||b.close()},[n]),m.useEffect(()=>{const y=e.current;if(!y)return()=>{};const b=()=>{s==null||s()};return y.addEventListener("cancel",b),()=>{y.removeEventListener("cancel",b)}},[s]),d.jsx(Re.dialog,{className:q("fixed inset-0 m-auto rounded-4xl border border-white/10 bg-background-150 text-foreground-800 shadow-xl dark:bg-background-250",g),animate:n?"animate":"initial",initial:"initial",exit:"exit",variants:{initial:dt,animate:Ot},transition:{duration:Oo.default,ease:"easeInOut"},ref:e,role:"dialog","aria-modal":"true","aria-labelledby":r?f:void 0,...n?v:{},children:n&&d.jsxs("div",{"data-modal-overlay":"true",className:q("flex min-h-[150px] flex-col gap-3",!o&&"p-6",a),ref:h,children:[!o&&d.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r&&d.jsx("h2",{id:f,className:"text-foreground-800 text-md-strong",children:r}),s&&d.jsx(Me,{variant:"square",color:"subtle-dimmed-inverted",size:"32-xs",title:p("common.closeText"),"aria-label":p("common.closeText"),onClick:s,testId:c,children:d.jsx(fo,{className:"size-5"})})]}),i]})})}const Dge="XF86Back",HRe="XF86BTVoice",jge=461;function Uge(t){return t.key===Dge||t.keyCode===jge}function Fge(t){const{className:e,children:n}=t;return d.jsx("span",{className:q("inline-block h-4 min-w-4 rounded-md bg-accent-200 px-1 pt-px text-center leading-4 text-foreground-800 text-3xs dark:bg-accent-200",e),children:n})}const Bge={default:"border-black/10 dark:border-white/10",accent:"border-stroke-300"};function jw(t){const{horizontalMargin:e=!0,verticalMargin:n=!0,color:r="default",className:o}=t;return d.jsx("div",{className:q("border-t-[1px]",e&&"mx-2",n&&"my-2",Bge[r],o)})}const Hge=m.lazy(()=>H(()=>import("./index-6yUf1rwO.js").then(t=>t.i),__vite__mapDeps([224,2,225,1]))),zge="focus-within:bg-neutral-50/5 before:pointer-events-none before:absolute before:inset-0 before:rounded-3xl before:border before:border-transparent focus-within:before:border-[1px] focus-within:before:border-[rgba(255,255,255,0.1)]";function Vge(){var h,p;const t=L(W$),[e,n]=it(KO),r=m.useContext(_y),o=L(pt),i=mI(),s=((h=be.instance().config().composer)==null?void 0:h.largeScreen)===!0&&((p=be.instance().config().composer)==null?void 0:p.voiceOnly)===!0,a=()=>{n(null),ht({source:"citationOverflowModal",scenario:"close"})},{focusable:c}=gd({isFocusBoundary:!0});vl(f=>{Uge(f)&&(f.stopPropagation(),a())});const u=m.useMemo(()=>new Map((e??[]).map((f,g)=>[g,m.createRef()])),[e]);return d.jsx(zd,{isOpen:t,onClose:s?void 0:a,headerText:`${e==null?void 0:e.length} ${X("chat.references")}`,className:q(s?"max-h-[40vh]":"max-h-[80vh]",s?"w-[480px]":"w-[440px]","mx-4 px-2"),children:d.jsx(gI.Provider,{value:c.focusKey??"",children:d.jsx("div",{className:q("flex flex-col gap-2 overflow-y-auto",s?"no-scrollbar":"t-custom-scrollbar"),children:e==null?void 0:e.map((f,g)=>d.jsx(z9,{ref:u.get(g),index:g,citation:f,currentConversationId:o,messageId:r,isLargeScreenVoiceComposer:s,citationsModalData:e,rel:i},g))})})})}const z9=m.forwardRef(({index:t,citation:e,currentConversationId:n,messageId:r,citationsModalData:o,isLargeScreenVoiceComposer:i=!1,rel:s},a)=>{const{title:c,url:u,publisher:h}=e,{refCallback:p,focusable:f}=gd({autoRestoreFocus:!0,forceFocus:!0,scrollIntoViewOnFocus:!0},a);return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:q(i&&zge,"group relative flex flex-row items-center gap-2 rounded-3xl p-2"),children:[d.jsxs("a",{rel:s,ref:p,className:"flex flex-1 flex-col items-start gap-2 py-1","data-spatial-navigation-autofocus":!0,href:u,"data-spatial-focus-key":f.focusKey,target:"_blank",onClick:g=>{if(i){g.preventDefault();return}ht({source:"citationModalLink",customData:JSON.stringify({destination:$u(u),conversationId:n,messageId:r})})},children:[d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx(Fge,{children:e.index}),d.jsx("div",{className:"text-foreground-550 text-xs",children:h??Vu(u)})]}),d.jsx("div",{children:c}),d.jsx("div",{className:"text-foreground-550 text-xs",children:Vu(u)})]}),i&&d.jsx(m.Suspense,{fallback:d.jsx("span",{}),children:d.jsx("div",{className:"flex size-28 items-center justify-center rounded-2xl bg-white opacity-0 group-focus-within:opacity-100",children:d.jsx(Hge,{value:u,size:86})})})]}),t<o.length-1&&d.jsx(jw,{horizontalMargin:!1,verticalMargin:!1,className:"my-4"})]})});z9.displayName="CitationItem";const $ge=m.lazy(()=>H(()=>Promise.resolve().then(()=>ww),void 0));async function Gge(t){await Wr({path:t,args:{options:{method:"DELETE"}}})}function Kge(){const{t}=Oe(),e=Ee(qO),{trigger:n,isMutating:r}=NI("/conversations/history",Gge),o=async()=>{await n(),e(null)},i=()=>{e(null)};return d.jsxs(zd,{isOpen:!0,onClose:i,headerText:t("settings.clearHistory.header"),className:"min-h-[328px] w-full max-w-[400px]",children:[d.jsx("p",{className:"text-start",children:t("settings.clearHistory.description")}),d.jsx(Me,{title:t("settings.clearHistory.confirm"),color:"default",size:"56-xl",variant:"rect",className:"mt-3 w-full text-system-red-550 dark:text-system-red-350",onClick:o,disabled:r,children:r?d.jsx($ge,{type:"spinnerThemed",className:"size-6"}):t("settings.clearHistory.confirm")}),d.jsx(Me,{title:t("common.cancel"),color:"strong",size:"56-xl",variant:"rect",className:"mt-3 w-full",onClick:i,children:t("common.cancel")})]})}const V9=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M17.7545 14.0002C18.9966 14.0002 20.0034 15.007 20.0034 16.2491V16.8245C20.0034 17.7188 19.6838 18.5836 19.1023 19.263C17.5329 21.0965 15.1457 22.0013 12.0004 22.0013C8.8545 22.0013 6.46849 21.0962 4.90219 19.2619C4.32242 18.583 4.00391 17.7195 4.00391 16.8267V16.2491C4.00391 15.007 5.01076 14.0002 6.25278 14.0002H17.7545ZM17.7545 15.5002H6.25278C5.83919 15.5002 5.50391 15.8355 5.50391 16.2491V16.8267C5.50391 17.3624 5.69502 17.8805 6.04287 18.2878C7.29618 19.7555 9.26206 20.5013 12.0004 20.5013C14.7387 20.5013 16.7063 19.7555 17.9627 18.2876C18.3117 17.8799 18.5034 17.361 18.5034 16.8245V16.2491C18.5034 15.8355 18.1681 15.5002 17.7545 15.5002ZM12.0004 2.00488C14.7618 2.00488 17.0004 4.24346 17.0004 7.00488C17.0004 9.76631 14.7618 12.0049 12.0004 12.0049C9.23894 12.0049 7.00036 9.76631 7.00036 7.00488C7.00036 4.24346 9.23894 2.00488 12.0004 2.00488ZM12.0004 3.50488C10.0674 3.50488 8.50036 5.07189 8.50036 7.00488C8.50036 8.93788 10.0674 10.5049 12.0004 10.5049C13.9334 10.5049 15.5004 8.93788 15.5004 7.00488C15.5004 5.07189 13.9334 3.50488 12.0004 3.50488Z"})),zRe=Object.freeze(Object.defineProperty({__proto__:null,default:V9},Symbol.toStringTag,{value:"Module"})),a0="relative size-full rounded-full aspect-square",FN="flex items-center justify-center uppercase",c0="after:absolute after:-inset-px after:rounded-full after:border-[0.5px] after:border-black/10 dark:after:border-white/20";function qge(t){const{firstName:e,imgSrc:n,nameSizeClass:r,altText:o}=t;return n?d.jsx("img",{className:q("overflow-hidden object-cover",a0,c0),src:n,alt:o??X("common.profileImage")}):e?d.jsx("div",{className:q(a0,FN,c0,r??"text-md"),children:d.jsx("div",{children:e[0]})}):d.jsx("div",{className:q(a0,FN,c0),children:d.jsx(V9,{className:"size-6 fill-foreground-800","alt-text":o??X("common.profileImage")})})}const Rp=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 120 120",fill:"none",...t},m.createElement("defs",null,m.createElement("radialGradient",{id:"a",cx:0,cy:0,r:1,gradientTransform:"matrix(-27.40125 -33.47302 31.47539 -25.76598 95.512 51.286)",gradientUnits:"userSpaceOnUse"},m.createElement("stop",{offset:.096,stopColor:"#00AEFF"}),m.createElement("stop",{offset:.773,stopColor:"#2253CE"}),m.createElement("stop",{offset:1,stopColor:"#0736C4"})),m.createElement("radialGradient",{id:"b",cx:0,cy:0,r:1,gradientTransform:"rotate(51.84 -70.254 70.14)scale(39.9779 38.7796)",gradientUnits:"userSpaceOnUse"},m.createElement("stop",{stopColor:"#FFB657"}),m.createElement("stop",{offset:.634,stopColor:"#FF5F3D"}),m.createElement("stop",{offset:.923,stopColor:"#C02B3C"})),m.createElement("radialGradient",{id:"e",cx:0,cy:0,r:1,gradientTransform:"matrix(-31.67773 90.58917 -108.5232 -37.949 103.796 30.703)",gradientUnits:"userSpaceOnUse"},m.createElement("stop",{offset:.066,stopColor:"#8C48FF"}),m.createElement("stop",{offset:.5,stopColor:"#F2598A"}),m.createElement("stop",{offset:.896,stopColor:"#FFB152"})),m.createElement("linearGradient",{id:"c",x1:31.75,x2:37.471,y1:18.75,y2:84.938,gradientUnits:"userSpaceOnUse"},m.createElement("stop",{offset:.156,stopColor:"#0D91E1"}),m.createElement("stop",{offset:.487,stopColor:"#52B471"}),m.createElement("stop",{offset:.652,stopColor:"#98BD42"}),m.createElement("stop",{offset:.937,stopColor:"#FFC800"})),m.createElement("linearGradient",{id:"d",x1:36.75,x2:39.874,y1:10,y2:82.213,gradientUnits:"userSpaceOnUse"},m.createElement("stop",{stopColor:"#3DCBFF"}),m.createElement("stop",{offset:.247,stopColor:"#0588F7",stopOpacity:0})),m.createElement("linearGradient",{id:"f",x1:106.964,x2:106.923,y1:33.365,y2:53.037,gradientUnits:"userSpaceOnUse"},m.createElement("stop",{offset:.058,stopColor:"#F8ADFA"}),m.createElement("stop",{offset:.708,stopColor:"#A86EDD",stopOpacity:0}))),m.createElement("path",{fill:"url(#a)",d:"M85.855 18.313A11.574 11.574 0 0 0 74.75 10h-3.379a11.574 11.574 0 0 0-11.384 9.485L54.2 51.018l1.436-4.913a11.574 11.574 0 0 1 11.11-8.327H86.38l8.235 3.207 7.937-3.207h-2.316a11.574 11.574 0 0 1-11.105-8.313z"}),m.createElement("path",{fill:"url(#b)",d:"M36.326 101.64A11.574 11.574 0 0 0 47.445 110h7.176c6.276 0 11.409-5.002 11.57-11.277l.781-30.405-1.634 5.583a11.574 11.574 0 0 1-11.108 8.321H34.432l-7.058-3.829-7.641 3.83h2.278c5.154 0 9.687 3.408 11.119 8.36z"}),m.createElement("path",{fill:"url(#c)",d:"M74.248 10H34.15c-11.457 0-18.33 15.142-22.913 30.283-5.43 17.939-12.534 41.93 8.02 41.93H36.57c5.174 0 9.716-3.421 11.138-8.396 3.01-10.531 8.286-28.903 12.43-42.889 2.105-7.107 3.86-13.211 6.551-17.012C68.2 11.785 70.715 10 74.248 10"}),m.createElement("path",{fill:"url(#d)",d:"M74.248 10H34.15c-11.457 0-18.33 15.142-22.913 30.283-5.43 17.939-12.534 41.93 8.02 41.93H36.57c5.174 0 9.716-3.421 11.138-8.396 3.01-10.531 8.286-28.903 12.43-42.889 2.105-7.107 3.86-13.211 6.551-17.012C68.2 11.785 70.715 10 74.248 10"}),m.createElement("path",{fill:"url(#e)",d:"M46.744 110h40.099c11.456 0 18.33-15.144 22.913-30.288 5.429-17.942 12.533-41.937-8.02-41.937H84.422a11.576 11.576 0 0 0-11.138 8.396c-3.01 10.533-8.286 28.909-12.43 42.897-2.106 7.109-3.86 13.214-6.552 17.016-1.51 2.131-4.025 3.916-7.558 3.916"}),m.createElement("path",{fill:"url(#f)",d:"M46.744 110h40.099c11.456 0 18.33-15.144 22.913-30.288 5.429-17.942 12.533-41.937-8.02-41.937H84.422a11.576 11.576 0 0 0-11.138 8.396c-3.01 10.533-8.286 28.909-12.43 42.897-2.106 7.109-3.86 13.214-6.552 17.016-1.51 2.131-4.025 3.916-7.558 3.916"})),VRe=Object.freeze(Object.defineProperty({__proto__:null,default:Rp},Symbol.toStringTag,{value:"Module"}));function Wge(){const t=le("aad-student"),e=L(DJ),{t:n}=Oe(),r=t&&e,o=L(YL),i=L(il),s=t&&e===void 0&&o&&i,a=n(r?"entraRedirect.guestTitle":"entraRedirect.workTitle"),c=n(r?"entraRedirect.guestDescription":"entraRedirect.workDescription");return{isStudentEnabled:r,isLoadingEnabled:s,workTitle:a,workDescription:c,titleGapClass:r?"mb-6 sm:mb-10":"mb-8 sm:mb-14",eventInfoScenario:r?"Student":"Enterprise",getPageTitle:()=>n(r?"aadStudent.title":"entraRedirect.pageTitle"),getPageSubTitle:v=>r?n("aadStudent.subtitle",{email:v}):void 0,getWorkButtonText:v=>r?n("aadStudent.continueAsGuestButtonText"):n("entraRedirect.goToWorkButton",{redirectUrl:v})}}function Yge(){var te;const t=L(YL),e=L(il),n=L(gr),[r,o]=m.useState(void 0),i=le("aad-login-removal"),s=Qc(),a=pi(),{isStudentEnabled:c,isLoadingEnabled:u,workTitle:h,workDescription:p,titleGapClass:f,eventInfoScenario:g,getPageTitle:v,getPageSubTitle:y,getWorkButtonText:b}=Wge(),C=!c&&(n==null?void 0:n.email);m.useEffect(()=>{t&&ar(Tg,JSON.stringify(t))},[t]);let S=!1;try{S=JSON.parse(Sn(Tg)??"false")}catch(Q){console.error("Failed to parse authentication status:",Q),S=!1}const E=t?e:!S&&!!((te=window.cwcRedirect)!=null&&te.cwcRedirectUrl),[I,T]=m.useState(E),[_,w]=m.useState(),{t:A}=Oe(),{login:M,logout:R}=Bd();m.useEffect(()=>{async function Q(){const re=await F2();o(re),C&&i&&Fle()}Q()},[C,i]);const $=(Q,re,Z)=>sa(`${Q}?fromCode=cmcv2&redirectId=${re}${Z?`&login_hint=${Z}`:""}`),V=async()=>{let Q=crypto.randomUUID().replace(/-/g,"").toUpperCase(),re=yC,Z="AadUnknown";e&&r?re=$(yC,Q,r.username):window.cwcRedirect&&(re=window.cwcRedirect.cwcRedirectUrl,Q=window.cwcRedirect.redirectId,Z=window.cwcRedirect.chatEligibility),be.instance().config().entraRedirectModalBehaviour==="new-tab"?pl(sa(re)):Tp(sa(re)),z.trackEvent({name:"interaction",data:{eventName:"copilotEnterpriseRedirect",..._,eventInfo_traceId:Q,eventInfo_redirectUrl:re,eventInfo_chatEligibility:Z}})},ie=async()=>{z.trackEvent({name:"interaction",data:{eventName:"copilotStudentRedirectSignOut",..._}}),await R()},N=async()=>{z.trackEvent({name:"interaction",data:{eventName:"copilotEnterpriseRedirectSwitchAccount",eventInfo_scenario:g,..._}}),T(!1),s?(await R(!1),await a({from:"/",to:"/login"})):await M({provider:"microsoft"})},Y=async()=>{z.trackEvent({name:"interaction",data:{eventName:t?"copilotEnterpriseRedirectSignOut":"copilotEnterpriseRedirectContinueSignedOut",..._}}),t?await R():T(!1)};if(m.useEffect(()=>{T(E),E&&(async()=>{var Z;let re={};if(e){const _e=await F2();re={userAadId:(Z=_e==null?void 0:_e.idTokenClaims)==null?void 0:Z.oid,userAadTenantId:_e==null?void 0:_e.tenantId}}else window.cwcRedirect&&(re={userAadId:window.cwcRedirect.userId,userAadTenantId:window.cwcRedirect.tenantId});z.trackEvent({name:"system",data:{eventName:"copilotEnterpriseRedirectImpression",eventInfo_redirectReason:e?"AAD":"CWC",eventInfo_scenario:g,...re}}),w(re)})().catch(console.error)},[e,E,g]),!I)return null;const ue=!S&&window.cwcRedirect?new URL(window.cwcRedirect.cwcRedirectUrl).hostname:yC,j=y(n==null?void 0:n.email),U=()=>c?null:i?d.jsx("div",{className:"mt-8 sm:mt-12",children:d.jsx(oo,{i18nKey:"entraRedirect.playAroundFirst",components:{entraContinue:d.jsx("button",{type:"button",className:"underline",onClick:Y,children:A("entraRedirect.playAroundFirst")})}})}):d.jsx("div",{className:"mt-8 sm:mt-12",children:d.jsx(oo,{i18nKey:t?"entraRedirect.signOut":"entraRedirect.continueSignedOut",components:{[t?"entraSignOut":"entraContinue"]:d.jsx("button",{type:"button",className:"underline",onClick:Y,children:A(t?"entraRedirect.signOut":"entraRedirect.continueSignedOut")})}})});return d.jsxs(Fn,{id:String(I),duration:0,mode:"sync",className:q("fixed inset-0",Xt.modal),children:[d.jsx(fl,{forceGradient:!0}),d.jsx("main",{className:"relative m-auto flex size-full max-w-chat flex-col items-center justify-center overflow-y-auto p-4 pb-8 pt-20 sm:py-4",children:u?d.jsx(Rt,{className:"size-8"}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"mb-9",children:d.jsx(Rp,{className:"size-12"})}),d.jsx("h1",{className:q("mb-8 w-full whitespace-pre-wrap break-words px-4 text-center text-3xl sm:mb-14",f),children:v()}),c&&j&&d.jsx("p",{className:"mb-10 w-full whitespace-pre-wrap break-words px-4 text-center text-base sm:mb-16",children:j}),d.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 md:gap-16",children:[d.jsx(BN,{title:h,description:p,onClick:c?ie:V,children:d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{children:b(ue)}),C&&d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("div",{className:"relative size-5",children:d.jsx(qge,{firstName:n.firstName??n.givenName??void 0,imgSrc:n.imgSrc,nameSizeClass:"text-xs"})}),d.jsx("p",{className:"text-xs",children:n.email})]})]})}),d.jsx(BN,{title:A("entraRedirect.personalTitle"),description:A("entraRedirect.personalDescription"),onClick:N,children:d.jsx("p",{className:"text-xs",children:A("entraRedirect.switchToPersonalButton")})})]}),U()]})})]})}function BN({title:t,onClick:e,description:n,children:r}){return d.jsxs("div",{className:"flex flex-col justify-between rounded-4xl bg-white/70 p-4 dark:bg-midnight-700/70 md:p-6 md:pb-8",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"mb-2.5 text-lg",children:t}),d.jsx("p",{className:"mb-6 text-sm",children:n})]}),d.jsx(Me,{color:"default",variant:"rect",title:t,onClick:e,children:r})]})}function ky(t,e=!0,n=!1){m.useEffect(()=>{var r;e&&((r=t.current)==null||r.focus({preventScroll:n}))},[t,e,n])}const Qge=m.lazy(()=>H(()=>import("./index-6yUf1rwO.js").then(t=>t.i),__vite__mapDeps([224,2,225,1])));function Jge(t){const{onClose:e,interceptedLink:n}=t,{t:r}=Oe(),o=m.useRef(null);return ky(o),vl(i=>{(i.key==="Escape"||i.key==="Control")&&e()}),d.jsxs("div",{className:"flex w-[400px] max-w-[80vw] flex-col items-center p-4 text-center",children:[d.jsx("div",{className:"bg-white p-2",children:d.jsx(m.Suspense,{fallback:d.jsx("span",{}),children:d.jsx(Qge,{value:n,size:96,"aria-label":r("composer.interceptedLink.qrcode_alt_text")})})}),d.jsx("h1",{className:"py-3 text-lg",children:r("composer.interceptedLink.title")}),d.jsx("p",{className:"w-full pb-7",children:d.jsx(oo,{i18nKey:"composer.interceptedLink.description",components:{span:d.jsx("span",{className:"break-words underline"})},values:{link:n}})}),d.jsx(Me,{ref:o,onClick:e,title:"close",variant:"pill",size:"48-lg",className:"w-full",children:r("common.closeText")})]})}function Zge(t){const{t:e}=Oe(),{mobileSource:n,onClose:r}=t,o=n==="apple"?rG:oG,i=e("subscriptionManage.redirectMobileStoreTitle",{store:o}),s=e("subscriptionManage.redirectMobileStoreContent",{store:o});return d.jsx("div",{className:nt("fixed inset-0 h-screen w-screen",Xt.modal),"data-outside-events-ignore":!0,onClick:r,children:d.jsx(fi,{isOpen:!0,className:"h-auto max-w-md !gap-0 rounded-[60px] !p-0",disableCloseOutside:!0,children:d.jsxs("div",{className:"flex w-full flex-col p-8",children:[d.jsx("h1",{className:"mt-4 w-full items-center text-center text-xl",children:i}),d.jsx("p",{className:"mt-6 w-full",children:s}),d.jsx(Me,{className:"mt-6 w-full rounded-4xl",color:"strong",title:e("subscriptionManage.upgradeButton"),onClick:r,children:e("subscriptionManage.redirectMobileStoreDismiss")})]})})})}function Xge(){const{t}=Oe(),e=L(go),n=L(Qj),r=L(Tb),[o,i]=it(Ode),[s,a]=m.useState(!1),c=m.useCallback(()=>{i(!1)},[i]),u=m.useCallback(async()=>{!n||!e||(a(!0),Ng.includes(n.status)||(await es()).stop({conversationId:e.id,taskId:n.id}))},[e,n]);m.useEffect(()=>{n!=null&&n.status&&Ng.includes(n.status)&&(i(!1),a(!1))},[n==null?void 0:n.status,i]);const h=r!==null?t("research.cancel.limitAnnouncement",{limit:r+1}):"";return d.jsxs(fi,{isOpen:o,headerText:t("research.cancel.title"),className:"max-w-96 gap-4",children:[`${t("research.cancel.description")}${` ${h}`}`,d.jsx(Me,{title:t("research.cancel.cancelButton"),onClick:u,className:"mt-auto text-system-red-550 dark:text-system-red-350",color:"default",size:"56-xl",disabled:s,children:s?d.jsx(Rt,{className:"size-8"}):t("research.cancel.cancelButton")}),d.jsx(Me,{title:t("common.keep"),color:"strong",size:"56-xl",onClick:c,children:t("common.keep")})]})}const $9=70;function eve(t){var e;return(e=t.contents)!=null&&e.length?t.finalResponse?"done":t.partialOutput&&t.partialOutput.length>0?"writing":"browsing":"planning"}const Uw=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...t},m.createElement("path",{d:"M4.5 10a5.5 5.5 0 1 1 11 0 5.5 5.5 0 0 1-11 0ZM10 3a7 7 0 1 0 4.391 12.452l5.329 5.328a.75.75 0 1 0 1.06-1.06l-5.328-5.329A7 7 0 0 0 10 3Z"})),$Re=Object.freeze(Object.defineProperty({__proto__:null,default:Uw},Symbol.toStringTag,{value:"Module"}));function tve(t){const{text:e,isInDrawer:n=!1,isPreview:r}=t,{t:o}=Oe(),i=r?x9(e,$9,{ellipsis:!0}):e;return n?d.jsxs("div",{children:[d.jsx("strong",{className:"me-2",children:o("research.searched")}),d.jsx("span",{className:"text-foreground-800",children:i})]}):d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-foreground-700",children:o("research.searched")}),d.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-black/[0.06] px-2 py-1 text-foreground-450",children:[d.jsx(Uw,{className:"size-4"}),d.jsx("span",{className:"text-foreground-800 text-xs",children:e})]})]})}function nve(t){let{url:e}=t;e=$u(e);const{title:n,decoration:r,source:o,iconUrl:i,mode:s,onClick:a}=t,c=m.useContext(_y),u=L(pt),h=()=>{a&&a(t),Tn({source:o,conversationId:u,messageId:c,destination:e})};return d.jsxs(Me,{onClick:h,color:"default",variant:"pill",size:"28-xxs",title:n,href:e,children:[r,i&&d.jsx("img",{src:i,alt:n,className:"size-4 rounded-md border-[0.5px] border-neutral-300 bg-white/90 dark:border-neutral-600"}),d.jsx("span",{className:"me-0.5",children:s==="research"?Vu(e):n})]})}function rve(t){const{url:e,isInDrawer:n=!1,isPreview:r=!1}=t,{t:o}=Oe();return d.jsxs("div",{className:"flex items-center gap-2",children:[n?d.jsx("strong",{children:o("research.read")}):d.jsx("span",{className:"text-foreground-700",children:o("research.read")}),r?d.jsx("span",{className:"text-foreground-800",children:Vu(e)}):d.jsx(nve,{title:Vu(e),url:e,source:"researchCitationLink"})]})}function HN(t){let e=0;for(const n of t)e+=n;return e}function ove(t,e,n){let r=0,o=null,i=[],s=0;return{getValue:()=>{if(!n)return 0;if(!o){o=Math.floor(performance.now());const c=t[t.length-1];if(!c)s=0;else{const u=c+HN(i)*1e3;u>o?(s=(u-o)/1e3,i=[]):(s=0,i=[])}}const a=t[r];return a?(r+=1,i=[],Math.max((a-o)/1e3,0)):(s=Number((s+HN(i)).toFixed(3)),i=[],e(r,o,s),r+=1,s)},queueUpdate:a=>{i.push(a)}}}function G9(t){const e=m.useRef([]);return m.useCallback(()=>ove(e.current,(n,r,o)=>{e.current[n]=r+o*1e3},t),[t])}function ive(t){const{text:e,shouldAnimate:n,isPreview:r}=t,o=G9(!1),[i,s]=m.useState(0),a=m.useMemo(()=>{const c=o(),u=r?x9(e,$9,{ellipsis:!0}):e,h=Dw(u);return qf(h,c,()=>{s(i+1)})},[o,i,r,e]);return d.jsx("div",{className:"text-foreground-700",children:d.jsx(Kf,{blocks:a,shouldAnimate:n})})}function sve(t){const{item:e,shouldAnimate:n=!1,isPreview:r=!1,isInDrawer:o=!1}=t;switch(e.type){case"citation":return d.jsx(rve,{url:e.url,isInDrawer:o,isPreview:r});case"chainOfThought":return d.jsx(ive,{text:e.text,shouldAnimate:n,isPreview:r});case"query":return d.jsx(tve,{text:e.text,isInDrawer:o,isPreview:r});default:return null}}function ave(t){const{progress:e}=t,{t:n}=Oe(),r=(()=>{switch(e){case"planning":return n("research.steps.browse.future");case"writing":return n("research.steps.write.present");case"done":return n("research.stepsDrawer.reportReady");default:return""}})();return d.jsx("div",{children:d.jsx("strong",{children:r})})}function Mm(t){const{progress:e,contentItem:n,shouldAnimate:r,isPreview:o=!1}=t;return e!=="browsing"?d.jsx(ave,{progress:e}):n?d.jsx(sve,{item:n,shouldAnimate:r,isPreview:o,isInDrawer:!0}):null}const K9=t=>m.createElement("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M12.0001 1.07191C13.2068 1.7686 14.2105 2.76833 14.912 3.97215C15.6135 5.17597 15.9885 6.54213 15.9997 7.93538C16.011 9.32864 15.6582 10.7007 14.9762 11.9157C14.2942 13.1307 13.3068 14.1465 12.1115 14.8626C10.9163 15.5787 9.55481 15.9702 8.16178 15.9984C6.76875 16.0266 5.39251 15.6904 4.16929 15.0233C2.94608 14.3562 1.91832 13.3811 1.18775 12.1947C0.457175 11.0083 0.049128 9.65168 0.00400014 8.25911L0 7.99991L0.00400014 7.74071C0.0488032 6.35911 0.450844 5.01268 1.17093 3.83271C1.89101 2.65273 2.90456 1.67948 4.11276 1.00782C5.32097 0.336164 6.6826 -0.0109686 8.0649 0.000264197C9.44721 0.011497 10.803 0.380712 12.0001 1.07191ZM10.9657 5.83431C10.828 5.69657 10.6447 5.61383 10.4503 5.6016C10.2559 5.58938 10.0636 5.64851 9.90972 5.76791L9.83452 5.83431L7.20009 8.46791L6.16568 7.43431L6.09048 7.36791C5.93654 7.2486 5.74437 7.18953 5.54999 7.2018C5.35562 7.21406 5.17239 7.29681 5.03467 7.43452C4.89695 7.57224 4.81421 7.75546 4.80194 7.94984C4.78968 8.14421 4.84874 8.33638 4.96806 8.49031L5.03446 8.56551L6.63448 10.1655L6.70968 10.2319C6.84998 10.3408 7.02251 10.3998 7.20009 10.3998C7.37767 10.3998 7.55019 10.3408 7.69049 10.2319L7.7657 10.1655L10.9657 6.96551L11.0321 6.89031C11.1515 6.73639 11.2107 6.54419 11.1984 6.34977C11.1862 6.15535 11.1035 5.97207 10.9657 5.83431Z",fill:"currentColor"})),GRe=Object.freeze(Object.defineProperty({__proto__:null,default:K9},Symbol.toStringTag,{value:"Module"}));function Om(t){const{isFinal:e=!1,isLast:n=!1,shouldAnimate:r=!1,children:o}=t;let i=null;return e?i=d.jsx(K9,{className:"relative bottom-1 size-4 text-background-900"}):n?i=d.jsx(Rt,{className:"relative bottom-1 size-4"}):i=d.jsx("div",{className:"size-2 rounded-full bg-foreground-800"}),d.jsxs(Re.div,{className:"relative grid grid-cols-[auto,1fr] items-start gap-4",initial:r?"start":"end",animate:"end",variants:{start:dt,end:s=>({...Ot,transition:{delay:s,ease:"easeInOut",duration:1.2}})},children:[d.jsxs("div",{className:"relative mt-2 flex h-full w-2 flex-col items-center",children:[i,!e&&!n&&d.jsx("div",{className:"absolute bottom-0 top-4 w-0.5 bg-neutral-300"})]}),o]})}function cve(t){var a,c;const{task:e,onGoToReport:n}=t,{t:r}=Oe(),o=m.useRef(null);m.useEffect(()=>{o.current&&o.current.scrollTo({top:o.current.scrollHeight,behavior:"smooth"})},[e]);const i=eve(e),s=((a=e.contents)==null?void 0:a.length)??0;return d.jsxs("div",{className:"flex h-full flex-col overflow-y-auto",children:[d.jsxs("div",{ref:o,className:"vertical-scrollbar t-bottom-fade relative h-bottom-fade space-y-4 overflow-y-auto scroll-smooth p-2 pb-12 pt-bottom-fade [scrollbar-gutter:stable_both-edges;]",children:[d.jsx(Om,{isLast:i==="planning",shouldAnimate:i==="planning",children:d.jsx(Mm,{progress:"planning"})}),(c=e.contents)==null?void 0:c.map((u,h)=>{const p=i==="browsing"&&h===s-1;return d.jsx(Om,{isLast:p,shouldAnimate:i!=="done"&&p,children:d.jsx(Mm,{progress:"browsing",contentItem:u})},h)}),(i==="writing"||i==="done")&&d.jsx(Om,{isLast:i==="writing",shouldAnimate:i==="writing",children:d.jsx(Mm,{progress:"writing"})}),i==="done"&&d.jsx(Om,{isFinal:!0,shouldAnimate:!0,children:d.jsx(Mm,{progress:"done"})})]}),i==="done"&&d.jsx(Me,{title:r("research.stepsDrawer.goToReport"),onClick:n,color:"strong",variant:"pill",size:"40-base",className:"mx-4 mt-8",children:r("research.stepsDrawer.goToReport")})]})}function lve(){const{t}=Oe(),e=L(Qj),[n,r]=it(Mde),o=()=>{r(!1)},i=()=>{o()};return d.jsx(fi,{isOpen:n,onClose:o,headerText:t("research.stepsDrawer.title"),className:"max-w-full p-4",headerClassName:"pb-12",headerTextClassName:"relative top-12 start-4",variant:"drawer",children:e&&d.jsx(cve,{task:e,onGoToReport:i})})}function uve(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function dve(){return le("share-to-social-media")&&!uve()}const zN={translateY:"100%"},hve={translateY:0};function fve(t){const{children:e,id:n,onClose:r,className:o}=t,i=m.useRef(null);return vl(s=>{const{current:a}=i;!a||!a.contains(document.activeElement)||s.key==="Escape"&&r()}),d.jsxs(d.Fragment,{children:[d.jsx(Re.div,{initial:dt,animate:Ot,exit:dt,transition:kE,className:"fixed inset-0 bg-black/50"}),d.jsx(Re.div,{id:n,initial:zN,animate:hve,exit:zN,transition:kE,className:q("absolute bottom-0 max-h-expanded-section w-full overflow-y-hidden rounded-4xl",Xt.modal,o),ref:i,children:d.jsx("div",{className:"flex h-full flex-col items-start gap-4 overflow-y-auto bg-background-100 p-6",children:e})})]})}function pve(t){return["/login","/fang","/referrals","/referrals/rules","/memory/narrative"].includes(t)}function yo(){const t=Ft();return(be.instance().config().sidebarNavigation??!1)&&!pve(t)}function mve(t){var a;const{children:e,id:n,onClose:r,className:o}=t,i=yo(),s=(a=be.instance().config().uiOverrides)==null?void 0:a.disableConversationsModalWrapper;return i||s?d.jsx("div",{className:"flex max-w-96 flex-col items-start gap-4 p-2",children:e}):d.jsx(fve,{id:n,onClose:r,className:o,children:e})}function Fw(t){const{createConversation:e}=my(),n=Ee(Yr),r=Ee(Ip),o=Ee(Ep);return m.useCallback(async s=>{try{n(null),r(null),t==null||t(),await e(s)}finally{o("center")}},[e,o,n,r,t])}function gve(){const[t,e]=m.useState(!1),n=rp(En),r=Fw(),o=m.useCallback(async i=>{if(!i)return;const s=Zj(i);Tn({source:"deleteConversation",conversationId:i,scenario:s?"actions":void 0}),e(!0),s?await Gc(`/tasks/${s}`,{options:{method:"DELETE"},analytics:{anonymousPath:"/tasks/*"}}):await Gc(`/conversations/${i}`,{options:{method:"DELETE"},analytics:{anonymousPath:"/conversations/*"}}),Ge(pt)===i&&await r({shouldNavigateToChat:!1}),e(!1),n(a=>{a.delete(i)})},[n,r]);return{loading:t,deleteConversation:o}}const Bw=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{fill:"currentColor",d:"M 20.292969 5.2929688 L 9 16.585938 L 4.7070312 12.292969 L 3.2929688 13.707031 L 9 19.414062 L 21.707031 6.7070312 L 20.292969 5.2929688 z"})),KRe=Object.freeze(Object.defineProperty({__proto__:null,default:Bw},Symbol.toStringTag,{value:"Module"}));function q9(t){const{disabled:e,checked:n,label:r,className:o,labelClassName:i,setChecked:s,"aria-label":a}=t,c=m.useId();return d.jsxs("label",{"aria-label":a,className:q("relative flex cursor-pointer items-center",o),htmlFor:c,children:[d.jsx("input",{checked:n,type:"checkbox",id:c,className:"peer sr-only",onChange:u=>s(u.target.checked),disabled:e}),d.jsx("span",{className:q("flex aspect-square size-5 items-center justify-center rounded-full border transition-colors duration-200 peer-focus:ring-1 peer-focus:ring-black peer-focus:ring-offset-2 peer-disabled:pointer-events-none peer-disabled:opacity-40 dark:peer-focus:ring-white","contrast-more:peer-focus:outline contrast-more:peer-focus:outline-2 contrast-more:peer-focus:outline-offset-2",n&&"bg-black contrast-more:bg-white dark:bg-white"),children:d.jsx(Bw,{className:q("size-3 text-white transition-opacity duration-200 contrast-more:text-current dark:text-black contrast-more:dark:text-current",n?"opacity-100":"opacity-0")})}),d.jsx("span",{className:q("mt-px ps-4 peer-disabled:pointer-events-none peer-disabled:opacity-40",i),children:r})]})}function vve(t){var v;const{conversationId:e,onClose:n}=t,r=m.useId(),{t:o}=Oe(),[i,s]=m.useState(!1),{loading:a,deleteConversation:c}=gve(),u=()=>{i&&ar(m$,"true"),n()},h=async()=>{await c(e),u(),Mt.emit("composer:focus-input")},p=yo(),g=!((v=be.instance().config().uiOverrides)==null?void 0:v.disableDeleteConfirmationCheckbox)&&!p;return d.jsxs(mve,{id:r,onClose:n,className:"h-96",children:[d.jsx("h2",{className:"text-lg",children:o("composer.deleteConversation.header")}),d.jsx("p",{children:o("composer.deleteConversation.description")}),g&&d.jsx(q9,{disabled:a,checked:i,label:o("composer.deleteConversation.dontRemindMeCheck"),setChecked:s,className:"flex-1"}),d.jsx(Me,{title:o("common.delete"),color:"default",size:"56-xl",variant:"rect",className:"mt-auto w-full text-system-red-550 dark:text-system-red-350",disabled:a,onClick:h,children:a?d.jsx(Rt,{className:"size-8"}):o("common.delete")}),d.jsx(Me,{title:o("common.keep"),color:"strong",size:"56-xl",variant:"rect",className:"w-full",disabled:a,onClick:u,children:o("common.keep")})]})}const bve=D(void 0);async function VN(t){try{return await navigator.clipboard.writeText(t),!0}catch(e){return z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"CopyError",eventInfo_details:"Error copying shared conversation url.",eventInfo_errorMessage:e instanceof Error?e.message:""}}),!1}}function yve({url:t,disableAutoCopy:e=!1,buttonColor:n="strong"}){const{t:r}=Oe(),o=r("share.copied"),i=r("share.copy"),[s,a]=m.useState(""),c=m.useRef(null),u=m.useCallback(()=>{c.current=window.setTimeout(()=>{a(i)},CO)},[i]),h=m.useCallback(()=>{c.current&&clearTimeout(c.current)},[]);m.useEffect(()=>e?(a(i),h):(VN(t).then(f=>{a(f?o:i),f&&u()}),h),[u,h,t,o,i,e]);const p=async()=>{await VN(t),a(o),h(),u()};return d.jsx(Me,{title:s,color:n,size:"56-xl",className:"w-full",onClick:p,"aria-live":"polite","aria-label":s,children:s})}function Cve(t){const{t:e}=Oe(),{value:n,onCopy:r,onError:o,children:i,title:s=e("share.copy"),disabled:a,copyOnRender:c=!1,...u}=t,[h,p]=m.useState(!1),f=m.useCallback(async()=>{try{await navigator.clipboard.writeText(n),p(!0),r&&r(),setTimeout(()=>p(!1),CO)}catch(g){o&&o(g),z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"CopyError",eventInfo_details:"Error on copying value to clipboard.",eventInfo_errorMessage:g instanceof Error?g.message:""}})}},[n,r,o]);return m.useEffect(()=>{c&&f()},[c,f]),d.jsx(Me,{onClick:f,title:s,disabled:a,...u,children:i??e(h?"share.copied":"share.copy")})}function Sve(t){const{onClose:e,shareUrl:n,imagePath:r,title:o}=t,[i,s]=m.useState(!0),{t:a}=Oe(),c=()=>{e(!1)};return d.jsxs(zd,{isOpen:!0,onClose:c,headerText:a("podcasts.share"),className:"w-full max-w-[640px]",children:[d.jsxs("div",{className:"mt-3 flex flex-col gap-6",children:[d.jsxs("div",{className:"mx-2 flex flex-col items-center gap-4",children:[d.jsxs("div",{className:"relative",children:[d.jsx(Yj,{alt:a("podcasts.share"),path:r,onLoad:()=>s(!1),className:"rounded-2xl"}),d.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-podcast-share-modal-light dark:bg-gradient-podcast-share-modal-dark"}),!i&&d.jsx("h1",{className:"absolute bottom-8 mx-8 inline text-foreground-800 text-xl",role:"presentation",children:o})]}),i&&d.jsx("div",{className:"flex h-[328px] items-center justify-center",children:d.jsx(Rt,{type:"spinnerThemed",className:"size-6"})})]}),d.jsx("div",{className:"py-4",children:d.jsx(yve,{url:n,disableAutoCopy:!0})})]}),d.jsx("div",{className:"m-auto mb-3 max-w-[484px] text-center text-foreground-600 text-2xs",children:a("podcasts.sharePodcastsDisclaimer")})]})}const Eve=m.lazy(()=>H(()=>import("./sender-share-conversation-modal-Dof54Ynh.js"),__vite__mapDeps([226,1,2,227,228])).then(t=>({default:t.ShareConversationModal})));function Ive(){const[t,e]=it(bve),{t:n}=Oe(),r=dve(),o=m.useMemo(()=>t?document.activeElement:null,[t]),i=()=>{var s;o instanceof HTMLElement&&setTimeout(()=>{o.focus()},0),e(void 0),(t==null?void 0:t.action)==="share"&&((s=t.onClose)==null||s.call(t))};switch(t==null?void 0:t.action){case"delete":return d.jsx(fi,{isOpen:!0,className:"w-3/4 max-w-fit",children:d.jsx(vve,{onClose:i,conversationId:t.conversationId})});case"share":{let s;return r?s=n("common.share"):t.messageId?s=n("share.shareModalHeaderOneTurn"):s=n("share.shareModalHeader"),d.jsx(fi,{trapFocus:!0,isOpen:!!t.conversationId,disableCloseOutside:!0,onClose:i,headerText:s,headerTextClassName:nt("text-lg",r&&"text-xl"),className:nt("relative max-h-full w-3/4 max-w-[640px] gap-3 overflow-y-auto",r&&"gap-4 p-8"),children:d.jsx(m.Suspense,{fallback:d.jsx(Me,{color:"strong",size:"56-xl",className:"w-full",title:n("common.loading"),disabled:!0,children:d.jsx(Rt,{className:"size-8"})}),children:d.jsx(Eve,{conversationId:t.conversationId,scenario:t.scenario,messageId:t.messageId})})})}case"share-podcast":return d.jsx(Sve,{onClose:i,shareUrl:t.shareUrl,imagePath:t.imagePath,title:t.title});default:return null}}const Tve="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/turn-limit-dark-CEuF11Ih.jpg",_ve="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/turn-limit-light-BSlP2HSn.jpg";function W9(t){const{dismiss:e,source:n,beforeContinue:r}=t,{t:o}=Oe(),{login:i}=Bd(),s=o("logIn.proUpsellHeader"),a=o("logIn.proUpsellDescription"),c=o("common.notNow"),u=o("signInPrompt.continueWithMicrosoft"),h=L(Ns),p=Ft();m.useEffect(()=>{sl({page:p,scenario:`UpsellProForAuth0AccountFrom${n}`})},[p,n]);const f=()=>{ht({source:`UpsellProForAuth0AccountFrom${n}`,scenario:"ProUpsellForAuth0AccountLinkWithMSA",destination:"MicrosoftLoginPage"}),r==null||r(),sessionStorage.setItem(D0,`${new Date().getTime().toString()}-link`),i({provider:"microsoft"})},g=()=>{ht({source:`UpsellProForAuth0AccountFrom${n}`,scenario:"dismissProUpsellForAuth0Account",destination:p}),e()};return d.jsxs("div",{className:"flex flex-col items-center p-4 text-center",children:[d.jsx("img",{src:h==="dark"?Tve:_ve,alt:o("images.birds"),className:"h-44 w-full rounded-xl object-cover"}),d.jsx("h1",{className:"pb-3 pt-6 text-lg",children:s}),d.jsx("p",{className:"max-w-[95%] break-words pb-7",children:a}),d.jsxs(Me,{onClick:f,title:u,variant:"pill",size:"48-lg",className:"w-full",color:"strong",testId:"prompt-sign-in-msft-composer-action",children:[d.jsx(nb,{className:"size-6"}),u]}),d.jsx(Me,{onClick:g,title:c,variant:"pill",size:"48-lg",color:"overlay-bright",className:"mt-3 w-full",testId:"not-now-button-composer-action",children:c})]})}const wve=Object.freeze(Object.defineProperty({__proto__:null,default:W9},Symbol.toStringTag,{value:"Module"}));function Ave(){const t=le("ceo-thinkdeeper"),e=le("ceo-smart-mode"),n=le("ceo"),r=le("webretrieval");return t||e||n||r}function Y9(){const[t,e]=it(Jc);return m.useEffect(()=>{e(n=>n||r$())},[e]),t}function kve(){const t=Y9(),e=Ave(),n=L(Zo),r=L(qO),[o,i]=it(vb),[s,a]=it(eG),c=be.instance().config().entraRedirectModalBehaviour!=="skip",u=le("ds-new-progress"),[h,p]=it(XO);return d.jsxs(d.Fragment,{children:[n&&d.jsx(jj,{accountActionRequired:n}),t&&o&&d.jsx(fi,{isOpen:!0,children:d.jsx(Jge,{interceptedLink:o,onClose:()=>{i(void 0)}})}),d.jsx(Ive,{}),r&&d.jsx(Kge,{}),s&&d.jsx(fi,{isOpen:!0,className:"min-h-[328px] max-w-[528px]",children:d.jsx(W9,{dismiss:()=>a(null),source:"ProSubPage"})}),c&&d.jsx(Yge,{}),d.jsx(che,{}),d.jsx(Vge,{}),e&&d.jsx(Lge,{}),u&&d.jsxs(d.Fragment,{children:[d.jsx(lve,{}),d.jsx(Xge,{})]}),h!==null&&d.jsx(Zge,{mobileSource:h,onClose:()=>p(null)})]})}const Q9=t=>m.createElement("svg",{width:96,height:93,viewBox:"0 0 96 93",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("mask",{id:"mask0_140_39981",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:0,y:0,width:96,height:93},m.createElement("mask",{id:"path-1-outside-1_140_39981",maskUnits:"userSpaceOnUse",x:0,y:0,width:96,height:93,fill:"black"},m.createElement("rect",{fill:"white",width:96,height:93}),m.createElement("path",{d:"M4 46.5C4 23.0279 23.0279 4 46.5 4H49.5C72.9721 4 92 23.0279 92 46.5V46.5C92 69.9721 72.9721 89 49.5 89H46.5C23.0279 89 4 69.9721 4 46.5V46.5Z"})),m.createElement("path",{d:"M46.5 4V8H49.5V4V0H46.5V4ZM49.5 89V85H46.5V89V93H49.5V89ZM46.5 89V85C25.237 85 8 67.763 8 46.5H4H0C0 72.1812 20.8188 93 46.5 93V89ZM92 46.5H88C88 67.763 70.763 85 49.5 85V89V93C75.1812 93 96 72.1812 96 46.5H92ZM49.5 4V8C70.763 8 88 25.237 88 46.5H92H96C96 20.8188 75.1812 0 49.5 0V4ZM46.5 4V0C20.8188 0 0 20.8188 0 46.5H4H8C8 25.237 25.237 8 46.5 8V4Z",fill:"url(#paint0_linear_140_39981)",fillOpacity:.8,mask:"url(#path-1-outside-1_140_39981)"}),m.createElement("g",{clipPath:"url(#paint1_angular_140_39981_clip_path)","data-figma-skip-parse":"true",mask:"url(#path-1-outside-1_140_39981)"},m.createElement("g",{transform:"matrix(0 -0.0425 0.0556447 0 48 46.5)"},m.createElement("foreignObject",{x:-1094.12,y:-1094.12,width:2188.24,height:2188.24},m.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",style:{background:"conic-gradient(from 90deg,rgba(214, 147, 237, 1) 0deg,rgba(250, 176, 198, 1) 60.2401deg,rgba(244, 185, 234, 1) 85.1532deg,rgba(141, 152, 255, 1) 126.663deg,rgba(170, 110, 238, 1) 209.329deg,rgba(255, 103, 119, 1) 250.911deg,rgba(255, 186, 113, 1) 291.415deg,rgba(198, 134, 255, 1) 332.659deg,rgba(214, 147, 237, 1) 360deg)",height:"100%",width:"100%",opacity:1}})))),m.createElement("path",{d:"M46.5 4V8H49.5V4V0H46.5V4ZM49.5 89V85H46.5V89V93H49.5V89ZM46.5 89V85C25.237 85 8 67.763 8 46.5H4H0C0 72.1812 20.8188 93 46.5 93V89ZM92 46.5H88C88 67.763 70.763 85 49.5 85V89V93C75.1812 93 96 72.1812 96 46.5H92ZM49.5 4V8C70.763 8 88 25.237 88 46.5H92H96C96 20.8188 75.1812 0 49.5 0V4ZM46.5 4V0C20.8188 0 0 20.8188 0 46.5H4H8C8 25.237 25.237 8 46.5 8V4Z",mask:"url(#path-1-outside-1_140_39981)"})),m.createElement("g",{mask:"url(#mask0_140_39981)"},m.createElement("g",{clipPath:"url(#paint2_angular_140_39981_clip_path)","data-figma-skip-parse":"true"},m.createElement("g",{transform:"matrix(0 -0.071 0.0897903 0 48 47.0001)"},m.createElement("foreignObject",{x:-1014.09,y:-1014.09,width:2028.17,height:2028.17},m.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",style:{background:"conic-gradient(from 90deg,rgba(0, 0, 0, 1) 0deg,rgba(255, 255, 255, 1) 52.2deg,rgba(197, 197, 197, 1) 122.4deg,rgba(0, 0, 0, 1) 147.6deg,rgba(255, 255, 255, 1) 171deg,rgba(174, 174, 174, 1) 235.8deg,rgba(0, 0, 0, 1) 250.911deg,rgba(217, 238, 247, 1) 266.4deg,rgba(255, 255, 255, 1) 332.659deg,rgba(0, 0, 0, 1) 360deg)",height:"100%",width:"100%",opacity:1}})))),m.createElement("rect",{x:-23,y:-24,width:142,height:142})),m.createElement("defs",null,m.createElement("clipPath",{id:"paint1_angular_140_39981_clip_path"},m.createElement("path",{d:"M46.5 4V8H49.5V4V0H46.5V4ZM49.5 89V85H46.5V89V93H49.5V89ZM46.5 89V85C25.237 85 8 67.763 8 46.5H4H0C0 72.1812 20.8188 93 46.5 93V89ZM92 46.5H88C88 67.763 70.763 85 49.5 85V89V93C75.1812 93 96 72.1812 96 46.5H92ZM49.5 4V8C70.763 8 88 25.237 88 46.5H92H96C96 20.8188 75.1812 0 49.5 0V4ZM46.5 4V0C20.8188 0 0 20.8188 0 46.5H4H8C8 25.237 25.237 8 46.5 8V4Z",mask:"url(#path-1-outside-1_140_39981)"})),m.createElement("clipPath",{id:"paint2_angular_140_39981_clip_path"},m.createElement("rect",{x:-23,y:-24,width:142,height:142})),m.createElement("linearGradient",{id:"paint0_linear_140_39981",x1:4,y1:89,x2:101.93,y2:75.3765,gradientUnits:"userSpaceOnUse"},m.createElement("stop",{stopColor:"#FFAB4E"}),m.createElement("stop",{offset:1,stopColor:"#FF7791"})))),qRe=Object.freeze(Object.defineProperty({__proto__:null,default:Q9},Symbol.toStringTag,{value:"Module"})),J9=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M20.2899 16.4358C20.6074 15.5282 20.78 14.5526 20.78 13.5366V9.5241C20.78 9.10859 20.4432 8.77175 20.0277 8.77175C19.6122 8.77175 19.2753 9.10859 19.2753 9.5241V13.5366C19.2753 14.1176 19.2072 14.6827 19.0785 15.2244L20.2899 16.4358Z",fill:"currentColor"}),m.createElement("path",{d:"M15.263 11.1575V6.51431C15.263 4.71377 13.8034 3.25414 12.0028 3.25414C10.7464 3.25414 9.65599 3.96485 9.11167 5.00618L8.01336 3.90787C8.86428 2.60809 10.3333 1.74944 12.0028 1.74944C14.6344 1.74944 16.7677 3.88274 16.7677 6.51431V12.6622L15.263 11.1575Z",fill:"currentColor"}),m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.0026 20.8093C7.986 20.8093 4.7299 17.5532 4.7299 13.5366L4.7299 9.5241C4.7299 9.10859 4.39306 8.77175 3.97755 8.77175C3.56204 8.77175 3.2252 9.10859 3.2252 9.5241L3.2252 13.5366C3.2252 18.3843 7.15498 22.314 12.0026 22.314C14.6664 22.314 17.053 21.1274 18.6628 19.2539L21.0006 21.5917C21.2944 21.8855 21.7707 21.8855 22.0645 21.5917C22.3584 21.2979 22.3584 20.8215 22.0645 20.5277L3.00504 1.46823C2.71123 1.17442 2.23487 1.17442 1.94106 1.46823C1.64725 1.76204 1.64725 2.2384 1.94106 2.53221L7.23793 7.82908V13.5362C7.23793 16.1678 9.37124 18.3011 12.0028 18.3011C13.5589 18.3011 14.9407 17.5552 15.8103 16.4015L17.5951 18.1862C16.261 19.7891 14.251 20.8093 12.0026 20.8093ZM8.74263 13.5362C8.74263 15.3368 10.2023 16.7964 12.0028 16.7964C13.1441 16.7964 14.1484 16.21 14.7308 15.322L8.74263 9.33378L8.74263 13.5362Z",fill:"currentColor"})),WRe=Object.freeze(Object.defineProperty({__proto__:null,default:J9},Symbol.toStringTag,{value:"Module"})),Hw=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7673 6.54284C16.7673 3.91128 14.634 1.77799 12.0024 1.77799C9.37089 1.77799 7.2376 3.91129 7.2376 6.54284L7.2376 13.5647C7.2376 16.1963 9.37089 18.3296 12.0024 18.3296C14.634 18.3296 16.7673 16.1963 16.7673 13.5647L16.7673 6.54284ZM12.0024 3.28268C13.803 3.28268 15.2626 4.7423 15.2626 6.54284L15.2626 13.5647C15.2626 15.3652 13.803 16.8249 12.0024 16.8249C10.2019 16.8249 8.74229 15.3652 8.74229 13.5647L8.74229 6.54284C8.74229 4.7423 10.2019 3.28268 12.0024 3.28268Z",fill:"currentColor"}),m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.0274 8.79987C19.6119 8.79987 19.2751 9.1367 19.2751 9.55221V13.5647C19.2751 17.5813 16.019 20.8374 12.0024 20.8374C7.98587 20.8374 4.72979 17.5813 4.72979 13.5647L4.72979 9.55221C4.72979 9.1367 4.39295 8.79987 3.97744 8.79987C3.56193 8.79987 3.2251 9.1367 3.2251 9.55221L3.2251 13.5647C3.2251 18.4123 7.15485 22.3421 12.0024 22.3421C16.85 22.3421 20.7798 18.4123 20.7798 13.5647V9.55221C20.7798 9.1367 20.443 8.79987 20.0274 8.79987Z",fill:"currentColor"})),YRe=Object.freeze(Object.defineProperty({__proto__:null,default:Hw},Symbol.toStringTag,{value:"Module"})),Z9=t=>m.createElement("svg",{width:63,height:73,viewBox:"0 0 63 73",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("g",{filter:"url(#filter0_d_3118_29179)"},m.createElement("path",{d:"M39.7952 28.3892L42.2422 41.8194C43.061 46.313 43.4704 48.5598 42.1865 49.4826C40.9025 50.4053 38.9035 49.3009 34.9054 47.0922L22.9563 40.491C16.2962 36.8117 12.9661 34.972 13.4372 33.1039C13.9083 31.2359 17.7474 31.1951 25.4255 31.1136C27.1365 31.0955 27.992 31.0864 28.6339 30.625C29.2759 30.1637 29.5572 29.3557 30.12 27.7398C32.6452 20.4884 33.9078 16.8627 35.8285 17.0117C37.7493 17.1608 38.4313 20.9036 39.7952 28.3892Z",fill:"white",fillOpacity:.8,shapeRendering:"crispEdges"}),m.createElement("path",{d:"M39.7952 28.3892L42.2422 41.8194C43.061 46.313 43.4704 48.5598 42.1865 49.4826C40.9025 50.4053 38.9035 49.3009 34.9054 47.0922L22.9563 40.491C16.2962 36.8117 12.9661 34.972 13.4372 33.1039C13.9083 31.2359 17.7474 31.1951 25.4255 31.1136C27.1365 31.0955 27.992 31.0864 28.6339 30.625C29.2759 30.1637 29.5572 29.3557 30.12 27.7398C32.6452 20.4884 33.9078 16.8627 35.8285 17.0117C37.7493 17.1608 38.4313 20.9036 39.7952 28.3892Z",stroke:"white",strokeWidth:1.5,shapeRendering:"crispEdges"})),m.createElement("path",{d:"M43.06 50.7014C44.3479 49.7757 44.5485 48.2871 44.5004 46.9375L44.469 46.4069C44.397 45.4896 44.2259 44.4068 44.0083 43.1722L43.7279 41.6191L43.7271 41.6113L43.7263 41.6119L41.2578 28.06L40.7794 25.455C40.3207 22.9993 39.9105 20.9984 39.4527 19.5092L39.3346 19.1407C39.0928 18.4125 38.8119 17.7441 38.4599 17.1874L38.2786 16.9184C37.7807 16.2335 37.0781 15.6722 36.1346 15.5382L35.9428 15.5173C35.0273 15.4462 34.264 15.7987 33.6613 16.3187L33.4134 16.551C32.8862 17.0835 32.4355 17.7951 32.024 18.597L31.8493 18.9462C31.1633 20.3587 30.4435 22.2885 29.6039 24.6656L28.7214 27.1892L28.7014 27.2468C28.4821 27.8767 28.3253 28.323 28.1864 28.662L28.0522 28.9689C27.8919 29.3038 27.7981 29.3776 27.7565 29.4075C27.7254 29.4298 27.6614 29.4719 27.4758 29.5106L27.2465 29.5479C27.0436 29.5728 26.806 29.587 26.5081 29.5964L25.4073 29.6142L25.3455 29.6153C22.0505 29.6503 19.3668 29.6775 17.3562 29.8624L16.5355 29.9519C15.6246 30.0688 14.7765 30.2424 14.0635 30.5367L13.7674 30.6702C13.0061 31.0434 12.328 31.6403 12.0348 32.5515L11.9812 32.738C11.7577 33.624 11.971 34.4332 12.3786 35.1149L12.5645 35.3986C13.059 36.0947 13.7998 36.7301 14.6458 37.3375L15.3198 37.8019C16.9879 38.9103 19.3175 40.1961 22.1748 41.7746L34.238 48.4394L35.6206 49.2003C36.9417 49.9202 38.0776 50.5066 39.0333 50.8666L39.516 51.0344C40.6626 51.3952 41.933 51.5114 43.06 50.7014Z",stroke:"black",strokeWidth:1.5}),m.createElement("defs",null,m.createElement("filter",{id:"filter0_d_3118_29179",x:2.64307,y:6.25732,width:51.1152,height:66.3022,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},m.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),m.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),m.createElement("feMorphology",{radius:2,operator:"erode",in:"SourceAlpha",result:"effect1_dropShadow_3118_29179"}),m.createElement("feOffset",{dy:16}),m.createElement("feGaussianBlur",{stdDeviation:4}),m.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),m.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12 0"}),m.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_3118_29179"}),m.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_3118_29179",result:"shape"})))),QRe=Object.freeze(Object.defineProperty({__proto__:null,default:Z9},Symbol.toStringTag,{value:"Module"}));function zw({defaultValue:t,controlledValue:e,onChange:n}){const r=e!==void 0,[o,i]=m.useState(t);return m.useEffect(()=>{r&&i(e)},[e,r]),{state:r?e:o,setState:c=>{r||i(c),n==null||n(c)}}}function xve(t){const{renderFocusedElement:e,children:n,className:r,options:o={},isOpen:i}=t,{offset:s=1,placement:a="bottom-end",adjustArrowPosition:c=S=>S}=o,u=m.useRef(null),{state:h,setState:p}=zw({controlledValue:i,defaultValue:!1}),{y:f=0}=c({x:0,y:0})??{},{refs:g,context:v,floatingStyles:y,middlewareData:b}=ep({open:h,placement:a,onOpenChange:p,middleware:[pd(s),md(),xM({element:u,padding:{right:-38,bottom:f}})],whileElementsMounted:fd}),C=c(b.arrow);return d.jsxs(d.Fragment,{children:[e==null?void 0:e({ref:g.setReference},h),h&&d.jsx(Xv,{children:d.jsx(eb,{context:v,modal:!1,children:d.jsxs("div",{ref:g.setFloating,style:y,className:nt("flex outline-none",Xt.coachmark),children:[d.jsx("div",{className:nt("start-0 flex rounded-ee-md rounded-es-3xl rounded-se-3xl rounded-ss-3xl border border-background-200 border-white shadow-sm",r),children:n}),d.jsx("div",{ref:u,style:{position:"absolute",left:C==null?void 0:C.x,top:(C==null?void 0:C.y)??f},className:"pointer-events-none",children:d.jsx(Z9,{className:"my-5 size-14"})})]})})})]})}const Lm="absolute inset-0 rounded-full",$N="relative size-6 transition-colors",GN=2,Rve=50,Nve=20,X9=.6,Pve=3,Mve=.55,Ove=1,Lve={opacity:0,scale:X9},Dve={opacity:1,scale:1,transition:{...Oj,delay:Dj}};function jve(t){const{t:e}=Oe(),{isMuted:n,inputVolume:r,isOutputPlaying:o,className:i,coachUserUnmute:s=!1,onClick:a}=t,c=!o&&!n,[u,h]=m.useState(!1),p=pr({breakpoint:"sm"});m.useEffect(()=>{let C;return s&&(C=setTimeout(()=>h(!0),600)),()=>clearTimeout(C)},[s]);const f=RM(r,Mj),g=zu(f,[GN,Rve],[X9,Pve]),v=zu(f,[GN,Nve],[Mve,Ove]),{focusable:y,refCallback:b}=gd({autoRestoreFocus:!0,forceFocus:!0});return d.jsx(xve,{className:"max-w-72 border-white bg-black/90 p-2 dark:bg-white",isOpen:u,options:{placement:"top-end",offset:p?{mainAxis:27,crossAxis:10}:{mainAxis:15,crossAxis:-55},adjustArrowPosition:C=>p?{x:C!=null&&C.x?C.x-20:void 0,y:12}:C},renderFocusedElement:C=>d.jsxs(d.Fragment,{children:[u?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"absolute start-1/2 -my-4 size-fit -translate-x-1/2",children:d.jsx(Fn,{duration:.6,exitDelay:4.5,exitDuration:.5,children:d.jsx(Re.div,{animate:{rotate:360},transition:{duration:2.5,repeat:1,ease:"linear"},children:d.jsx(Q9,{className:"size-20"})})})}),d.jsx("div",{className:"absolute start-1/2 -my-4 size-fit -translate-x-1/2",children:d.jsx(Re.div,{className:"size-[80px] rounded-full border-4 border-solid border-black/80 shadow-sm dark:border-white",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:4.5,ease:"linear"}})})]}):null,d.jsx(Re.button,{...C,title:e(n?"composer.unmuteMicrophone":"composer.muteMicrophone"),className:q("size-12 rounded-full",mf,tb,i),layout:!s,initial:"initial",animate:"enter",variants:{initial:Lve,enter:Dve},onClick:a,ref:S=>{C.ref(S),b(S)},"data-spatial-focus-key":y.focusKey,children:d.jsxs(Re.span,{className:q("flex items-center justify-center overflow-hidden border",n?"border-transparent bg-black/8 dark:bg-white/5":"border-white bg-white/50 hover:bg-white/80 dark:border-white/12 dark:bg-black/40",c&&"text-spot-blue-450 dark:text-midnight-300",Lm),layout:!s,children:[d.jsx(Pn,{children:c&&d.jsx(Re.div,{className:q("flex items-center justify-center overflow-hidden rounded-full blur-[6px]",Lm),layout:!0,initial:dt,animate:Ot,exit:dt,style:{scale:g},children:d.jsx(Re.div,{className:q(Lm),layout:!0,style:{opacity:v},children:d.jsx(Re.div,{className:q("animate-spin-slow bg-gradient-audio-input-light dark:bg-gradient-audio-input-dark",Lm)})})})}),n?d.jsx(J9,{className:$N,"aria-hidden":!0}):d.jsx(Hw,{className:$N,"aria-hidden":!0})]})})]}),children:d.jsx("div",{className:"flex p-0 px-3 text-white text-sm dark:text-foreground-300",children:e("voice.v2.waitingInteractionUnmuteSubheader")})})}function Qf(t,e={},n){const{initialize:r=!1}=e,o=m.useRef(null);return m.useEffect(()=>{const i=n??o.current,s=new ResizeObserver(([a])=>{a&&t(a.contentRect)});return i&&(s.observe(i),r&&t(i.getBoundingClientRect())),()=>s.disconnect()},[t,r,n]),o}const eU=24e3,Jf=24e3;function Uve(t){const e=atob(t),n=e.length,r=new Uint8Array(n);for(let o=0;o<n;o+=1)r[o]=e.charCodeAt(o);return r.buffer}function Fve(t){let e="";const n=new Uint8Array(t),r=n.byteLength;for(let o=0;o<r;o+=1){const i=n[o];typeof i=="number"&&(e+=String.fromCharCode(i))}return btoa(e)}function tU(t){const e=Uve(t),n=new Int16Array(e),r=new Float32Array(n.length);for(let o=0;o<n.length;o+=1)r[o]=n[o]/32768;return r}function Bve(t){const e=t<0?t*32768:t*32767;return Math.max(-32768,Math.min(32767,e))}const DE=XF(0);function Hve(t){let e=0;for(const n of t){const r=n-128;e+=r*r}return Math.sqrt(e/t.length)}function Vw(t){return t/hb}function JRe(t){return`${Vw(t)}x`}function ZRe(){const t=st().get(aL);return Vw(t)}const KN=48,qN=50;function WN(t){const{isNested:e}=t,[n,r]=m.useState(1),[o,i]=m.useState(1),s=m.useRef(void 0),a=m.useRef(void 0),c=Qf(f=>{s.current=f.width,a.current=f.height,r((s.current+KN)/s.current),i((a.current+KN)/a.current)},{initialize:!0}),u=RM(DE,Mj),h=zu(u,[0,qN],[1,n]),p=zu(u,[0,qN],[1,o]);return d.jsx(Re.div,{className:"absolute inset-0",ref:c,initial:dt,animate:{...Ot,transition:{delay:Dj}},exit:dt,children:d.jsx(Re.div,{className:q("absolute inset-0 flex items-center justify-center overflow-hidden rounded-6xl",e?"-scale-x-100 rounded-5xl blur-lg":"bg-stone-100/30 bg-blend-luminosity backdrop-blur-xl after:absolute after:inset-px after:rounded-6xl after:border after:border-transparent dark:bg-midnight-800/30"),layout:!0,style:{scaleX:h,scaleY:p},children:d.jsx(Re.div,{className:q("absolute -inset-16 aspect-square bg-gradient-audio-output-light bg-blend-saturation saturate-150 dark:bg-gradient-audio-output-dark dark:saturate-100",e?"animate-spin-slower opacity-20 dark:opacity-30":"animate-spin-slow opacity-40 dark:opacity-50")})})})}function zve(t){const{dynamicHeight:e}=t;return d.jsx(Re.div,{className:q("t-bottom-fade absolute bottom-0 mx-4 box-content w-bottom-fade rounded-lg pt-bottom-fade",e?"h-bottom-fade":"h-composer"),initial:dt,animate:Ot,exit:dt,transition:Cy,children:d.jsx(fl,{isBottomFade:!0})})}function Vve(t,e){const{children:n,className:r,margins:o,data:i,size:s="regular",onButtonRef:a}=t,c=i.isDisabled?"":i.title,u=s==="small";return d.jsx(Re.div,{className:nt("relative shrink-0",o??"my-1",u?"h-9":"h-10",i.isVisible&&!u&&"size-10",i.isVisible&&u&&"size-9",!i.isVisible&&"overflow-hidden"),layout:!0,initial:!1,ref:e,children:d.jsx(Re.button,{type:"button",className:nt("absolute flex items-center justify-center rounded-xl fill-foreground-750",u?"size-9 p-1":"size-10 p-2",Ic["subtle-dimmed"],"disabled:active:bg-transparent disabled:active:bg-none",r),layout:"position",disabled:!i.isVisible||i.isDisabled,"aria-hidden":!i.isVisible,"aria-label":c,title:c,onClick:i.onClick,"data-testid":i.testId,"aria-expanded":typeof i.ariaExpanded=="boolean"?i.ariaExpanded:void 0,ref:a,children:n})})}const Jo=m.forwardRef(Vve);function $ve(){return L(WI).map(e=>e.id)}function nU(t){if(t.length===0)throw new Error("Array must have at least one element");return Math.floor(Math.random()*t.length)}function XRe(t,e){if(t.length===1)throw new Error("Array must have at least two elements");let n;do n=nU(t);while(n===e);return n}function Gve(t){if(t.length!==0)return t[nU(t)]}function Kve(t){const e=[...t];for(let n=t.length-1;n>0;n-=1){const r=Math.floor(Math.random()*(n+1)),o=e[n];o&&e[r]&&(e[n]=e[r],e[r]=o)}return e}function e2e(t,e){if(t.length!==e.length)return!1;const n=[...t].sort(),r=[...e].sort();return n.every((o,i)=>o===r[i])}const qve=m.lazy(()=>H(()=>import("./character-DZ-LFNRh.js"),__vite__mapDeps([229,1,2,230])).then(t=>({default:t.Character})));function Wve(){const[t,e]=it(up),{createConversation:n}=my(),[r,o]=m.useState(!1),i=Ee(BO),s=Ee(fc),a=$ve(),c=m.useRef(null),u=L(Zi);m.useEffect(()=>{if(c.current===null){const y=Gve(a);y&&(c.current=y)}},[a]);const{t:h}=Oe();m.useEffect(()=>{r&&c.current&&z.trackEvent({name:"system",data:{eventName:"characterPromotionShown",eventInfo_characterId:c.current}})},[r]),m.useEffect(()=>{const y=localStorage.getItem(v$);o(!y&&u.length>=10&&u.length<14)},[t,u.length]);function p(y){switch(y){case"mica":return"mica-head";case"aqua":return"aqua-head";case"erin":return"erin-head";default:return"mica-head"}}async function f(){c.current&&(s("clicking"),z.trackEvent({name:"interaction",data:{eventName:"characterPromotionClicked",eventInfo_characterId:c.current}}),i(!0),IX({settingName:"characterId",oldValue:"",newValue:c.current}),z.setSettings({userSettingCharacterId:c.current}),await Promise.all([Wr({path:"/user/settings",args:{options:{method:"PATCH"},body:{preferredCharacter:c.current}}})]))}const g=m.useCallback(async()=>{o(!1)},[]),v=m.useCallback(async()=>{c.current&&(o(!1),i(!0),e(c.current),await n())},[i,e,n]);return r?d.jsx("div",{className:"pointer-events-auto absolute -top-40 end-4 size-56 pb-2",onClick:f,onKeyDown:async y=>{y.key==="Enter"&&await f()},role:"button",tabIndex:0,"aria-label":h("characterAnimation.characterOptInAriaLabelText"),children:d.jsx(qve,{className:"outline-none",characterId:p(c.current),onCharacterDismissed:g,onCharacterClicked:v})}):null}const rU="0px 0px 0px 1px rgb(255, 255, 255) inset",oU="0px 0px 0px 1px rgba(255, 255, 255, 0.08) inset",Yve="0px 10px 24px 0px rgba(0, 0, 0, 0.18)",Qve="0px 42px 30px 0px rgba(0, 0, 0, 0.06)",Jve="0px 16px 48px -2px rgba(244, 190, 146, 0.18)",Zve="0px 16px 48px -2px rgba(0, 0, 0, 0.25)",Xve="0px 16px 24px -2px rgba(0, 0, 0, 0.1)",ebe="0px 16px 24px -2px rgba(0, 0, 0, 0.25)",tbe=28,nbe=32,rbe=24,obe=26,ibe="relative flex grow flex-col overflow-hidden before:absolute before:inset-0 before:rounded-3xl before:border-2 before:border-stroke-350",t2e="bg-white/90 shadow-composer-input dark:bg-midnight-900/80 dark:shadow-none",sbe="w-auto rounded-3xl contrast-more:border-2",abe="bg-gradient-to-b from-white/90 to-white/0 dark:from-black/30 dark:to-midnight-800/10",cbe="bg-white/90 dark:bg-midnight-850/60";function $w(t){const{title:e,onClick:n,appearDelay:r=NV,appearDuration:o=Oo.audio.unavailable,className:i}=t;return d.jsx(Re.div,{layout:"position",initial:"initial",animate:"animate",className:"relative flex h-12 shrink-0 items-center",variants:{initial:{...dt,scale:.9},animate:{...Ot,scale:1,transition:{...Oj,delay:r,duration:o}}},children:d.jsx("button",{type:"button",onClick:n,title:e,className:q("min-w-44",mf,Ic.strong,yI["40-base"],CI["40-base"],tb,"rounded-2xl before:rounded-2xl",i),children:e})})}function Dm(t){const{children:e,className:n}=t;return d.jsx(Re.div,{className:n,initial:dt,animate:Ot,exit:dt,transition:{delay:Lj},children:e})}const lbe={initial:dt,animate:Ot};function ube(t){const{titleKey:e,textKey:n,buttonTextKey:r,button:o,cancelButton:i,onClick:s,closeDialogCallback:a}=t,{t:c}=Oe(),u=c(e),h=c(o.textKey);return d.jsxs(d.Fragment,{children:[d.jsx(Re.div,{layout:!0,variants:lbe,initial:"initial",animate:"animate",role:"dialog","aria-label":u,tabIndex:-1,children:d.jsxs("div",{className:"m-3 text-center text-foreground-800",children:[d.jsx("p",{className:"py-3",children:u}),d.jsx("p",{className:"text-xs",children:c(n)}),r&&d.jsx("div",{className:"mx-auto flex w-full max-w-xs justify-around px-5 py-3 text-accent-600",children:d.jsx("button",{onClick:s,type:"button",className:"text-xs",children:c(r)})})]})}),d.jsxs(Re.div,{className:"relative mx-0.5 my-1 flex w-full items-center justify-center gap-2 px-2 align-middle",onClick:a,children:[i&&d.jsx(Me,{variant:"rect",title:c(i.textKey),className:"relative my-3 flex h-10 max-w-40 items-center justify-center py-3 dark:bg-black/40 dark:hover:bg-black/40",onClick:i.onClick,children:c(i.textKey)}),d.jsx(Me,{variant:"rect",title:h,className:"relative my-3 flex h-10 max-w-40 items-center justify-center py-3 dark:bg-black/40 dark:hover:bg-black/40",onClick:o.onClick,children:h})]})]})}function Gw(){const t=le("composer-creation-button");return!Fo("kill-composer-creation-button")&&t}function YN({config:t}){const{t:e}=Oe(),n=Gw(),r=Fd();if(t)switch(t.mode){case"stop":return d.jsx(Me,{testId:"stop-button",color:"accent",variant:"circle",size:n?"36-sm":"40-base",className:n?"":"my-1","aria-label":e("composer.stopButton"),title:e("composer.stopButton"),onClick:()=>t.onClick(),children:d.jsx("div",{className:"size-3.5 rounded bg-accent-550 contrast-more:border-2 dark:bg-accent-150"})});case"submit":return d.jsx(Me,{testId:"submit-button",color:"strong",variant:"square",size:n?"36-sm":"40-base",className:nt(n?"rounded-2xl":"my-1 rounded-submitButton"),"aria-label":e("userInput.submitButtonText"),title:e("userInput.submitButtonText"),onClick:()=>t.onClick(),disabled:t.disabled,children:d.jsx(wp,{className:"size-6"})});case"microphone":return r?void 0:d.jsx(Jo,{data:{title:e("composer.startAudioCall"),testId:"audio-call-button",onClick:()=>t.onClick(),isVisible:!0},className:Ic["subtle-dimmed-inverted"],size:n?"small":"regular",margins:n?"my-0":"my-1",children:d.jsx(Hw,{className:"size-6","aria-hidden":!0})});default:return}}function cf(t){const{children:e,color:n="neutral",className:r}=t;return d.jsx("div",{className:nt("flex h-4 items-center rounded px-1.5 text-3xs",n==="neutral"?"bg-black/8 text-foreground-550 dark:bg-white/8 dark:text-foreground-650":"bg-accent-350/30 text-accent-650 dark:bg-accent-450/30",r),children:e})}function dbe(t){var i;const{item:e,onClick:n}=t,r=L(pt),o=m.useRef(void 0);return m.useEffect(()=>{r&&o.current!==r&&e.onImpression&&(o.current=r,e.onImpression(r))},[r,e]),d.jsxs(Me,{title:e.title,"aria-label":e.title,variant:"rect",color:"subtle-dimmed-inverted",onClick:n,size:"40-base",alignment:"start",className:"min-w-[230px] px-3 py-2",testId:e.testId,children:[d.jsx("div",{className:"size-6 min-w-6",children:e.icon}),d.jsxs("div",{className:"grow text-left",children:[d.jsxs("div",{className:"line-clamp-1 inline-flex gap-1.5 text-xs",children:[e.title,(i=e.tags)==null?void 0:i.map(s=>d.jsx("div",{className:"flex items-center",children:d.jsx(cf,{color:s.color,children:d.jsx("span",{className:"leading-4",children:s.label})},s.label)},s.label))]}),d.jsx("p",{className:"line-clamp-1 leading-4 text-foreground-600 text-2xs dark:text-foreground-700",children:e.description})]})]},e.key)}const hbe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/dismiss-BcarQlxK.svg";function fbe(t){const{renderTrigger:e,renderSurface:n,containerClassNames:r,color:o="default",onOutsideEvent:i,placement:s="bottom",floatingOffset:a=10}=t,[c,u]=m.useState(!1),h=m.useRef(null),p=m.useRef(null),{refs:f,floatingStyles:g,context:v}=ep({placement:s,strategy:"fixed",middleware:[pd(a),tp(),md()],whileElementsMounted:fd,open:c,onOpenChange:u}),y=m.useCallback(C=>{C.stopPropagation(),C.preventDefault(),u(S=>!S)},[]),b=m.useCallback(()=>{u(!1),i==null||i()},[i]);return Kc({onOutsideEvent:b,elements:[f.floating,h],includeScroll:!0,invokeOnce:!0}),vl(C=>{C.key==="Escape"&&c&&b()}),d.jsxs("div",{ref:f.setReference,className:q("relative",r==null?void 0:r.trigger),children:[e({openPopover:y,isOpen:c,ref:h}),AM.createPortal(d.jsx(Pn,{children:c&&d.jsx(eb,{context:v,modal:!0,returnFocus:!0,initialFocus:p,children:d.jsx(Re.div,{ref:f.setFloating,className:nt("rounded-2xl p-3 shadow-lg",o==="thin"?ra:Ji,r==null?void 0:r.surface,Xt.modal),style:{...g,...OI},role:"dialog",tabIndex:-1,initial:"initial",animate:"animate",exit:"exit",variants:{initial:dt,animate:Ot,exit:{...dt,transition:{duration:Oo.default}}},transition:{duration:Oo.default,ease:"easeInOut"},children:d.jsx("div",{className:q("pointer-events-auto relative max-h-expanded-section overflow-visible",Xt.modal),children:n({closePopover:b,isOpen:c,focusRef:p})})})})}),document.getElementById("popoverPortal")??document.body)]})}const Kw=m.forwardRef((t,e)=>{const{items:n,defaultSelectedItemIndex:r,onSelect:o,onReset:i,onMenuClick:s,disabled:a,showDefaultItemInDropdown:c=!1}=t,u=L(pt),h=m.useRef(void 0),p=m.useMemo(()=>!r||r<0||r>=n.length?0:r,[r,n]),[f,g]=m.useState(p);m.useImperativeHandle(e,()=>({setSelectedItemIndex:C=>g(C)}),[]);const{selectedItem:v,dropdownItems:y,selectedNonDefault:b}=m.useMemo(()=>({selectedItem:n[f]??void 0,dropdownItems:c?n:n.filter((C,S)=>S!==f),selectedNonDefault:f!==p}),[n,f,p,c]);return m.useEffect(()=>{u&&h.current!==u&&v&&v.onImpression&&(h.current=u,v.onImpression(u))},[u,v]),d.jsx(fbe,{color:"default",renderTrigger:({openPopover:C})=>v&&d.jsxs(Me,{title:v.key,"aria-label":v.title,variant:"rect",size:"36-sm",disabled:a,color:b?"composer-selected":"subtle-dimmed",className:nt("h-9 select-none gap-x-1 rounded-2xl border border-black/8 dark:border-white/8",v.isIconEnabledInButton?"pe-3 ps-2":"px-3"),onClick:S=>{var E;s==null||s(),(E=v.beforeClick)==null||E.call(v,u??""),b?(g(p),i==null||i()):C(S)},testId:v.testId,children:[b?d.jsx(rr,{url:hbe,className:"size-4"}):v.isIconEnabledInButton&&v.icon,d.jsx("span",{className:"text-xs",children:v.buttonTitle??v.title}),!b&&v.isChevronEnabledInButton&&d.jsx(Hd,{className:"size-4 rotate-90"})]}),renderSurface:({closePopover:C})=>d.jsx("div",{className:"flex flex-col",children:y.map(S=>d.jsx(dbe,{item:S,onClick:E=>{var T;(T=S.beforeClick)==null||T.call(S,u??"");const I=n.findIndex(_=>_.key===S.key);g(I),o(I),C(E)}},S.key))}),containerClassNames:{surface:"p-1 border-white/25 dark:border-slate-600/25 shadow-composer-tinted-light dark:shadow-composer-tinted-dark"},placement:"bottom-start",floatingOffset:4})});Kw.displayName="ComposerDropdownButton";const pbe=l.record(l.string());function iU(t){const[e,n]=it(nG),r=!!e[t],o=m.useCallback(()=>{const i={...e,[t]:new Date().toISOString()};ei(E$,pbe,i),n(i)},[e,t,n]);return{alreadyShown:r,dismissCoachmark:o}}const sU="smartmode",n2e="pagesEditThisResponse";function mbe(t){const{renderReferenceElement:e,children:n,className:r,placement:o,offset:i,isOpen:s=!0,portalId:a,withArrow:c=!1,arrowClassName:u="dark:fill-black fill-white",animation:h="none",onOutsideEvent:p,onInsideEvent:f}=t,g=m.useRef(null),{refs:v,x:y,y:b,strategy:C,context:S,placement:E}=ep({open:s,placement:o??"right",middleware:[pd(i??1),tp({fallbackAxisSideDirection:"end"}),md(),xM({element:g})],whileElementsMounted:fd});Kc({onOutsideEvent:()=>{p==null||p()},invokeOnce:!0,elements:[v.floating]});const I=lI(S),T=uI(S),_=dI(S),{getReferenceProps:w,getFloatingProps:A}=hI([I,T,_]),M=L(Ns),R=gbe(h,E);return d.jsxs(d.Fragment,{children:[e==null?void 0:e({ref:v.setReference,...w()},s),s&&d.jsx(Xv,{id:a,children:d.jsxs(Re.div,{ref:v.setFloating,style:{position:C,top:`${b}px`,insetInlineStart:`${y}px`,boxShadow:M==="dark"?"0px 0px 0px 1px rgba(255, 255, 255, 0.08) inset":void 0},...R,...A({}),className:q("start-0 flex rounded-2xl p-4 shadow-xl",Xt.coachmark,cz,c&&"!overflow-visible",r),onClick:f,children:[n,c?d.jsx(eB,{ref:g,context:S,tipRadius:3,strokeWidth:2,className:u}):null]})})]})}function gbe(t,e){switch(t){case"bounce":return vbe(e);case"none":return{};default:return{}}}function vbe(t){const n=t.startsWith("top")||t.startsWith("bottom"),r=t.startsWith("top")||t.startsWith("left")?-1:1;return n?{animate:{y:`${r*10}px`,transition:W2}}:{animate:{x:`${r*10}px`,transition:W2}}}function aU({triggerComponent:t,offset:e=10,onInsideEvent:n}){const{t:r}=Oe(),{alreadyShown:o,dismissCoachmark:i}=iU(sU),s=c9(),a=c=>{c.stopPropagation(),i()};return d.jsx(mbe,{className:"max-w-48 cursor-pointer bg-black dark:bg-midnight-150",arrowClassName:"dark:fill-midnight-150 fill-black",isOpen:!o,placement:"right",offset:e,withArrow:!0,renderReferenceElement:c=>d.jsx(Re.div,{ref:c.ref,className:"relative",children:t}),portalId:"composer-container",onInsideEvent:()=>{n==null||n(),i()},children:d.jsxs("div",{className:"flex max-w-[160px] flex-col gap-0.5 bg-black text-white dark:bg-midnight-150 dark:text-black",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("div",{className:"text-2xs-strong",children:r("composer.chatModes.smart.coachmarkTitle")}),d.jsx("button",{onClick:a,type:"button",children:d.jsx(fo,{className:"size-4"})})]}),d.jsx("div",{className:"text-2xs",children:s.coachmarkDescription})]})})}const cU="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/quick-pVrRG7df.svg",lU="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/smart-Ccvst-g_.svg",bbe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/think-DxNkOoJG.svg";function ybe(t,e){z.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionElement:"composerCreateButton",eventInfo_impressionScenario:t??"off",eventInfo_conversationId:e}})}function Cbe(t,e){z.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionElement:"composerThinkButton",eventInfo_impressionScenario:t?"thinkDeeperOn":"thinkDeeperOff",eventInfo_conversationId:e}})}function Sbe(t){z.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionElement:"composerScreenshotButton",eventInfo_conversationId:t}})}function Ebe(t,e){z.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"composerCreateButton",eventInfo_clickScenario:Ibe(t),eventInfo_conversationId:e}})}function Ibe(t){if(!t)return"showDrawer";switch(t){case"actions":return"exitActions";case"image":return"exitImage";case"podcast":return"exitPodcast";case"researchReport":return"exitResearchReport";case"quiz":return"exitQuiz";default:return"showDrawer"}}function Tbe(t,e){z.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"composerThinkButton",eventInfo_clickScenario:t?"disableThinkDeeper":"enableThinkDeeper",eventInfo_conversationId:e}})}function _be(t){z.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"composerScreenshotButton",eventInfo_conversationId:t}})}const uU=["smart-mode-6e0b4c6f","smart-mode-cd0c997b","smart-mode"];function xy(){return QL(uU,"any")}function wbe(){return Ju(uU,"any")}function Abe(t){const{disabled:e=!1}=t,n=kbe(),r=xy(),[o,i]=it(_n),[s,a]=m.useState(!1),c=m.useRef(null),u=m.useCallback(p=>{const f=n[p];((f==null?void 0:f.key)==="chat"||(f==null?void 0:f.key)==="smart"||(f==null?void 0:f.key)==="reasoning")&&(a(!0),i(f.key))},[n,i]);m.useEffect(()=>{var p;if(s)a(!1);else{const f=n.findIndex(g=>g.key===o);(p=c.current)==null||p.setSelectedItemIndex(f)}},[n,o,s,a]);const h=d.jsx(Kw,{ref:c,items:n,onSelect:u,defaultSelectedItemIndex:0,showDefaultItemInDropdown:!0,onReset:()=>{i("chat")},disabled:e,onMenuClick:()=>ht({source:"composerChatModeDropdownButton",pageName:"chatPage",customData:JSON.stringify({currentMode:o})})});return r?d.jsx(aU,{triggerComponent:h,offset:10}):h}function QN(t){return e=>Cbe(t,e)}function JN(t){return e=>Tbe(t,e)}function kbe(){const{t}=Oe("translation"),e=xy(),n=c9(),r={key:"chat",title:t("composer.chatModes.chat.title"),buttonTitle:t("composer.chatModes.chat.buttonTitle"),icon:d.jsx(rr,{url:cU,className:"size-5"}),description:t("composer.chatModes.chat.description"),testId:"composer-chat-mode-quick-button",onImpression:QN(!1),beforeClick:JN(!1),tags:[{label:t("composer.chatModes.chat.latency"),color:"neutral"}],isChevronEnabledInButton:!0,isIconEnabledInButton:!1},o={key:"reasoning",title:t("composer.chatModes.reasoning.title"),icon:d.jsx(rr,{url:bbe,className:"size-6"}),description:t("composer.chatModes.reasoning.description"),testId:"composer-chat-mode-reasoning-button",onImpression:QN(!0),beforeClick:JN(!0),tags:[{label:t("composer.chatModes.reasoning.latency"),color:"neutral"}]},i=[r,o];if(e){const s={key:"smart",title:n.title,icon:d.jsx(rr,{url:lU,className:"size-6"}),description:n.description,testId:"composer-chat-mode-smart-button",tags:[{label:t("common.new"),color:"accent"}]};i.push(s)}return i}const xbe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/research-DamIycj6.svg",Rbe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/think-deeper-C6Ziv8bd.svg",dU="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/checklist-BDS7QRqm.svg";function hU(){const t=le("deep-research"),e=le("deep-research-nano"),n=Lr(),r=L(wd);return t&&(r||!1||!r&&n&&e)&&!be.instance().config().disableDeepResearch}const Nbe=["chat","reasoning"],Pbe=["chat","reasoning","research"];function Mbe(){const[t,e]=it(_n),n=Cw(),{t:r}=Oe(),o=u=>{ht({source:"composerChatModeMenu",customData:JSON.stringify({currentMode:t,newMode:u})}),e(u),Rw({msg:r("actions.screenReaderSwitchPrefix",{chatMode:$f(u)})})},i=hU(),s=xy(),a=Fd();let c=Nbe.concat(s?["smart"]:[],i?["research"]:[],n?["computerUse"]:[]);return a&&(c=c.filter(u=>Pbe.includes(u))),d.jsx("div",{className:"pointer-events-auto relative flex flex-col gap-1 rounded-2xl text-xs contrast-more:border-2","data-testid":"composer-mode-menu",role:"radiogroup",children:c.map((u,h)=>d.jsx(Lbe,{chatMode:u,isSelected:t===u,onSelect:o,focusOnMount:h===0},u))})}const Obe={chat:d.jsx(rr,{url:cU,className:"size-5"}),reasoning:d.jsx(rr,{url:Rbe,className:"size-5"}),research:d.jsx(rr,{url:xbe,className:"size-5"}),computerUse:d.jsx(rr,{url:dU,className:"size-5"}),smart:d.jsx(rr,{url:lU,className:"size-5"})};function Lbe(t){const{chatMode:e,isSelected:n,focusOnMount:r,onSelect:o}=t,{t:i}=Oe(),s=m.useRef(null);ky(s,r);const a=e==="research"||e==="smart",c=e!=="smart";return d.jsxs("button",{type:"button",ref:s,title:$f(e),onClick:()=>o(e),className:q("flex items-center justify-between gap-4 rounded-xl px-4 py-2",Ic["subtle-dimmed"]),"data-testid":`${e}-mode-option`,role:"radio","aria-checked":n,children:[d.jsxs("div",{className:"flex items-center gap-4",children:[Obe[e],d.jsxs("div",{className:"pe-4 text-left",children:[d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsxs("div",{children:[" ",$f(e)," "]}),a&&d.jsx(cf,{color:"accent",children:d.jsx("span",{children:i("common.new")})}),e==="computerUse"&&d.jsx(cf,{color:"accent",children:d.jsx("span",{children:i("settings.labs.title")})}),c&&d.jsx(cf,{children:d.jsx("span",{children:i(`composer.chatModes.${e}.latency`)})})]}),d.jsx("div",{className:"text-foreground-600 text-2xs dark:text-foreground-700",children:cfe(e)})]})]}),d.jsx(Dbe,{isSelected:n})]})}function Dbe(t){const{isSelected:e}=t;return d.jsx("div",{className:q("flex size-5 items-center justify-center rounded-full border-2",e?"border-foreground-800":"border-foreground-450"),children:e&&d.jsx("div",{className:"size-2.5 rounded-full bg-foreground-800 contrast-more:border-2"})})}function jbe(t){const{isChatModeMenuOpen:e,onRef:n,onClick:r,disableChatModeSwitcher:o}=t,{t:i}=Oe(),s=L(_n),a=c=>{ht({source:"composerChatModeSwitcher",customData:JSON.stringify({currentMode:s,isOpen:e})}),r(c)};return d.jsx(Re.div,{layout:"position",initial:!1,children:d.jsxs(Me,{testId:"chat-mode-switcher",title:i(e?"composer.chatModes.closeModeMenu":"composer.chatModes.openModeMenu"),onClick:a,color:"subtle-dimmed",ref:n,className:"my-1 border border-black/8",disabled:!o,children:[d.jsx("span",{className:"text-xs",children:$f(s)}),d.jsx(Hd,{className:q("size-4",e?"-rotate-90":"rotate-90")})]})})}function Ube(){const t=m.useRef(null);return{captureFocus:()=>{document.activeElement instanceof HTMLElement&&(t.current=document.activeElement)},restoreFocus:()=>{t.current&&t.current.focus()}}}function qw(t){const{renderTrigger:e,triggerClick:n,children:r,className:o,options:i,isOpen:s,onIsOpenChange:a}=t,{state:c,setState:u}=zw({controlledValue:s,defaultValue:!1,onChange:a}),{disableFocusManager:h=!1}=i??{},p=Sy(),{refs:f,x:g,y:v,strategy:y,context:b}=ep({open:c,placement:(i==null?void 0:i.placement)??"bottom-end",onOpenChange:u,middleware:[pd((i==null?void 0:i.offset)??1),tp({fallbackAxisSideDirection:"end"}),md()],whileElementsMounted:fd}),C=lI(b),S=uI(b),E=dI(b,{role:(i==null?void 0:i.roleType)??"dialog"}),{getReferenceProps:I,getFloatingProps:T}=hI([C,S,E]),_=w=>{i!=null&&i.stopReferencePropagation&&w.stopPropagation(),n==null||n(w)};return d.jsxs(d.Fragment,{children:[e==null?void 0:e({ref:f.setReference,...I({onClick:_})},c),c&&d.jsx(Xv,{children:d.jsx(eb,{context:b,modal:!1,disabled:h,returnFocus:(i==null?void 0:i.returnFocus)??!0,children:d.jsx("div",{ref:f.setFloating,style:{position:y,top:`${v}px`,[p?"insetInlineEnd":"insetInlineStart"]:`${g}px`},...T({onClick:w=>{i!=null&&i.stopFloatingPropagation&&w.stopPropagation(),i!=null&&i.hideOnMenuClick&&u(!1)}}),className:q("flex rounded-2xl p-1.5 shadow-xl",Xt.modal,o),children:r})})})]})}function Fbe({disableChatModeSwitcher:t}){const[e,n]=it(vy),r=xy(),{captureFocus:o,restoreFocus:i}=Ube(),s=m.useCallback(a=>{n(c=>a?(o(),"chatMode"):c==="chatMode"?(setTimeout(()=>{i()},0),null):c)},[n,o,i]);return d.jsx(qw,{isOpen:e==="chatMode",onIsOpenChange:s,renderTrigger:(a,c)=>{const u=d.jsx(jbe,{isChatModeMenuOpen:c,onRef:a.ref,onClick:a.onClick,disableChatModeSwitcher:t});return r?d.jsx(aU,{triggerComponent:u,offset:10,onInsideEvent:()=>{s(!0)}}):u},options:{placement:"top-start",offset:{mainAxis:10,crossAxis:-12},hideOnMenuClick:!0},className:nt(Ji,"p-2"),children:d.jsx(Mbe,{})})}function Bbe({state:t}){const{t:e}=Oe(),n=Ft(),r=pi(),o=Ee(Yr),i=Ee(Cd),s=Ee(bb),a=Gw();return d.jsx(Jo,{data:{title:e("composer.goToHome"),testId:"home-button",onClick:async()=>{o(null),i(!1),s(void 0),Tn({source:"homeButton"}),await r({to:"/",from:n})},isVisible:t!=="hidden",isDisabled:t==="disabled"},size:a?"small":"regular",children:d.jsx(Rp,{className:"size-6","aria-hidden":!0})})}const lf=20,Hbe={id:-1,title:"",addedToTabSelection:!1,isInSearchResult:!0,tabType:"all-tabs",active:!1,highlighted:!1,pinned:!1,selected:!1,incognito:!1,autoDiscardable:!0,discarded:!1,index:-1,windowId:-1,groupId:-1};function Ww(t){return t.tabType==="all-tabs"}function zbe(t,e){const{t:n}=Oe(),r=m.useMemo(()=>{const s=t.filter(u=>u.isInSearchResult&&!Ww(u)),a=Math.min(s.length,lf);return e&&a>1&&a<lf?[{...Hbe,title:n("composer.multiTabs.allTabs",{count:a}),isInSearchResult:!0},...s]:s},[t,n,e]),o=e?r.length-1:r.length,i=m.useCallback(()=>t.map(s=>({...s,addedToTabSelection:r.slice(1,lf+1).some(a=>a.id===s.id)})),[r,t]);return{appearedTabs:r,appearedTabsCount:o,getUpdatedTabsBySpecialTab:i}}const fU=t=>m.createElement("svg",{viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M6.5 2C4.01472 2 2 4.01472 2 6.5V11.5002C1.39278 11.0441 1 10.3179 1 9.5V6.5C1 3.46243 3.46243 1 6.5 1H9.5C10.3179 1 11.0441 1.39278 11.5002 2H6.5ZM4.06095 6.3954C4.34069 5.02835 5.55025 4 7 4H13.5002C13.0441 3.39278 12.3179 3 11.5 3H7C4.79086 3 3 4.79086 3 7V11.5C3 12.3179 3.39278 13.0441 4 13.5002V7C4 6.79289 4.02099 6.59069 4.06095 6.3954ZM5 7.5C5 6.11929 6.11929 5 7.5 5H12.5C13.8807 5 15 6.11929 15 7.5V12.5C15 13.8807 13.8807 15 12.5 15H7.5C6.11929 15 5 13.8807 5 12.5V7.5ZM7.5 6C6.67157 6 6 6.67157 6 7.5V12.5C6 13.3284 6.67157 14 7.5 14H12.5C13.3284 14 14 13.3284 14 12.5V7.5C14 6.67157 13.3284 6 12.5 6H7.5Z"})),r2e=Object.freeze(Object.defineProperty({__proto__:null,default:fU},Symbol.toStringTag,{value:"Module"})),pU=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 24",fill:"currentColor",...t},m.createElement("path",{d:"M12.5 2C18.0228 2 22.5 6.47715 22.5 12C22.5 17.5228 18.0228 22 12.5 22C6.97715 22 2.5 17.5228 2.5 12C2.5 6.47715 6.97715 2 12.5 2ZM12.5 3.5C7.80558 3.5 4 7.30558 4 12C4 16.6944 7.80558 20.5 12.5 20.5C17.1944 20.5 21 16.6944 21 12C21 7.30558 17.1944 3.5 12.5 3.5ZM12.5 7C12.9142 7 13.25 7.33579 13.25 7.75V11.25H16.75C17.1642 11.25 17.5 11.5858 17.5 12C17.5 12.4142 17.1642 12.75 16.75 12.75H13.25V16.25C13.25 16.6642 12.9142 17 12.5 17C12.0858 17 11.75 16.6642 11.75 16.25V12.75H8.25C7.83579 12.75 7.5 12.4142 7.5 12C7.5 11.5858 7.83579 11.25 8.25 11.25H11.75V7.75C11.75 7.33579 12.0858 7 12.5 7Z"})),o2e=Object.freeze(Object.defineProperty({__proto__:null,default:pU},Symbol.toStringTag,{value:"Module"})),Yw=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...t},m.createElement("path",{d:"M17.75 3A3.25 3.25 0 0 1 21 6.25v11.5A3.25 3.25 0 0 1 17.75 21H6.25A3.25 3.25 0 0 1 3 17.75V6.25A3.25 3.25 0 0 1 6.25 3h11.5Zm.58 16.401-5.805-5.686a.75.75 0 0 0-.966-.071l-.084.07-5.807 5.687c.182.064.378.099.582.099h11.5c.203 0 .399-.035.58-.099l-5.805-5.686L18.33 19.4ZM17.75 4.5H6.25A1.75 1.75 0 0 0 4.5 6.25v11.5c0 .208.036.408.103.594l5.823-5.701a2.25 2.25 0 0 1 3.02-.116l.128.116 5.822 5.702c.067-.186.104-.386.104-.595V6.25a1.75 1.75 0 0 0-1.75-1.75Zm-2.498 2a2.252 2.252 0 1 1 0 4.504 2.252 2.252 0 0 1 0-4.504Zm0 1.5a.752.752 0 1 0 0 1.504.752.752 0 0 0 0-1.504Z"})),i2e=Object.freeze(Object.defineProperty({__proto__:null,default:Yw},Symbol.toStringTag,{value:"Module"})),mU=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 24",fill:"currentColor",...t},m.createElement("path",{d:"M12.5 2C18.0228 2 22.5 6.47715 22.5 12C22.5 17.5228 18.0228 22 12.5 22C6.97715 22 2.5 17.5228 2.5 12C2.5 6.47715 6.97715 2 12.5 2ZM15.7197 8.96967L11.25 13.4393L9.28033 11.4697C8.98744 11.1768 8.51256 11.1768 8.21967 11.4697C7.92678 11.7626 7.92678 12.2374 8.21967 12.5303L10.7197 15.0303C11.0126 15.3232 11.4874 15.3232 11.7803 15.0303L16.7803 10.0303C17.0732 9.73744 17.0732 9.26256 16.7803 8.96967C16.4874 8.67678 16.0126 8.67678 15.7197 8.96967Z"})),s2e=Object.freeze(Object.defineProperty({__proto__:null,default:mU},Symbol.toStringTag,{value:"Module"}));function gU(t){return m.useCallback(e=>{if(e.key==="Enter"&&!e.shiftKey||e.key===" "){e.preventDefault();try{const n=t(e);n instanceof Promise&&n.catch(console.error)}catch(n){console.error("Error in useEnterOrSpaceKeyDown:",n)}}},[t])}function Vbe(t){const e=t.children[0];return e instanceof HTMLElement?e:null}function $be(t,e=!0){m.useEffect(()=>{if(e&&t.current){const n=Vbe(t.current);n&&n.focus()}},[t,e])}const Sl=t=>d.jsx(Kbe,{...t});Sl.Motion=m.forwardRef(Gbe);function Gbe(t,e){const{children:n,axis:r="vertical",circular:o=!0,tabbable:i,autoFocus:s=!1,...a}=t,c=NM({axis:r,circular:o,tabbable:i}),u=m.useRef(null);return m.useImperativeHandle(e,()=>u.current,[]),ky(u,s),le("a11y-keyboard-navigation")?d.jsx(Re.div,{ref:u,...c,...a,children:n}):d.jsx(Re.div,{ref:u,...a,children:n})}function Kbe(t){const{children:e,axis:n="vertical",circular:r,tabbable:o,autoFocus:i=!1,...s}=t,a=NM({axis:n,circular:r,tabbable:o}),c=m.useRef(null);return $be(c,i),le("a11y-keyboard-navigation")?d.jsx("div",{ref:c,...a,...s,children:e}):d.jsx("div",{ref:c,...s,children:e})}const ZN="ms-auto me-[2px] size-6 flex-none";function qbe(t,e){const{tab:n,onClick:r,showHighlight:o,showActionIcon:i=!0,onFocus:s,className:a,totalTabsCount:c,maxSelectedTabsLimit:u}=t,[h,p]=m.useState(!1),{t:f}=Oe(),g=m.useCallback(()=>{r==null||r({...n,addedToTabSelection:n.tabType!=="all-tabs"?!n.addedToTabSelection:n.addedToTabSelection})},[r,n]),v=gU(g),y=Ww(n),b=h||!n.favIconUrl||y,C=y?fU:Yw,S=y&&c&&c>=u;return d.jsxs(Sl.Motion,{className:nt(" box-border flex w-full cursor-pointer flex-row items-center rounded-lg p-1.5 active:bg-black/3 safe-hover:bg-black/5 dark:active:bg-white/5 dark:safe-hover:bg-black/30",o&&"bg-black/5 dark:bg-white/8","forced-colors:focus:outline forced-colors:focus:outline-2 forced-colors:focus:outline-black dark:forced-colors:focus:outline-white","contrast-more:focus:outline contrast-more:focus:outline-2 contrast-more:focus:outline-black dark:contrast-more:focus:outline-white",a),onClick:g,tabIndex:0,onKeyDown:v,ref:e,onFocus:s,tabbable:!0,"aria-label":n.title,children:[d.jsx("div",{className:"relative flex size-4 flex-none flex-row items-center rounded-lg bg-black/5",children:b?d.jsx(C,{className:"size-full"}):d.jsx("img",{src:n.favIconUrl,alt:f("composer.multiTabs.tabFavIconAltText"),className:"size-full rounded-[1px] object-cover",onError:()=>{p(!0)}})}),d.jsxs("span",{className:"font-ligatures-none me-7 ms-2 max-h-full truncate text-foreground-850 text-xs",children:[n.title,S&&d.jsx("span",{className:"ms-1 text-foreground-650 text-2xs",children:f("composer.multiTabs.browserTabMenuMentionLimitText",{limit:u})}),d.jsx("span",{})]}),i&&n.tabType!=="all-tabs"&&(n.addedToTabSelection?d.jsx(mU,{className:ZN}):d.jsx(pU,{className:ZN}))]})}const Wbe=m.forwardRef(qbe),XN="";function Ybe(t){const{onChange:e,defaultValue:n}=t,{t:r}=Oe(),[o,i]=m.useState(n??XN),s=()=>{i(XN)},a=gU(s),c=m.useCallback(u=>{i(u.target.value)},[]);return m.useEffect(()=>{e==null||e(o)},[e,o]),d.jsxs("div",{className:"mt-3 flex h-8 w-full flex-row items-center rounded-3xl bg-white/60 dark:bg-black/60",children:[d.jsx(Uw,{className:"mx-2 size-4"}),d.jsx("input",{type:"text",id:"browser-tab-search",autoComplete:"off",spellCheck:!1,autoCorrect:"off",className:"w-full flex-1 rounded-lg bg-transparent py-2 text-sm focus:outline-none",placeholder:r("composer.multiTabs.browserTabMenuSearchPlaceholder"),"aria-label":r("composer.multiTabs.browserTabMenuSearchPlaceholder"),onChange:c,value:o,maxLength:100}),o&&d.jsx("div",{role:"button",tabIndex:0,className:"me-1 ms-auto h-6 cursor-pointer rounded-xl border border-midnight-250 bg-midnight-200 px-3 py-1 text-foreground-800 text-2xs dark:border-white/50 dark:bg-white/5",onKeyDown:a,onClick:s,"aria-label":r("composer.multiTabs.browserTabMenuSearchClear"),children:r("composer.multiTabs.browserTabMenuSearchClear")})]})}function vU(t,e){let n=null;return(...r)=>{n!==null&&window.clearTimeout(n),n=window.setTimeout(()=>t(...r),e)}}const Qbe=300,a2e=2e3;function Jbe(t,e=1e3){const n=m.useRef();return n.current=t,m.useMemo(()=>vU((...i)=>{var s;(s=n.current)==null||s.call(n,...i)},e),[e])}function Zbe(t){const e=m.useRef(0),n=m.useCallback(async()=>{const r=window.innerHeight;r!==e.current&&(e.current=r,await t(r))},[t]);Qf(n,{initialize:!0},document.documentElement)}const Xbe="edge://discover-chat-v2",eye="edge://discover-chat-v2.top-chrome",c2e="Edge.Context.Pref",l2e="Edge.Context.OnPref",u2e="browser.underside_chat_consent",d2e="browser.underside_video_transcript_consent",tye="Edge.IsFeatureEnabled",nye="Edge.OnIsFeatureEnabled",h2e="isShowCopilotButtonSupported";class $v{constructor(){W(this,"resolve",null);W(this,"isCancelled");W(this,"token");this.token=new Promise(e=>{this.resolve=e}),this.isCancelled=!1}static cancelled(){const e=new $v;return e.cancel(),e}static create(e){const n=new $v;return e&&e.then(()=>n.cancel()),n}static delay(e){return this.create(new Promise(n=>{setTimeout(()=>n(null),e)}))}cancelled(){return this.isCancelled}cancel(){return!this.isCancelled&&this.resolve&&this.resolve(this),this.isCancelled=!0,this.isCancelled}dispose(){this.cancel()}}function rye(t){window.parent.postMessage(t,Xbe),window.parent.postMessage(t,eye)}class Qw{constructor(e,n="",r,o){W(this,"listenerKey",Qw.name);W(this,"result",null);W(this,"priority","Normal");W(this,"createdDate",new Date);W(this,"id");W(this,"resolveListener");W(this,"eventName");W(this,"canResolve");this.eventName=e,this.id=n,r==null||r.then(()=>this.cancel()),this.canResolve=o}init(e){e!==void 0?this.resolveListener=e:this.result=new Promise(n=>{this.resolveListener=n})}maybeHandleEvent(e){if(!this.resolveListener)throw new Error("PostMessageListener is not initialized");const{eventName:n,requestId:r}=e;return r!==this.id?!1:n===this.eventName?this.canResolve&&!this.canResolve(e)?!1:(this.resolveListener(e),!0):!1}cancel(){if(!this.resolveListener)throw new Error("PostMessageListener is not initialized");return this.result&&this.resolveListener(null),!0}}const oc=class oc{constructor(){W(this,"activeListeners",[])}static instance(){return oc.singleton||(oc.singleton=new oc),oc.singleton}push(e,n,r){return e.init(r),this.activeListeners.push(e),n&&n(),e.result===null?Promise.resolve(null):e.result.then(o=>(this.pop(e),o)).catch(()=>(this.pop(e),null))}pop(e){const n=this.activeListeners.indexOf(e);n>-1&&this.activeListeners.splice(n,1)}findAndHandleListener(e){for(const n of[...this.activeListeners].sort((r,o)=>r.createdDate<o.createdDate?-1:1))if(n.maybeHandleEvent(e))break}};W(oc,"singleton",null);let jE=oc;class oye{constructor(){W(this,"isFeatureAvailableApiSupported");W(this,"enabledFeatures",new Map);this.isFeatureAvailableApiSupported=this.getFeatureAvailableApiSupported()}async isFeatureEnabled(e){return this.enabledFeatures.has(e)||await this.retrieveEnabledFeatures([e]),this.enabledFeatures.get(e)??!1}async retrieveEnabledFeatures(e){if(!this.isFeatureAvailableApiSupported)return;await this.waitForNativeBridgeConnected();const n=1e3,r={eventName:tye,requestId:crypto.randomUUID(),isOutgoing:!0,args:{featureNames:e}},o=await jE.instance().push(new Qw(nye,r.requestId,$v.delay(n).token),()=>{rye(r)});if(o){const i=o.args;for(const s of e){const a=i.featureNames.includes(s);this.enabledFeatures.set(s,a)}}}getFeatureAvailableApiSupported(){for(const n of navigator.userAgent.split(" "))if(n.startsWith("Edg/")){const r=n.split("/")[1];if(r!==void 0){const o=r.split(".")[0];if(o!==void 0)return parseInt(o,10)>=132}}return!1}waitForNativeBridgeConnected(){const e=st();return e.get($m)?Promise.resolve():new Promise(n=>{const r=e.sub($m,()=>{e.get($m)&&(r(),n())})})}}const f2e=new oye;function iye(t){return t!=null&&typeof t=="object"&&"id"in t&&typeof t.id=="number"&&"windowId"in t&&typeof t.windowId=="number"&&"url"in t&&typeof t.url=="string"}function bU(t){return Array.isArray(t)&&t.every(e=>iye(e))}const sye=.2,aye=.2,cye=594,lye=46,uye=360,dye=240;function hye(t,e){const n=new Set(t.map(o=>o.id)),r=new Set(e.map(o=>o.id));if(n.size!==r.size)return!0;for(const o of n)if(!r.has(o))return!0;return!1}function fye(){Mt.emit("edge:try-grow-content-height",cye)}function pye(t){const e=new Map;for(const n of t)n.id&&n.addedToTabSelection&&e.set(n.id.toString(),n);return e}function mye(t){const{styles:e,onRef:n,onSave:r,onClose:o=()=>{},outsideClickElements:i=[],originElement:s,mode:a="add"}=t,[c,u]=it(Ia),h=m.useRef(new Map(c)),p=m.useRef(null),[f,g]=m.useState([]),[v,y]=m.useState(0),b=m.useRef(null),{t:C}=Oe(),S=m.useDeferredValue([...f]),E=L(Sj),{appearedTabs:I,appearedTabsCount:T,getUpdatedTabsBySpecialTab:_}=zbe(S,E),[w,A]=m.useState(!1),M=h.current,[R,$]=m.useState(0),[V,ie]=m.useState(!1),N=m.useCallback(()=>{if(p.current&&s&&s.current){const we=s.current.getBoundingClientRect();$(we.top-lye)}},[$,s]);Zbe(()=>{fye(),N()}),m.useEffect(()=>{ie(!1);async function we(){const{tabs:Ke}=await Dle.run({});if(bU(Ke)){const de=[];for(const ge of Ke)ge.id&&de.push({...ge,addedToTabSelection:M.has(ge.id.toString()),isInSearchResult:!0});g(de)}}we().catch(console.error).finally(()=>{ie(!0)})},[M]),m.useLayoutEffect(()=>{p.current&&V&&N()},[N,V]);const Y=m.useMemo(()=>f.filter(we=>we.addedToTabSelection),[f]),ue=m.useMemo(()=>Y.length>lf,[Y]),j=m.useCallback(we=>{n==null||n(we),p.current=we},[n]),U=m.useCallback(we=>{const Ke=pye(we);u(Ke);const de=Array.from(Ke.values()),ge=hye(de,[...M.values()]);r==null||r(de,ge)},[M,r,u]),te=m.useCallback(()=>{ue||U(f)},[ue,U,f]),Q=m.useCallback(we=>{g(Ke=>Ke.map(ge=>ge.id===we.id?we:ge))},[]),re=Jbe(m.useCallback(we=>{g(Ke=>Ke.map(de=>({...de,isInSearchResult:de.title?de.title.toLowerCase().includes(we.toLowerCase().trim()):!0})))},[]),Qbe),Z=m.useCallback(we=>{y(Ke=>we==="up"?Ke>0?Ke-1:I.length-1:Ke<I.length-1?Ke+1:0)},[y,I]);m.useEffect(()=>{b.current&&v>=0&&b.current.scrollIntoView({block:"nearest"})},[v,b]);const _e=m.useCallback(we=>{let Ke=[];Ww(we)?Ke=_():Ke=f.map(de=>de.id===we.id?{...we,addedToTabSelection:!0}:de),g(Ke),U(Ke)},[_,U,f]),ye=m.useCallback(we=>{var Ke;if(["ArrowUp","ArrowDown"].includes(we.code))we.preventDefault(),Z(we.code==="ArrowUp"?"up":"down");else if(we.code==="Enter"){we.preventDefault();const de=I[v];de&&_e({...de,addedToTabSelection:!0})}else we.code==="Tab"&&((Ke=p.current)==null||Ke.focus())},[Z,v,I,_e]);m.useEffect(()=>(Mt.on("multi-tabs:search",re),Mt.on("multi-tabs:key-down",ye),()=>{Mt.off("multi-tabs:search",re),Mt.off("multi-tabs:key-down",ye)}),[ye,re]),Kc({onOutsideEvent:o,elements:[p,...i],invokeOnce:!1,shouldAttachListeners:w}),m.useEffect(()=>{A(!0)},[]);const Se=m.useMemo(()=>E?dye:uye,[E]),Ne=m.useMemo(()=>({maxHeight:`${R>Se?Se:R}px`,...e}),[R,Se,e]);return d.jsxs(Sl.Motion,{className:nt(Xt.modal,"pointer-events-auto relative z-40 box-border flex max-h-[400px] w-full flex-col rounded-b-6xl rounded-t-4xl border border-white p-4 shadow-lg backdrop-blur-2xl backdrop-saturate-150 contrast-more:border-2 dark:border-white/10","bg-gradient-composer-tabs-menu-light dark:bg-gradient-composer-tabs-menu-dark","bg-blend-normal","forced-colors:bg-stroke-150 dark:forced-colors:bg-midnight-850","contrast-more:bg-stroke-150 dark:contrast-more:bg-midnight-850",E?"px-4 pb-1.5 pt-4":"p-4"),style:Ne,tabbable:!0,tabIndex:0,ref:j,"data-testid":"composer-multi-tabs-menu",initial:"start",animate:"end",variants:{start:dt,end:{...Ot,transition:{duration:sye,delay:aye}}},children:[d.jsxs("div",{className:"flex w-full flex-row items-center justify-between pt-2",children:[d.jsx("span",{className:"font-[500] text-foreground-900 text-xs",children:C(a==="add"?"composer.multiTabs.browserTabMenuTitle":"composer.multiTabs.browserTabMenuTitleForUpdate")}),!E&&d.jsx(Me,{color:"subtle-dimmed",title:C("common.closeText"),size:"32-xs",onClick:o,"aria-label":C("common.closeText"),children:d.jsx(fo,{className:"size-5 cursor-pointer"})})]}),!E&&d.jsx(Ybe,{onChange:re}),d.jsxs("div",{className:nt("relative flex w-full overflow-hidden",E?"mb-0 mt-3":"my-3"),children:[d.jsx("div",{className:nt("t-custom-scrollbar flex w-full flex-col gap-y-1 overflow-y-auto overflow-x-hidden px-0.5 py-0.5"),children:I.length>0?I.map((we,Ke)=>d.jsx(Wbe,{tab:we,onClick:E?_e:Q,showHighlight:Ke===v,ref:Ke===v?b:null,onFocus:()=>{y(Ke)},showActionIcon:!E,className:nt(!E&&"py-2"),totalTabsCount:T,maxSelectedTabsLimit:lf},we.id)):d.jsx("span",{className:"-ms-0.5 h-8 leading-8 text-foreground-850 text-xs",role:"status",children:f.length===0?C("composer.multiTabs.noTabsOpen"):C("composer.multiTabs.noTabsFound")})}),I.length>=4&&E&&d.jsx("div",{className:nt("pointer-events-none absolute inset-x-0 bottom-0 h-8 rounded-b-lg px-4","bg-gradient-composer-tabs-menu-mask-light dark:bg-gradient-composer-tabs-menu-mask-dark")})]}),!E&&d.jsx(Me,{title:C("composer.multiTabs.browserTabMenuShareButton"),className:"mx-auto mt-auto w-full flex-none",disabled:ue,onClick:te,color:"strong",size:"48-lg","aria-label":C("composer.multiTabs.browserTabMenuShareButton"),children:C(a==="add"?"composer.multiTabs.browserTabMenuShareButton":"composer.multiTabs.browserTabMenuShareButtonForUpdate")})]})}const yU=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{id:"Shape",d:"M2 6.25C2 4.45507 3.45507 3 5.25 3H18.75C20.5449 3 22 4.45507 22 6.25V12H20.5V6.25C20.5 5.2835 19.7165 4.5 18.75 4.5H5.25C4.2835 4.5 3.5 5.2835 3.5 6.25V15.75C3.5 16.7165 4.2835 17.5 5.25 17.5H11V19H5.25C3.45507 19 2 17.5449 2 15.75V6.25ZM14 13C12.8954 13 12 13.8954 12 15V20C12 21.1046 12.8954 22 14 22H21C22.1046 22 23 21.1046 23 20V15C23 13.8954 22.1046 13 21 13H14Z",fill:"currentColor"})),p2e=Object.freeze(Object.defineProperty({__proto__:null,default:yU},Symbol.toStringTag,{value:"Module"}));function gye(t){const{onClick:e}=t,{t:n}=Oe();return d.jsx(Jo,{data:{title:n("videoCard.pictureInPicture.miniPlayer"),testId:"trigger-picture-in-picture",isVisible:!0,onClick:e},children:d.jsx(yU,{className:"size-6","aria-hidden":!0})})}function Jw(){return L(Or)==="US"&&be.instance().config().proSubscription.enabled}function vye(t){const{title:e,onClick:n,appearDelay:r,appearDuration:o,voiceAvailabilityStatus:i,payflowSkuType:s}=t,a=Jw(),c=L(An);return m.useEffect(()=>{c!=null&&c.accountType&&z.trackEvent({name:"interaction",data:{eventName:"payflowEntryImpression",eventInfo_loginProvider:c.accountType,eventInfo_actionButton:"GetCopilotPro",eventInfo_payflowEntryPoint:"VoiceLimit",eventInfo_payflowType:a?"ProSubPaywall":"UniPux",eventInfo_payflowSkuType:s,eventInfo_upsellReason:i,eventInfo_upsellEntryStyle:"Button"}})},[i,s,a,c==null?void 0:c.accountType]),d.jsx($w,{className:"mx-2",title:e,onClick:n,appearDelay:r,appearDuration:o})}const bye="https://content.lifecycle.office.net/dime/v1/dime.js";function yye(){return new Promise((t,e)=>{const n=document.createElement("script");n.src=bye,n.type="text/javascript",n.async=!0,n.onload=()=>{t()},n.onerror=()=>{e(new Error("Failed to load Dime script"))},document.head.appendChild(n)})}const eP=new al(yye);async function Cye({language:t,market:e,sessionId:n}){var r;try{const[o]=await Promise.all([jle(),eP.get()]);return new window.Dime({language:t,market:e,sessionId:n,partnerId:"cmc",authHint:o==null?void 0:o.username,userInfo:{puid:(r=o==null?void 0:o.idTokenClaims)==null?void 0:r.puid}})}catch(o){return eP.reset(),console.log("Failed to load Dime script",o),null}}const l0=new al(t=>Cye(t));var Ou,Xf;class Sye{constructor(){ln(this,Ou,ci("pfcid")??crypto.randomUUID());ln(this,Xf);W(this,"ensureDime",async({language:e,market:n})=>(e!==he(this,Xf)&&l0.reset(),Bt(this,Xf,e),l0.get({language:e,market:n,sessionId:he(this,Ou)})));W(this,"overrideSessionId",e=>{l0.reset(),Bt(this,Ou,e)})}get sessionId(){return he(this,Ou)}}Ou=new WeakMap,Xf=new WeakMap;const u0=new Sye;function d0(t){return t instanceof Error?{errorCode:t.toString(),errorDetails:t.message}:{errorCode:"unknown",errorDetails:String(t)}}function Vd(t,e,n){const r={eventInfo_payflowEntryPoint:e.payflowEntryPoint,eventInfo_upsellReason:e.upsellReason,eventInfo_loginProvider:e.loginProvider,eventInfo_payflowType:"DIME",eventInfo_payflowInstanceId:e.payflowInstanceId,eventInfo_curatedSubscription:e.curatedSubscription,eventInfo_correlationId:e.correlationId,eventInfo_dimeMarket:e.dimeMarket,eventInfo_campaignId:e.campaignId};let o;switch(t){case"payflowEnter":o={eventName:"payflowEnter",...r,eventInfo_upsellEntryStyle:(n==null?void 0:n.eventInfo_upsellEntryStyle)||"Banner"};break;case"payflowLoginClick":o={eventName:"payflowLoginClick",...r};break;case"dimeCheckoutRendering":o={eventName:"dimeCheckoutRendering",...r};break;case"dimeCheckoutSuccess":o={eventName:"dimeCheckoutSuccess",...r};break;case"dimeCheckoutClosed":o={eventName:"dimeCheckoutClosed",...r};break;case"dimeCheckoutError":o={eventName:"dimeCheckoutError",eventInfo_errorCode:(n==null?void 0:n.eventInfo_errorCode)??"",eventInfo_errorDetails:(n==null?void 0:n.eventInfo_errorDetails)??"",...r};break;default:o={eventName:"unknown",...r};break}z.trackEvent({name:"interaction",data:o})}function Eye(t){Vd("payflowEnter",t,{eventInfo_upsellEntryStyle:"Banner"})}function m2e(t){Vd("payflowLoginClick",t)}function Iye(t){Vd("dimeCheckoutRendering",t)}function Tye(t){Vd("dimeCheckoutSuccess",t)}function _ye(t){Vd("dimeCheckoutClosed",t)}function g2e(t){z.trackEvent({name:"interaction",data:{eventName:"manageSubPageActionClick",eventInfo_loginProvider:t.loginProvider,eventInfo_curatedSubscription:t.curatedSubscription,eventInfo_actionTarget:t.actionTarget}})}function v2e(t){z.trackEvent({name:"interaction",data:{eventName:"manageSubFREShown",eventInfo_loginProvider:t.loginProvider,eventInfo_curatedSubscription:t.curatedSubscription}})}function b2e(t){z.trackEvent({name:"interaction",data:{eventName:"manageSubPageLoaded",eventInfo_loginProvider:t.loginProvider,eventInfo_curatedSubscription:t.curatedSubscription,eventInfo_willShowFre:t.willShowFre,eventInfo_willShowProDeprecation:t.willShowProDeprecation,eventInfo_upgradeButtonShown:t.upgradeButtonShown,eventInfo_upgradeButtonTarget:t.upgradeButtonTarget,eventInfo_manageButtonShown:t.manageButtonShown,eventInfo_manageButtonTarget:t.manageButtonTarget,eventInfo_cancelButtonShown:t.cancelButtonShown,eventInfo_cancelButtonTarget:t.cancelButtonTarget,eventInfo_proAutoRenewOn:t.proAutoRenewOn}})}function h0(t){Vd("dimeCheckoutError",t,{eventInfo_errorCode:t.errorCode,eventInfo_errorDetails:t.errorDetails})}const CU="https://go.microsoft.com/fwlink/?linkid=2281226&client=cmc&ocid=cmme6wdx8nv",wye="sapphire://payment",SU="cmme6wdx8nv",EU="cmmjacjzqcs";function IU(t){const{urlParams:e}=be.instance().config().proSubscription;if(!e)return CU;const{client:n}=e,{linkid:r,ocid:o,language:i,market:s}=t,a=new URL("https://go.microsoft.com/fwlink/");return a.searchParams.append("linkid",r),a.searchParams.append("client",n),a.searchParams.append("ocid",o),s&&a.searchParams.append("market",s),i&&a.searchParams.append("language",i),a.toString()}function tP(t,e,n,r){var u,h,p;const{urlParams:o}=be.instance().config().proSubscription;if(!o)return CU;const{ocids:i}=o,s=e?(u=i[t])==null?void 0:u.freeTrial:(h=i[t])==null?void 0:h.buy,a=r??((p=i[t])==null?void 0:p.market);return IU({linkid:e?"2243582":"2281226",ocid:s??SU,language:n,market:a})}function Aye(t,e,n){return IU({linkid:"2281226",ocid:t??EU,language:e,market:n})}const kye="https://account.microsoft.com/services/copilot/details",xye="https://account.microsoft.com/services/microsoft365/details",y2e="https://account.microsoft.com/";function C2e({entryPoint:t,isPro:e}){const{manageRefId:n}=be.instance().config().proSubscription,r=`copilot.${n}.${t}`,o=new URL(e?kye:xye);return o.searchParams.append("ref",r),o.hash="billing",o.toString()}function nP(t){be.instance().config().subscribeInNewWindow?pl(t):Tp(t)}function Gv(t){const{payflowEntryPoint:e,skuType:n,upsellReason:r,beforeNavigate:o,entryStyle:i,preferPremium:s=!1,enableDimePreload:a=!1}=t,c=Ft(),u=pi(),h=le("pro-sub-dime"),p=le("cmc-m365-sku"),f=h||p,g=Jw(),v=be.instance().config().proSubscription.enabled,y=L(_b),b=L(Or),{i18n:{resolvedLanguage:C}}=Oe(),S=L(An),E=Ee(Yr),I=L(Ns),T=L(gL),_=L(HJ),{shouldRedirectMobile:w,redirectMobileSource:A}=lG(_??null),M=Ee(XO),R=m.useMemo(()=>p?aG(T,s):"gopremium",[p,s,T]);m.useEffect(()=>{f&&a&&R&&(async()=>{if((await _E.get()).supportsPwBBroker()){const Q=await u0.ensureDime({language:C??"en-US",market:b});return Q==null?void 0:Q.preload({experiences:[R]})}return Promise.resolve()})()},[C,b,R,f,a]);const $=h?EU:SU,V=m.useCallback(()=>{switch(e){case"VoiceLimit":return AO()?wye:v?tP(e,y,"",b):"";default:return tP(e,y,"",b)}},[v,y,e,b]),ie=m.useCallback(async()=>{const U=crypto.randomUUID();if(z.trackEvent({name:"interaction",data:{eventName:"payflowEnter",eventInfo_payflowCorrelationId:U,eventInfo_loginProvider:(S==null?void 0:S.accountType)??"unknown",eventInfo_payflowEntryPoint:e,eventInfo_payflowType:g?"ProSubPaywall":"UniPux",eventInfo_payflowSkuType:n,eventInfo_upsellReason:r,eventInfo_upsellEntryStyle:i}}),g)o&&typeof o=="function"&&o(),await u({to:`/pro/subscribe?payflow-correlationId=${U}&entry-point=${e}`,from:c});else{const te=V();nP(te)}},[i,g,c,e,n,r,S==null?void 0:S.accountType,o,V,u]),N=m.useCallback(()=>{const U=Aye($,"",b);nP(U)},[$,b]),Y=m.useMemo(()=>({payflowEntryPoint:e,upsellReason:r??"unknown",loginProvider:(S==null?void 0:S.accountType)??"unknown",curatedSubscription:(_==null?void 0:_.tier)??"unknown",campaignId:$,dimeMarket:b??"unknown",correlationId:u0.sessionId}),[e,r,S==null?void 0:S.accountType,_==null?void 0:_.tier,$,b]),ue=m.useCallback(async U=>{const te={...Y,payflowInstanceId:U};Eye({...te});const Q=await u0.ensureDime({language:C??"en-US",market:b});if(!R)throw new Error("No dime experience available");if(Q)try{Iye({...te}),(await Q.launch({experience:R,theme:I??"light",campaignId:$},()=>{Tye({...te})})).status==="Success"?_p():_ye({...te})}catch(re){h0({...te,...d0(re)}),N()}else h0({...te,...d0(new Error("Dime not a valid instance"))}),N()},[C,b,I,R,$,Y,N]);return{handleProSubscription:m.useCallback(async()=>{if(p&&w&&A!==null){M(A);return}if((!g||f)&&(S==null?void 0:S.provider)==="auth0"){E("upsell-microsoft-account-for-pro-subscription");return}const U=await _E.get();if(f&&U.supportsPwBBroker()){const te=crypto.randomUUID();try{await ue(te)}catch(Q){h0({...Y,...d0(Q),payflowInstanceId:te}),N()}}else ie()},[f,ue,S==null?void 0:S.provider,g,ie,E,Y,N,w,A,M,p])}}function TU(t){const{provider:e="microsoft",scenario:n,from:r}=t,o=Qc(),i=pi(),{login:s}=Bd();return m.useCallback(async()=>{if(n&&Tn({source:"signin",scenario:n}),o){await i({from:r,to:"/login"});return}await s({provider:e})},[r,i,o,s,e,n])}function Rye(){const{t}=Oe(),e=L(Vh),n=Lr(),r=L(wb),o=be.instance().config().proSubscription.enabled,i=L(_b),s=o&&i&&!r,a=Qc(),c=L(An),u=Ee(Yr),h=TU({scenario:"voice",from:"/"}),{handleProSubscription:p}=Gv({payflowEntryPoint:"VoiceLimit",skuType:s?"FreeTrial":"1Mo-Paid",upsellReason:e,entryStyle:"Button"});if(m.useEffect(()=>{r&&(c!=null&&c.accountType)&&z.trackEvent({name:"interaction",data:{eventName:"payflowHiddenEntryImpressionForTeenUser",eventInfo_loginProvider:c.accountType,eventInfo_actionButton:"GetCopilotPro",eventInfo_payflowEntryPoint:"VoiceLimit",eventInfo_payflowType:"UniPux",eventInfo_payflowSkuType:s?"FreeTrial":"1Mo-Paid",eventInfo_upsellReason:e}})},[e,r,n,s,c==null?void 0:c.accountType]),!r)return n?d.jsx(vye,{voiceAvailabilityStatus:e,payflowSkuType:s?"FreeTrial":"1Mo-Paid",title:t(s?"voice.freeTrialToPro":"voice.v2.subscribeToPro"),onClick:async()=>{if(a&&(c==null?void 0:c.provider)==="auth0"){u("upsell-microsoft-account-for-pro-subscription");return}Tn({source:"subscribeCopilotPro",scenario:"voice"}),await p()}}):d.jsx($w,{className:"mx-2",title:t("voice.signUpOrLogin"),onClick:h})}const Nye="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/settings-B9ohU3kQ.svg",_U=t=>m.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M6.74707 3.99954H10.2113C10.6255 3.99954 10.9613 4.33533 10.9613 4.74954C10.9613 5.12924 10.6791 5.44303 10.313 5.49269L10.2113 5.49954H6.74707C5.55621 5.49954 4.58143 6.4247 4.50226 7.59549L4.49707 7.74954V17.2495C4.49707 18.4404 5.42223 19.4152 6.59302 19.4944L6.74707 19.4995H16.2478C17.4387 19.4995 18.4134 18.5744 18.4926 17.4036L18.4978 17.2495V16.7518C18.4978 16.3375 18.8336 16.0018 19.2478 16.0018C19.6275 16.0018 19.9413 16.2839 19.991 16.65L19.9978 16.7518V17.2495C19.9978 19.2538 18.4254 20.8908 16.447 20.9943L16.2478 20.9995H6.74707C4.74281 20.9995 3.1058 19.4272 3.00227 17.4487L2.99707 17.2495V7.74954C2.99707 5.74528 4.56943 4.10827 6.54791 4.00474L6.74707 3.99954H10.2113H6.74707ZM14.5011 6.5194V3.74954C14.5011 3.12557 15.2078 2.78949 15.688 3.13934L15.7702 3.20828L21.7648 8.95828C22.0446 9.22663 22.0701 9.65765 21.8412 9.95561L21.7649 10.0407L15.7703 15.7926C15.32 16.2246 14.5881 15.9472 14.5082 15.3584L14.5011 15.2514V12.5261L14.1576 12.5562C11.7579 12.8065 9.45784 13.8874 7.24302 15.8169C6.72391 16.2691 5.92078 15.8415 6.00616 15.1584C6.67094 9.83884 9.45282 6.90684 14.2017 6.53904L14.5011 6.5194V3.74954V6.5194ZM16.0011 5.50818V7.24954C16.0011 7.66375 15.6653 7.99954 15.2511 7.99954C11.3777 7.99954 8.97704 9.67567 7.9398 13.1567L7.86074 13.4353L8.21293 13.1985C10.4494 11.7367 12.7988 10.9995 15.2511 10.9995C15.6308 10.9995 15.9446 11.2817 15.9942 11.6478L16.0011 11.7495V13.4924L20.1623 9.49963L16.0011 5.50818Z",fill:"currentColor"})),S2e=Object.freeze(Object.defineProperty({__proto__:null,default:_U},Symbol.toStringTag,{value:"Module"}));function Zw(){const t=L(rue),e=le("edge-multi-tabs-reverse");return t&&!e}const Pye=st();function Mye(){const t=Zw(),[e,n]=m.useState("add"),[r,o]=m.useState(!1),[i,s]=m.useState(!1),[a,c]=it(Sj),u=Ee(Ia),{refs:h,floatingStyles:p}=kM({placement:"top-start",strategy:"absolute",whileElementsMounted:fd,middleware:[pd(()=>({mainAxis:6,crossAxis:0})),md({padding:12}),wM({apply({rects:C,elements:S}){Object.assign(S.floating.style,{width:`${C.reference.width}px`})}})]}),f=m.useCallback(async C=>{const{isTrigger:S,keyword:E}=C;c(S),S&&(Mt.emit("multi-tabs:search",E),n("add")),o(S)},[c,o]),g=m.useCallback(()=>{a&&(c(!1),Mt.emit("mention:cancel","ignore")),o(!1)},[a,c]),v=m.useCallback(()=>{a&&(Mt.emit("mention:cancel","remove"),c(!1)),o(!1),s(!0),Mt.emit("edge:maybe-fetch-page-context","onSaveMultiTabs")},[a,c]),y=m.useCallback(C=>t&&r&&a?(Mt.emit("multi-tabs:key-down",C),!0):!1,[a,t,r]),b=()=>a&&r&&t;return m.useEffect(()=>{const C=Pye.sub(pt,()=>{o(!1),s(!1),c(!1),u(new Map)});return()=>{C()}},[u,c]),{isMultiTabsMenuExpanded:r,floatingStyles:p,edgeTabMenuRefs:h,setIsMultiTabsMenuExpanded:o,isShowMultiTabsPreviewCard:i,setIsShowMultiTabsPreviewCard:s,handleMentionEvent:f,isMentionTriggered:a,handleMultiTabsMenuSaveBtnEvent:v,handleMultiTabsMenuCloseBtnEvent:g,handleUserInputEnterEvent:b,handleUserInputKeydownEvent:y,multiTabsMenuMode:e,setMultiTabsMenuMode:n}}const Oye=st();function wU(t){Oye.set(fc,t)}function Lye(){const t=le("multiplecharacters"),e=L(cL),[n,r]=it(up);m.useEffect(()=>{t&&!n&&r(e)},[t,e,n,r])}function Ry(){const t=Ft();return t.startsWith("/podcasts")||t.startsWith("/shares/podcasts")}const AU=D(0),kU=D(),xU=D(),E2e=D({}),I2e=D({lastPosition:0,wasPlaying:!1}),$d="daily";function T2e(){z.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"personalizeButton",eventInfo_clickScenario:"",eventInfo_pageName:$d}})}function _2e(t){z.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"TopicSettings_Select",eventInfo_clickScenario:t,eventInfo_pageName:$d}})}function w2e(t){z.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"TopicSettings_UnSelect",eventInfo_clickScenario:t,eventInfo_pageName:$d}})}function A2e(t){z.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"TopicSettings_Save",eventInfo_clickScenario:t.join(","),eventInfo_pageName:$d}})}function k2e(){z.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"TopicSettings_Later",eventInfo_clickScenario:"",eventInfo_pageName:$d}})}const UE={Podcast:"podcastPlayer",DailyBriefing:"dailyBriefingPlayer"},uf={Daily:$d,Podcast:"podcast"},Ks={Skip:"skip",Rewind:"rewind",Play:"play",Pause:"pause",Next:"next",Previous:"previous",Playback:"playback",Mute:"mute",Unmute:"unmute"};function Ka(t,e,n){ht({source:t,pageName:t===UE.Podcast?uf.Podcast:uf.Daily,scenario:e,customData:n})}function RU(t){const{url:e,podcastId:n,schema:r,includeTranscripts:o=!1}=t;return qn(e,r,{query:{podcastId:n,includeTranscripts:String(o)}}).then(i=>i.data)}function Dye(t,e,n,r,o){return r&&n?{url:`/sharing/podcasts/${n}`,schema:Rg}:t?e?{url:`/podcasts/${e}/${t}`,schema:Rg}:{url:"/daily-briefing",podcastId:t,includeTranscripts:o,schema:z5}:null}function jye(){const{podcastId:t,podcastType:e,shareId:n}=cI({strict:!1}),r=L(kU),o=t??r,i=Ry(),s=!!t||i,a=le("db-transcript"),c=Ee(xU),{data:u,isLoading:h,error:p}=hl(Dye(o,e,n,s,a),RU);m.useEffect(()=>{if(u&&s){const v=Rg.parse(u);c(v.podcastId)}},[u,s,c]);const f=()=>s?e?`${uf.Podcast}.${e}`:uf.Podcast:uf.Daily;if(u&&s){const v=Rg.parse(u),{isAvailable:y,podcastId:b,chapters:C,playback:{positionInSeconds:S,chapterId:E}}=v,I=n?`/sharing/podcasts/${n}/Files`:`/podcasts/${e}/${b}/Files`,T=C.map(({id:A,title:M,image:R,audio:$})=>({id:A,title:M,image:{landscape:{...R.landscape,url:`${I}/${R.landscape.name}`},portrait:{...R.portrait,url:`${I}/${R.portrait.name}`}},audio:$})),_={isAvailable:y,podcastId:b,chapters:T.map(A=>({...A,audio:{default:{url:`${I}/${A.audio.name}`,duration:A.audio.duration,transcript:null}},transitionMusic:null,sources:[]})),playback:{position:S,chapterId:E}},w={...v,chapters:T};return{data:_,podcastData:w,isPodcast:s,isLoading:h,error:p,pageImpressionKey:f()}}return{data:!s&&u?z5.parse(u):void 0,isPodcast:s,isLoading:h,error:p,pageImpressionKey:f()}}function x2e(){const{data:t}=hl({url:"/daily-briefing/topics",schema:H5},RU);return{data:t}}async function R2e(t,e){await Wr({path:"/daily-briefing/topics/unfollow",args:{body:{ids:e}}}),await Wr({path:"/daily-briefing/topics/follow",args:{body:{ids:t}}})}function Uye(){const t=pi(),e=Ee(Yr),n=Ee(kU),[r,o]=it(AU),i=m.useCallback(async()=>{await t({from:"/daily",to:"/"}),n(void 0),e(null)},[n,e,t]),s=m.useCallback(async u=>{n(u),o(0),e("daily-briefing-player"),await t({from:"/",to:"/daily"})},[e,o,n,t]),a=m.useCallback(async()=>{o(r),await t({from:"/daily",to:"/topic-selection"}),e(null)},[e,o,r,t]),c=m.useCallback(async()=>{o(r),e("daily-briefing-player"),await t({from:"/topic-selection",to:"/daily"})},[r,o,e,t]);return{navigateToDailyBriefing:s,navigateToTopicSelection:a,exitDailyBriefing:i,returnToDailyBriefing:c,currentChapterIndex:r}}function Fye({media:t,thresholds:e,key:n}){const r=m.useRef(0),o=m.useRef([]),i=m.useRef(new Set);return m.useEffect(()=>{o.current=(e==null?void 0:e.sort((s,a)=>s.seconds-a.seconds))??[]},[e]),m.useEffect(()=>{r.current=0,i.current=new Set;let s=null;if(!t)return()=>{};function a(){s=performance.now()}function c(f){if(s!==null){const g=(performance.now()-s)/1e3;r.current+=g,s=f?performance.now():null,p()}}function u(){c(!1)}function h(){c(!0)}const p=()=>{for(let f=0;f<o.current.length;f+=1){const g=o.current[f];g&&r.current>=g.seconds&&!i.current.has(f)&&(i.current.add(f),g.callback())}};return t.addEventListener("playing",a),t.addEventListener("pause",u),t.addEventListener("ended",u),t.addEventListener("timeupdate",h),()=>{t.removeEventListener("playing",a),t.removeEventListener("pause",u),t.removeEventListener("ended",u),t.removeEventListener("timeupdate",h)}},[t,n]),{totalTimePlayedRef:r}}const Bye=D(!1),Hye=D(null),FE=D(!1),f0=D(!1),BE=D(0),HE=D(0),Ih=D(null),zye=D(!0),Vye=D(-1);function NU(t,e,n){return{DailyBriefing:`${e}|${n}`,Podcast:e}[t]}function rP(t,e,n){const r=NU(t,e,n);r&&Wr({path:`/media/${t}/${r}/playback/completed`,args:{}}).catch(o=>{OO(o)})}function $ye(t,e,n,r){const o=NU(t,n,r);o&&Wr({path:`/media/${t}/${o}/playback`,args:{options:{method:"PATCH"},body:{positionInSeconds:e}}}).catch(i=>{OO(i)})}function p0(t,e){const n=Object.keys(e);if(n.length!==0)return typeof t<"u"&&n.includes(t)?e[t]:Object.values(e)[0]}const Gye=5,Kye=5e3;function PU(){var se,ne;const{exitDailyBriefing:t}=Uye(),{data:e,isPodcast:n,pageImpressionKey:r}=jye(),o=n?UE.Podcast:UE.DailyBriefing,i=L(xU),s=L(lp),a=m.useMemo(()=>e?n?e.chapters.map(K=>{var He;return[((He=K.audio.default)==null?void 0:He.duration)??0]}):e.chapters.map(K=>{var He;const pe=[((He=p0(s,K.audio))==null?void 0:He.duration)??0];return K.transitionMusic&&pe.push(K.transitionMusic.duration),pe}):[],[e,n,s]),[c,u]=it(AU),h=m.useRef(null),[p,f]=m.useState(!1),[g,v]=m.useState(!1),y=c<a.length-1,b=c>0,C=m.useRef(performance.now()),S=m.useRef(performance.now()),E=m.useMemo(()=>{var K;return(K=e==null?void 0:e.chapters[c])!=null&&K.id?e.chapters[c].id:i&&i.split(",")[c]},[e==null?void 0:e.chapters,c,i]),I=m.useMemo(()=>e?n?e.chapters.map(K=>{var pe;return[((pe=K.audio.default)==null?void 0:pe.url)??""]}):e.chapters.map(K=>{var He;const pe=[((He=p0(s,K.audio))==null?void 0:He.url)??""];return K.transitionMusic&&pe.push(K.transitionMusic.url),pe}):[],[e,s,n]),[T,_]=m.useState(0),[w,A]=m.useState([]),[M,R]=m.useState(null),$=JSON.stringify({podcastId:i,eventInfo_chapterId:(se=e==null?void 0:e.chapters[c])==null?void 0:se.id,eventInfo_chapterPlayDuration:performance.now()-C.current}),[V,ie]=it(zye),N=m.useCallback(()=>{ie(K=>{const pe=!K,He=pe?Ks.Mute:Ks.Unmute;return Ka(o,He,$),pe})},[$,o,ie]);Fye({media:M,key:E,thresholds:[{seconds:Gye,callback:()=>{if(E&&!w.includes(E)){try{Wr({path:`/daily-briefing/${E}/viewed`,args:{analytics:{anonymousPath:"/daily-briefing/*/viewed"}}})}catch{}A([...w,E])}}}]}),m.useEffect(()=>{if(!M||!p)return;const K=setInterval(()=>{const pe=M.currentTime;$ye("DailyBriefing",pe,i,E)},Kye);return()=>{clearInterval(K)}},[M,p,E,i]);function Y(){var K;f(!0),(K=h.current)==null||K.playAnimation(),M==null||M.play(),Ka(o,Ks.Play,$)}function ue(){var K;f(!1),(K=h.current)==null||K.pauseAnimation(),M==null||M.pause(),Ka(o,Ks.Pause,$)}function j(K){if(M){const pe=Math.min(M.currentTime+K,M.duration);M.currentTime=pe,Ka(o,Ks.Skip,JSON.stringify({seconds:K}))}}function U(K){if(M){const pe=Math.max(M.currentTime-K,0);M.currentTime=pe,Ka(o,Ks.Rewind,JSON.stringify({seconds:K}))}}function te(){var K,pe,He;rP("DailyBriefing",i,E),e!=null&&e.chapters&&z.trackEvent({name:"system",data:{eventName:"chapterPlayDuration",eventInfo_podcastId:i,eventInfo_chapterIndex:c,eventInfo_isCompleted:c===e.chapters.length-1,eventInfo_publisherName:(pe=(K=e.chapters[c])==null?void 0:K.sources)==null?void 0:pe.map(at=>at.publisherName).join(","),eventInfo_impressionElement:r,eventInfo_customData:JSON.stringify({eventInfo_chapterId:(He=e.chapters[c])==null?void 0:He.id,eventInfo_chapterPlayDuration:performance.now()-C.current})}})}function Q(){rP("Podcast",i),z.trackEvent({name:"system",data:{eventName:"podcastPlayDuration",eventInfo_isCompleted:!0,eventInfo_podcastId:i,eventInfo_podcastPlayDuration:performance.now()-S.current,eventInfo_impressionElement:r}})}function re(){M&&(M.currentTime=0)}function Z(K){te(),C.current=performance.now(),re(),_(0),u(K)}function _e(){y&&(Z(c+1),Ka(o,Ks.Next,$))}function ye(){b&&(Z(c-1),Ka(o,Ks.Previous,$))}function Se(K){M&&(M.playbackRate=K/100)}function Ne(K){const He=(CC.indexOf(K)+1)%CC.length;return CC[He]??hb}function we(){f(!0);const K=I[c]??[];T<K.length-1?_(pe=>pe+1):K.length-1===T&&y?_e():(ge(),t())}function Ke(K){K==="open"&&v(p),K==="close"&&g&&Y()}function de(){C.current=performance.now(),S.current=performance.now()}function ge(){n?Q():te()}const $e=le("db-transcript"),P=m.useMemo(()=>{if(!$e)return[];const K=e==null?void 0:e.chapters[c];if(!K)return[];const pe=p0(s,K.audio);return(pe==null?void 0:pe.transcript)??[]},[$e,s,e==null?void 0:e.chapters,c]),J=m.useMemo(()=>a[c]??[],[a,c]),Te=Ee(Vye),O=m.useCallback((K,pe)=>{if(K.length===0||pe===0)return-1;let He=0,at=K.length-1,ut=0;for(;He<=at;){const Le=Math.floor((He+at)/2),Xe=K[Le];if(!Xe)break;Xe.startTime<=pe?(ut=Le,He=Le+1):at=Le-1}return ut},[]),ce=m.useCallback(K=>{const pe=K.currentTarget;let{currentTime:He}=pe;for(let ut=0;ut<T;ut+=1){const Le=J[ut];Le&&(He+=Le)}if(He===0)return;const at=O(P,He);Te(at)},[J,T,P,O,Te]);return m.useEffect(()=>{if(!(!$e||!M))return M.addEventListener("timeupdate",ce),()=>{M.removeEventListener("timeupdate",ce)}},[M,ce,$e]),{isPlaying:p,currentChapterId:E,currentChapterIndex:c,chapterDurations:a,currentChapterPartIndex:T,audioElement:M,setAudioElement:R,audioChaptersProgressBarRef:h,currentChapterAudioSrc:((ne=I[c])==null?void 0:ne[T])??"",isPlayerMuted:V,currentChapterTranscript:P,play:e?Y:void 0,pause:e?ue:void 0,skipForward:e?K=>j(K):()=>{},skipBack:e?K=>U(K):()=>{},goToNextChapter:y?_e:void 0,goToPreviousChapter:b?ye:void 0,getNextPlaybackSpeed:e?K=>Ne(K):void 0,applyPlaybackRate:e?K=>Se(K):()=>{},onChapterEnded:we,onToggleVoiceSettings:Ke,resetAllTimers:de,trackPlayerEndEvents:ge,togglePlayerMuted:N}}function qye(){const{currentChapterId:t}=PU();return m.useMemo(()=>{if(t)return{type:"dailyBriefing",chapterId:t}},[t])}function Wye(t){const[e,n]=m.useState(0);return m.useEffect(()=>{if(!t)return()=>{};const r=a=>{a.preventDefault(),n(c=>c+1)},o=a=>{a.preventDefault(),n(c=>Math.max(0,c-1))},i=a=>{a.preventDefault(),n(0)},s=()=>{document.hidden&&n(0)};return window.addEventListener("dragenter",r,!0),window.addEventListener("dragleave",o,!0),window.addEventListener("drop",i,!0),document.addEventListener("visibilitychange",s),()=>{window.removeEventListener("dragenter",r,!0),window.removeEventListener("dragleave",o,!0),window.removeEventListener("drop",i,!0),document.removeEventListener("visibilitychange",s)}},[t]),e>0}async function Yye(t,e){try{const n=await t.arrayBuffer(),r=new Uint8Array(n),o=await qn("/attachments",fQ,{options:{method:"POST",headers:{"Content-Type":xs(t)},body:new Blob([r]),signal:e}}).then(i=>i.data);if("errorCode"in o)throw new Error(o.errorCode);return o.url}catch(n){throw console.error("Error uploading image",n),n}}async function Qye(t,e){try{const n=new FormData;t.type!==""?n.append("file",t):n.append("file",new File([t],t.name,{type:xs(t)}),t.name);const r=await qn("/attachments",G5,{options:{method:"POST",body:n,signal:e}}).then(o=>o.data);if("errorCode"in r)throw new Error(r.errorCode);return r.id}catch(n){throw console.error("Error uploading document",n),n}}async function Jye(t,e){try{const n=await qn("/attachments/onedrive",G5,{options:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id}),signal:e}}).then(r=>r.data);if("errorCode"in n)throw new Error(n.errorCode);return n.id}catch(n){throw console.error("Error uploading OneDrive file",n),n}}async function Zye(t,e){switch(t.kind){case"local-file":return Qye(t.file,e);case"onedrive":return Jye(t.item,e);default:{const n=t;throw new Error(`Unhandled upload kind: ${n}`)}}}async function Xye(t){const{uploadTasks:e,signal:n,onSuccess:r,onError:o,onFinish:i,scenario:s}=t,a=e.map(async c=>{const u=c.upload;try{if(c.type==="document"){const p={content:{type:"document",attachmentId:await Zye(c.upload,n)},item:{type:"document",partId:c.partId,fileName:c.metadata.name,contentType:c.metadata.contentType},size:c.metadata.size,type:c.metadata.contentType},f={id:c.id,file:c.upload.file,scenario:s,processing:!1,attachment:p};r(f)}else{const h=await Yye(u.file,n),p={content:{type:"image",url:h},item:{type:"image",url:h},size:c.metadata.size,type:c.metadata.contentType},f={id:c.id,file:u.file,scenario:s,processing:!1,attachment:p};r(f)}}catch(h){o&&o(h,c)}finally{i()}return null});return Promise.all(a)}function N2e(t,e){const n=e.split(".").pop()??"";return`/attachments/${t}.${n}`}function oP(t){switch(t.kind){case"local-file":{const{file:e}=t;return{name:e.name,contentType:xs(e),size:e.size}}case"onedrive":{const{item:e}=t;return{name:e.name,contentType:xw(e.name),size:e.size}}default:{const e=t;throw new Error(`Unhandled upload kind: ${e}`)}}}function eCe(t){const[e,n]=it(i9),r=m.useRef(new Set),o=m.useRef(0),i=Ee(ml),s=m.useCallback(()=>{for(const f of r.current)f.abort();r.current.clear()},[]);m.useEffect(()=>()=>{s()},[s]);const a=m.useCallback((f,g)=>{i({isOpen:!0,scenario:g??null,reason:f})},[i]),c=m.useCallback(()=>{a("fileUpload")},[a]),u=m.useCallback(()=>{n([],t),o.current=0,s()},[s,n,t]),h=m.useCallback(async f=>{const{uploads:g,scenario:v,onError:y,replaceExisting:b=!1,shouldUploadImageAsDocument:C}=f;b&&u();const S=[],E=[];for(const T of g){const _=oP(T),w=kp(_.contentType),A=`file-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;if(w||C){const M=String(o.current);o.current+=1,S.push({id:A,upload:T,partId:M,metadata:_,type:"document"}),E.push({id:A,file:T.file,scenario:v,processing:!0})}else S.push({id:A,upload:T,metadata:_,type:"image"}),E.push({id:A,file:T.file,scenario:v,processing:!0})}n(T=>[...T,...E],t);const I=new AbortController;r.current.add(I),await Xye({signal:I.signal,uploadTasks:S,onSuccess:T=>{n(_=>_.map(w=>w.id===T.id?T:w),t)},onError:(T,_)=>{if(T instanceof Error&&T.message==="not-signed-in")throw u(),c(),T;const w={id:_.id,file:_.upload.file,scenario:v,processing:!1,error:T};n(A=>A.map(M=>M.id===_.id?w:M),t),y&&y(T,_.upload)},onFinish:()=>{r.current.delete(I)}})},[u,c,n,t]),p=m.useCallback(f=>{n(g=>{const v=[...g];return v.splice(f,1),v},t)},[n,t]);return{uploadedAttachments:e,isUploadingAttachments:e.some(f=>f.processing===!0),clearAttachments:u,uploadAttachments:h,getUploadMetadata:oP,removeAttachmentByIndex:p}}function tCe(t,e,n,r){const{t:o}=Oe(),{clearAttachments:i,uploadAttachments:s,getUploadMetadata:a,isUploadingAttachments:c,uploadedAttachments:u,removeAttachmentByIndex:h}=eCe(),p=m.useCallback(async y=>{const{uploads:b,scenario:C,replaceExisting:S=!0,supportedMimeTypes:E=Ta}=y,I=u.filter(({error:T})=>!T).length;if(!S&&I+b.length>PE){e({title:o("composer.errors.multi.tooManyFiles.title",{maxFiles:PE}),message:o("composer.errors.multi.tooManyFiles.message")});return}for(const T of b){const _=Hfe(T.file,{supportedMimeTypes:E});if(_){e(_),n();return}}t();try{await s({uploads:b,scenario:C,replaceExisting:S,onError:(T,_)=>{if(T instanceof Error){e(S9(T.message));const{name:w,size:A}=a(_);$fe({name:w,size:A,message:T.message,kind:_.kind})}else e({title:o("composer.errors.default.title"),message:o("composer.errors.default.message")})}})}catch(T){T instanceof Error&&T.message==="not-signed-in"?r():e({title:o("composer.errors.default.title"),message:o("composer.errors.default.message")})}},[u,t,e,o,n,s,a,r]),f=m.useCallback(async y=>{const{rawFiles:b,scenario:C,replaceExisting:S=!0,supportedMimeTypes:E=Ta}=y;if(b.length===0)return;const I=[];for(const T of b)I.push({file:zfe(T),kind:"local-file"});await p({uploads:I,scenario:C,replaceExisting:S,supportedMimeTypes:E})},[p]),g=m.useCallback(()=>{i(),n()},[i,n]),v=m.useCallback(y=>{u.length===1?g():h(y)},[h,u,g]);return{processUploadedFiles:p,processUploadedLocalFiles:f,isUploadingAttachments:c,uploadedAttachments:u,resetFileUpload:g,removeAttachment:v}}function Xw(){const t=pr({breakpoint:"sm"});return(be.instance().config().responsiveFullWidthSidebarEnabled??!1)&&t}function Ny(){var r;const t=L(kr)==="side-by-side",e=pr({breakpoint:"sm"}),n=!!((r=be.instance().config().actions)!=null&&r.alwaysLayoutChatDetailsOverChat);return t&&(e||n)}function MU(t){return t.map(e=>{if(e.author==="human"||!e.content.find(a=>a.type==="citation"))return e;const r=e.content.find(a=>a.type==="text");if(!r)return e;const o=e.content.filter(a=>a.type==="citation").sort((a,c)=>a.position-c.position),{text:i,citationMetadata:s}=nCe(r.text,o);return r.text=i,r.citations=s,e})}function nCe(t,e){if(!e)return{text:t,citationMetadata:[]};let n=t;const r=[];let o=0;const i=new Map;for(const a of e){const c=a.url;if(!i.has(c)){o+=1;const u=`${o}`;i.set(c,u),r.push({index:u,title:a.title,url:a.url,iconUrl:a.iconUrl??null,publisher:a.publisher??null})}}const s=e.map((a,c)=>({citation:a,originalIndex:c})).sort((a,c)=>{const u=c.citation.position-a.citation.position;return u!==0?u:c.originalIndex-a.originalIndex}).map(a=>a.citation);for(const a of s){const c=a.url,u=i.get(c);u!==void 0&&(n=WB(n,n9(u,a.url),a.position))}return{text:n,citationMetadata:r}}function rCe(){const t=Rj(),{conversationId:e}=cI({strict:!1}),{data:n,error:r,isLoading:o}=tB({queryKey:["sharePage",e],queryFn:()=>oCe(`/conversations/shares/${e}`),staleTime:1/0,enabled:t&&!!e});return{data:n,error:r,isLoading:o}}async function oCe(t){const{data:e,response:n}=await qn(t,aJ,{parseOptions:{safe:!0},analytics:{anonymousPath:"/conversations/shares/*"}});if(n.status>=400&&n.status<500)throw new iCe(n.status.toString());return{...e,messages:MU(e.messages.reverse())}}class iCe extends Error{}function sCe(){const t=Rj(),{isMediaViewerOpen:e}=Na(),n=L(Yr),r=le("share-continue-v2"),{error:o}=rCe();return t?o?!1:r||e||!!n:!0}function eA(){return Ew("(hover: hover) and (pointer: fine)")}const aCe={h550:"550",h600:"600",h760:"760"};function Kv(t){const{breakpoint:e}=t,n=aCe[e];return!Ew(`(min-height: ${n}px)`)}function Np(){const t=Ge(Zi),e=Ge(go);return t.length===0&&!!(e!=null&&e.isNew)}function cCe(){try{return El.latestLocation.pathname}catch{return typeof window<"u"&&window.location.pathname?window.location.pathname:"/"}}function Gd(){const t=cCe(),e=t.endsWith("/talk"),n=t.startsWith("/chats")&&!e,r=t.endsWith("/landing");return n||r}function Py(){return!Ge(KI)}function lCe(){var s;const t=Py(),e=Ge(TT),n=Ge(Ep),r=Np(),o=Gd(),i=!!((s=be.instance().config().landingPage)!=null&&s.enableCentralComposer);return t&&!e&&n==="center"&&o&&r&&i}function uCe(){var o;const t=Py(),e=Np(),n=Gd(),r=!!((o=be.instance().config().landingPage)!=null&&o.enableStarterPrompts);return t&&n&&e&&r}function OU(){var i;const t=Py(),e=Np(),n=Gd(),r=Ge($J),o=!!((i=be.instance().config().landingPage)!=null&&i.enableWidgets);return t&&r&&n&&e&&o}function dCe(){const t=Py(),e=Np(),n=Gd(),r=OU(),o=We("appr-home");return t&&n&&e&&o&&!r}function LU(){var s;const t=We("autosuggest"),e=We("edge-autosuggest"),n=Np(),r=Gd(),o=t||e,i=!!((s=be.instance().config().landingPage)!=null&&s.enableAutoSuggest);return o&&i&&r&&n}function Pp(){return{isCompatibleLandingRoute:Gd(),isAutoSuggestEnabled:LU(),isCentralComposerEnabled:lCe(),isStarterPromptsEnabled:uCe(),isWidgetSectionEnabled:OU(),isAppearanceOnHomeEnabled:dCe()}}function hCe(){var r;const t=Ft(),e=le("cmc-landing"),n=!!((r=be.instance().config().landingPage)!=null&&r.enableLandingRoute);return e&&n&&t.endsWith("/landing")}function fCe(){const t=Ft();return{isLivingPortraitEnabled:le("labs-portrait-enabled")&&t.startsWith("/labs/experiments/portrait")}}const pCe=D(),mCe=/\/(?:.*\/)?(ar|vi|gm)-([a-zA-Z0-9]{6,10})/,gCe="gemSnapshotKey";function vCe(){const t=L(pCe),{contentPageType:e}=Na();return m.useMemo(()=>{if(!(!t||!e))try{const n=t.pathname.match(mCe),r=(n==null?void 0:n[2])??null;if(!r)return;switch(e){case"newsGem":{const o=t.searchParams.get(gCe);return o?{type:"newsGem",gemId:r,snapshotKey:o}:void 0}case"newsArticle":return{type:"news",articleId:r};default:return}}catch{return}},[t,e])}function bCe(){const t=pi(),e=Zv();return m.useCallback(async()=>{await t({to:"/agents",params:{},from:e.state.location.pathname})},[t,e.state.location.pathname])}function yCe(){const t=Fo("kill-domain-referrer");return m.useCallback(e=>pl(e,{preventReferrer:t}),[t])}function CCe(){var h,p,f;const t=le("cross-promo-popup"),e=(f=(p=(h=be.instance().config().crossPromotion)==null?void 0:h.aggressive)==null?void 0:p.popup)==null?void 0:f.secondDay,n=Sn(Q0),r=!Hv(n,Ig),o=Sn(HI),i=!Hv(o,2*Ig),s=Sn(wg),a=Sw(s,2),c=L(QI);return m.useMemo(()=>!!(r&&t&&i&&a&&e&&(c===!0?!1:c!==void 0)),[e,t,i,a,r,c])}function vu(t){const{name:e,status:n,eventName:r,source:o,isMobile:i}=t;z.trackEvent({name:e,data:{eventName:r,eventInfo_source:o,eventInfo_isMobilePlatform:i,eventInfo_status:n}})}function DU(){const[t,e]=it(fs),n=le("cross-promo-popup"),r=le("top-banner-cross-promo-desktop");let o="setting";(n||(t==null?void 0:t.type)==="popup")&&(o="popup"),r&&(o="topBanner"),(t==null?void 0:t.type)==="card"&&(o="bottomRightCard");const i=Ee(Yr);return m.useCallback(()=>{const s=Date.now().toString();ar(HI,s);const a=Sn(wg);ar(wg,(parseInt(a??"0",10)+1).toString()),vu({name:"interaction",status:"Dismissed",eventName:"crossPromotionStripCard",source:o}),i(null),e(null)},[o,i,e])}function jU(t){m.useEffect(()=>{const e=()=>{t()};return Nt.on("languageChanged",e),()=>{Nt.off("languageChanged",e)}},[t])}function UU(t){const{onStartComplete:e}=t;m.useEffect(()=>{const n=()=>{e(),Mt.off("app:start-complete",n)};return Mt.on("app:start-complete",n),()=>{Mt.off("app:start-complete",n)}},[e])}const tA=1e3*60*60,SCe={revalidateOnFocus:!1,refreshInterval:tA};async function ECe(t,e,n){return qn(t,gJ,{query:{"api-version":"2",supportedWidgets:e.join(","),...n?{intent:n}:{}},options:{method:"GET",headers:{"Content-Type":"application/json"}},analytics:{anonymousPath:t}}).then(r=>r.data)}function ICe(t){return t?["conversation-starter"]:["conversation-starter","feature-discovery","kickstarter","image-generation","conversation-starter-prompted-greeting"]}function TCe(t){var e;if(t.length>0){if(((e=t[0])==null?void 0:e.type)==="textAndGreeting")return t;const n=t[0];if(n)return[n]}}function _Ce(t){const e=t.toLowerCase();return e==="imagegeneration"||e==="f1"}function wCe(){var p;const t=Ee(vL),[e,n]=m.useState(!1),r=m.useMemo(()=>{const f=c$();if(f&&_Ce(f))return f},[]),o=Ee(Ab),i=Fo("kill-landing-widgets"),s=!!((p=be.instance().config().landingPage)!=null&&p.shouldFetchWidgetsData);UU({onStartComplete:()=>{n(!0)}});const{data:a,isLoading:c,error:u,mutate:h}=hl(e&&s?"/activation/widgets":null,f=>ECe(f,ICe(i),r),SCe);o(c),jU(h),m.useEffect(()=>{if(a!=null&&a.widgets){const f=TCe(a.widgets);t(f)}},[a,t]),m.useEffect(()=>{u&&(z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"widgets",eventInfo_errorMessage:`${u}`,eventInfo_details:"Widget API error"}}),o(!1),t(void 0))},[u,t,o])}function ACe(){const t=L(IT),e=dp(),{isCompatibleLandingRoute:n}=Pp(),r=t&&e&&n;return m.useMemo(()=>{if(r)return{type:"greeting",greetingMessage:t}},[t,r])}function kCe(){const t=Ge(Or);return gw(Nt.resolvedLanguage,t)}function P2e(){const{i18n:t}=Oe(),e=L(Or);return gw(t.resolvedLanguage,e)}const xCe=100,RCe=70,NCe=4,Wc=st(),zE=D(null),FU=D("");let m0=null;function PCe(t){Wc.set(FU,t)}function iP(){return Wc.get(FU)}function bu(t){Wc.set(lw,t)}function BU(){const t=Wc.get(zE);t&&(t.abort(),Wc.set(zE,null))}function MCe(){BU();const t=new AbortController;return Wc.set(zE,t),t}function OCe(t,e,n){const r=new URL("https://www.bing.com/AS/Suggestions/V2?pt=page.chat"),[o,i]=n.split("-");return r.searchParams.set("lang",(o==null?void 0:o.toLowerCase())??"en"),r.searchParams.set("cc",(i==null?void 0:i.toLowerCase())??"us"),r.searchParams.set("qry",t.toLowerCase()),r.searchParams.set("cvid",e),We("encacsc")&&r.searchParams.set("ascopilot1","1"),We("enblsuggrndmzn")&&r.searchParams.set("ascopilot2","1"),We("encpsrchdata")&&r.searchParams.set("ascopilot3","1"),r.toString()}async function LCe(t){const{query:e,conversationId:n,market:r,abortController:o}=t,i=OCe(e,n,r);return fetch(i,{signal:o.signal}).then(s=>s.json())}function DCe(t,e){const n=t.toLowerCase().split(/\s+/),r=e.st.toLowerCase().split(/\s+/);let o=0;for(let c=0;c<Math.min(n.length,r.length)&&n[c]===r[c];c+=1)o+=1;const i=e.st.split(/\s+/),s=i.slice(0,o).join(" "),a=i.slice(o).join(" ");return{original:e.st,sliced:a,prefill:s+(s?" ":"")}}async function jCe(t){var n;const e=Ge(pt);if(e)try{const r=MCe(),o=kCe(),i=performance.now(),s=await LCe({query:t,conversationId:e,market:o,abortController:r});if(t===iP()){if(!s.s.length){bu(null),xr({feature:"fetchChatAutoComplete",errorType:"NoSuggestions",customData:JSON.stringify({conversationId:e})});return}const a=s.s.map(c=>DCe(s.qc.q,c));if(!a.length){bu(null),xr({feature:"fetchChatAutoComplete",errorType:"NoSuggestions",customData:JSON.stringify({conversationId:e})});return}bu({prefill:((n=a[0])==null?void 0:n.prefill)??t,conversationId:e,type:"BCT",suggestions:a.slice(0,NCe)}),ga({feature:"fetchChatAutoComplete",duration:performance.now()-i})}}catch(r){r instanceof DOMException&&r.name==="AbortError"||z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"autosuggest",eventInfo_errorMessage:`${r}`,eventInfo_details:"Autosuggest API error"}}),t===iP()&&bu(null)}}function UCe(t){m0&&clearTimeout(m0),m0=setTimeout(()=>{jCe(t)},xCe)}function HU(t){var o;const e=(o=be.instance().config().landingPage)==null?void 0:o.regexForAutoSuggest,n=We("autosuggest")||We("edge-autosuggest"),r=Ge(pt);if(!n||!e||!e.test(t)||t.length>=RCe){bu(null);return}PCe(t),!t||!r?bu(null):UCe(t)}function Bh(){BU(),Wc.set(lw,null)}function VE(){return VE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},VE.apply(null,arguments)}function FCe(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var BCe=m.useLayoutEffect,HCe=function(e){var n=m.useRef(e);return BCe(function(){n.current=e}),n},sP=function(e,n){if(typeof e=="function"){e(n);return}e.current=n},zCe=function(e,n){var r=m.useRef();return m.useCallback(function(o){e.current=o,r.current&&sP(r.current,null),r.current=n,n&&sP(n,o)},[n])},aP={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},VCe=function(e){Object.keys(aP).forEach(function(n){e.style.setProperty(n,aP[n],"important")})},cP=VCe,Cr=null,lP=function(e,n){var r=e.scrollHeight;return n.sizingStyle.boxSizing==="border-box"?r+n.borderSize:r-n.paddingSize};function $Ce(t,e,n,r){n===void 0&&(n=1),r===void 0&&(r=1/0),Cr||(Cr=document.createElement("textarea"),Cr.setAttribute("tabindex","-1"),Cr.setAttribute("aria-hidden","true"),cP(Cr)),Cr.parentNode===null&&document.body.appendChild(Cr);var o=t.paddingSize,i=t.borderSize,s=t.sizingStyle,a=s.boxSizing;Object.keys(s).forEach(function(f){var g=f;Cr.style[g]=s[g]}),cP(Cr),Cr.value=e;var c=lP(Cr,t);Cr.value=e,c=lP(Cr,t),Cr.value="x";var u=Cr.scrollHeight-o,h=u*n;a==="border-box"&&(h=h+o+i),c=Math.max(h,c);var p=u*r;return a==="border-box"&&(p=p+o+i),c=Math.min(p,c),[c,u]}var uP=function(){},GCe=function(e,n){return e.reduce(function(r,o){return r[o]=n[o],r},{})},KCe=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],qCe=!!document.documentElement.currentStyle,WCe=function(e){var n=window.getComputedStyle(e);if(n===null)return null;var r=GCe(KCe,n),o=r.boxSizing;if(o==="")return null;qCe&&o==="border-box"&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px");var i=parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),s=parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth);return{sizingStyle:r,paddingSize:i,borderSize:s}},YCe=WCe;function zU(t,e,n){var r=HCe(n);m.useLayoutEffect(function(){var o=function(s){return r.current(s)};if(t)return t.addEventListener(e,o),function(){return t.removeEventListener(e,o)}},[])}var QCe=function(e){zU(window,"resize",e)},JCe=function(e){zU(document.fonts,"loadingdone",e)},ZCe=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],XCe=function(e,n){var r=e.cacheMeasurements,o=e.maxRows,i=e.minRows,s=e.onChange,a=s===void 0?uP:s,c=e.onHeightChange,u=c===void 0?uP:c,h=FCe(e,ZCe),p=h.value!==void 0,f=m.useRef(null),g=zCe(f,n),v=m.useRef(0),y=m.useRef(),b=function(){var E=f.current,I=r&&y.current?y.current:YCe(E);if(I){y.current=I;var T=$Ce(I,E.value||E.placeholder||"x",i,o),_=T[0],w=T[1];v.current!==_&&(v.current=_,E.style.setProperty("height",_+"px","important"),u(_,{rowHeight:w}))}},C=function(E){p||b(),a(E)};return m.useLayoutEffect(b),QCe(b),JCe(b),m.createElement("textarea",VE({},h,{onChange:C,ref:g}))},eSe=m.forwardRef(XCe);function tSe(t,e){const n=m.useRef(null);m.useEffect(()=>{const r=t==null?void 0:t.current;if(!r)return;const o=s=>{const a=r.selectionStart,c=r.selectionEnd;if(a!==c&&s.key!=="Backspace"&&s.key!=="Delete")n.current={type:"replace",char:s.key,index:a};else if(s.key==="Backspace"&&a>0){const h=r.value[a-1];h!==void 0&&(n.current={char:h,index:a-1,type:"delete"})}else if(s.key==="Delete"&&a<r.value.length){const h=r.value[a];h!==void 0&&(n.current={char:h,index:a,type:"delete"})}else n.current=null},i=()=>{e&&e(n.current),n.current=null};return r.addEventListener("keydown",o),r.addEventListener("input",i),()=>{r.removeEventListener("keydown",o),r.removeEventListener("input",i)}},[t,e])}const $E="@",nSe=new RegExp(`${$E}([^${$E}]*)`,"g");function rSe(t,e){return[...t.slice(0,e).matchAll(nSe)].map(r=>({keyword:r[1],start:r.index,end:r.index+r[0].length}))}function oSe(t,e){const n=rSe(t,e);if(n.length===0)return;const r=n[n.length-1];return(r==null?void 0:r.end)===e?r:void 0}function iSe(t){const{className:e,textAreaRef:n,onMentionChange:r,textAreaValue:o,onCancelMention:i}=t,[s,a]=m.useState(void 0),{t:c}=Oe(),u=m.useRef(!1),h=m.useRef(r),p=m.useRef(null),f=m.useRef(new Set),g=m.useCallback(S=>{S&&S.char===$E&&S.type!=="insert"&&f.current.delete(S.index)},[]),v=m.useCallback(()=>{a(void 0),p.current=null},[a]);tSe(n,g),m.useEffect(()=>{h.current=r},[r]);const y=m.useCallback(()=>{const S=n==null?void 0:n.current;if(!S)return;const E=S.selectionStart,I=S.selectionEnd;if(E===I){const T=oSe(o,E);T?f.current.has(T.start)?v():(p.current=T,a(_=>_!==T.keyword?T.keyword:_)):v()}},[v,n,o]),b=m.useCallback((S="remove")=>{var w,A;const E=p.current;if(!E)return;if(S==="ignore"){f.current.add(E.start),(w=h.current)==null||w.call(h,{isTrigger:!1}),a(void 0);return}const I=o.slice(0,E.start),T=o.slice(E.end),_=I+T;p.current=null,(A=h.current)==null||A.call(h,{isTrigger:!1}),i==null||i(_)},[i,o]);m.useEffect(()=>{o===""?(v(),f.current.clear()):y()},[y,o,a,v]),m.useEffect(()=>{var S,E;if(!u.current){u.current=!0;return}s!==void 0?(S=h.current)==null||S.call(h,{isTrigger:!0,keyword:s}):(E=h.current)==null||E.call(h,{isTrigger:!1})},[s,h]),m.useEffect(()=>(Mt.on("mention:cancel",b),()=>{Mt.off("mention:cancel",b)}),[b]);const C=s==="";return d.jsxs("div",{className:q("pointer-events-none absolute z-0 overflow-auto",e),"aria-hidden":"true",children:[d.jsx("span",{className:"invisible select-none whitespace-pre-wrap break-words",children:o}),C&&d.jsx("span",{className:"text-foreground-550 dark:text-foreground-600",children:c("userInput.mentionPlaceholderText")})]})}function sSe(t,e){const n=m.useCallback(async r=>{r.key==="Enter"&&!r.shiftKey&&!e&&await t(r)},[t,e]);vl(n)}function aSe(t,e,n){const r=m.useRef(!1),o=m.useCallback(()=>{r.current=!0},[]),i=m.useCallback(()=>{setTimeout(()=>{r.current=!1},100)},[]);return sSe(async s=>{var a;(a=t.current)!=null&&a.contains(document.activeElement)&&!r.current&&(s.preventDefault(),await e())},n),{handleCompositionStart:o,handleCompositionEnd:i}}const cSe="pointer-events-none cursor-not-allowed select-none shadow-none",lSe="opacity-40",uSe=.25,nA="userInput",rA=m.forwardRef((t,e)=>{var _e;const{t:n}=Oe(),{inputValue:r,errorMessage:o,className:i,characterLimit:s,characterLimitErrorMessage:a,disabled:c,placeholder:u=n("userInput.placeholderText"),autoFocus:h=!0,testId:p,setInput:f,setError:g,onBlur:v,onChange:y,onFocus:b,onClick:C,onEnter:S,onKeyDown:E,onMentionIfEnabled:I,rightButtons:T,isMultiLines:_,"aria-autocomplete":w,"aria-controls":A,disabledClassName:M,inputContainerClassName:R}=t,$=Ft(),{isCentralComposerEnabled:V}=Pp(),ie=m.useRef(null),N=m.useRef(null),Y=eA()||be.instance().config().enterKeyButtonEnabled,ue=n("userInput.characterLimitText",{maxCharacters:s.toString()});m.useEffect(()=>{var ye;Y&&((ye=N.current)==null||ye.focus())},[$,Y]);const j=m.useCallback(ye=>{const{value:Se}=ye.target;f(Se),y&&y(Se),Se.length>s?g(a??ue):g(null)},[f,y,s,g,a,ue]);m.useImperativeHandle(e,()=>({updateInputValue:ye=>{const Se=ye(r);f(Se)},focus:()=>{var ye;(ye=N.current)==null||ye.focus()},blur:()=>{var ye;(ye=N.current)==null||ye.blur()},contains:ye=>{var Se;return((Se=N.current)==null?void 0:Se.contains(ye))??!1},updateSelectionRange:(ye,Se)=>{var Ne;(Ne=N.current)==null||Ne.setSelectionRange(ye,Se)},getTextAreaRef(){return N}}),[r,f]),vl(ye=>{var Se,Ne;ye.key==="Escape"&&((Se=ie.current)!=null&&Se.contains(document.activeElement))&&((Ne=N.current)==null||Ne.blur()),E==null||E(ye)});const U=m.useCallback(ye=>{(ye.clipboardData.getData("text/plain")||"").length>0&&ye.stopPropagation()},[]),{handleCompositionStart:te,handleCompositionEnd:Q}=aSe(ie,S,!Y),re=(_e=be.instance().config().composer)==null?void 0:_e.reducedUserInputHeight,Z=c?M??lSe:"";return d.jsxs(Re.div,{className:nt("flex grow items-end",c&&cSe,Z,i),onClick:()=>{var ye;C==null||C(),(ye=N.current)==null||ye.focus()},ref:ie,onBlur:ye=>v==null?void 0:v(ye),layout:"preserve-aspect",children:[d.jsx(Re.div,{className:"relative grow overflow-hidden",layout:!0,children:d.jsx(Re.div,{className:"relative flex size-full cursor-text overflow-hidden text-black dark:text-white",layout:!0,children:d.jsxs(Re.div,{className:"flex grow flex-col gap-4 py-user-input",layout:!0,transition:{duration:0},children:[d.jsx("div",{className:nt("overflow-y-auto px-4",{"max-h-[15dvh]":re,"max-h-user-input-shallow":V&&!re,"max-h-user-input":!V&&!re},be.instance().config().showScrollbarOnHover?"scrollbar-container":"",R),children:d.jsxs("div",{className:"relative",children:[d.jsx("label",{className:nt(["invisible block h-0",{"whitespace-nowrap":!_}]),htmlFor:"userInput",children:u}),d.jsx(eSe,{className:nt("font-ligatures-none inline-block min-h-user-input w-full resize-none overflow-y-hidden whitespace-pre-wrap bg-transparent align-top text-black outline-none placeholder:text-foreground-450 dark:text-white dark:placeholder:text-foreground-600",Qi("composer")??"text-base",Gf("composerVertical")),disabled:c,placeholder:u,ref:N,id:nA,role:"textbox","aria-autocomplete":w,"aria-controls":A,spellCheck:!1,value:r,enterKeyHint:"enter",onChange:j,onFocus:()=>b==null?void 0:b(r),onCompositionStart:te,onCompositionEnd:Q,onPaste:U,autoFocus:h,"data-testid":p}),I&&d.jsx(iSe,{className:nt("font-ligatures-none inline-block min-h-user-input w-full resize-none overflow-y-hidden whitespace-pre-wrap bg-transparent align-top text-black outline-none placeholder:text-foreground-450 dark:text-white dark:placeholder:text-foreground-600",Qi("composer")??"text-base",Gf("composerVertical"),"inset-0"),textAreaRef:N,textAreaValue:r,onMentionChange:I,onCancelMention:ye=>{f(ye),g(null)}})]})}),o&&d.jsx("div",{className:"flex min-h-6 select-none items-center px-4 text-foreground-600 text-xs",children:o})]})})}),d.jsx(Re.div,{className:nt("relative bottom-0 my-1.5 flex h-9 items-center",T!=null&&T.length?"mx-1.5 w-auto gap-1":"w-0"),children:T==null?void 0:T.map((ye,Se)=>d.jsx(Pn,{children:d.jsx(Re.div,{initial:dt,animate:{...Ot,transition:{delay:uSe}},transition:{duration:Oo.default},children:ye})},Se))})]})});rA.displayName="UserInput";const Kd=st(),dSe=500,My=D(""),VU=D("starter-prompts"),$U=D(!0);function GE(t){Kd.set(My,t)}function KE(){Kd.set(My,"")}function ug(t){Kd.set(VU,t)}function Ya(t){Kd.set($U,t)}function GU(t){Kd.set(Cd,t)}function oA(){return L(My)}function hSe(){return L(VU)}function fSe(){return L($U)}const pSe=vU((t,e)=>{TX(Ge(pt),t,JSON.stringify(e))},dSe);function mSe(t,e){pSe(t,e)}function KU(t){const{text:e,attachments:n,inputMethod:r}=t,o=Ge(My),i=We("multiplecharacters"),s=Iw({breakpoint:"sm"}),a=Ge(_n),c=Ge(Yr),u=!zi("kill-chat-message-preview"),h=a==="computerUse",f=LU()&&!c&&!h;if(e||ug("starter-prompts"),Ya(o.length<=0||e.length===0),GU(!1),Kd.set(bb,void 0),mSe(r??"user"),i&&wU("typing"),s&&eZ(),f&&HU(e),wbe()&&a==="smart"&&u)try{ps.sendMessagePreview({text:e,inputMethod:"text",filesWithAttachment:n??[]})}catch{}}function jm(t){const{prompt:e,prefillSource:n}=t,r=document.querySelector(`#${nA}`);r&&(Bh(),GE(e),KU({text:e,inputMethod:n}),setTimeout(()=>{r.focus(),r.setSelectionRange(e.length,e.length)},0))}const gSe=(t,e)=>{var n,r,o,i;if(t==="light"){const s=(r=(n=be.instance().config().composer)==null?void 0:n.shadowBoxStyleOverride)==null?void 0:r.outerLargeBoxShadowLight;if(s)return s;if(e)return Jve}else if(t==="dark"){const s=(i=(o=be.instance().config().composer)==null?void 0:o.shadowBoxStyleOverride)==null?void 0:i.outerLargeBoxShadowDark;if(s)return s;if(e)return Zve}return Yve},vSe=(t,e)=>{var n,r,o,i;if(t==="light"){const s=(r=(n=be.instance().config().composer)==null?void 0:n.shadowBoxStyleOverride)==null?void 0:r.outerSmallBoxShadowLight;if(s)return s;if(e)return Xve}else if(t==="dark"){const s=(i=(o=be.instance().config().composer)==null?void 0:o.shadowBoxStyleOverride)==null?void 0:i.outerSmallBoxShadowDark;if(s)return s;if(e)return ebe}return Qve},bSe=t=>t==="dark"?oU:rU,ySe=st();function Zs(t){t&&ySe.set(Os,{title:t.title,subtitle:t.message,dismissable:!0,dismissAfter:10*1e3})}function M2e(t,e){ht({source:"shareMenu",scenario:t,sectionName:e})}function O2e(t){const{conversationId:e,messageId:n}=t;z.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"sharePreview",eventInfo_impressionElement:"shareBlockedBanner",eventInfo_conversationId:e,eventInfo_messageId:n}})}function L2e(t){const{scenario:e,uploadedfileType:n,shareId:r,conversationId:o,messageIds:i}=t;z.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"shareButton",eventInfo_clickScenario:e,eventInfo_uploadFileType:n,eventInfo_customData:JSON.stringify({eventInfo_shareId:r,eventInfo_oneTurn_messageId:i?i.join(","):""}),eventInfo_conversationId:o}})}function D2e(t){const{conversationId:e,shareId:n,socialMedia:r,scenario:o,sharedLevel:i}=t,s={facebook:"senderToFacebook",twitter:"senderToX",linkedin:"senderToLinkedIn",whatsapp:"senderToWhatsApp",reddit:"senderToReddit"};z.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:s[r],eventInfo_clickScenario:o,eventInfo_customData:JSON.stringify({eventInfo_shareId:n,SharedLevel:i}),eventInfo_conversationId:e}})}function j2e(t){z.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"receivePreview",eventInfo_impressionScenario:"shareAsLink",eventInfo_customData:JSON.stringify({eventInfo_shareId:t})}})}function U2e(){z.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"talkToCopilot"}})}function F2e(t){const{cardType:e,messageId:n,conversationId:r,scenario:o}=t;Tn({source:"shareMenu",scenario:o,messageId:n,conversationId:r,cardType:e})}function B2e(t){const{conversationId:e,messageId:n,errorName:r,errorMessage:o,errorStack:i}=t;z.trackEvent({name:"system",data:{eventName:"shareMessagesFailed",eventInfo_conversationId:e,eventInfo_messageId:n??"",eventInfo_error:r,eventInfo_errorMessage:o,eventInfo_errorStack:i}})}function CSe(){ht({source:"continueClicked"})}function SSe(t){const{shareId:e,error:n,conversationId:r}=t;xr({feature:"share",scenario:"continueClickFailed",errorType:n==null?void 0:n.name,errorMessage:n==null?void 0:n.message,customData:JSON.stringify({eventInfo_shareId:e,eventInfo_conversationId:r})})}function ESe(t,e,n){const r=st();return new Promise((o,i)=>{let s=null;e(r.get(t))&&o(r.get(t));const a=r.sub(t,()=>{const u=r.get(t);e(u)&&(a(),o(u))}),c=()=>{a(),s&&clearTimeout(s)};s=setTimeout(()=>{c(),i(new Error("Timeout waiting for atom to be ready"))},n)})}function ISe(t){return t.some(e=>e.author==="human"&&e.content.some(n=>n.type==="image"||n.type==="document"))}function H2e(t){var n,r;const e=t.filter(o=>o.author==="human");if(e.length===1){const o=(r=(n=e[0])==null?void 0:n.content.find(i=>i.type==="image"||i.type==="document"))==null?void 0:r.type;return o==="image"?"image":o==="document"?"file":void 0}return ISe(t)?"image|file":void 0}function TSe(t){const n=new URL(t).pathname.split("/").filter(Boolean);return n[n.length-1]??null}async function dP(){CSe();const t=st(),e=TSe(window.location.href);let n;t.set(wE,!0);try{const r=await _Se(`/conversations/shares/${e}/continue`),{id:o,title:i}=r.conversation;n=o;const s=new Date().toISOString(),a={id:o,updatedAt:s,isNew:!1,title:i,history:[],streamingState:"idle",continuedAt:s};t.set(En,c=>{const u=new Map(c);return u.set(o,a),u}),t.set(pt,o),await ASe(o)}catch(r){throw Zs({title:Nt.t("composer.errors.continue.title"),message:Nt.t("composer.errors.continue.message")}),SSe({shareId:e??"",conversationId:n,error:r instanceof Error?r:new Error(String(r))}),r}finally{t.set(wE,!1)}}async function _Se(t){return(await qn(t,cJ,{options:{method:"POST"}})).data}const wSe=1e4;async function ASe(t){await ESe(En,e=>{const n=e.get(t);return((n==null?void 0:n.history)??[]).length>0},wSe)}function kSe(t,e,n){if(!t||!e)return!1;const r=t.getTime(),o=e.getTime(),i=n?n.getTime():null;return o<=r||i===null?!1:i<=r}function qU(){return`Copilot_${Ec(new Date,"yyyyMMdd_HHmmss")}`}async function z2e(t,e){const n=qU(),o=await(await fetch(t)).blob(),i=URL.createObjectURL(o),s=document.createElement("a");s.href=i,s.download=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}function xSe(t){t.target instanceof HTMLImageElement&&URL.revokeObjectURL(t.target.src)}async function RSe(t,e=!1){try{const n=await Gc(t,{analytics:{anonymousPath:"/attachments/*.png"}});return e&&n.status!==200?null:await n.blob()}catch{return null}}async function NSe(t,e=!1){try{const n=await RSe(t,e);return n?URL.createObjectURL(n):null}catch{return null}}function qE(t,e){const n=cn(t),r=cn(e);return n.getTime()>r.getTime()}function qv(t){const e=cn(t);return e.setHours(0,0,0,0),e}function iA(t,e){const n=qv(t),r=qv(e);return+n==+r}function Wv(t,e){return UI(t,-e)}const PSe=11,MSe=7,OSe=2,LSe=10,DSe=21,jSe=21,USe=10,hP=l.object({daysActive:l.array(l.coerce.date())}),WE=l.object({result:l.enum(["dismissed","positive","negative"]),date:l.coerce.date(),dismissCounter:l.number()});function FSe(t){const e=new Date;let n=t;return t.some(r=>iA(r,e))||(n=[...t,e]),n.length>USe?n.slice(-10):n}function BSe(){const t=Bo(Dk,hP),e=(t==null?void 0:t.daysActive)??[],n=FSe(e),r=Wv(new Date,MSe),o=n.filter(i=>qE(i,r)||iA(i,r)).length;return n!==e&&ei(Dk,hP,{daysActive:n}),o}function HSe(){const t=Bo(J0,WE);if(!t)return!1;const e=t.result==="positive",n=t.result==="negative"&&qE(t.date,Wv(new Date,jSe)),r=t.result==="dismissed"&&qE(t.date,Wv(new Date,t.dismissCounter>5?DSe:LSe));return e||n||r}function zSe(t,e){let n="popUpDismiss";e==="negative"?n="appThumbDown":e==="positive"&&(n="appThumbUp"),Tn({source:n,conversationId:t});const r=Bo(J0,WE),o=(r==null?void 0:r.result)==="dismissed"?r.dismissCounter:0,i={result:e,date:new Date,dismissCounter:e==="dismissed"?o+1:0};ei(J0,WE,i)}function VSe(t={},e=!1){const[n,r]=m.useState(!1),[o,i]=m.useState(!1),{onFocus:s,onBlur:a,onPointerDown:c}=t;return[n,{onFocus:h=>{(!o||e)&&r(!0),s==null||s(h)},onBlur:h=>{r(!1),i(!1),a==null||a(h)},onPointerDown:h=>{i(!0),c==null||c(h)}}]}const $Se="bg-stone-300/20 dark:bg-midnight-350/5";function GSe(t,e){return t?t===!0?{animate:{...e}}:{animate:t}:{style:e}}function KSe(t,e,n,r){const o=e?r:n;return t?{animate:o}:{style:o}}function sA(t){const{children:e,size:n="md",position:r="default",nested:o=!1,background:i="default",stroke:s,className:a,containerRef:c,interactable:u=!1,label:h,animate:p,onFocus:f,onBlur:g,onPointerDown:v,onAnimationStart:y,onAnimationComplete:b,focusOnPointerDown:C,isSelected:S=!1,...E}=t,[I,T]=VSe({onFocus:f,onBlur:g,onPointerDown:v},C),_=S||I,A=o&&(i==="acrylic"||i==="acrylic-thin"),M=A?g0[`${n}-${r}`]:qSe[`${n}-${r}`],R=A?g0[`${n}-${r}`]:WSe[`${n}-${r}`],$=A?g0[`${n}-${r}`]:YSe[`${n}-${r}`],V={default:"bg-white/45 dark:bg-midnight-350/10",darker:$Se,acrylic:Ji,"acrylic-fallback":uz,"acrylic-thin":ra,"acrylic-thin-fallback":pz,transparent:"bg-transparent"},ie=u?{"aria-label":h,role:"button",tabIndex:0,...T,onKeyDown:j=>{var U;(j.key==="Enter"||j.key===" ")&&(j.preventDefault(),(U=E.onClick)==null||U.call(E,j))}}:{onFocus:f,onBlur:g,onPointerDown:v},N=GSe(p,M),Y=KSe(p,_,R,$),ue=a&&!a.includes("relative")&&!a.includes("absolute")&&!a.includes("fixed")&&"relative";return d.jsxs(Re.div,{className:q(V[i],a,ue,A&&"outline-1 outline-offset-2","isolate will-change-transform"),ref:c,onAnimationComplete:b,...N,...ie,...E,children:[e,d.jsx(Re.div,{className:q(_&&"border-foreground-750 dark:border-white",s&&!_&&"border-black/8 dark:border-white/8",!s&&!_&&"border-transparent",!A&&"border-[20px]",A&&s&&!_&&"border",A&&s&&_&&"border-2","pointer-events-none absolute inset-0"),...Y})]})}const qSe={"xs-default":{clipPath:"var(--clip-path-squircle-16)"},"sm-default":{clipPath:"var(--clip-path-squircle-24)"},"md-default":{clipPath:"var(--clip-path-squircle-36)"},"lg-default":{clipPath:"var(--clip-path-squircle-48)"},"xl-default":{clipPath:"var(--clip-path-squircle-60)"},"xs-top":{clipPath:"var(--clip-path-squircle-16-12)"},"sm-top":{clipPath:"var(--clip-path-squircle-24-16)"},"md-top":{clipPath:"var(--clip-path-squircle-36-24)"},"lg-top":{clipPath:"var(--clip-path-squircle-48-36)"},"xl-top":{clipPath:"var(--clip-path-squircle-60-48)"},"xs-bottom":{clipPath:"var(--clip-path-squircle-12-16)"},"sm-bottom":{clipPath:"var(--clip-path-squircle-16-24)"},"md-bottom":{clipPath:"var(--clip-path-squircle-24-36)"},"lg-bottom":{clipPath:"var(--clip-path-squircle-36-48)"},"xl-bottom":{clipPath:"var(--clip-path-squircle-48-60)"}},WSe={"xs-default":{clipPath:"var(--clip-path-squircle-stroke-16)"},"sm-default":{clipPath:"var(--clip-path-squircle-stroke-24)"},"md-default":{clipPath:"var(--clip-path-squircle-stroke-36)"},"lg-default":{clipPath:"var(--clip-path-squircle-stroke-48)"},"xl-default":{clipPath:"var(--clip-path-squircle-stroke-60)"},"xs-top":{clipPath:"var(--clip-path-squircle-stroke-16-12)"},"sm-top":{clipPath:"var(--clip-path-squircle-stroke-24-16)"},"md-top":{clipPath:"var(--clip-path-squircle-stroke-36-24)"},"lg-top":{clipPath:"var(--clip-path-squircle-stroke-48-36)"},"xl-top":{clipPath:"var(--clip-path-squircle-stroke-60-48)"},"xs-bottom":{clipPath:"var(--clip-path-squircle-stroke-12-16)"},"sm-bottom":{clipPath:"var(--clip-path-squircle-stroke-16-24)"},"md-bottom":{clipPath:"var(--clip-path-squircle-stroke-24-36)"},"lg-bottom":{clipPath:"var(--clip-path-squircle-stroke-36-48)"},"xl-bottom":{clipPath:"var(--clip-path-squircle-stroke-48-60)"}},YSe={"xs-default":{clipPath:"var(--clip-path-squircle-stroke-focused-16)"},"sm-default":{clipPath:"var(--clip-path-squircle-stroke-focused-24)"},"md-default":{clipPath:"var(--clip-path-squircle-stroke-focused-36)"},"lg-default":{clipPath:"var(--clip-path-squircle-stroke-focused-48)"},"xl-default":{clipPath:"var(--clip-path-squircle-stroke-focused-60)"},"xs-top":{clipPath:"var(--clip-path-squircle-stroke-focused-16-12)"},"sm-top":{clipPath:"var(--clip-path-squircle-stroke-focused-24-16)"},"md-top":{clipPath:"var(--clip-path-squircle-stroke-focused-36-24)"},"lg-top":{clipPath:"var(--clip-path-squircle-stroke-focused-48-36)"},"xl-top":{clipPath:"var(--clip-path-squircle-stroke-focused-60-48)"},"xs-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-12-16)"},"sm-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-16-24)"},"md-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-24-36)"},"lg-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-36-48)"},"xl-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-48-60)"}},g0={"xs-default":{borderTopLeftRadius:16,borderTopRightRadius:16,borderBottomLeftRadius:16,borderBottomRightRadius:16},"sm-default":{borderTopLeftRadius:24,borderTopRightRadius:24,borderBottomLeftRadius:24,borderBottomRightRadius:24},"md-default":{borderTopLeftRadius:36,borderTopRightRadius:36,borderBottomLeftRadius:36,borderBottomRightRadius:36},"lg-default":{borderTopLeftRadius:48,borderTopRightRadius:48,borderBottomLeftRadius:48,borderBottomRightRadius:48},"xl-default":{borderTopLeftRadius:60,borderTopRightRadius:60,borderBottomLeftRadius:60,borderBottomRightRadius:60},"xs-top":{borderTopLeftRadius:16,borderTopRightRadius:16,borderBottomLeftRadius:12,borderBottomRightRadius:12},"sm-top":{borderTopLeftRadius:24,borderTopRightRadius:24,borderBottomLeftRadius:16,borderBottomRightRadius:16},"md-top":{borderTopLeftRadius:36,borderTopRightRadius:36,borderBottomLeftRadius:24,borderBottomRightRadius:24},"lg-top":{borderTopLeftRadius:48,borderTopRightRadius:48,borderBottomLeftRadius:36,borderBottomRightRadius:36},"xl-top":{borderTopLeftRadius:60,borderTopRightRadius:60,borderBottomLeftRadius:48,borderBottomRightRadius:48},"xs-bottom":{borderTopLeftRadius:12,borderTopRightRadius:12,borderBottomLeftRadius:16,borderBottomRightRadius:16},"sm-bottom":{borderTopLeftRadius:16,borderTopRightRadius:16,borderBottomLeftRadius:24,borderBottomRightRadius:24},"md-bottom":{borderTopLeftRadius:24,borderTopRightRadius:24,borderBottomLeftRadius:36,borderBottomRightRadius:36},"lg-bottom":{borderTopLeftRadius:36,borderTopRightRadius:36,borderBottomLeftRadius:48,borderBottomRightRadius:48},"xl-bottom":{borderTopLeftRadius:48,borderTopRightRadius:48,borderBottomLeftRadius:60,borderBottomRightRadius:60}};function Oy({className:t,style:e}){return d.jsx("div",{className:q("animate-[shimmer_2s_infinite] bg-black/5 bg-gradient-to-r dark:bg-white/5","from-transparent via-background-150 to-transparent","bg-[length:50%_100%] bg-no-repeat",t),style:e})}function QSe(t){const{isImageOrVideo:e}=t;return d.jsx("div",{className:"flex flex-col gap-3 px-4",children:d.jsx(Oy,{className:q("w-full",e?"h-[144px] sm:h-[176px]":"h-[300px]"),style:{clipPath:"var(--clip-path-squircle-36)"}})})}function fP(t){const{type:e,length:n}=t;if(e==="ads")return d.jsx("div",{});const r=e==="image"||e==="video",o=r&&n===1;return d.jsx(sA,{size:"md",stroke:!0,className:q("relative flex",o?"w-[300px]":"w-full","flex-col py-3 transition-opacity duration-300 ease-in-out"),children:d.jsx(QSe,{isImageOrVideo:r})})}function V2e(t){if(t.type==="image")return t.images.length;if(t.type==="video")return t.videos.length}function JSe(t){var g;const{uploadedFile:e,onRemove:n,scenario:r,isUploading:o}=t,{t:i}=Oe(),[s,a]=m.useState(null),[c,u]=m.useState(!1),h=i(r==="screenshot"?"composer.screenshotAdded":"composer.uploadedImageAltText");m.useEffect(()=>{const v=URL.createObjectURL(e);return u(!1),a(v),()=>{URL.revokeObjectURL(v)}},[e]);const p=v=>{u(!0),v.target instanceof HTMLImageElement&&URL.revokeObjectURL(v.target.src)};if(!s)return null;const f=(g=be.instance().config().composer)==null?void 0:g.smallAttachmentCard;return d.jsxs(Re.div,{className:q("relative max-w-fit shrink-0",{"mx-1 mt-2 h-[58px]":f,"h-32":!f}),layout:"position",initial:dt,animate:c?Ot:dt,exit:dt,transition:{delay:Lj},children:[d.jsx(Re.img,{className:q("w-auto rounded-xl border border-black/8 object-contain shadow-inner dark:border-white/8",{"h-[58px]":f,"h-32":!f}),src:s,role:"img","aria-label":h,alt:h,onLoad:p,onError:p,draggable:!1}),d.jsx(hd,{msg:h}),d.jsx(Re.button,{type:"button",title:i("composer.removeImage"),"aria-label":i("composer.removeImage"),onClick:n,className:"absolute end-0.5 top-0.5 m-1 rounded-full border border-black/20 bg-white fill-black p-1 text-black",children:d.jsx(fo,{className:"size-3"})}),o&&d.jsxs(Fn,{className:"absolute inset-0 grid place-items-center bg-white/80 dark:bg-white/45",children:[d.jsx(m.Suspense,{fallback:d.jsx("div",{"aria-hidden":!0}),children:d.jsx(Rt,{type:"spinnerThemed",className:"size-11"})}),d.jsx(hd,{msg:i("fileUpload.uploadingFile"),type:"polite"})]})]})}function ZSe(t){const{attachments:e,onRemove:n}=t,{t:r}=Oe(),o=i=>{const s=e[i];s!=null&&s.file&&(n(i),Rw({msg:r("fileUpload.attachmentRemoved"),type:"polite"}))};return d.jsx("div",{className:"relative flex max-h-64 min-w-0 max-w-full flex-wrap gap-2 overflow-y-auto overflow-x-hidden px-1",children:e.map(({file:i,error:s,processing:a,scenario:c},u)=>{if(s||!i)return null;const h=xs(i);return kp(h)?d.jsx(Nw,{onRemove:()=>o(u),filename:i.name,fileType:h,isUploading:a},`attachment-${u}`):d.jsx(JSe,{uploadedFile:i,onRemove:()=>o(u),scenario:c,isUploading:a},`attachment-${u}`)})})}function XSe(t){const{text:e,onClick:n,className:r,testId:o}=t;return d.jsx(Me,{title:"",onClick:n,className:nt("min-w-fit",r),color:"chip",testId:o,children:d.jsx("span",{className:"px-1",children:e})})}const e0e=1e3;function aA(){var c;const t=!!((c=be.instance().config().landingPage)!=null&&c.enablePromptedGreetings),e=le("intent-image-gen-prompted-greeting"),n=le("qa-intent-image-gen-prompted-greeting"),r=le("intent-f1-prompted-greeting"),o=le("qa-intent-f1-prompted-greeting"),i=le("conversation-starter-prompted-greeting-c1"),s=le("qa-conversation-starter-prompted-greeting-c1"),a=le("qa-conversation-starter-prompted-greeting-debug");return t&&(e||n||r||o||i||s||a)}function t0e(){const[t,e]=it(bL),n=aA();return m.useEffect(()=>{let r;return n?(e(!1),r=window.setTimeout(()=>{e(!0)},e0e)):e(!1),()=>{r&&clearTimeout(r)}},[e,n]),t}function n0e(t){const{className:e,onWidgetClick:n,pageName:r="chatPage",widgetData:o,shouldStackChips:i,shouldCenterChips:s,containerId:a=""}=t,c=m.useRef(null),u=fI(c,{once:!0,amount:"all"}),h=o.source??"chatStarterPills";m.useEffect(()=>{u&&sl({page:r,scenario:h,element:"chatStarterPills"})},[u,h,r]);const p=f=>{const{prompt:g,id:v,actionType:y,uri:b,source:C,text:S,index:E}=f;ht({pageName:r,source:h,scenario:v,customData:JSON.stringify({prompt:g,text:S,index:E})}),n({actionType:y,id:v,prompt:g,uri:b,source:C})};return d.jsx(Fn,{role:"list","aria-label":"",className:nt("mx-auto flex w-full gap-2 p-2 sm:flex-wrap sm:p-4",i?"mb-1 flex-col items-end space-y-1 sm:flex-row":"scrollbar-container max-h-[110px] overflow-x-auto overflow-y-hidden",s?"sm:justify-center":"sm:justify-start",e),id:a,ref:c,children:o.items.map((f,g)=>{if(!("text"in f))return null;const{id:v,text:y}=f,{type:b}=f.action,C="prompt"in f.action?f.action.prompt:void 0,S="uri"in f.action?f.action.uri:void 0;switch(o.type){case"text":case"textAndGreeting":return d.jsx(XSe,{text:y,onClick:()=>p({prompt:C,uri:S,id:v,actionType:b,source:"pills",text:y,index:g}),className:q(i&&"w-auto min-w-min max-w-[80%] text-start"),testId:`starter-prompt-${v}`},v);default:return null}})})}function r0e(t){var h;const{className:e,onWidgetClick:n,pageName:r="chatPage"}=t,o=L(Ad),i=aA(),s=L(bL),{isAppearanceOnHomeEnabled:a}=Pp(),c=L(IT),u=(h=be.instance().config().landingPage)==null?void 0:h.stackStarterChipsForSmallScreens;return i&&!s||!o||!["text","textAndGreeting"].includes(o.type)?null:d.jsx(n0e,{onWidgetClick:n,className:e,pageName:r,widgetData:o,shouldStackChips:u,shouldCenterChips:a,containerId:c??""})}function o0e(t){const{imgAlt:e,imgSrc:n,text:r,className:o,onClick:i,fetchPriority:s}=t,[a,c]=m.useState(!1);return d.jsx("div",{className:"aspect-[155/190] w-full min-w-[100px] max-w-full sm:w-[155px] sm:min-w-[120px] sm:max-w-[155px]",children:d.jsxs("button",{className:nt("relative flex h-full w-full flex-col items-center gap-2 rounded-lg bg-white p-2 shadow-md transition-all duration-[400ms] ease-[cubic-bezier(0,0,0,1)] hover:scale-[1.025] hover:shadow-lg dark:bg-slate-700",o),onClick:i,type:"button",children:[!a&&d.jsx(Oy,{className:"aspect-square w-full rounded-md"}),d.jsx("img",{className:nt("aspect-square w-full rounded-md object-cover",a?"opacity-100":"opacity-0"),src:n,alt:e,onLoad:()=>c(!0),onError:()=>c(!1),fetchPriority:s}),d.jsx("div",{className:"flex w-full flex-1 items-center justify-center px-2",children:d.jsx("p",{className:"truncate text-center text-xs-strong",children:r})})]})})}function pP(t){const{className:e,text:n,imgSrc:r,imgAlt:o,variant:i,onClick:s,fetchPriority:a}=t,[c,u]=m.useState(!1);return d.jsx("div",{className:nt("max-w-full drop-shadow-md transition-shadow hover:drop-shadow-lg sm:min-w-[120px]",i==="kickstarter"&&"aspect-[166/200] w-[166px] sm:max-w-[166px]",i==="feature-discovery"&&"aspect-[155/200] w-[155px] sm:max-w-[155px]"),children:d.jsxs(sA,{interactable:!0,stroke:!0,onClick:s,className:nt("relative h-full w-full transition-transform duration-[400ms] ease-[cubic-bezier(0,0,0,1)] hover:scale-[1.025]",e),children:[!c&&d.jsx(Oy,{className:"absolute size-full"}),d.jsx("img",{src:r,alt:o,className:nt("absolute size-full object-cover",c?"opacity-100":"opacity-0"),onLoad:()=>u(!0),onError:()=>u(!1),fetchPriority:a}),c&&d.jsx("div",{className:"absolute z-10 flex size-full flex-col px-4 py-5",children:d.jsx("p",{className:q("mt-auto line-clamp-2 overflow-hidden text-center text-xs-strong",i==="feature-discovery"&&"text-white/80",i==="kickstarter"&&"text-white"),children:n})})]})})}const i0e=l.union([l.literal("open"),l.literal("close")]),WU=l.object({sidebarVisibility:i0e.optional()});function s0e(t){ei(RO,WU,{sidebarVisibility:t})}function YU(){var t;return((t=Bo(RO,WU))==null?void 0:t.sidebarVisibility)??"close"}function a0e(){return!be.instance().config().sidebarNavigation||Iw({breakpoint:"md"})?!1:YU()!=="close"}const Oa=D(a0e()),c0e={deepLink:"deepLink",prefillComposer:"chatBox",sendMessage:"chat"};function l0e(t){const{className:e,onWidgetClick:n}=t,r=pr({breakpoint:"md"}),o=yo(),i=L(Oa),s=o&&i&&!r,a=m.useRef(null),c=L(Ad),u=fI(a,{once:!0,amount:"all"});m.useEffect(()=>{u&&c&&sl({page:"chatPage",scenario:"widgets",element:c.id,customData:JSON.stringify({visibleItems:c.items.map(f=>f.id)})})},[u,c]);const h=f=>{const{prompt:g,id:v,actionType:y,uri:b,widgetName:C,source:S}=f,E=y==="deepLink"?JSON.stringify({uri:b}):void 0;ht({pageName:"chatPage",sectionName:"widgets",scenario:C,source:v,destination:c0e[y],customData:E}),n({actionType:y,id:v,prompt:g,uri:b,source:S})},p=f=>{const g=new URL(f);return g.searchParams.set("o","7"),g.searchParams.set("rm","3"),g.toString()};return!c||c.type!=="textAndImage"?null:d.jsx("div",{className:nt("grid w-full grid-cols-2 gap-6 px-2 sm:flex sm:items-center",s&&"scrollbar-container justify-start overflow-x-auto bp-960:justify-center bp-960:overflow-x-hidden",!s&&"sm:justify-center",e),ref:a,children:c.items.map((f,g)=>{const{id:v,text:y}=f,{type:b}=f.action,C="prompt"in f.action?f.action.prompt:void 0,S="uri"in f.action?f.action.uri:void 0,{altText:E,url:I}=f.thumbnail,T={actionType:b,id:v,prompt:C,uri:S,widgetName:c.id,source:"widgets"},_=g%2===0?"-rotate-2 hover:rotate-0":"rotate-2 hover:rotate-0";switch(c.id){case"kickstarter":return d.jsx(pP,{text:y,imgSrc:p(I),imgAlt:E,variant:"kickstarter",onClick:()=>h(T),className:_,fetchPriority:"high"},v);case"feature-discovery":return d.jsx(pP,{text:y,imgSrc:p(I),imgAlt:E,variant:"feature-discovery",onClick:()=>h(T),className:_,fetchPriority:"high"},v);case"image-generation":return d.jsx(o0e,{text:y,imgSrc:p(I),imgAlt:E,className:_,onClick:()=>h(T),fetchPriority:"high"},v);default:return null}})})}function u0e(t){const[e,n]=m.useState(!1),{tab:r,className:o=""}=t,{t:i}=Oe();return e||!r.favIconUrl?d.jsx(Yw,{className:q("size-5",o)}):d.jsx("img",{src:r.favIconUrl,alt:i("composer.multiTabs.tabFavIconAltText"),className:q("size-4 rounded bg-white",o),onError:()=>{n(!0)}})}function d0e(t){try{return new URL(t).hostname.replace(/^www\./,"")}catch{return null}}function h0e(t,e=5){const n=new Set;for(const r of t){if(n.size>=e)break;if(r.url){const o=d0e(r.url);o&&n.add(o)}}return Array.from(n).join(", ")}function f0e(t,e=5){const n=new Set;for(const r of t){if(n.size>=e)break;r.title&&n.add(r.title)}return Array.from(n).join(", ")}function p0e(t){const{tabs:e}=t,n=m.useMemo(()=>f0e(e,5),[e]),r=e.length-1;return d.jsxs("div",{className:"flex",children:[d.jsx("span",{className:"min-w-0 truncate font-semibold text-foreground-750 text-xs",children:n}),r>0&&d.jsxs("span",{className:"ms-1 font-semibold text-foreground-750 text-xs",children:["+",r]})]})}function m0e(t){const{tabs:e}=t,n=m.useMemo(()=>h0e(e,5),[e]);return d.jsx("span",{className:"truncate text-foreground-750 opacity-60 text-2xs",children:n})}function QU(t){const{tabs:e,onRemove:n,showRemoveIcon:r,onClick:o}=t,{t:i}=Oe(),s=m.useMemo(()=>e.slice(0,3),[e]),a=u=>{u.stopPropagation(),n==null||n()},c=u=>{u.stopPropagation(),o==null||o()};return d.jsxs(Re.div,{className:"relative flex h-[58px] w-full flex-row items-center justify-center gap-2 overflow-hidden rounded-xl border border-black/8 bg-white/90 p-3 dark:border-white/8 dark:bg-midnight-800/80",layout:"position",initial:dt,animate:Ot,exit:dt,onClick:c,children:[d.jsx("div",{className:q("flex h-5 min-w-5 flex-none items-center justify-center rounded bg-white/90 dark:bg-midnight-800/80"),children:s.map((u,h)=>d.jsx(u0e,{tab:u,className:q(h>0&&"-ms-[6px]")},u.id))}),d.jsxs("div",{className:"me-7 flex min-w-0 flex-1 flex-col",children:[d.jsx(p0e,{tabs:e}),d.jsx(m0e,{tabs:e})]}),r&&d.jsx("button",{type:"button",title:i("composer.removeImage"),"aria-label":i("composer.removeImage"),onClick:a,tabIndex:0,className:"absolute end-0.5 top-0.5 m-1 rounded-full p-1 text-foreground-850 safe-hover:bg-black/5 dark:safe-hover:bg-black/30",children:d.jsx(fo,{className:"size-3"})})]})}function g0e({onClick:t,showRemoveIcon:e=!0}){const[n,r]=it(Ia),o=m.useMemo(()=>Array.from(n.values()),[n]);return n.size===0?null:d.jsx("div",{className:"flex min-h-[60px] cursor-pointer flex-col gap-2",children:d.jsx(QU,{showRemoveIcon:e,tabs:o,onRemove:()=>{r(new Map)},onClick:t})})}const JU=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M11.7498 3C12.1295 3 12.4434 3.28201 12.4931 3.64808L12.5 3.74985L12.5012 11H19.7543C20.1685 11 20.5043 11.3358 20.5043 11.75C20.5043 12.1297 20.2221 12.4435 19.8561 12.4932L19.7543 12.5H12.5012L12.5032 19.7491C12.5033 20.1633 12.1676 20.4993 11.7534 20.4993C11.3737 20.4993 11.0598 20.2173 11.0101 19.8512L11.0032 19.7494L11.0012 12.5H3.7522C3.33798 12.5 3.0022 12.1642 3.0022 11.75C3.0022 11.3703 3.28435 11.0565 3.65043 11.0068L3.7522 11H11.0012L11 3.75015C10.9999 3.33594 11.3356 3 11.7498 3Z"})),$2e=Object.freeze(Object.defineProperty({__proto__:null,default:JU},Symbol.toStringTag,{value:"Module"}));function v0e({onRef:t,onClick:e,onButtonRef:n}){const{t:r}=Oe(),o=L(vy);return d.jsx(Jo,{data:{title:r("common.open"),testId:"plus-button",isVisible:!0,ariaExpanded:o==="plus",onClick:e},ref:t,onButtonRef:n,children:d.jsx(JU,{className:"size-6","aria-hidden":!0})})}const Ly=t=>m.createElement("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("mask",{id:"mask0_21044_3802",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:0,y:0,width:20,height:20},m.createElement("path",{d:"M19.7803 1.28033C20.0732 0.987435 20.0732 0.512561 19.7803 0.219669C19.4874 -0.0732238 19.0125 -0.0732228 18.7196 0.219671L8.71967 10.2197L8.25 11.75L9.78033 11.2803L19.7803 1.28033ZM4.25 1C2.45507 1 1 2.45508 1 4.25V15.75C1 17.5449 2.45507 19 4.25 19H15.75C17.5449 19 19 17.5449 19 15.75V7.75C19 7.33579 18.6642 7 18.25 7C17.8358 7 17.5 7.33579 17.5 7.75V15.75C17.5 16.7165 16.7165 17.5 15.75 17.5H4.25C3.2835 17.5 2.5 16.7165 2.5 15.75V4.25C2.5 3.2835 3.2835 2.5 4.25 2.5H12.25C12.6642 2.5 13 2.16421 13 1.75C13 1.33579 12.6642 1 12.25 1H4.25Z",fill:"currentColor"})),m.createElement("g",{mask:"url(#mask0_21044_3802)"},m.createElement("rect",{width:24,height:24,transform:"translate(-2 -2)",fill:"currentColor"}))),G2e=Object.freeze(Object.defineProperty({__proto__:null,default:Ly},Symbol.toStringTag,{value:"Module"})),ZU=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.92188 11.8237H19.4529C19.4529 11.8237 19.4529 9.89366 19.4529 9.6831C18.6246 6.41578 15.6854 4 12.1862 4C9.56739 4 7.26337 5.35396 5.92188 7.4044C5.92188 8.82754 5.92188 11.8237 5.92188 11.8237Z",fill:"#0364B8"}),m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.15227 8.30349L9.15203 8.30431C8.23597 7.73294 7.1565 7.40234 6.00013 7.40234C5.97439 7.40234 5.94909 7.404 5.92344 7.40431C2.64519 7.44587 0 10.1364 0 13.4511C0 14.7371 0.399257 15.9285 1.07801 16.9086H14.1906V11.3459L9.15227 8.30349Z",fill:"#0078D4"}),m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.4514 9.68327C19.3425 9.67596 19.233 9.6709 19.1223 9.6709C18.4357 9.6709 17.7825 9.81469 17.1899 10.073L14.1875 11.3461V16.9176H23.4143C23.7861 16.2237 23.9974 15.4296 23.9974 14.5855C23.9974 11.9828 21.9902 9.85405 19.4514 9.68327Z",fill:"#1490DF"}),m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.1602 14.3467L17.9151 13.5949L15.0613 11.8716L14.1907 11.3459L11.8941 12.3202L7.49635 14.1859L5.52123 15.0238L1.07812 16.9087C2.16256 18.4747 3.96212 19.5 6.00025 19.5H19.1255C20.9807 19.5 22.5937 18.4551 23.4175 16.9175L19.1602 14.3467Z",fill:"#28A8EA"})),K2e=Object.freeze(Object.defineProperty({__proto__:null,default:ZU},Symbol.toStringTag,{value:"Module"})),cA=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("g",null,m.createElement("path",{id:"Shape",d:"M11.7717 3.74212C14.1132 1.39853 17.9121 1.39853 20.2553 3.74168C22.5384 6.02474 22.5969 9.68995 20.4309 12.0439L20.2428 12.2413L11.4427 21.0395L11.4062 21.0697C9.94492 22.3865 7.69092 22.3417 6.28355 20.9344C4.96453 19.6153 4.84241 17.5527 5.9172 16.096C5.94054 16.0506 5.96879 16.0068 6.002 15.9657L6.05556 15.9061L6.14247 15.8183L6.28355 15.6704L6.28647 15.6733L13.7222 8.21901C13.9881 7.95239 14.4047 7.92763 14.6986 8.14509L14.7829 8.2176C15.0495 8.48351 15.0742 8.90014 14.8568 9.19404L14.7843 9.27826L7.18966 16.8913C6.47202 17.7669 6.5219 19.0612 7.3393 19.8786C8.16836 20.7077 9.48801 20.7472 10.3638 19.997L19.1965 11.1666C20.952 9.40894 20.952 6.5597 19.1946 4.80234C17.4922 3.0999 14.765 3.0467 12.9986 4.64274L12.8307 4.80234L12.8181 4.81665L3.28179 14.353C2.9889 14.6459 2.51403 14.6459 2.22113 14.353C1.95487 14.0867 1.93066 13.67 2.14852 13.3764L2.22113 13.2923L11.77 3.74168L11.7717 3.74212Z",fill:"currentColor"}))),q2e=Object.freeze(Object.defineProperty({__proto__:null,default:cA},Symbol.toStringTag,{value:"Module"})),XU=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",...t},m.createElement("path",{fill:"currentColor",d:"M6.3 3A3.2 3.2 0 0 0 3 6.3v11.4C3 19.6 4.5 21 6.3 21h11.4c1.8 0 3.3-1.5 3.3-3.3V6.3C21 4.5 19.5 3 17.7 3H6.3ZM4.5 6.3c0-1 .8-1.8 1.8-1.8h11.4c1 0 1.8.8 1.8 1.8v11.4c0 1-.8 1.8-1.8 1.8H6.3c-1 0-1.8-.8-1.8-1.8V6.3ZM8 7.5c-.3 0-.5.2-.5.5v2.3a.8.8 0 0 1-1.5 0V8c0-1.1.9-2 2-2h2.3a.8.8 0 0 1 0 1.5H8Zm0 9a.5.5 0 0 1-.5-.5v-2.3a.8.8 0 0 0-1.5 0V16c0 1.1.9 2 2 2h2.3a.8.8 0 0 0 0-1.5H8ZM16.5 8c0-.3-.2-.5-.5-.5h-2.3a.8.8 0 0 1 0-1.5H16a2 2 0 0 1 2 2v2.3a.8.8 0 0 1-1.5 0V8Zm-.5 8.5c.3 0 .5-.2.5-.5v-2.3a.8.8 0 0 1 1.5 0V16a2 2 0 0 1-2 2h-2.3a.8.8 0 0 1 0-1.5H16Z"})),W2e=Object.freeze(Object.defineProperty({__proto__:null,default:XU},Symbol.toStringTag,{value:"Module"})),e8=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...t},m.createElement("path",{d:"M3 5.75A2.75 2.75 0 0 1 5.75 3h12.5A2.75 2.75 0 0 1 21 5.75v6.272a6.471 6.471 0 0 0-1.5-.709V5.75c0-.69-.56-1.25-1.25-1.25H5.75c-.69 0-1.25.56-1.25 1.25v12.5c0 .69.56 1.25 1.25 1.25h5.563c.173.534.412 1.037.709 1.5H5.75A2.75 2.75 0 0 1 3 18.25V5.75ZM23 17.5a5.5 5.5 0 1 0-11 0 5.5 5.5 0 0 0 11 0Zm-5 .5.001 2.503a.5.5 0 1 1-1 0V18h-2.505a.5.5 0 0 1 0-1H17v-2.5a.5.5 0 1 1 1 0V17h2.497a.5.5 0 0 1 0 1H18Z"})),Y2e=Object.freeze(Object.defineProperty({__proto__:null,default:e8},Symbol.toStringTag,{value:"Module"})),Th=q("flex w-full flex-row items-center gap-2");function b0e(t){const{startNewChatDisabled:e,startNewConversation:n,selectFile:r,selectOneDriveFile:o,takeScreenshot:i,selectUserOpenedTabs:s,uploadButtonDisabled:a=!1}=t,c=m.useRef(null),{t:u}=Oe(),h=L(Jc),p=L(pt),f=m.useRef(void 0);return ky(c),m.useEffect(()=>{i&&f.current!==p&&Sbe(p)},[p,i]),d.jsxs(Sl,{className:"pointer-events-auto relative flex flex-col rounded-2xl contrast-more:border-2","data-testid":"composer-plus-menu",role:"menu",circular:!0,children:[d.jsx(Me,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",className:"ps-3.5",title:u("composer.startNewChat"),onClick:n,testId:"new-chat-button",ref:c,disabled:e,children:d.jsxs("div",{className:Th,children:[d.jsx(Ly,{className:"size-5"}),u("composer.startNewChatShort")]})}),r&&!h&&d.jsx(Me,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",title:u("composer.upload"),disabled:a,testId:"file-upload-button",onClick:g=>{g.preventDefault(),r()},children:d.jsxs("div",{className:Th,children:[d.jsx(cA,{className:"size-6"})," ",u("composer.upload")]})}),i&&d.jsx(Me,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",title:u("composer.takeScreenshot"),onClick:g=>{g.preventDefault(),g.stopPropagation(),i(),_be(p)},children:d.jsxs("div",{className:Th,children:[d.jsx(XU,{className:"size-6"}),u("composer.takeScreenshotShort")]})}),o&&d.jsx(Me,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",title:u("composer.addFromOneDrive"),onClick:g=>{g.preventDefault(),g.stopPropagation(),o()},children:d.jsxs("div",{className:Th,children:[d.jsx(ZU,{className:"size-6"}),u("composer.addFromOneDrive")]})}),s&&d.jsx(Me,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",title:u("composer.multiTabs.addTab"),onClick:g=>{g.preventDefault(),g.stopPropagation(),s()},children:d.jsxs("div",{className:Th,children:[d.jsx(e8,{className:"size-6"}),u("composer.multiTabs.addTab")]})})]})}function y0e(){const[t,e]=m.useState(!1);return m.useEffect(()=>{async function n(){const{uiOverrides:{showScreenshotButton:r=()=>Promise.resolve(!1)}={}}=be.instance().config(),o=await r();e(o)}n().catch(()=>{})},[]),t}function C0e({startNewChatDisabled:t,uploadButtonDisabled:e=!1,onStartNewConversation:n,onSelectFileIfEnabled:r,onSelectOneDriveFileIfEnabled:o,onTakeScreenshot:i,onSelectUserOpenedTabsIfEnabled:s,onRef:a}){const[c,u]=it(vy),h=y0e(),f=`plus-menu-${dp()}`,g=c==="plus";return d.jsx(qw,{isOpen:g,onIsOpenChange:v=>u(y=>v?"plus":y==="plus"?null:y),renderTrigger:v=>d.jsx(v0e,{onRef:v.ref,onButtonRef:a,onClick:y=>{v.onClick(y),ht({source:"composerPlusButton",pageName:"chatPage",customData:JSON.stringify({isOpen:g})})}}),options:{placement:"top-start",offset:{mainAxis:10,crossAxis:-12},hideOnMenuClick:!0},className:nt(Ji,"p-2"),children:d.jsx(b0e,{startNewChatDisabled:t,uploadButtonDisabled:e,startNewConversation:n,selectFile:r,selectOneDriveFile:o,takeScreenshot:h?i:void 0,selectUserOpenedTabs:s})},f)}const mP=Yc.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)}),v0={dedupe:!0},S0e=(t,e,n)=>{const{cache:r,compare:o,suspense:i,fallbackData:s,revalidateOnMount:a,revalidateIfStale:c,refreshInterval:u,refreshWhenHidden:h,refreshWhenOffline:p,keepPreviousData:f}=n,[g,v,y,b]=ko.get(r),[C,S]=Es(t),E=m.useRef(!1),I=m.useRef(!1),T=m.useRef(C),_=m.useRef(e),w=m.useRef(n),A=()=>w.current,M=()=>A().isVisible()&&A().isOnline(),[R,$,V,ie]=xi(r,C),N=m.useRef({}).current,Y=Fe(s)?n.fallback[C]:s,ue=(P,J)=>{for(const Te in N){const O=Te;if(O==="data"){if(!o(P[O],J[O])&&(!Fe(P[O])||!o(Se,J[O])))return!1}else if(J[O]!==P[O])return!1}return!0},j=m.useMemo(()=>{const P=!C||!e?!1:Fe(a)?A().isPaused()||i?!1:Fe(c)?!0:c:a,J=K=>{const pe=ho(K);return delete pe._k,P?{isValidating:!0,isLoading:!0,...pe}:pe},Te=R(),O=ie(),ce=J(Te),se=Te===O?ce:J(O);let ne=ce;return[()=>{const K=J(R());return ue(K,ne)?(ne.data=K.data,ne.isLoading=K.isLoading,ne.isValidating=K.isValidating,ne.error=K.error,ne):(ne=K,K)},()=>se]},[r,C]),U=rb.useSyncExternalStore(m.useCallback(P=>V(C,(J,Te)=>{ue(Te,J)||P()}),[r,C]),j[0],j[1]),te=!E.current,Q=g[C]&&g[C].length>0,re=U.data,Z=Fe(re)?Y:re,_e=U.error,ye=m.useRef(Z),Se=f?Fe(re)?ye.current:re:Z,Ne=Q&&!Fe(_e)?!1:te&&!Fe(a)?a:A().isPaused()?!1:i?Fe(Z)?!1:c:Fe(Z)||c,we=!!(C&&e&&te&&Ne),Ke=Fe(U.isValidating)?we:U.isValidating,de=Fe(U.isLoading)?we:U.isLoading,ge=m.useCallback(async P=>{const J=_.current;if(!C||!J||I.current||A().isPaused())return!1;let Te,O,ce=!0;const se=P||{},ne=!y[C]||!se.dedupe,K=()=>Tc?!I.current&&C===T.current&&E.current:C===T.current,pe={isValidating:!1,isLoading:!1},He=()=>{$(pe)},at=()=>{const Le=y[C];Le&&Le[1]===O&&delete y[C]},ut={isValidating:!0};Fe(R().data)&&(ut.isLoading=!0);try{if(ne&&($(ut),n.loadingTimeout&&Fe(R().data)&&setTimeout(()=>{ce&&K()&&A().onLoadingSlow(C,n)},n.loadingTimeout),y[C]=[J(S),_c()]),[Te,O]=y[C],Te=await Te,ne&&setTimeout(at,n.dedupingInterval),!y[C]||y[C][1]!==O)return ne&&K()&&A().onDiscarded(C),!1;pe.error=mn;const Le=v[C];if(!Fe(Le)&&(O<=Le[0]||O<=Le[1]||Le[1]===0))return He(),ne&&K()&&A().onDiscarded(C),!1;const Xe=R().data;pe.data=o(Xe,Te)?Xe:Te,ne&&K()&&A().onSuccess(Te,C,n)}catch(Le){at();const Xe=A(),{shouldRetryOnError:St}=Xe;Xe.isPaused()||(pe.error=Le,ne&&K()&&(Xe.onError(Le,C,Xe),(St===!0||Tr(St)&&St(Le))&&(!A().revalidateOnFocus||!A().revalidateOnReconnect||M())&&Xe.onErrorRetry(Le,C,Xe,Ut=>{const Gt=g[C];Gt&&Gt[0]&&Gt[0](_r.ERROR_REVALIDATE_EVENT,Ut)},{retryCount:(se.retryCount||0)+1,dedupe:!0})))}return ce=!1,He(),!0},[C,r]),$e=m.useCallback((...P)=>ib(r,T.current,...P),[]);if(Mo(()=>{_.current=e,w.current=n,Fe(re)||(ye.current=re)}),Mo(()=>{if(!C)return;const P=ge.bind(mn,v0);let J=0;const O=RI(C,g,(ce,se={})=>{if(ce==_r.FOCUS_EVENT){const ne=Date.now();A().revalidateOnFocus&&ne>J&&M()&&(J=ne+A().focusThrottleInterval,P())}else if(ce==_r.RECONNECT_EVENT)A().revalidateOnReconnect&&M()&&P();else{if(ce==_r.MUTATE_EVENT)return ge();if(ce==_r.ERROR_REVALIDATE_EVENT)return ge(se)}});return I.current=!1,T.current=C,E.current=!0,$({_k:S}),Ne&&(Fe(Z)||Ss?P():wI(P)),()=>{I.current=!0,O()}},[C]),Mo(()=>{let P;function J(){const O=Tr(u)?u(R().data):u;O&&P!==-1&&(P=setTimeout(Te,O))}function Te(){!R().error&&(h||A().isVisible())&&(p||A().isOnline())?ge(v0).then(J):J()}return J(),()=>{P&&(clearTimeout(P),P=-1)}},[u,h,p,C]),m.useDebugValue(Se),i&&Fe(Z)&&C){if(!Tc&&Ss)throw new Error("Fallback data is required when using suspense in SSR.");_.current=e,w.current=n,I.current=!1;const P=b[C];if(!Fe(P)){const J=$e(P);mP(J)}if(Fe(_e)){const J=ge(v0);Fe(Se)||(J.status="fulfilled",J.value=!0),mP(J)}else throw _e}return{mutate:$e,get data(){return N.data=!0,Se},get error(){return N.error=!0,_e},get isValidating(){return N.isValidating=!0,Ke},get isLoading(){return N.isLoading=!0,de}}},E0e=xI(S0e),I0e=t=>Es(t?t(0,null):null)[0],b0=Promise.resolve(),T0e=t=>(e,n,r)=>{const o=m.useRef(!1),{cache:i,initialSize:s=1,revalidateAll:a=!1,persistSize:c=!1,revalidateFirstPage:u=!0,revalidateOnMount:h=!1,parallel:p=!1}=r,[,,,f]=ko.get(AI);let g;try{g=I0e(e),g&&(g=uO+g)}catch{}const[v,y,b]=xi(i,g),C=m.useCallback(()=>Fe(v()._l)?s:v()._l,[i,g,s]);rb.useSyncExternalStore(m.useCallback(A=>g?b(g,()=>{A()}):()=>{},[i,g]),C,C);const S=m.useCallback(()=>{const A=v()._l;return Fe(A)?s:A},[g,s]),E=m.useRef(S());Mo(()=>{if(!o.current){o.current=!0;return}g&&y({_l:c?E.current:S()})},[g,i]);const I=h&&!o.current,T=t(g,async A=>{const M=v()._i,R=v()._r;y({_r:mn});const $=[],V=S(),[ie]=xi(i,A),N=ie().data,Y=[];let ue=null;for(let j=0;j<V;++j){const[U,te]=Es(e(j,p?null:ue));if(!U)break;const[Q,re]=xi(i,U);let Z=Q().data;const _e=a||M||Fe(Z)||u&&!j&&!Fe(N)||I||N&&!Fe(N[j])&&!r.compare(N[j],Z);if(n&&(typeof R=="function"?R(Z,te):_e)){const ye=async()=>{if(!(U in f))Z=await n(te);else{const Ne=f[U];delete f[U],Z=await Ne}re({data:Z,_k:te}),$[j]=Z};p?Y.push(ye):await ye()}else $[j]=Z;p||(ue=Z)}return p&&await Promise.all(Y.map(j=>j())),y({_i:mn}),$},r),_=m.useCallback(function(A,M){const R=typeof M=="boolean"?{revalidate:M}:M||{},$=R.revalidate!==!1;return g?($&&(Fe(A)?y({_i:!0,_r:R.revalidate}):y({_i:!1,_r:R.revalidate})),arguments.length?T.mutate(A,{...R,revalidate:$}):T.mutate()):b0},[g,i]),w=m.useCallback(A=>{if(!g)return b0;const[,M]=xi(i,g);let R;if(Tr(A)?R=A(S()):typeof A=="number"&&(R=A),typeof R!="number")return b0;M({_l:R}),E.current=R;const $=[],[V]=xi(i,g);let ie=null;for(let N=0;N<R;++N){const[Y]=Es(e(N,ie)),[ue]=xi(i,Y),j=Y?ue().data:mn;if(Fe(j))return _(V().data);$.push(j),ie=j}return _($)},[g,i,_,S]);return{size:S(),setSize:w,mutate:_,get data(){return T.data},get error(){return T.error},get isValidating(){return T.isValidating},get isLoading(){return T.isLoading}}},_0e=fO(E0e,T0e);function lA(t,e,n){const{data:r,error:o,isLoading:i,size:s,setSize:a,mutate:c}=_0e(e,t,{revalidateFirstPage:!!(n!=null&&n.refreshInterval),...n}),u=m.useCallback(async()=>{await c()},[c]),h=m.useCallback(async()=>{await a(s+1)},[a,s]),p=r==null?void 0:r[s-1],f=s>0&&!!r&&typeof p>"u",g=i||f,v=p?!!e(s+1,p):!1;return{loader:{loading:g,hasNextPage:v,error:o,onLoadMore:h,data:r},refetch:u}}function t8(){const t=s9(),e=L(pt),n=L(YI),r=m.useCallback(async({url:i,args:s,conversationId:a})=>{const c=await qn(i,X5,{query:s,analytics:{anonymousPath:"/conversations/*/history"},parseOptions:{safe:!0}}).then(u=>u.data);return c.results.length>0&&(c.results=MU(c.results),t(a,u=>{var h;u.length===0&&w0e((h=c.results.at(0))==null?void 0:h.createdAt),c.results.reverse(),u.unshift(...c.results)})),c},[t]);return lA(r,(i,s)=>{if(!e||n!=null&&n.prompt||!(s!=null&&s.next)&&i>0)return null;const a={url:`/conversations/${e}/history`,conversationId:e};return s!=null&&s.next&&(a.args={cursor:s.next}),a})}function w0e(t){try{const e=Ge(go),n=e==null?void 0:e.updatedAt;if(!t||!n)return;const r=new Date(n),o=new Date(t);(r.getTime()-o.getTime())/1e3/60>1&&z.trackEvent({name:"system",data:{eventName:"historyUpdatedAtDiscrepancy",eventInfo_conversationId:e.id,eventInfo_conversationUpdatedAt:n,eventInfo_lastMessageCreatedAt:t}})}catch{}}const A0e=3,k0e=10,x0e=3,gP={SUCCESS:"success",FAILED:"failed"};function R0e({toggleVoiceChat:t,enabled:e=!1}){const n=m.useRef(t);n.current=t;const r=m.useRef({hasAudio:!0,hasText:!0,retryCount:0,consecutiveErrors:0,isFirstTurn:!0}),[o,i]=m.useState(!1),s=L(pt),a=m.useCallback(g=>{const v=r.current;let y="initialAutoRetry";o?y="userManualRetry":v.isFirstTurn?y="initialAutoRetry":v.consecutiveErrors>0&&(y="backendAutoRecover");const b=JSON.stringify({retryCount:v.retryCount,consecutiveErrors:v.consecutiveErrors});z.trackEvent({name:"system",data:{eventName:"voiceRecoveryEventData",eventInfo_result:g,eventInfo_scenario:y,eventInfo_customData:b,eventInfo_conversationId:s??""}})},[o,s]),c=m.useCallback(async()=>{n.current("end",{force:!0}),await Tw(),n.current("start",{force:!0}),r.current.isFirstTurn=!0,r.current.retryCount+=1},[]),u=m.useCallback(()=>{a(gP.FAILED),n.current("end",{force:!0}),r.current.retryCount=0,r.current.consecutiveErrors=0,i(!0)},[a,i]),h=m.useCallback(()=>{(r.current.retryCount>0||r.current.consecutiveErrors>0||o)&&a(gP.SUCCESS),r.current.retryCount=0,r.current.consecutiveErrors=0,i(!1)},[i,a,o]),p=m.useCallback(()=>{const g=r.current;if(!o&&g.isFirstTurn&&g.retryCount<k0e){c();return}if(!(!g.isFirstTurn&&!o&&(g.consecutiveErrors+=1,g.consecutiveErrors<x0e))){if(o&&g.retryCount<A0e){c();return}u()}},[o,c,u]);return{voiceRecoveryHandler:m.useCallback(g=>{if(e)switch(g.event){case"startMessage":r.current.hasAudio=!1,r.current.hasText=!1;break;case"appendText":r.current.hasText=!0;break;case"audio":r.current.hasAudio=!0,h();break;case"done":r.current.hasText&&!r.current.hasAudio&&p(),r.current.isFirstTurn=!1;break}},[h,p,e]),isNoAudioErrorVisible:e?o:!1}}const N0e="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/call_ending-BxIIadI4.mp3",P0e="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/call_opening-CKuCznU5.mp3";function uA({data:t,parsedAudioData:e,audioContext:n,gainNode:r,sourceNodes:o,nextBufferTime:i,updateNextBufferTime:s,onAudioEnd:a,outputVolumeMuted:c=!1,getPlaySignal:u,updateAudioDuration:h,onAudioStart:p,playbackRate:f}){const g=e??tU(t);g.length!==0&&navigator.locks.request("audio-playback",async()=>{const v=g.length/Jf;h==null||h(v);const y=u==null?void 0:u(v);if(y)try{console.log("Awaiting play signal"),await y}catch(b){b instanceof Error&&(`${b.message}`,void 0);return}try{p(),await M0e(g,n,r,o,i,s,()=>a(t),c,f)}catch(b){console.error("Error playing audio:",b)}})}async function M0e(t,e,n,r,o,i,s,a,c=1){let u=t;if(c!==1){const{processAudioStretch:v}=await H(async()=>{const{processAudioStretch:y}=await import("./audio-stretch-processor-D0CzCbTE.js");return{processAudioStretch:y}},[]);u=v(t,c,Jf)}const h=e.createBuffer(1,u.length,Jf);h.getChannelData(0).set(u);const p=e.createBufferSource();p.buffer=h,p.connect(n),a&&(n.gain.value=0);const f=st();if(r.size===0){const v=f.get(HE),y=f.get(BE),b=v+(e.currentTime-y);f.set(HE,b)}r.add(p),p.onended=()=>{s(),f.set(BE,e.currentTime),r.delete(p),r.size===0&&f.set(FE,!1)};const g=h.length/h.sampleRate;o.current<e.currentTime&&i(e.currentTime),p.start(o.current),f.set(FE,!0),i(o.current+g)}async function O0e(t,e,n,r,o){const i=r&&await r(),s=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0,autoGainControl:!0,sampleRate:eU,...i}}),a=s.getAudioTracks()[0];a&&(a.onended=h=>{o==null||o(h)});const c=e.createMediaStreamSource(s),u=e.createScriptProcessor(8192,1,1);return c.connect(n),n.connect(u),u.connect(e.destination),u.onaudioprocess=h=>{const p=h.inputBuffer.getChannelData(0),f=new Int16Array(p.length);for(let v=0;v<p.length;v+=1){const y=p[v];typeof y=="number"&&(f[v]=Bve(y))}const g=Fve(f.buffer);t(g)},s}async function vP(t,e){const n=await Promise.race([hD(e),new Promise(r=>{try{const o=new Audio(t);o.addEventListener("ended",()=>r(o),{once:!0}),o.play()}catch{}})]);n==null||n.remove()}const L0e=Jf*2;class D0e{constructor(){W(this,"audioBuffer",[]);W(this,"totalBufferSize",0);W(this,"lastProcessOptions",null)}addAudioData(e){if(!e)return!1;const n=tU(e),r=n.length;return r===0?!1:(this.audioBuffer.push({audioData:n,bufferSize:r}),this.totalBufferSize+=r,this.totalBufferSize>=L0e)}getLastProcessOptions(){return this.lastProcessOptions}setLastProcessOptions(e){this.lastProcessOptions=e}mergeAudioChunks(){const e=new Float32Array(this.totalBufferSize);let n=0;for(const r of this.audioBuffer){const{audioData:o}=r;e.set(o,n),n+=o.length}return e}getAudioData(){if(this.audioBuffer.length===0)return null;if(this.audioBuffer.length===1){const e=this.audioBuffer[0];return e?e.audioData:null}return this.mergeAudioChunks()}clearBuffer(){this.audioBuffer=[],this.totalBufferSize=0}}function j0e(t,e){const n=t.data;if(!e){uA(t);return}e.setLastProcessOptions(t),e.addAudioData(n)&&n8(e)}function U0e(t){t&&n8(t)}function n8(t){const e=t.getAudioData(),n=t.getLastProcessOptions();!e||!n||(uA({...n,parsedAudioData:e}),t.clearBuffer())}const Q2e={lmks_rest:"lmksRest",frames:"frames",expr:"expr",neck_pose:"neckPose",jaw_pose:"jawPose",eyes_pose:"eyesPose",eyes_open_ratio:"eyesOpenRatio",rotation:"rotation",translation:"translation",lmks:"lmks"};class F0e{constructor(e,n){W(this,"lmksRest");W(this,"frames");this.lmksRest=e,this.frames=n}}class B0e{constructor(e,n){W(this,"exp");W(this,"pose");this.exp=e,this.pose=n}isValid(){return this.exp.dtype!==""&&this.exp.data.length>0||this.pose.dtype!==""&&this.pose.data.length>0}}const H0e=3.141592653589793,bP="System.Single, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089";function z0e(t){const e=[],n=[],r=(a,c)=>{if(c>=a.length)throw new Error("index out of range");return a[c]===void 0?0:a[c]};for(const{frame:a,offset:c}of t){if(a.length<97)return console.log("Invalid frame length"),null;const u=new Array(28).fill(0);u[12]=r(a,78),u[16]=r(a,43),u[17]=r(a,43),u[21]=r(a,72),u[23]=.5*r(a,52)+.5*r(a,53),u[24]=.75*r(a,76),u[26]=.75*r(a,76),e.push({exp:u,offset:c});const h=[[-1*r(a,88)+H0e,-1*r(a,89),r(a,90)],[0,r(a,92),-1*r(a,91)],[0,r(a,95),-1*r(a,94)]];n.push(h)}const o={dtype:bP,shape:[e.length,16],data:e,isColumnMajor:!1},i={dtype:bP,shape:[n.length,3,3],data:n,isColumnMajor:!1};return new B0e(o,i)}class V0e{constructor(){W(this,"LOCK_NAME","animation-data-frames-lock");W(this,"TIMEOUT_MSEC",P$);W(this,"a2eState",{frames:[],timeoutId:null});W(this,"vasaState",{frames:[],timeoutId:null});W(this,"a2eConfig",{getAnimationData:e=>z0e(e),calculateDuration:e=>e/LO});W(this,"vasaConfig",{getAnimationData:e=>new F0e([],e),calculateDuration:e=>e/DO});W(this,"waitingForLock",new Set);W(this,"lockedBy",null);W(this,"unblock",()=>{})}async requestLock(e,n){if(typeof navigator<"u"&&navigator.locks){if(this.waitingForLock.has(e))return;this.waitingForLock.add(e),await navigator.locks.request(this.LOCK_NAME,async()=>{this.lockedBy&&this.lockedBy!==this.LOCK_NAME&&await new Promise(r=>{this.unblock=()=>{r()}}),await n(),this.waitingForLock.delete(e)})}else await n()}lockAnimation(e){this.lockedBy=e}unlockAnimation(){this.lockedBy=null,this.unblock()}setA2EFrame(e,n,r){e&&(this.a2eState.frames.push({frame:e,offset:n}),this.addFrames(this.a2eState,this.a2eConfig,r))}setVasaFrame(e,n){e&&(this.vasaState.frames.push(e),this.addFrames(this.vasaState,this.vasaConfig,n))}async addFrames(e,n,r){const o=e;this.requestLock("addFrames",async()=>{if(o.frames.length>=j$){o.timeoutId&&clearTimeout(o.timeoutId),this.flushFrames(o,n,r);return}if(!o.timeoutId){const i=window.setTimeout(()=>{this.flushFrames(o,n,r)},this.TIMEOUT_MSEC);o.timeoutId=i}})}flushFrames(e,n,r){this.requestLock("flushFrames",async()=>{if(e.frames.length===0)return;st().set(WO,{animationData:n.getAnimationData(e.frames)});const o=n.calculateDuration(e.frames.length);r==null||r(o),`${e.frames.length}`;const i=e;i.frames=[],i.timeoutId=null})}resetFrames(){for(const e of[this.a2eState,this.vasaState])e.timeoutId&&clearTimeout(e.timeoutId),e.frames=[],e.timeoutId=null}}class Yv{constructor(){W(this,"totalAudioDuration",0);W(this,"totalAnimationDataDuration",0);W(this,"nonInitialPromiseChecked",0);W(this,"animationDataFrameHandler");W(this,"isFrameAppendable",!1);this.animationDataFrameHandler=new V0e}lockAnimation(e){this.animationDataFrameHandler&&this.animationDataFrameHandler.lockAnimation(e)}unlockAnimation(){this.animationDataFrameHandler&&this.animationDataFrameHandler.unlockAnimation()}addAnimationDataDuration(e){this.totalAnimationDataDuration+=e*1e3}addAudioDuration(e){const n=e*1e3;this.totalAudioDuration+=n}getAnimationSyncPromise(e,n){return`${this.totalAudioDuration}${this.totalAnimationDataDuration}`,e===0?Yv.constructCharacterTalkPromise(M$):n===0?null:this.totalAudioDuration>this.totalAnimationDataDuration+D$&&(this.nonInitialPromiseChecked+=1,this.nonInitialPromiseChecked%L$===1)?Yv.constructCharacterTalkPromise(O$):null}resetAudioAnimationSync(e=null){this.animationDataFrameHandler&&(this.animationDataFrameHandler.resetFrames(),this.totalAudioDuration=0,this.totalAnimationDataDuration=0);const n=st();n.set(Hye,e??null),n.set(FE,!1),n.set(HE,0),n.set(BE,0)}enableFramesAppending(){this.isFrameAppendable=!0}disableFramesAppending(){this.isFrameAppendable=!1}setA2EFrame(e,n){if(this.isFrameAppendable&&this.animationDataFrameHandler){if(((e==null?void 0:e.length)??0)===0)return;n!==this.totalAnimationDataDuration&&(`${n}${this.totalAnimationDataDuration}`,void 0),this.totalAnimationDataDuration+=1/LO*1e3,this.animationDataFrameHandler.setA2EFrame(e,n),`${this.totalAudioDuration}${this.totalAnimationDataDuration}`}}setVasaFrameData(e){this.isFrameAppendable&&this.animationDataFrameHandler&&(this.totalAnimationDataDuration+=1/DO*1e3,this.animationDataFrameHandler.setVasaFrame(e))}static constructCharacterTalkPromise(e){const n="start-audio-playback-custom",r=new AbortController,{signal:o}=r,i=new Promise(c=>{const u=()=>{c(),r.abort()};window.addEventListener(n,u,{once:!0,signal:o})}),s=new Promise((c,u)=>{const h=()=>{u(new Error("Audio interrupted")),r.abort()};Mt.on("voice:audio-interrupted",h)}),a=new Promise(c=>{setTimeout(()=>{c(),r.abort()},e)});return Promise.race([i,s,a])}}const Jv=class Jv{constructor(){W(this,"readyTime",0);W(this,"startCallTime",0);W(this,"startMessageTime",0);W(this,"mostRecentTokenTime",0);W(this,"interruptAudioTime",0);W(this,"speechEndTime",0);W(this,"currentConversationId","");W(this,"currentCallId","");W(this,"currentMessageId","");W(this,"introComplete",!1);W(this,"receivedTranscript",!1);W(this,"receivedText",!1);W(this,"receivedAudio",!1);W(this,"receivedFirstToken",!1);W(this,"receivedLastToken",!1);W(this,"receivedFirstAnimation",!1);W(this,"hasAudioStarted",!1);W(this,"scenario")}static getInstance(){return this.instance||(this.instance=new Jv),this.instance}onBeforeStartCall(e){this.readyTime=performance.now(),this.scenario=e?"appearance":void 0}onStartCall(e){this.interruptAudioTime=0,this.speechEndTime=0,this.introComplete=!1,this.startCallTime=performance.now(),this.currentConversationId=e,this.currentCallId=crypto.randomUUID(),z.trackEvent({name:"interaction",data:{eventName:"copilotCompose",eventInfo_conversationId:this.currentConversationId,eventInfo_inputMethod:"voice",eventInfo_landingPage:z.getLandingPage(),eventInfo_scenario:this.scenario}}),z.trackEvent({name:"interaction",data:{eventName:"audioStartSent",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:this.startCallTime-this.readyTime,eventInfo_scenario:this.scenario}})}onStartMessage(e){this.receivedTranscript=!1,this.receivedText=!1,this.receivedAudio=!1,this.receivedFirstToken=!1,this.receivedLastToken=!1,this.receivedFirstAnimation=!1,this.hasAudioStarted=!1,this.currentMessageId=e,this.startMessageTime=performance.now(),jg.onStartMessage(e,this.startMessageTime),this.speechEndTime&&z.trackEvent({name:"system",data:{eventName:"copilotAudioReqtoResp",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:this.startMessageTime-this.speechEndTime,eventInfo_scenario:this.scenario}}),z.trackEvent({name:"system",data:{eventName:"copilotAudioStartMessage",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_scenario:this.scenario,eventInfo_firstTurn:!this.introComplete}})}onTranscriptReceived(){this.receivedTranscript=!0}onTextReceived(e){e===this.currentMessageId&&(this.receivedText=!0)}onAudioInterrupt(){this.interruptAudioTime=performance.now()}onAudioReceived(){this.receivedAudio=!0,!(!this.introComplete||!this.currentMessageId)&&(this.mostRecentTokenTime=performance.now(),this.receivedFirstToken||(this.receivedFirstToken=!0,this.startMessageTime&&z.trackEvent({name:"system",data:{eventName:"copilotAudioResptoReceived",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:this.mostRecentTokenTime-this.startMessageTime,eventInfo_scenario:this.scenario}}),this.speechEndTime&&z.trackEvent({name:"system",data:{eventName:"copilotAudioFirstTokenReceived",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:this.mostRecentTokenTime-this.speechEndTime,eventInfo_scenario:this.scenario}})))}onSpeechEndDetected(){this.speechEndTime=performance.now(),jg.onSpeechEndDetected(this.speechEndTime),this.interruptAudioTime&&z.trackEvent({name:"system",data:{eventName:"copilotAudioInput",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:this.speechEndTime-this.interruptAudioTime,eventInfo_scenario:this.scenario}})}onCharacterAnimationReceived(){this.receivedFirstAnimation||(this.receivedFirstAnimation=!0,z.trackEvent({name:"system",data:{eventName:"copilotAudioCharacterAnimationReceived",eventInfo_conversationId:this.currentConversationId,eventInfo_duration:performance.now()-this.speechEndTime,eventInfo_messageId:this.currentMessageId,eventInfo_callId:this.currentCallId,eventInfo_scenario:this.scenario}}))}onMessageDone(e){const{messageId:n,voiceType:r}=e;if(z.trackEvent({name:"system",data:{eventName:"copilotAudioMessageDone",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:n,eventInfo_scenario:this.scenario,eventInfo_firstTurn:!this.introComplete,eventInfo_transcriptReceived:this.receivedTranscript,eventInfo_textReceived:this.receivedText,eventInfo_audioReceived:this.receivedAudio}}),!this.introComplete){this.introComplete=!0,z.trackEvent({name:"system",data:{eventName:"copilotAudioCallSetUp",eventInfo_duration:performance.now()-this.readyTime,eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_responseVoiceType:r,eventInfo_scenario:this.scenario}});return}!this.receivedLastToken&&n===this.currentMessageId&&(this.receivedLastToken=!0,this.speechEndTime&&z.trackEvent({name:"system",data:{eventName:"copilotAudioLastTokenReceived",eventInfo_conversationId:this.currentConversationId,eventInfo_messageId:n,eventInfo_callId:this.currentCallId,eventInfo_duration:this.mostRecentTokenTime-this.speechEndTime,eventInfo_scenario:this.scenario}}),z.trackEvent({name:"system",data:{eventName:"copilotResponseRender",eventInfo_inputMethod:"voice",eventInfo_responseMethod:"voice",eventInfo_conversationId:this.currentConversationId,eventInfo_messageId:this.currentMessageId,eventInfo_responseVoiceType:r,eventInfo_landingPage:z.getLandingPage(),eventInfo_scenario:this.scenario}}))}onEndCall(e){const n=performance.now()-this.startCallTime;z.trackEvent({name:"system",data:{eventName:"copilotAudioCallEnd",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:n,eventInfo_numMessages:e,eventInfo_scenario:this.scenario}}),this.currentCallId=""}onAudioStartFailed(e){z.trackEvent({name:"system",data:{eventName:"copilotAudioStartFailed",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:performance.now()-this.startCallTime,eventInfo_reason:e,reason:e,eventInfo_scenario:this.scenario}})}onAudioStartTimeout(e){z.trackEvent({name:"system",data:{eventName:"copilotAudioStartTimeout",eventInfo_conversationId:this.currentConversationId,eventInfo_duration:e,eventInfo_scenario:this.scenario}})}onTerminated(e){z.trackEvent({name:"system",data:{eventName:"copilotAudioTerminated",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:performance.now()-this.startCallTime,eventInfo_reason:e,reason:e,eventInfo_scenario:this.scenario}})}onError(e){z.trackEvent({name:"system",data:{eventName:"copilotAudioError",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:performance.now()-this.startCallTime,eventInfo_errorCode:e,eventInfo_scenario:this.scenario}})}onAudioStart(){if(!this.hasAudioStarted){this.hasAudioStarted=!0;const e=Math.round(performance.now()-(this.speechEndTime||this.startMessageTime));z.trackEvent({name:"system",data:{eventName:"copilotAudioStart",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:e,eventInfo_scenario:this.scenario}})}}};W(Jv,"instance");let YE=Jv;const $0e=null;function G0e(t){return t instanceof Error&&(t.name==="NotFoundError"||t.name==="OverconstrainedError")}const K0e=1;function Um(t,e){Mt.emit(`voice:audio-${e}-volume-changed`,t)}function q0e({initAudio:t,getAudioConstraints:e,onCallTerminated:n,onSpeechEndDetected:r,keepAudioInputAlive:o=!1,shouldRefetchHistory:i=!0,isVoiceRecoveryEnabled:s=!1}){const a=Ee(fc),c=Ee(WO),u=Ee(X$),h=le("experimental-vasa"),p=RT(),f=Ee(Qu),g=le("voice-call-jingles"),v=Ee(z$),y=L(pt),b=L(gb),C=L(lp),S=Ee(Vh),E=Ee(V$),I=Ee(Ac),T=Ee(Cd),_=le("voice-speed"),w=L(aL),A=s9(),{refetch:M}=t8(),{showBoundary:R}=UM(),$=m.useRef(),V=m.useRef(),ie=m.useRef(),N=nB(0),Y=m.useRef(null),ue=m.useRef(null),j=m.useRef(null),U=m.useRef(null),te=m.useRef(new Set),Q=m.useRef(null),[re,Z]=m.useState(!1),_e=m.useRef(0),ye=k=>{_e.current=k},Se=k=>{var G;return(G=Q.current)==null?void 0:G.addAudioDuration(k)},Ne=m.useRef("inactive"),we=m.useCallback(()=>p?!!Ge(Qu):!1,[p]),Ke=m.useRef(!1),de=m.useRef(""),ge=m.useRef(_?new D0e:void 0),$e=m.useRef(0),P=m.useCallback(k=>{Ke.current&&k===de.current&&(v("listening"),a("listening"),Z(!1))},[v,a]),J=m.useCallback(k=>{const{analyser:G,frameIdRef:ee,volume:Ce}=k;if(!G)return;const De=new Uint8Array(G.frequencyBinCount),Qe=K0e,rt=()=>{var yt;G.getByteTimeDomainData(De);const lt=Hve(De);Math.abs(lt-Ce.get())>Qe&&((yt=k.update)==null||yt.call(k,lt),Ce.set(lt)),ee.current=requestAnimationFrame(rt)};rt()},[]),Te=k=>{k.current!==null&&(cancelAnimationFrame(k.current),k.current=null)};m.useEffect(()=>()=>{Te(j),Te(ue)},[]);const[O,ce]=m.useState(!t),se=YE.getInstance();m.useEffect(()=>{t||(ce(!0),S("waiting-for-user-interaction"))},[t,ce,S]);const ne=m.useCallback(async()=>{y&&(A(y,k=>k.splice(0)),await M())},[M,y,A]),K=m.useCallback(async()=>{if(ie.current){for(const k of ie.current.getTracks())k.stop();ie.current=null}if($.current)try{await $.current.close(),$.current=null}catch(k){console.error("Unable to close audioContextIn",k)}Te(ue),N.set(0),Um(0,"input"),fn(Ih,null)},[N]),pe=m.useCallback(async k=>{if(Ne.current="ending",await K(),V.current)try{await V.current.close(),V.current=null}catch(G){console.error("Unable to close audioContextOut",G)}Te(j),DE.set(0),Um(0,"output"),Z(!1),ce(!1),k.sendAudioEnd(),v("idle"),Ge(Vh)==="available"&&(g&&vP(N0e,3e3),i&&await ne(),se.onEndCall($e.current),$e.current=0,T(!0))},[K,v,g,ne,i,se,T]),He=m.useCallback(async k=>{$.current=new AudioContext({sampleRate:eU}),Y.current=$.current.createAnalyser(),_e.current=0;const G=async()=>{o&&Ne.current==="active"&&(await K(),await He(k))};let ee=null;try{ee=await O0e(k.sendAudio,$.current,Y.current,e,G)}catch(Ce){Ce instanceof Error&&(Ce.name==="NotAllowedError"||Ce.name==="NotSupportedError")?(S("microphone-denied"),await pe(k),z.trackEvent({name:"system",data:{eventName:"copilotNoMicrophoneAccess"}})):G0e(Ce)?(S("microphone-not-found"),await pe(k),z.trackEvent({name:"system",data:{eventName:"copilotMicrophoneNotFound"}})):R(new Error(`Error starting audio capture: ${Ce}`))}if(ee){if(O)for(const Ce of ee.getTracks())Ce.enabled=!1;ie.current=ee,J({volume:N,analyser:Y.current,frameIdRef:ue,update:Ce=>{Um(Ce,"input")}})}},[O,J,N,o,K,e,S,pe,R]),at=m.useRef(!1),ut=m.useCallback(()=>{if(Te(j),!V.current)return;const k=V.current.createGain(),G=V.current.createAnalyser();k.connect(G),G.connect(V.current.destination),U.current=k,Z(!0),J({volume:DE,analyser:G,frameIdRef:j,update:ee=>{Um(ee,"output")}})},[J]),Le=m.useCallback(k=>{const G=k==="mute";if(ce(G),fn(Bye,G),ie.current)for(const ee of ie.current.getTracks())ee.enabled=k==="unmute"},[]),Xe=m.useCallback(k=>{var G;if(we())return(G=Q.current)==null?void 0:G.getAnimationSyncPromise(_e.current,k)},[we]),St=m.useCallback(async k=>{V.current=new AudioContext({sampleRate:Jf}),_e.current=0,ut(),at.current||(at.current=!0,await He(k)),Ge(JI)&&Le("mute")},[He,ut,Le]),Ut=m.useCallback(()=>{const k=be.instance().config().audioConfigClientType;if(k)return k;if(we())return"character"},[we]),Gt=m.useCallback(async k=>{var De;if(!y||!t||Ne.current==="ending")return;S("checking-availability"),E(null),at.current=!1;const{sendAudioStart:G}=k,ee=Ut();G(y,{voice:C??((De=b[0])==null?void 0:De.id)},ee);const Ce=1e4;setTimeout(()=>{Ge(Vh)==="checking-availability"&&Ne.current==="active"&&se.onAudioStartTimeout(Ce)},Ce),se.onStartCall(y),g&&await navigator.locks.request("audio-playback",async()=>{var Qe,rt;(Qe=Q.current)==null||Qe.lockAnimation("audio-playback"),await vP(P0e,3e3),(rt=Q.current)==null||rt.unlockAnimation()}),mu("onStartVoiceChat")},[y,t,S,C,b,se,E,g,Ut]),Kt=m.useCallback(()=>{var k,G;for(const ee of te.current)ee.stop();te.current.clear(),(k=V.current)==null||k.close(),V.current=null,Z(!1),(G=Q.current)==null||G.resetAudioAnimationSync()},[]),kn=m.useCallback(async k=>{Kt(),await pe(k),n()},[pe,n,Kt]),F=Vw(_?w:hb),me=m.useRef(null),ve=m.useCallback(k=>G=>{var ee,Ce,De,Qe,rt,lt,yt,Qt;switch(G.event){case"startMessage":{const{messageId:ot}=G;if(se.onStartMessage(ot),Kt(),Ne.current==="inactive")break;St(k),S("available"),v("listening"),Z(!0),fn(f0,!1),(ee=Q.current)==null||ee.resetAudioAnimationSync(V.current),(Ce=Q.current)==null||Ce.enableFramesAppending();break}case"transcriptEvent":{se.onTranscriptReceived();break}case"appendText":{const{messageId:ot}=G;se.onTextReceived(ot);break}case"audioStartFailed":{const{reason:ot}=G,{success:xn}=nL.safeParse(ot);S(xn?ot:"error"),se.onAudioStartFailed(ot);break}case"audioTimeRemaining":{const{seconds:ot}=G;E(ot);break}case"audio":{if(Ne.current==="inactive")break;if(se.onAudioReceived(),v("responding"),Z(!0),de.current=G.audio,V.current&&U.current){const ot={data:G.audio,audioContext:V.current,gainNode:U.current,sourceNodes:te.current,nextBufferTime:_e,updateNextBufferTime:ye,onAudioEnd:P,outputVolumeMuted:h,getPlaySignal:Xe,updateAudioDuration:we()?Se:void 0,onAudioStart:()=>se.onAudioStart(),playbackRate:F};_?j0e(ot,ge.current):uA(ot)}break}case"characterAnimation":{if(se.onCharacterAnimationReceived(),we()){const{frame:ot}=G;(ot==null?void 0:ot.model)==="spda2e"&&((De=Q.current)==null||De.setA2EFrame(ot.poseDiffusion,G.offsetInMilliseconds)),(ot==null?void 0:ot.model)==="vasa"&&((Qe=Q.current)==null||Qe.setVasaFrameData(ot))}break}case"callUI":{const{callUI:ot}=G,xn=Ge(Ih);ot?Array.isArray(ot.topics)?(ot.selectedIndex??(ot.selectedIndex=-1),fn(Ih,ot)):fn(Ih,{...xn??{},...ot,topics:(xn==null?void 0:xn.topics)??null}):fn(Ih,null);break}case"characterEmotion":{we()&&u({emotion:G.emotion,bodyReaction:G.bodyReaction});break}case"interruptAudio":{we()&&(Mt.emit("voice:audio-interrupted"),(rt=Q.current)==null||rt.resetAudioAnimationSync(),(lt=Q.current)==null||lt.disableFramesAppending(),c(null)),v("listening"),a("listening"),se.onAudioInterrupt(),Kt(),fn(f0,!0),u(null);break}case"speechEndDetected":{se.onSpeechEndDetected(),a("thinking"),r==null||r();break}case"callTerminated":{kn(k),se.onTerminated(G.reason);break}case"error":{const{errorCode:ot}=G;switch(ot){case"over-turn-limit":{I(0);break}case"character-out-of-capacity":{k.setCallType("standard");break}}Ne.current==="active"&&se.onError(ot);break}case"done":{const{messageId:ot}=G;Ke.current=!0,$e.current+=1,ge.current&&U0e(ge.current),se.onMessageDone({messageId:ot,voiceType:C??((yt=b[0])==null?void 0:yt.id)}),fn(f0,!0);break}case"banned":{const{expiresAt:ot}=G,xn=pw(ot);xn&&(mw(xn,"voice",ot),Kt(),pe(k));break}case"callTypeChanged":{const{callType:ot}=G;ot==="standard"&&f(void 0);break}}try{(Qt=me.current)==null||Qt.call(me,G)}catch{}},[se,Kt,St,S,we,E,v,P,h,Xe,a,c,r,kn,I,C,b,pe,f,F,_,u]),je=m.useCallback(()=>k=>{switch(k.event){case"callEnded":{Ne.current="inactive";break}}},[]),Ve=m.useCallback(async(k,G)=>{const{force:ee=!1}=G??{};if(k==="start"&&Ne.current!=="inactive"&&!ee)return;if(k==="start"){const De=m1();se.onBeforeStartCall(De)}if(k==="end"&&Ne.current==="inactive"&&!ee)return;Ne.current=k==="start"&&t?"active":"inactive",k==="start"&&we()&&(Q.current=new Yv),jg.onVoiceChatToggled(k,y);const Ce=await es({useMockConnection:!!$0e});k==="start"?(Ce.setOnEvent(ve(Ce)),await Gt(Ce)):(Ce.setOnEvent(je()),await pe(Ce))},[ve,je,we,Gt,pe,se,t,y]),{voiceRecoveryHandler:ct,isNoAudioErrorVisible:Be}=R0e({toggleVoiceChat:Ve,enabled:s});return me.current=ct,{toggleVoiceChat:Ve,toggleMute:Le,isInputMuted:O,inputVolume:N,hasOutputVolume:re,isNoAudioErrorVisible:Be}}const J2e="https://picassostaticassetsstg.azureedge.net/character/try-now/lumi_intro_394_222";function yP(t,e){if(!t)return!1;const n=Sn(C$)??Sn(S$);return!e&&!n}function W0e({isAudioCall:t,onCallTerminated:e,onMute:n,onUnmute:r}){const o=Ft(),i=EL(),[s,a]=gy(),c=s==="audioCall",[u,h]=m.useState(!1),p=L(Qu),f=le("appearance-try-now-modal"),g=L(JI),{state:v,setState:y}=zw({defaultValue:!c}),{toggleVoiceChat:b,toggleMute:C,hasOutputVolume:S,inputVolume:E,isInputMuted:I}=q0e({initAudio:v,onCallTerminated:e}),T=m.useRef(b);T.current=b,m.useEffect(()=>{t?!c&&!yP(f,p)&&!g&&T.current("start"):T.current("end")},[o,t,c,T,p,g,f]);const _=m.useCallback(()=>{b("start"),v&&!u&&(h(!0),C("unmute"))},[b,v,u,C]),w=m.useCallback(()=>{a(),y(!0),b("end")},[a,y,b]),A=m.useCallback(()=>{y(!0),C(I?"unmute":"mute"),I?r==null||r():n==null||n()},[y,C,I,n,r]);m.useEffect(()=>{t&&c&&v&&_()},[v,t,c,_]);const M=m.useCallback(async(V=!1)=>{(!t||V)&&await R()!=="NotSupported"||(await i({talk:!0}),yP(f,p)||_())},[t,f,i,p,_]);m.useEffect(()=>{c&&M(!0)},[c,M]);async function R(){return(await kle.run({onAudioCall:async()=>"NotSupported"})).onAudioCall()}const $=m.useCallback(V=>{const{toLocation:ie}=V,N=ie.pathname;t&&!N.endsWith("/talk")&&T.current("end")},[t]);return hw($),{launchAudioCall:M,startAudioCallIfNotStartedAlready:_,endAudioCall:w,toggleAudioInput:A,inputVolume:E,isInputMuted:I,hasOutputVolume:S,isAudioDeepLink:c,canInitAudio:v}}const r8={sdk:"8.0",messaging:{origin:window.location.origin,channelId:crypto.randomUUID()},accessibility:{showFocusOnLoad:!1,enableFocusTrap:!0},authentication:{},entry:{oneDrive:{recent:{}}},typesAndSources:{mode:"files",filters:Bfe,pivots:{oneDrive:!0,recent:!0,photos:!1}}},Y0e=new URLSearchParams({app:"CMC",scenario:"AnalyzeDoc",filePicker:JSON.stringify(r8),locale:Nt.resolvedLanguage??"en-US"}),o8="https://onedrive.live.com",Q0e=`${o8}/picker?${Y0e}`;async function i8(){const t=await Ule();return(t==null?void 0:t.accessToken)??""}function J0e(t){return t!==null&&typeof t=="object"&&"type"in t&&t.type==="initialize"&&"channelId"in t&&typeof t.channelId=="string"}function Z0e({port:t,onClose:e,onPick:n,setIsLoading:r,onError:o}){return async i=>{let s;switch(i.data.type){case"notification":i.data.data.notification==="page-loaded"&&r(!1);break;case"command":switch(t.postMessage({type:"acknowledge",id:i.data.id}),i.data.data.command){case"authenticate":s=await i8(),typeof s<"u"?t.postMessage({type:"result",id:i.data.id,data:{result:"token",token:s}}):(t.postMessage({type:"result",id:i.data.id,data:{result:"error",error:{code:"authTokenError",message:"Could not get OneDrive authentication token."}}}),r(!1),o(),e());break;case"close":e();break;case"pick":i.data.data.items!==void 0&&i.data.data.items.length>0&&i.data.data.items[0]!==void 0&&(n(i.data.data.items[0]),t.postMessage({type:"result",id:i.data.id,data:{result:"success"}}),e());break;default:r(!1),t.postMessage({result:"error",error:{code:"unsupportedCommand",message:i.data.data.command},isExpected:!0}),o(),e();break}break}}}function X0e({onClose:t,onPick:e,onError:n}){const r=m.useRef(null),{t:o}=Oe(),[i,s]=m.useState(!0);return m.useEffect(()=>{var p;const a=()=>{const f={title:o("composer.errors.attachmentOneDrive.title"),message:o("composer.errors.attachmentOneDrive.message")};n(f),z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitMessage",eventInfo_errorMessage:f.message,eventInfo_details:"Error submitting message"}})},c=(p=r.current)==null?void 0:p.contentWindow;let u,h;return c&&(async()=>{const g=c.document.createElement("form");g.method="POST",g.action=Q0e,c.document.body.appendChild(g);const v=c.document.createElement("input");v.type="hidden",v.name="access_token",v.value=await i8(),g.appendChild(v),window.addEventListener("message",y=>{if(y.origin&&y.origin===o8){const b=y.data;if(J0e(b)&&b.channelId===r8.messaging.channelId){if([h]=y.ports,!h){s(!1),a(),t();return}u=Z0e({port:h,onClose:t,onPick:e,onError:a,setIsLoading:s}),h.addEventListener("message",u),h.start(),h.postMessage({type:"activate"})}}}),g.submit()})(),()=>{u&&window.removeEventListener("message",u),h&&h.close()}},[t,e,n,o]),d.jsxs(zd,{isOpen:!0,onClose:t,className:"flex h-[90vh] max-h-[680px] w-[90vw] max-w-[1080px]",fullBleed:!0,children:[i&&d.jsxs("div",{className:"flex size-full items-center justify-center","aria-live":"polite",role:"status","aria-label":o("oneDrive.pickerLoading"),children:[d.jsx("span",{className:"sr-only",children:o("oneDrive.pickerLoading")}),d.jsx(Rt,{className:"size-20"})]}),d.jsx("iframe",{title:o("onedrive.filePicker"),ref:r,hidden:i,width:"100%",height:"100%"})]})}const e1e="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/add-BTcFT5ig.svg",t1e="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/image-zMo0jLdY.svg",n1e="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/podcast-BQmBU8ew.svg",r1e="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/quiz-BBvkoZrF.svg",o1e="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/research-i8a7tpJF.svg";function i1e(t){const{onPrefillComposerInput:e,disabled:n=!1}=t,r=L(ST),o=L(Tb),[i,s]=it(_n),a=L(gr),c=L(_b),u=Lr(),h=Ee(ml),p=Jw(),{handleProSubscription:f}=Gv({payflowEntryPoint:"PodcastLimit",skuType:c?"FreeTrial":"1Mo-Paid",upsellReason:"",entryStyle:"Button"}),{handleProSubscription:g}=Gv({payflowEntryPoint:"ResearchReportLimit",skuType:c?"FreeTrial":"1Mo-Paid",upsellReason:"",entryStyle:"Button"}),v=s1e({remainingPodcastGeneration:r,remainingResearchReportGeneration:o,isPro:(a==null?void 0:a.isPro)??!1}),y=Ee(Cj),b=oA(),C=m.useCallback(I=>{const T=v[I];if(T){switch(T.key){case"image":y("image");break;case"podcast":if(!u&&r===0){h({isOpen:!0,scenario:"podcast",reason:"createPodcast"});return}if(!(a!=null&&a.isPro)&&r===0){if(!p)return;f();return}y("podcast");break;case"researchReport":if(!u&&o===0){h({isOpen:!0,scenario:"researchReport",reason:"createResearchReport"});return}if(!(a!=null&&a.isPro)&&o===0){if(!p)return;g();return}y("researchReport"),s("research");break;case"quiz":y("quiz");break;case"actions":y("actions"),s("computerUse");break;default:y(null);break}e(T.composerInputPrompt??"")}},[v,y,e,a,r,o,p,f,g,u,h,s]),S=m.useCallback(()=>{y(null),KE(),s("chat")},[y,s]),E=m.useRef(null);return m.useEffect(()=>{var I;b.length===0&&i!=="research"&&i!=="computerUse"&&((I=E.current)==null||I.setSelectedItemIndex(0),S())},[b,S,i]),d.jsx(Kw,{ref:E,items:v,onSelect:C,defaultSelectedItemIndex:0,onReset:S,disabled:n,onMenuClick:()=>ht({source:"composerCreateButton",pageName:"chatPage"})})}function Vl(t){return e=>{ybe(t,e)}}function $l(t){return e=>{Ebe(t,e)}}function s1e({remainingPodcastGeneration:t,remainingResearchReportGeneration:e,isPro:n}){const r=le("podcast-in-create-drawer"),o=hU(),i=Cw(),s=r,a=o,c=le("quiz-in-create-drawer"),{t:u}=Oe("translation",{keyPrefix:"composer.create"});return m.useMemo(()=>{const p={key:"create",title:u("buttonTitle"),icon:d.jsx(rr,{url:e1e,className:"size-5"}),description:u("buttonDescription"),composerInputPrompt:"",testId:"composer-create-button",onImpression:Vl(null),beforeClick:$l(null),isIconEnabledInButton:!0},f={key:"image",title:u("image.title"),icon:d.jsx(rr,{url:t1e,className:"size-6"}),description:u("image.description"),composerInputPrompt:u("image.prompt"),testId:"composer-create-image-button",onImpression:Vl("image"),beforeClick:$l("image")};function g(){return{key:"podcast",title:u("podcast.title"),icon:d.jsx(rr,{url:n1e,className:"size-6"}),description:u("podcast.description"),composerInputPrompt:u("podcast.prompt"),testId:"composer-create-podcast-button",onImpression:Vl("podcast"),beforeClick:$l("podcast"),tags:t!==null&&n===!1?[{label:u("podcast.remainingCalls",{remainingCalls:t.toString()}),color:t>0?"neutral":"accent"}]:void 0}}function v(){return{key:"researchReport",title:u("researchReport.title"),icon:d.jsx(rr,{url:o1e,className:"size-6"}),description:u("researchReport.description"),composerInputPrompt:u("researchReport.prompt"),testId:"composer-create-research-report-button",onImpression:Vl("researchReport"),beforeClick:$l("researchReport"),tags:e!==null&&n===!1?[{label:u("researchReport.remainingCalls",{remainingCalls:e.toString()}),color:e>0?"neutral":"accent"}]:void 0}}function y(){return{key:"quiz",title:u("quiz.title"),icon:d.jsx(rr,{url:r1e,className:"size-6"}),description:u("quiz.description"),composerInputPrompt:u("quiz.prompt"),testId:"composer-create-quiz-button",onImpression:Vl("quiz"),beforeClick:$l("quiz")}}function b(){return{key:"actions",title:u("actions.title"),icon:d.jsx(rr,{url:dU,className:"size-6"}),description:u("actions.description"),composerInputPrompt:u("actions.prompt"),testId:"composer-create-actions-button",onImpression:Vl("actions"),beforeClick:$l("actions"),tags:n===!1?[{label:u("actions.labsTag"),color:"accent"}]:void 0}}return[p,f,a?v():void 0,s?g():void 0,c?y():void 0,i?b():void 0].filter(C=>C!==void 0)},[t,n,u,i,s,a,e,c])}function a1e({selectFile:t,disabled:e=!1}){const{t:n}=Oe();return d.jsx("div",{className:"flex",children:d.jsx(Me,{role:"menuitem",variant:"rect",size:"36-sm",color:"subtle-dimmed-inverted",title:n("composer.upload"),disabled:e,testId:"file-upload-button","aria-label":n("composer.upload"),className:"size-9 p-1",onClick:r=>{r.preventDefault(),t()},children:d.jsx(cA,{className:"size-6"})})})}const s8=st(),dA=D(null),hA=D(null);function a8(t){s8.set(dA,t)}function c8(t){s8.set(hA,t)}function c1e(t,e){var s;const n={eventInfo_inputLength:t.length};let r=n;const o=Ge(dA);if(o){const{source:a,type:c,prompt:u}=o;a==="widgets"?r={...n,widget:c,widgetPromptLength:u.length}:r={...n,pill:c,pillPromptLength:u.length}}const i=Ge(hA);return i&&(r={...r,autoCompleteLength:i.prompt.length}),(e==null?void 0:e.length)!==0&&((s=e==null?void 0:e[0])!=null&&s.scenario)&&(r={...r,uploadFileScenario:e[0].scenario}),JSON.stringify(r)}function l1e(t){const e=Ge(dA),n=Ge(hA),r=e==null?void 0:e.prompt.trim(),o=t.trim(),i=n==null?void 0:n.prompt.trim(),s=n==null?void 0:n.prefix.trim(),a=o.toLowerCase()===(i==null?void 0:i.toLowerCase());return!a&&!e?null:a?!r||!o.toLowerCase().includes(r.toLowerCase())?"autoComplete":s&&s.length>r.length?(e==null?void 0:e.source)==="widgets"?"widgetWithTextAndAutoComplete":"pillWithTextAndAutoComplete":(s==null?void 0:s.length)===r.length?(e==null?void 0:e.source)==="widgets"?"widgetWithAutoComplete":"pillWithAutoComplete":"autoComplete":!r||!o.toLowerCase().includes(r.toLowerCase())?null:o.length>r.length?(e==null?void 0:e.source)==="widgets"?"widgetWithText":"pillWithText":(e==null?void 0:e.source)==="widgets"?"widget":"pill"}function u1e(){a8(null),c8(null)}const l8=t=>m.createElement("svg",{viewBox:"0 0 28 28",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M27.9994 14.0514C27.9994 6.29111 21.7315 0 13.9997 0C6.26795 0 0 6.29111 0 14.0514C0 20.641 4.52023 26.1705 10.6179 27.6892V18.3455H7.73121V14.0514H10.6179V12.2011C10.6179 7.41859 12.7745 5.20184 17.4526 5.20184C18.3396 5.20184 19.8701 5.37664 20.4962 5.55088V9.44312C20.1658 9.40828 19.5918 9.39085 18.8789 9.39085C16.5835 9.39085 15.6965 10.2637 15.6965 12.5328V14.0514H20.2694L19.4837 18.3455H15.6965V28C22.6286 27.1597 28 21.2356 28 14.0514H27.9994Z"})),Z2e=Object.freeze(Object.defineProperty({__proto__:null,default:l8},Symbol.toStringTag,{value:"Module"})),u8=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("g",{id:"Linkedin"},m.createElement("path",{id:"Shape",d:"M23.6999 2.75909C23.6999 1.39872 22.5971 0.295929 21.2368 0.295929H2.76308C1.40272 0.295929 0.299927 1.39872 0.299927 2.75909V21.2328C0.299927 22.5931 1.40272 23.6959 2.76308 23.6959H21.2368C22.5971 23.6959 23.6999 22.5931 23.6999 21.2328V2.75909ZM3.63848 9.12156H7.24935V20.6943H3.63848V9.12156ZM16.4313 8.83425C19.8921 8.83425 20.6797 10.9844 20.753 13.861L20.7589 14.3469V20.6942H17.1519L17.1517 14.9161C17.1477 13.5985 17.0603 11.9984 15.278 11.9984C13.4002 11.9984 13.1135 13.4611 13.1135 14.971V20.6942H9.51161V9.12143H12.9689V10.7028H13.0188L13.1052 10.5509C13.6314 9.68925 14.7739 8.83425 16.4313 8.83425ZM3.35125 5.45367C3.35125 4.30239 4.28565 3.36809 5.44404 3.36809C6.59732 3.36809 7.53556 4.30239 7.53556 5.45367C7.53556 6.60623 6.59732 7.54053 5.44404 7.54053C4.28565 7.54053 3.35125 6.60623 3.35125 5.45367Z",fill:"currentColor"}))),X2e=Object.freeze(Object.defineProperty({__proto__:null,default:u8},Symbol.toStringTag,{value:"Module"})),d8=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28",...t},m.createElement("g",{clipPath:"url(#clip0_9013_4638)"},m.createElement("path",{d:"M14 0C6.26828 0 0 6.26828 0 14C0 17.8664 1.56734 21.3664 4.10047 23.8995L1.43391 26.5661C0.904531 27.0955 1.27969 28 2.02781 28H14C21.7317 28 28 21.7317 28 14C28 6.26828 21.7317 0 14 0Z",className:"fill-foreground-650"}),m.createElement("path",{d:"M16.8481 6.60187C17.091 7.63109 18.0152 8.39781 19.1188 8.39781C20.4072 8.39781 21.4517 7.35328 21.4517 6.06484C21.4517 4.7764 20.4072 3.73187 19.1188 3.73187C17.9922 3.73187 17.0527 4.53031 16.8339 5.59234C14.9472 5.79469 13.4739 7.39484 13.4739 9.33406C13.4739 9.33843 13.4739 9.34172 13.4739 9.34609C11.4221 9.4325 9.54846 10.0166 8.06096 10.9386C7.50861 10.5109 6.81518 10.2561 6.06268 10.2561C4.25689 10.2561 2.79346 11.7195 2.79346 13.5253C2.79346 14.8356 3.56346 15.9644 4.6758 16.4861C4.78408 20.2814 8.91955 23.3341 14.0066 23.3341C19.0936 23.3341 23.2346 20.2781 23.3374 16.4795C24.441 15.9545 25.2044 14.8291 25.2044 13.5264C25.2044 11.7206 23.741 10.2572 21.9352 10.2572C21.186 10.2572 20.4958 10.5098 19.9446 10.9342C18.4439 10.0056 16.5496 9.42156 14.4769 9.3439C14.4769 9.34062 14.4769 9.33844 14.4769 9.33515C14.4769 7.94609 15.5094 6.79328 16.8481 6.60406V6.60187ZM7.92971 15.6002C7.98439 14.4145 8.77189 13.5045 9.68736 13.5045C10.6028 13.5045 11.3028 14.4659 11.2481 15.6516C11.1935 16.8372 10.5099 17.2681 9.5933 17.2681C8.67674 17.2681 7.87502 16.7858 7.92971 15.6002ZM18.3269 13.5045C19.2435 13.5045 20.031 14.4145 20.0846 15.6002C20.1392 16.7858 19.3364 17.2681 18.421 17.2681C17.5055 17.2681 16.8208 16.8383 16.7661 15.6516C16.7114 14.4659 17.4103 13.5045 18.3269 13.5045ZM17.2375 18.3433C17.4092 18.3608 17.5186 18.5391 17.4519 18.6987C16.8886 20.0452 15.5586 20.9912 14.0066 20.9912C12.4546 20.9912 11.1256 20.0452 10.5613 18.6987C10.4946 18.5391 10.6039 18.3608 10.7756 18.3433C11.7819 18.2416 12.8702 18.1858 14.0066 18.1858C15.143 18.1858 16.2302 18.2416 17.2375 18.3433Z",style:{fill:"rgb(var(--color-foreground-100))"}})),m.createElement("defs",null,m.createElement("clipPath",{id:"clip0_9013_4638"},m.createElement("rect",{width:28,height:28,fill:"white"})))),eNe=Object.freeze(Object.defineProperty({__proto__:null,default:d8},Symbol.toStringTag,{value:"Module"})),h8=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28",fill:"currentColor",...t},m.createElement("g",null,m.createElement("path",{d:"M16.6638 11.85L27.0874 0H24.6174L15.5665 10.2892L8.33765 0H0L10.9315 15.5591L0 27.9856H2.47021L12.0281 17.1199L19.6623 27.9856H28L16.6632 11.85H16.6638ZM13.2805 15.6962L12.1729 14.1468L3.36026 1.81862H7.15435L14.2663 11.7679L15.3739 13.3172L24.6185 26.2497H20.8244L13.2805 15.6967V15.6962Z",fill:"currentColor"}))),tNe=Object.freeze(Object.defineProperty({__proto__:null,default:h8},Symbol.toStringTag,{value:"Module"})),f8=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28",fill:"currentColor",...t},m.createElement("path",{d:"M23.9202 4.06584C21.2885 1.44525 17.7882 0.00132957 14.0588 0C6.37397 0 0.119658 6.21909 0.116984 13.8635C0.115647 16.3072 0.758058 18.6925 1.97804 20.7946L0 27.9796L7.39072 26.0517C9.4269 27.1566 11.7198 27.7383 14.0528 27.739H14.0588C21.7423 27.739 27.9974 21.5192 28 13.8748C28.0013 10.17 26.5527 6.6871 23.9202 4.0665V4.06584ZM14.0588 25.3975H14.0541C11.9751 25.3969 9.93564 24.8411 8.15617 23.7914L7.73299 23.5415L3.34709 24.6856L4.5176 20.4329L4.24218 19.9968C3.08236 18.162 2.46937 16.0413 2.4707 13.8642C2.47338 7.51078 7.67149 2.34138 14.0635 2.34138C17.1586 2.34271 20.0678 3.54266 22.2557 5.72117C24.4437 7.89902 25.6476 10.7949 25.6463 13.8735C25.6436 20.2275 20.4455 25.3969 14.0588 25.3969V25.3975ZM20.4147 16.7673C20.0664 16.5938 18.3538 15.7561 18.0343 15.6405C17.7147 15.5248 17.4828 15.467 17.2508 15.814C17.0189 16.161 16.3511 16.9415 16.1478 17.1721C15.9446 17.4035 15.7414 17.4321 15.3931 17.2585C15.0449 17.085 13.9225 16.7194 12.5915 15.5394C11.5561 14.6206 10.8568 13.4866 10.6536 13.1395C10.4504 12.7925 10.6322 12.605 10.806 12.4329C10.9624 12.2773 11.1543 12.028 11.3287 11.8259C11.5033 11.6238 11.5607 11.4789 11.677 11.2482C11.7934 11.0168 11.7352 10.8148 11.6483 10.6412C11.5614 10.4677 10.8649 8.76253 10.574 8.06918C10.2912 7.39377 10.0039 7.48551 9.79059 7.47421C9.58736 7.46424 9.35542 7.46225 9.12279 7.46225C8.89016 7.46225 8.51309 7.54867 8.19358 7.89569C7.87407 8.24267 6.97426 9.08097 6.97426 10.7855C6.97426 12.49 8.22236 14.1381 8.39681 14.3694C8.57127 14.6008 10.8534 18.0995 14.3476 19.6006C15.1786 19.9576 15.8276 20.171 16.3336 20.3306C17.168 20.5945 17.9273 20.5573 18.5276 20.4682C19.1968 20.3685 20.5886 19.6299 20.8787 18.8208C21.1688 18.0117 21.1688 17.3177 21.0819 17.1734C20.995 17.0292 20.7624 16.9421 20.4141 16.7686L20.4147 16.7673Z"})),nNe=Object.freeze(Object.defineProperty({__proto__:null,default:f8},Symbol.toStringTag,{value:"Module"})),rNe=["facebook","twitter","whatsapp","linkedin","reddit"],dg={facebook:{displayName:"Facebook",linkGenerator:t=>`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(t)}`,icon:d.jsx(l8,{})},twitter:{displayName:"X",linkGenerator:(t,e)=>`https://twitter.com/intent/tweet?url=${encodeURIComponent(t)}&text=${encodeURIComponent(e)}`,icon:d.jsx(h8,{})},whatsapp:{displayName:"WhatsApp",linkGenerator:(t,e)=>`https://api.whatsapp.com/send?text=${encodeURIComponent(`${e} ${t}`)}`,icon:d.jsx(f8,{})},linkedin:{displayName:"LinkedIn",linkGenerator:(t,e)=>`https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(t)}&text=${encodeURIComponent(e)}`,icon:d.jsx(u8,{})},reddit:{displayName:"Reddit",linkGenerator:(t,e)=>`https://www.reddit.com/submit?url=${encodeURIComponent(t)}&title=${encodeURIComponent(e)}`,icon:d.jsx(d8,{})}};function d1e(t){const{socialMedia:e,className:n,loading:r,disabled:o,onClickSocialMedia:i,includeTitle:s,iconClassName:a="size-6"}=t,c=d.jsx("div",{className:a,children:dg[e].icon}),u="56-xl",h="subtle-dimmed-inverted",p=dg[e].displayName,f=nt("flex-1 py-2",n);return d.jsxs(Me,{size:u,color:h,title:p,className:f,onClick:g=>i(e,g),disabled:o,children:[r?d.jsx(Rt,{className:"size-8"}):c,s&&d.jsx("span",{className:"font-medium text-foreground-550 text-3xs",children:dg[e].displayName})]})}function h1e(t,e,n){if(!e)return;const r=dg[t].linkGenerator(e,n??"");pl(r)}function f1e({isOpen:t,onClose:e}){const{t:n}=Oe(),r=Fj(),o=m.useMemo(()=>["twitter","facebook","whatsapp"],[]);return d.jsx(zd,{isOpen:t,className:"grid size-full max-h-[640px] max-w-[640px] justify-center gap-4",onClose:e,headerText:n("common.share"),children:(r==null?void 0:r.type)==="image"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"mx-auto mb-4 flex h-full w-fit overflow-hidden rounded-2xl",children:d.jsx("img",{src:r.url,alt:r.altText,className:"size-full object-contain"})}),d.jsx(Cve,{value:r.url,title:n("share.copy"),size:"56-xl",variant:"pill",className:"w-full"}),d.jsx("div",{className:"flex w-full items-center justify-around",children:o.map(i=>d.jsx(d1e,{socialMedia:i,className:"flex flex-col gap-1",onClickSocialMedia:s=>{h1e(s,r.url)},includeTitle:!0},i))}),d.jsx("div",{className:"text-center text-foreground-550 text-2xs",children:n("share.shareImageDescription")})]})})}const p1e=m.lazy(()=>H(()=>import("./product-purchase-Dw9Fr_Y7.js"),__vite__mapDeps([231,1,2,232,233,234,235,236,237,238,239,225])).then(t=>({default:t.ProductPurchase}))),m1e=1.25,g1e=64,v1e=8,b1e={opacity:0,scale:m1e,translateY:g1e},y1e={opacity:1,scale:1,translateY:0},Gl="size-6",C1e=m.lazy(()=>H(()=>import("./upsell-block-CmjWxp_8.js"),__vite__mapDeps([240,1,2,241]))),S1e=m.lazy(()=>H(()=>import("./price-tracking-block-Cbv5fZls.js").then(t=>t.p),__vite__mapDeps([242,1,2,243,244,245,246,247])).then(t=>({default:t.PriceTrackingBlock}))),E1e=m.lazy(()=>H(()=>import("./composer-auto-complete-DgwCoUa1.js"),__vite__mapDeps([248,1,2]))),I1e=m.lazy(()=>H(()=>import("./composer-actions-prompt-suggestions-DZDg2TZh.js"),__vite__mapDeps([249,1,2,250,251,252,253,254,255,256,257,258,259])).then(t=>({default:t.ComposerActionsPromptSuggestions}))),T1e=m.lazy(()=>H(()=>import("./voice-options-zbmcQvIZ.js").then(t=>t.v),__vite__mapDeps([260,1,2]))),_1e=m.lazy(()=>H(()=>import("./think-deeper-pro-subscription-CBfV_NU2.js"),__vite__mapDeps([261,1,2]))),w1e=m.lazy(()=>H(()=>import("./over-task-quota-Dq-ErrIj.js"),__vite__mapDeps([262,1,2,263])).then(t=>({default:t.OverTaskQuota}))),A1e=m.lazy(()=>H(()=>import("./computer-use-task-closed-Coi9kqz3.js"),__vite__mapDeps([264,1,2,265,266,267,268,269,270,271,272,273,274,275,263])).then(t=>({default:t.ComputerUseTaskClosed}))),k1e=m.lazy(()=>H(()=>import("./safety-risk-card-B0QqGJzi.js"),__vite__mapDeps([276,1,2,277,263])).then(t=>({default:t.SafetyRiskCard}))),x1e=m.lazy(()=>H(()=>import("./add-to-page-MvDCa9tI.js"),__vite__mapDeps([278,1,2])).then(t=>({default:t.AddToPage}))),R1e=m.lazy(()=>H(()=>import("./cross-selling-strip-consumer-CJgF9276.js"),__vite__mapDeps([279,1,2,241]))),N1e=m.lazy(()=>H(()=>import("./composer-prompt-review-Biq_aJR6.js"),__vite__mapDeps([280,1,2,281]))),y0=m.lazy(()=>H(()=>import("./composer-action-CuhF44zF.js"),__vite__mapDeps([263,1,2]))),P1e=m.lazy(()=>H(()=>import("./biometric-consent-vHESJBBe.js"),__vite__mapDeps([282,1,2])).then(t=>({default:t.BiometricConsent}))),M1e=m.lazy(()=>H(()=>Promise.resolve().then(()=>wve),void 0)),O1e=m.lazy(()=>H(()=>import("./daily-briefing-chat-2Ad-3BKC.js"),__vite__mapDeps([283,1,2,284,285])).then(t=>({default:t.DailyBriefingChat}))),L1e=m.lazy(()=>H(()=>import("./composer-sign-in-Cnx-1jcx.js"),__vite__mapDeps([286,1,2,287]))),D1e=m.lazy(()=>H(()=>import("./daily-briefing-composer-player-Djs_8BAA.js"),__vite__mapDeps([288,1,2,273,269,270,271,272,285])));function j1e(){var ek,tk;const{t}=Oe(),{isLivingPortraitEnabled:e}=fCe(),n=le("image-copy-paste"),r=L(Jc),o=le("pay-native-checkout"),i=le("shopping-card"),s=le("multiplecharacters"),a=le("anonymousattachmentupload"),c=le("onedrive-file-upload"),u=le("ds-editprompt"),h=le("ds-new-progress"),p=!yy(),f=L(lL),g=le("multi-file-upload"),v=le("dr-nano-single-file-upload"),y=Fd(),b=pi(),C=EL(),S=bCe(),E=Ft(),I=L(An),T=yo(),_=L(Oa),w=pr({breakpoint:"sm"}),A=Kv({breakpoint:"h760"}),M=Kv({breakpoint:"h550"}),R=Xw(),$=fSe(),V=oA(),ie=hSe(),[N,Y]=m.useState(null),ue=Ee(FO),[j,U]=it(ml),te=L(Rde),Q=L(Nde),re=L(G$),Z=L(GO),_e=L(H$),ye=L(wE),[Se,Ne]=m.useState(!1),we=_e||Se,{startConversationDisabled:Ke}=my(),de=L(Ns),[ge,$e]=m.useState(!1),[P,J]=it(Yr),Te=Ee(Zle),[O,ce]=it(KJ),[se,ne]=it(Ip),K=Ee(VO),pe=L(fs),He=(pe==null?void 0:pe.type)==="popup",at=CCe(),ut=He||at,Le=DU(),Xe=(ek=be.instance().config().composer)==null?void 0:ek.enableAppShadow,{isPlaying:St,pause:Ut,onToggleVoiceSettings:Gt,resetAllTimers:Kt}=PU(),kn=qye(),F=ACe(),me=vCe(),ve=Lr(),je=m.useRef(null),Ve=m.useRef(null),ct=m.useRef(null),Be=m.useRef(null),[k,G]=m.useState(!1),[ee,Ce]=m.useState(null),De=m.useCallback(fe=>{Ce(fe)},[Ce]),Qe=m.useCallback(()=>{G(!1)},[G]),rt=le("imagegenv3"),lt=le("logged-out-sharing"),yt=le("remove-prefill-space-after-prompt-cmc"),{isMediaViewerOpen:Qt,closeMediaViewer:ot,isPictureInPictureSupported:xn,triggerPictureInPicture:br,showOneLineComposerWhenMediaViewerOpen:$o,contentComposerType:Il,contentPageType:Co}=Na(),or=Fj(),Op=Il===Fv.IMAGE_VIEWER,Lp=Il===Fv.CLOSE_BUTTON,Tl=Ee(Ep),Ur=E.endsWith("/talk"),an=E.endsWith("/daily"),_l=le("1s-dbchat"),Dp=le("discover-composer-off"),Jr=Ry(),qd=an||Jr,jp=hCe(),et=Ey(),B=E.startsWith("/chats")&&!Ur,Pe=E.startsWith("/shares"),Je=Co==="weather",en=L(Vh),{login:Wn}=Bd(),vn=P==="dialog",Yn=o&&P==="checkout",So=sCe(),[Mn,ir]=it(_n),[Up,Fp]=m.useState(!1),D7=L(Cj),mi=Zw(),{isCentralComposerEnabled:j7,isAutoSuggestEnabled:U7,isStarterPromptsEnabled:F7,isWidgetSectionEnabled:B7,isAppearanceOnHomeEnabled:H7}=Pp(),{floatingStyles:z7,edgeTabMenuRefs:Fy,isMultiTabsMenuExpanded:V7,setIsMultiTabsMenuExpanded:yA,multiTabsMenuMode:$7,setMultiTabsMenuMode:CA,handleMentionEvent:G7,handleMultiTabsMenuSaveBtnEvent:SA,handleMultiTabsMenuCloseBtnEvent:EA,handleUserInputEnterEvent:K7,handleUserInputKeydownEvent:IA,isMentionTriggered:TA}=Mye(),q7=L(Jhe),Wd=Mn==="computerUse",wl=j7&&(!P||P==="biometric-consent"),_A=U7&&!P&&!Wd,wA=ie==="autosuggest"&&_A,AA=m.useId(),W7=L(TT),Y7=F7&&(!P||P==="biometric-consent")&&!Wd&&!W7&&(!M||w),Q7=wl&&B7&&!Wd&&!w&&!A,Yd=m.useRef(null),J7=yCe(),Z7=!Ur&&!an&&!Jr&&!wl&&!Yn&&!Je;let kA=!0;const By=(et||B||jp||Pe)&&(!P||P==="biometric-consent")&&!(Qt&&!$o);By&&((tk=be.instance().config().composer)!=null&&tk.disableTextInput)&&(kA=!1);const xA=Yn,Hy=L(lw),RA=L(q$),[zy,NA]=it(tue),Bp=L(nue);le("multiple-research-tasks-in-conversation");const Al=jde(),Qd=L(kr),La=Qd==="side-by-side"&&(Al==null?void 0:Al.type)==="computerUse",PA=Ny(),Hp=La&&!Jj(Al.status),Jd=La&&zde(Al),X7=La&&Vde(Al),eF=!E.endsWith("/agents")&&!an&&!jp&&!Pe&&!H7&&!Qt&&!y,zp=Bp&&!0&&!h,MA=Jd||La||an||zp||Qt,tF=m.useCallback(()=>{const fe=[];if(Ve.current){const qe=Ve.current.getTextAreaRef();qe.current&&fe.push(qe)}return fe},[Ve]),OA=!(Qt&&!$o)&&!Ur&&(!P||P==="daily-briefing-chat"),Vp=re||!OA||Hp||Jd||X7||zp,Vy=Wye(OA),Zd=L(eue),Ls=L(Xle),[$y,LA]=it(yj),Gy=Qc(),{dismissCoachmark:DA}=iU(sU),Xd=P==="prompt-sign-in"||P==="prompt-3p-sign-in"||P==="prompt-location"||P==="prompt-review"||P==="confirm-link-navigation"||P==="cross-promo-card"||P==="shopping-upsell-card"||P==="shopping-price-tracking"||P==="add-to-page"||P==="safety-risk-card"||P==="computer-use-task-closed"||P==="over-task-quota"||P==="daily-briefing-chat"||P==="upsell-microsoft-account-for-pro-subscription"||P==="biometric-consent"||P==="finance-watchlist-unfollow-toast",jA=!Ur&&P!=="daily-briefing-player"&&P!=="audioSettings"&&P!=="reasoning-mode-pro-subscription"&&P!=="checkout"&&!Xd&&!(Qt&&!$o),nF=m.useCallback(fe=>{Zs(fe)},[]),rF=()=>{var qe;const fe=((qe=be.instance().config().composer)==null?void 0:qe.homeButtonState)??"enabled";return fe!=="enabled"?fe:et?"disabled":"enabled"},oF=m.useCallback(()=>{var fe;(fe=Ve.current)==null||fe.focus(),Ya(!0)},[]),iF=m.useCallback(()=>{ct.current&&(ct.current.value="")},[]),kl=m.useCallback((fe,qe)=>{U({isOpen:!0,scenario:qe??null,reason:fe})},[U]),sF=m.useCallback(()=>{kl("fileUpload")},[kl]),{processUploadedFiles:UA,processUploadedLocalFiles:Ds,isUploadingAttachments:aF,uploadedAttachments:xl,resetFileUpload:cF,removeAttachment:Ky}=tCe(oF,Zs,iF,sF),lF=L(Qhe),Go=xl.filter(({error:fe})=>!fe),qy=(Go.length>0||Vy)&&!Ur,FA=Go.length>0,uF=aF,BA=!!(V.trim().length>0||FA)&&!Vp,HA=!!((N&&N.length>0)===!0||uF||we||ye||V.trim().length===0&&Mn==="computerUse"),zA=g&&Go.length>=PE,[dF,hF]=m.useMemo(()=>{const{reason:fe}=j;return fe?[t(`signInPrompt.${fe}Header`,t("signInPrompt.header")),t(`signInPrompt.${fe}Text`,t("signInPrompt.text"))]:[t("signInPrompt.header"),t(lt?"signInPrompt.textV2":"signInPrompt.textV3")]},[lt,j,t]),[VA,fF]=m.useState({onSubmitCallback:null,onCancelCallback:null}),[Wy,Yy]=m.useState(!1);m.useEffect(()=>{!Qt&&Wy&&Yy(!1)},[Qt,Wy]);const pF=m.useCallback(()=>{var fe;SA(),(fe=Ve.current)==null||fe.focus()},[SA]),mF=m.useCallback(()=>{var fe;TA||(fe=je.current)==null||fe.focus(),EA()},[EA,TA]),gF=m.useCallback(async()=>new Promise(fe=>{if(Ge(dL)||Go.length===0){fe(!0);return}J("biometric-consent"),fF({onSubmitCallback:()=>{J(null),fe(!0)},onCancelCallback:()=>{J(null),fe(!1)}})}),[Go,J]),vF=m.useCallback(fe=>{var qt;if(!IA(fe)&&fe.key==="ArrowDown"&&(qt=Ve.current)!=null&&qt.contains(document.activeElement)&&Yd.current){fe.preventDefault();const Pt=Yd.current.querySelector("button");Pt&&Pt.focus()}},[IA]),Qy=async fe=>{var qe,qt;if(Pe&&await dP(),!BA||!V&&!FA||HA){await ps.onSubmitMessageBlocked();return}if(!(rt&&!await gF())){if(h&&Mn==="research"&&Bp){const Pt=Ge(pt);if(Pt){Ph(t("error.researchTaskNotAllowedWhileRunningAnother"),Pt),ir("chat");return}}DA(),KE(),kF?(qt=Ve.current)==null||qt.focus():(qe=Ve.current)==null||qe.blur(),await LF(fe??V)}},bF=m.useCallback(async()=>{await C()},[C]),{launchAudioCall:Jy,startAudioCallIfNotStartedAlready:Zy,endAudioCall:eh,toggleAudioInput:yF,hasOutputVolume:Xy,inputVolume:CF,isInputMuted:SF,isAudioDeepLink:EF,canInitAudio:IF}=W0e({isAudioCall:Ur,onCallTerminated:bF,onMute:()=>Tn({source:"audioCall",scenario:"mute"})});m.useEffect(()=>{te&&(J(Gy?"prompt-3p-sign-in":"prompt-sign-in"),j.isOpen&&U({...j,isOpen:!1,reason:j.reason??(re?"overTurnLimit":null)}),Ya(!0))},[J,U,te,j,Gy,re]),m.useEffect(()=>{Q&&("geolocation"in navigator?setTimeout(()=>{J("prompt-location"),Ya(!0),ar("hasBeenPromptedForLocation","true"),z.trackEvent({name:"interaction",data:{eventName:"locationPrompt",eventInfo_action:"seen"}})},RV):z.trackEvent({name:"system",data:{eventName:"geolocationUnavailable"}}))},[J,Q]),m.useEffect(()=>{qd?J("daily-briefing-player"):ut?(Ya(!0),J("cross-promo-card")):J(Jd?"safety-risk-card":Hp?"computer-use-task-closed":null)},[J,ut,Hp,Jd,qd]);const eC=m.useRef(null),$p=Qf(fe=>{const qe=document.getElementById("app");qe&&(Te(fe.height),qe.style.setProperty("--composer-container-height",`${fe.height}px`))}),TF=Qf(fe=>{$p.current&&(fe.height===0?$p.current.style.removeProperty("--composer-attachments-height"):$p.current.style.setProperty("--composer-attachments-height",`${fe.height+v1e}px`))}),_F=()=>{Ko(),ce(void 0)},$A=()=>{ge&&(Zy(),$e(!1))},Ko=()=>{if(an&&P==="daily-briefing-chat"&&(J("daily-briefing-player"),KE()),P==="prompt-3p-sign-in"&&(Jr||an)&&J("daily-briefing-player"),!(re||an||Jr||Hp||Jd)){if(vn&&(Ls!=null&&Ls.closeDialogCallback)){Ls.closeDialogCallback();return}P==="prompt-review"&&zSe(Ge(pt),"dismissed"),P==="cross-promo-card"&&Le(),P==="audioSettings"&&$A(),J(null),P==="prompt-sign-in"&&j.scenario&&U({isOpen:!1,scenario:null})}},tC=m.useCallback(async()=>{eh(),Tl("bottom"),e?await b({to:"/labs/experiments/portrait",from:E}):await C()},[eh,Tl,e,b,E,C]);m.useEffect(()=>{be.instance().config().endAudioOnVisibilityHidden&&!RA&&(St?Ut==null||Ut():Ur&&tC())},[tC,Ur,St,Ut,RA]);const GA={title:t("composer.endAudioCall"),icon:d.jsx(fo,{className:Gl,"aria-hidden":!0}),isVisible:!0,onClick:tC},wF=Rye(),KA=()=>{an||Jr?Ut==null||Ut():Ur&&eh(),$e(!0)},Gp=Ee(vy),nC=(Mn==="chat"||Mn==="reasoning"||Mn==="smart"||Mn==="research"&&v)&&!La,Zr=Mn==="research"?Ty:Ta,AF=Ffe(Zr);m.useEffect(()=>{for(const[fe,qe]of xl.entries())kw(qe.file,{supportedMimeTypes:Zr})||Ky(fe)},[Zr,xl,Ky]);const kF=eA(),ur=Gw(),xF=ur&&(Mn==="chat"||Mn==="research"||Mn==="computerUse"),RF=ur&&D7===null,th=ur&&!Ur&&!Qt,nh=m.useCallback(()=>{Gp(null)},[Gp]);m.useEffect(()=>{nh()},[jA,nh]),m.useEffect(()=>{ug(V&&Hy?"autosuggest":Wd&&(!V||ur)?"actions-autosuggest":"starter-prompts")},[Hy,V,ur,Wd]),Kc({onOutsideEvent:()=>{Ko()},elements:[eC],includeScroll:!1,invokeOnce:!1}),Kc({onOutsideEvent:Bh,elements:[eC,Yd],includeScroll:!1,invokeOnce:!1});const qA={title:t("composer.closeVoiceSettings"),icon:d.jsx(fo,{className:Gl,"aria-hidden":!0}),isVisible:!0,onClick:oC},Kp={title:t("imageCard.composer.closeImageViewer"),icon:d.jsx(fo,{className:Gl,"aria-hidden":!0}),isVisible:!0,onClick:ot},WA={title:t("imageCard.composer.shareImageViewer"),icon:d.jsx(_U,{className:Gl,"aria-hidden":!0}),isVisible:!0,onClick:()=>{Yy(!0)}},YA={title:t("imageCard.composer.downloadImageViewer"),icon:d.jsx(Aw,{className:Gl,"aria-hidden":!0}),isVisible:!0,onClick:async()=>{if((or==null?void 0:or.type)==="image")try{await I9({url:or.url,fileName:qU()})}catch(fe){const qe=fe instanceof Error?fe.message:"unknown error on downloading image";NE(qe)}}},NF=fe=>{var Pt;Ya(!0),s&&wU("idle");const{relatedTarget:qe}=fe;((Pt=Yd.current)==null?void 0:Pt.contains(qe))||setTimeout(()=>Bh(),100)},PF=fe=>{_A&&fe&&HU(fe)},QA=m.useCallback(async fe=>{const{actionType:qe,id:qt,prompt:Pt,uri:ns,source:gi}=fe;switch(qe){case"prefillComposer":{if(Pt){qt&&a8({prompt:Pt,type:qt,source:gi});const Fr=yt?Pt:`${Pt} `;jm({prompt:Fr,prefillSource:gi==="widgets"?"widget":"starterPill"})}break}case"sendMessage":{if(Pt)try{Ne(!0),await ps.submitMessage({text:Pt,inputMethod:"text"})}finally{Ne(!1)}break}case"deepLink":{ns&&ns==="copilotn://voiceCall"&&await Jy();break}}},[yt,Jy]),MF=(fe,qe)=>{c8({prompt:fe,prefix:qe}),Qy(fe)},JA=m.useCallback(fe=>{jm({prompt:fe,prefillSource:"promptPassThrough"}),ne(null),K(null)},[ne,K]);m.useEffect(()=>{((se==null?void 0:se.source)==="promptInUrl"||(se==null?void 0:se.source)==="edgeOnAskCopilot")&&JA(se.prompt)},[se,JA]);const rC=m.useCallback((fe,qe)=>{const{scenario:qt,reasonIfSignInError:Pt}=qe;fe.message==="not-signed-in"?kl(Pt,qt):Zs(S9(fe.message))},[kl]),OF=le("local-agents"),LF=async fe=>{var gi,Fr,nk,rk;const qe=l1e(fe),qt=c1e(fe,xl),Pt=fe.trim(),ns=Mn==="research"&&u?{research:{awaitUserConfirmation:!0}}:void 0;if(P!=="daily-briefing-chat"&&(cF(),Ya(!0),GU(!1),ue(!0),J(null)),Bh(),OF){if(Pt.startsWith("/agent")){await S();return}if(E.endsWith("/agents"))return}P!=="daily-briefing-chat"&&!y&&await C();try{Ne(!0);let js;kn&&(js=kn),F&&(js=F),me&&(js=me),await ps.submitMessage({text:Pt,filesWithAttachment:xl,inputMethod:"text",scenario:qe??void 0,customData:qt??void 0,reference:js,context:ns})}catch(js){if(js instanceof Error){let ok={};Go.length>0&&(ok={eventInfo_uploadFileSize:((Fr=(gi=Go[0])==null?void 0:gi.file)==null?void 0:Fr.size)??0,eventInfo_uploadFileType:((rk=(nk=Go[0])==null?void 0:nk.file)==null?void 0:rk.type)??"",eventInfo_numDocumentsUploaded:Go.length}),z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitMessage",eventInfo_errorMessage:js.message,eventInfo_details:"Error submitting message",...ok}}),rC(js,{reasonIfSignInError:"fileUpload"})}else z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitMessage",eventInfo_errorMessage:"Unknown error",eventInfo_details:"Error submitting message"}}),Zs({title:t("composer.errors.default.title"),message:t("composer.errors.default.message")})}finally{Ne(!1),u1e()}},rh=m.useCallback(fe=>{const qe=!ve&&!a;return qe&&kl("fileUpload",fe),qe},[ve,a,kl]),ZA=m.useCallback(()=>{var fe;rh()||(fe=ct.current)==null||fe.click()},[rh]);m.useEffect(()=>{if(Vp||!n)return()=>{};const fe=async qe=>{const{file:qt,error:Pt}=Vfe(qe);(qt??Pt)&&(qe.preventDefault(),Pt?rC(Pt,{reasonIfSignInError:"fileUpload"}):qt&&Ds({rawFiles:[qt],scenario:"pasteUpload",replaceExisting:!g,supportedMimeTypes:Zr}))};return document.addEventListener("paste",fe),()=>document.removeEventListener("paste",fe)},[Ds,Vp,n,rC,g,Zr]),m.useEffect(()=>{zy!==null&&(Ds({rawFiles:[zy],scenario:"fileUpload",replaceExisting:!g,supportedMimeTypes:Zr}),NA(null))},[zy,Ds,NA,g,Zr]),m.useEffect(()=>{ee&&!k&&(UA({uploads:[{kind:"onedrive",item:ee,file:new File([],ee.name)}],scenario:"fileUpload",replaceExisting:!g,supportedMimeTypes:Zr}),Ce(null))},[ee,Ce,k,UA,g,Zr]),m.useEffect(()=>{an&&Kt()},[an]);function DF(fe){const qe=Array.from(fe.target.files??[]),qt=qe[0];if(qe.length===0||!qt)return;Ds({rawFiles:g?qe:[qt],scenario:"fileUpload",replaceExisting:!g,supportedMimeTypes:Zr})}const jF=fe=>{if(!nC||(fe.preventDefault(),rh()))return;nh();const qe=fe.dataTransfer.files[0],qt=Array.from(fe.dataTransfer.files);qe&&Ds({rawFiles:g?qt:[qe],scenario:"fileUpload",replaceExisting:!g,supportedMimeTypes:Zr})};function oC(){Fp(!0),J(fe=>fe==="audioSettings"?an||Jr?(Gt("close"),"daily-briefing-player"):($A(),null):"audioSettings")}async function UF(){Pe&&await dP(),Tn({source:"audioCallButton"}),await Jy()}m.useEffect(()=>{const fe=qe=>qe==="start"?Zy():eh();return Mt.on("composer:request-voice",fe),()=>{Mt.off("composer:request-voice",fe)}},[eh,Zy]),m.useEffect(()=>{const fe=()=>{var qe;(qe=Ve.current)==null||qe.focus()};return Mt.on("composer:focus-input",fe),()=>{Mt.off("composer:focus-input",fe)}},[]);const FF=m.useCallback(()=>{var fe;(fe=Ve.current)==null||fe.focus()},[Ve]),BF=Fw(FF),HF=m.useCallback(async()=>{if(rh())return;nh();const{file:fe,error:qe}=await wle.run({});fe?Ds({rawFiles:[fe],scenario:"screenshot",replaceExisting:!g,supportedMimeTypes:Zr}):qe&&Zs(qe)},[nh,rh,Ds,g,Zr]),zF=async()=>{Ko(),"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(async fe=>{const{latitude:qe,longitude:qt,accuracy:Pt}=fe.coords;z.trackEvent({name:"interaction",data:{eventName:"locationPrompt",eventInfo_action:"shared",eventInfo_locationAccuracy:Pt}}),await Wr({path:"/user/location",args:{body:{latitude:qe,longitude:qt,accuracyInMeters:Pt,provider:Pt<100?"gps":"wifi"}}})},fe=>{z.trackEvent({name:"interaction",data:{eventName:"locationPrompt",eventInfo_action:"denied",eventInfo_error:{code:fe.code,message:fe.message}}}),Zs({title:t("composer.errors.location.title"),message:t("composer.errors.location.message")})},{enableHighAccuracy:!0})},VF=TU({from:"/",scenario:"voice"}),$F=()=>{const fe=d.jsx(Jo,{className:"end-0",data:GA,children:GA.icon});if(P==="dismiss-audio-call-only")return fe;switch(en){case"requires-account":case"signed-out":return d.jsxs(d.Fragment,{children:[fe,d.jsx($w,{className:"mx-2",title:t("voice.signUpOrLogin"),onClick:VF})]});case"time-expired-non-pro":case"time-expired-month-non-pro":return d.jsxs(d.Fragment,{children:[fe,wF]});case"time-expired":case"checking-availability":case"error":case"not-in-flight":case"throttled":case"throttled-non-pro":case"region-not-available":case"time-expired-month":case"microphone-denied":case"microphone-not-found":return fe;case"waiting-for-user-interaction":case"available":return d.jsx(Re.div,{className:q(P!=="audioSettings"&&"flex"),children:P==="audioSettings"?d.jsx(Jo,{className:"end-0",data:qA,children:qA.icon}):d.jsxs(d.Fragment,{children:[fe,d.jsx(jve,{className:"mx-2",inputVolume:CF,isMuted:SF,isOutputPlaying:Xy,coachUserUnmute:EF&&!IF&&!Up,onClick:yF}),!e&&d.jsx(Dm,{children:d.jsx(Jo,{className:"start-0",data:{title:t("composer.voiceSettings"),isVisible:!0,onClick:oC},children:d.jsx(rr,{url:Nye,className:Gl,"aria-hidden":!0})})})]})});default:return en}},iC=({enableActionButtons:fe})=>{var gi;let qe;Go.length>0?qe=t("userInput.messageRequiredPlaceholderText"):Vy?nC?qe=t("userInput.imageDropPreviewPlaceHolderText"):qe=t("userInput.fileDropNotSupportedPlaceHolderText",{chatMode:$f(Mn)}):Pe?qe=t("userInput.continueConversationInputPlaceholderText"):f!=null&&f.name&&s?qe=t("userInput.characterPlaceholderText",{character:f.name}):zp?qe=t("research.placeholder"):_l&&an?qe=t(P==="daily-briefing-chat"?"userInput.dailyChatInputPlaceholderText":"userInput.dailyComposerInputPlaceholderText"):mi?qe=t("userInput.placeholderTextWithMention"):qe=void 0;const qt=(gi=be.instance().config().composer)==null?void 0:gi.smallAttachmentCard,ns=P==="daily-briefing-player"&&_l&&an?"":void 0;return d.jsxs(d.Fragment,{children:[d.jsxs(Re.div,{className:q("w-full",{"mt-2 h-auto min-h-32 px-2":qy&&!mi&&!qt,"mt-2 h-[58px] px-2":qy&&!mi&&qt,"h-auto":mi,"h-0":!qy&&!mi}),ref:TF,layout:!0,children:[lF&&d.jsx(ZSe,{onRemove:Ky,attachments:xl}),mi&&q7&&d.jsx(Re.div,{className:"z-10 mt-2 w-full px-2","data-testid":"browser-tabs-preview",children:d.jsx(g0e,{onClick:()=>{CA("update"),yA(!0)}})})]}),d.jsx(rA,{ref:Ve,className:q("w-auto grow",ur&&!an&&"mt-1"),disabled:Vp,disabledClassName:ns,inputValue:V,errorMessage:N,onClick:async()=>{eF&&(et&&ht({source:"composerInput",scenario:"clickNavigateToChat",pageName:"discover"}),await C())},onBlur:NF,onChange:Fr=>{KU({text:Fr,attachments:Go}),DA()},onFocus:PF,onEnter:async()=>{K7()||await Qy()},onKeyDown:vF,onMentionIfEnabled:mi?G7:void 0,setInput:GE,setError:Y,placeholder:qe,characterLimit:Z,rightButtons:fe?[d.jsx(YN,{config:XA()},"composer-action-button")]:void 0,testId:"composer-input","aria-autocomplete":"both","aria-controls":wA?AA:void 0})]})},XA=()=>{if(we||zp)return{mode:"stop",onClick:ps.stopMessage};if(BA)return{mode:"submit",disabled:HA,onClick:Qy};if(!r&&!MA)return{mode:"microphone",onClick:UF}};function qp(fe){return fe?nbe:tbe}function GF(fe){return fe?obe:rbe}const KF=({showChatModeSwitcherButton:fe,showPlusButton:qe,showUploadFileButton:qt,homeButtonState:Pt,enableInputActionButtons:ns})=>{const gi=ur?"to-stone-400/8 from-stone-400/5 dark:from-midnight-800/65 dark:to-midnight-800/65":"from-stone-400/10 to-white/35 dark:from-slate-700/35 dark:to-midnight-800/65";return d.jsx(Re.div,{className:q("relative max-h-full w-expanded-composer max-w-chat bg-gradient-to-b p-1.5",gi),layout:!0,style:{borderRadius:qp(th),boxShadow:de==="dark"?oU:rU},ref:Fy.setReference,children:d.jsxs(Re.div,{className:q(ur?cbe:abe),layout:!0,style:{borderRadius:GF(th)},children:[d.jsx(Re.div,{className:q(ibe,sbe,Vy?"before:opacity-100 before:delay-100 before:duration-200":"before:opacity-0"),layout:!0,onDragOver:Fr=>Fr.preventDefault(),onDrop:Fr=>jF(Fr),children:iC({enableActionButtons:ns})}),!ns&&d.jsxs(Re.div,{className:q("relative bottom-0 flex justify-between pb-0.5",ur?"mt-1 pe-2.5 ps-1.5":"px-2"),layout:!0,children:[d.jsxs("div",{className:"flex gap-1",children:[d.jsx(Bbe,{state:Pt}),d.jsxs("div",{className:"flex gap-2",children:[fe&&d.jsx(Fbe,{disableChatModeSwitcher:!MA}),xF&&d.jsx(i1e,{onPrefillComposerInput:Fr=>{jm({prompt:Fr,prefillSource:"create"})},disabled:we||Bp}),RF&&d.jsx(Abe,{disabled:we||Bp})]})]}),d.jsxs("div",{className:"flex gap-2",children:[qe&&d.jsx(C0e,{startNewChatDisabled:Ke,onStartNewConversation:BF,onSelectFileIfEnabled:nC?ZA:void 0,uploadButtonDisabled:zA,onSelectOneDriveFileIfEnabled:(I==null?void 0:I.provider)==="microsoft"&&c?()=>{G(!0),Gp(null)}:void 0,onTakeScreenshot:HF,onSelectUserOpenedTabsIfEnabled:mi?()=>{Gp(null),CA("add"),yA(!0)}:void 0,onRef:Fr=>{je.current=Fr}}),qt&&d.jsx(a1e,{selectFile:ZA,disabled:zA}),d.jsx(YN,{config:XA()})]})]})]})})},qF=async()=>{j.scenario&&(Tn({source:"signin",scenario:j.scenario}),U({isOpen:!1,scenario:null})),Gy?await b({from:"/conversations",to:"/login"}):await Wn({provider:"microsoft"})};return!So||!kA||et&&Dp&&!Qt?null:d.jsxs(d.Fragment,{children:[d.jsx(f1e,{isOpen:Wy,onClose:()=>Yy(!1)}),xA&&d.jsx("div",{className:q("fixed inset-0 size-full bg-stone-850/30 backdrop-blur-[10px] dark:bg-midnight-850/70")}),d.jsxs("div",{"data-testid":"composer",ref:$p,className:q("pointer-events-none absolute bottom-0 flex",wl&&"sm:bottom-1/2 sm:translate-y-1/2 sm:pt-36",Xt.composer,Qd==="side-by-side"&&B&&T&&!PA&&"mb-2",Qd==="side-by-side"&&B&&!PA&&"w-1/4 min-w-chat-side-by-side",Qd==="side-by-side"&&B&&"end-0 pe-1",(Qd==="chat-only"||w||!B)&&"w-full"),children:[d.jsx("input",{type:"file",accept:AF.join(","),className:"hidden",ref:ct,onChange:DF,"aria-hidden":"true",multiple:g}),d.jsx(Pn,{children:Z7&&d.jsx(zve,{dynamicHeight:P===null&&!et})}),d.jsxs(Re.div,{className:q("relative flex w-full flex-col-reverse items-center px-3 sm:flex-col",wl?"sm:mb-0":"sm:mb-8",Xe?"mb-3":"mb-4",(an||Jr)&&"min-w-72"),initial:p?"enter":!1,animate:"animate",variants:{enter:b1e,animate:y1e},transition:Cy,style:OI,children:[Q7&&d.jsx(Fn,{className:"pointer-events-auto flex h-[250px] w-full max-w-chat justify-center px-2 pb-4",initial:p?"initial":!1,children:d.jsx(l0e,{onWidgetClick:QA})}),d.jsxs(PM,{transition:$?Wue:{duration:0},children:[d.jsxs(Re.div,{className:q("relative max-h-full min-h-composer min-w-16 max-w-chat rounded-5xl",mi&&"z-40",T&&_&&!wl&&!R&&"md:top-2"),children:[s&&jA&&d.jsx(Wve,{}),d.jsx(Re.div,{className:"absolute inset-0",layout:!0,style:{borderRadius:qp(th),boxShadow:gSe(de,ur)}}),d.jsx(Pn,{children:Xy&&d.jsx(WN,{})}),d.jsx(Re.div,{className:q("relative",fz),layout:!0,style:{borderRadius:qp(th),boxShadow:vSe(de,ur)},children:d.jsxs(Re.div,{className:q("pointer-events-auto relative flex flex-col overflow-hidden contrast-more:border-2",vn&&"max-w-72",xA&&ra),"data-testid":"composer-content",ref:eC,layout:!0,style:{borderRadius:qp(th),boxShadow:bSe(de)},children:[d.jsx(Pn,{children:Xy&&d.jsx(WN,{isNested:!0})}),d.jsxs(Pn,{children:[P&&P!=="daily-briefing-player"&&P!=="dismiss-audio-call-only"&&d.jsxs(Re.div,{className:q(!vn&&!Xd&&P!=="reasoning-mode-pro-subscription"&&"border-b border-black/10 dark:border-white/10",P==="reasoning-mode-pro-subscription"&&"sm:w-think-deeper-pro-subscription",P==="audioSettings"&&"w-settings",Xd&&P!=="daily-briefing-chat"&&"w-prompt-sign-in",Xd&&(P==="computer-use-task-closed"||P==="safety-risk-card")&&"max-w-single-image",P==="daily-briefing-chat"&&(_?"min-w-chat-side-by-side bp-960:max-w-full lg:w-expanded-composer":"w-expanded-composer")),layout:!0,children:[P!=="dialog"&&d.jsxs(Re.div,{"data-testid":"audio-settings-dialog",className:q("t-custom-scrollbar max-h-expanded-section overflow-auto",P==="audioSettings"&&"px-2 py-4"),layout:!0,initial:dt,animate:{...Ot,transition:{delay:Oo.default}},ref:Be,children:[d.jsx(Pn,{children:Xd&&d.jsxs(Dm,{children:[P==="biometric-consent"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{"aria-hidden":!0}),children:d.jsx(P1e,{onSubmit:VA.onSubmitCallback,onCancel:VA.onCancelCallback})}),P==="prompt-sign-in"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(y0,{header:dF,text:hF,primaryAction:{title:t("common.loginText"),onClick:qF},testid:"prompt-sign-in-composer-action",secondaryAction:re?void 0:{onClick:Ko,title:t("common.maybeLater"),testid:"maybe-later-button"}})}),P==="prompt-3p-sign-in"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(L1e,{dismiss:Ko})}),P==="upsell-microsoft-account-for-pro-subscription"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(M1e,{dismiss:Ko,source:"Composer"})}),P==="daily-briefing-chat"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(O1e,{dismiss:Ko,inputUI:iC({enableActionButtons:!0})})}),P==="prompt-location"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(y0,{header:t("locationPermission.header"),text:t("locationPermission.text"),primaryAction:{title:t("locationPermission.share"),onClick:zF},secondaryAction:{onClick:Ko,title:t("common.maybeLater")}})}),P==="confirm-link-navigation"&&$y&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(y0,{showImage:!1,header:t("composer.linkConfirmation.header"),text:t("composer.linkConfirmation.text",{url:$y}),primaryAction:{title:t("common.continue"),onClick:()=>{Tn({source:"linkNavigationConfirmButton"}),J7(sa($u($y))),Ko(),LA(void 0)}},secondaryAction:{onClick:()=>{Ko(),LA(void 0)},title:t("common.cancel")}})}),P==="prompt-review"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(N1e,{})}),P==="cross-promo-card"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(R1e,{variant:"aggressive"})}),i&&P==="shopping-upsell-card"&&d.jsx(m.Suspense,{fallback:d.jsx(fP,{}),children:d.jsx(C1e,{onDismiss:()=>J(null)})}),P==="shopping-price-tracking"&&O&&d.jsx(m.Suspense,{fallback:d.jsx(fP,{}),children:d.jsx(S1e,{content:O.data,messageId:O.messageId,cardType:O.cardType,onConfirm:()=>J("shopping-upsell-card"),onCancel:_F})}),P==="add-to-page"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(x1e,{onClose:Ko})}),P==="safety-risk-card"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(k1e,{})}),P==="computer-use-task-closed"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(A1e,{})}),P==="over-task-quota"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(w1e,{})})]})}),P==="audioSettings"&&d.jsx(Dm,{children:d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(T1e,{onVoiceSelected:KA,onVoiceSpeedChange:KA})})}),P==="reasoning-mode-pro-subscription"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(_1e,{})}),Yn&&d.jsx(Dm,{children:d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex max-h-expanded-section w-prompt-sign-in flex-col overflow-auto rounded-t-5xl p-5 sm:w-checkout-composer",children:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(Rt,{className:"size-12"})})}),children:d.jsx(p1e,{})})})]}),vn&&Zd&&Ls&&d.jsx(ube,{titleKey:Zd.titleKey,textKey:Zd.textKey,buttonTextKey:Zd.buttonTextKey,onClick:Zd.onClick,button:Ls.button,cancelButton:Ls.cancelButton,closeDialogCallback:Ls.closeDialogCallback})]}),(an&&P!=="daily-briefing-chat"||Jr)&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-composer w-daily-briefing items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(D1e,{onDismissAudioSettingClick:()=>oC(),isPodcast:Jr,inputUI:_l&&!Jr?iC({enableActionButtons:!1}):void 0})}),Ur&&(!P||P==="audioSettings"||P==="dismiss-audio-call-only")&&d.jsx("div",{className:"flex justify-center p-2",children:$F()}),By&&KF({showChatModeSwitcherButton:!ur,showPlusButton:!ur,showUploadFileButton:ur&&!r&&Mn!=="computerUse",homeButtonState:La||ur?"hidden":rF(),enableInputActionButtons:Qt&&$o||ur&&La}),Qt&&Lp&&d.jsxs(Re.div,{className:q("relative flex max-h-full max-w-chat justify-center",!P&&"p-2",!vn&&"h-composer"),layout:!0,children:[d.jsx(Jo,{data:Kp,children:Kp.icon}),xn&&d.jsx(gye,{onClick:br})]}),Qt&&Op&&d.jsxs(Re.div,{className:q("relative flex max-h-full max-w-chat justify-center",!P&&"p-2",!vn&&"h-composer"),layout:!0,children:[(or==null?void 0:or.type)==="image"&&or.shareable&&d.jsx(Jo,{data:WA,children:WA.icon}),(or==null?void 0:or.type)==="image"&&or.downloadable&&d.jsx(Jo,{data:YA,children:YA.icon}),d.jsx(Jo,{data:Kp,children:Kp.icon})]}),k&&d.jsx(X0e,{onPick:De,onClose:Qe,onError:nF})]})]})})]}),wl&&d.jsxs(Fn,{id:ie,className:q("pointer-events-auto flex h-[150px] w-full max-w-chat flex-none items-end px-2 sm:flex-initial sm:items-start",Xt.composerBottomSlot),delay:.2,initial:p?"initial":!1,children:[wA&&d.jsx(m.Suspense,{fallback:null,children:d.jsx(E1e,{id:AA,dataResponse:Hy,onClick:(fe,qe)=>MF(fe,qe),onHighlight:fe=>GE(fe),onDismiss:Bh,className:"mb-3 sm:mb-0 sm:mt-3",ref:Yd})}),ie==="actions-autosuggest"&&d.jsx(m.Suspense,{fallback:null,children:d.jsx(I1e,{onClick:fe=>jm({prompt:fe,prefillSource:"action"})})}),ie==="starter-prompts"&&Y7&&d.jsx(r0e,{className:"sm:mt-8",onWidgetClick:QA})]}),mi&&V7&&By&&d.jsx(mye,{onSave:pF,styles:z7,onRef:Fy.setFloating,onClose:mF,outsideClickElements:tF(),mode:$7,originElement:Fy.reference})]})]})]})]})}function U1e(t){const{isChecked:e,label:n,description:r,className:o,onChange:i,accessory:s,disabled:a,testId:c}=t,u=m.useId(),[h,p]=m.useState(!1),f=()=>p(!0),g=()=>p(!1),{focusable:v}=gd({autoRestoreFocus:!0,forceFocus:!0});let y=e?"bg-system-green-400":"bg-black/20 dark:bg-white/20";return a&&(y="bg-black/20 after:bg-white/40 dark:bg-white/20 dark:after:bg-black/40"),d.jsxs("label",{className:q("flex items-center justify-between gap-4",!a&&"cursor-pointer",o),htmlFor:u,ref:v.ref,"data-testid":c,children:[d.jsxs("div",{className:"flex flex-1 flex-col",children:[d.jsx("span",{className:"text-foreground-800 text-sm",children:n}),r&&d.jsx("span",{className:"font-medium text-foreground-450 text-xs",children:r})]}),d.jsxs("span",{className:"flex flex-row items-center gap-2",children:[s,d.jsx("input",{id:u,type:"checkbox",title:n,checked:e,onChange:b=>i(b.target.checked),onFocus:f,onBlur:g,className:"sr-only",disabled:a}),d.jsx("div",{className:q("relative h-6 w-10 rounded-full","after:absolute after:start-[2px] after:top-[2px] after:size-5 after:rounded-full after:transition-all contrast-more:forced-color-adjust-none",y,!a&&"after:bg-white after:shadow-switch after:hover:scale-110 after:active:w-6",e&&"after:translate-x-4",e&&!a&&"after:active:translate-x-3",h&&"outline")})]})]})}function F1e(){const t=Fo("kill-cookie-banner"),e=L(Or),[n,r]=it(ZI),[o,i]=m.useState("main"),[s,a]=m.useState(!1),[c,u]=m.useState(!1),[h,p]=m.useState(!1),f=_w(e),g=!!FI(),[v,y]=it(Hj),b=!t&&(!!v||f&&!g&&!n);if(m.useEffect(()=>{b&&z.trackEvent({name:"system",data:{eventName:"cookieBannerShown",eventInfo_region:e}})},[e,b]),!b)return null;const C=E=>{z.trackEvent({name:"interaction",data:{eventName:"cookieBannerChoice",eventInfo_analytics:E.analytics,eventInfo_advertising:E.advertising,eventInfo_socialMedia:E.socialMedia}}),WV(E),i("main"),y(void 0),r(!0)},S=v==="more-options";return d.jsxs("div",{className:"pointer-events-none absolute inset-x-0 top-0 flex w-full justify-center p-3",children:[d.jsx("div",{className:"absolute top-0 h-3.5 w-full bg-stone-150 opacity-90 dark:bg-midnight-850"}),d.jsx("div",{className:q("relative w-full max-w-cookie-banner rounded-xl border border-black/5 shadow-xl dark:border-black/40",Ji,Xt.modal),children:d.jsxs("div",{className:"pointer-events-auto relative max-h-[90vh] overflow-auto p-5",id:"cookie-banner",children:[v!=="more-options"&&o==="main"&&d.jsxs("div",{className:"flex flex-col gap-4",children:[d.jsx("h3",{className:"text-md",children:X("cookies.heading")}),d.jsxs("div",{className:"flex flex-col gap-x-8 gap-y-6 text-2xs sm:flex-row",children:[d.jsxs("div",{className:"flex flex-col gap-x-5 gap-y-4 text-2xs sm:flex-row",children:[d.jsx("p",{children:X("cookies.bannerIntro")}),d.jsxs("p",{children:[X("cookies.bannerExplanation"),d.jsx(aa,{href:dd,title:X("cookies.privacyLink"),className:"ps-1 underline",children:X("cookies.privacyLink")})]})]}),d.jsxs("div",{className:"flex min-w-44 shrink-0 grow flex-col gap-2",children:[d.jsx(Me,{variant:"rect",size:"32-xs",onClick:()=>C({analytics:!0,advertising:!0,socialMedia:!0}),title:X("cookies.accept"),testId:"cookie-banner-accept-button",children:X("cookies.accept")}),d.jsx(Me,{variant:"rect",size:"32-xs",onClick:()=>C({analytics:!1,advertising:!1,socialMedia:!1}),title:X("cookies.reject"),testId:"cookie-banner-reject-button",children:X("cookies.reject")}),d.jsx(Me,{variant:"rect",color:"subtle-dimmed",size:"32-xs",onClick:()=>{i("more-options")},title:X("cookies.moreOptions"),testId:"cookie-banner-options-button",children:X("cookies.moreOptions")})]})]})]}),(v==="more-options"||o==="more-options")&&d.jsxs("div",{className:"flex flex-col",children:[d.jsxs("div",{className:"flex items-center",children:[!S&&d.jsx(Me,{title:X("common.backText"),variant:"circle",color:"subtle-dimmed",size:"32-xs",onClick:()=>i("main"),children:d.jsx(Hd,{className:"rotate-180"})}),d.jsx("h3",{className:q({"ps-3":!S},"text-md"),children:X("cookies.moreOptionsHeading")})]}),d.jsx("p",{className:"py-3 text-2xs",children:X("cookies.essentialCookiesExplanation")}),d.jsx(C0,{label:X("cookies.advertisingLabel"),explanation:X("cookies.advertisingDescription"),isChecked:c,onChange:()=>u(E=>!E),testId:"cookie-banner-advertising-option"}),d.jsx(C0,{label:X("cookies.analyticsLabel"),explanation:X("cookies.analyticsDescription"),isChecked:s,onChange:()=>a(E=>!E),testId:"cookie-banner-analytics-option"}),d.jsx(C0,{label:X("cookies.socialMediaLabel"),explanation:X("cookies.socialMediaDescription"),isChecked:h,onChange:()=>p(E=>!E),testId:"cookie-banner-social-option"}),d.jsx("div",{className:"flex justify-end",children:d.jsx(Me,{variant:"rect",size:"36-sm",className:"w-fit px-7",onClick:()=>{C({analytics:s,advertising:c,socialMedia:h})},title:X("cookies.savePreferences"),testId:"cookie-banner-save",children:X("cookies.savePreferences")})})]})]})})]})}function C0(t){const{label:e,explanation:n,isChecked:r,onChange:o,testId:i}=t;return d.jsxs(d.Fragment,{children:[d.jsx(jw,{horizontalMargin:!1}),d.jsx(U1e,{label:e,className:"w-full py-2 pe-1",isChecked:r,onChange:o,testId:i}),d.jsx("p",{className:"pb-4 pt-1 text-2xs",children:n})]})}function B1e(){const[t,e]=m.useState(!0),n=L(fs),r=DU(),o=m.useMemo(()=>n==null?void 0:n.images,[n]),i=m.useMemo(()=>({title:n==null?void 0:n.title,subTitle:n==null?void 0:n.subTitle}),[n]),a=L(Ns)==="dark"?o==null?void 0:o.dark:o==null?void 0:o.light,c=i;m.useEffect(()=>{vu({name:"interaction",status:"Shown",eventName:"crossPromotionStripCard",source:"bottomRightCard"})},[]);const u=()=>{e(!1),r()};return n===null||!t?null:d.jsx(Fn,{mode:"sync",className:"fixed bottom-5 end-5 z-[1000]",children:d.jsxs("div",{className:q("flex h-32 w-96 flex-col justify-center rounded-5xl border border-white bg-background-100 p-3 dark:border-white/5 dark:bg-background-250"),children:[d.jsxs("div",{className:"flex items-center",children:[a&&d.jsx("img",{src:a,alt:X("crossSelling.imageAlt"),className:"size-24 rounded-lg object-cover"}),d.jsxs("div",{className:"me-6 ms-3",children:[d.jsx("div",{className:"mb-1 text-sm",children:d.jsx("strong",{children:c.title})}),d.jsx("div",{className:"text-sm",children:c.subTitle})]})]}),d.jsx("div",{className:"absolute end-1.5 top-1.5 flex self-start",children:d.jsx(Me,{title:X("common.closeText"),variant:"square",color:"subtle-dimmed","aria-label":X("common.closeText"),onClick:u,className:"flex size-8 items-center justify-center p-1.5",children:d.jsx(fo,{className:"m-0 size-5 self-center p-0"})})})]})})}function CP({icon:t,text:e,buttonText:n,buttonColor:r,buttonOnClick:o,className:i=""}){return d.jsxs("div",{className:q("flex items-center justify-between",i),children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"flex size-10 items-center justify-center rounded-[8.5px] border border-black/10 bg-background-200 dark:border-white/10",children:d.jsx("div",{className:"m-1 size-6",children:t})}),d.jsx("p",{className:"text-base",children:e})]}),d.jsx(Me,{className:"h-10 w-24",color:r,title:n,"aria-label":n,variant:"rect",onClick:o,children:n})]})}const p8=t=>m.createElement("svg",{viewBox:"0 0 192 192",xmlns:"http://www.w3.org/2000/svg",fill:"none",...t},m.createElement("circle",{cx:96,cy:96,r:74,stroke:"currentColor",strokeWidth:12}),m.createElement("ellipse",{cx:96,cy:96,stroke:"currentColor",strokeWidth:12,rx:30,ry:74}),m.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:12,d:"M28 72h136M28 120h136"})),oNe=Object.freeze(Object.defineProperty({__proto__:null,default:p8},Symbol.toStringTag,{value:"Module"})),H1e="https://ercz.adj.st/home?network=1g17o7tz&campaign=1gl0zo0u&adj_t=1gl0zo0u&adj_deep_link=sapphirecopilot%3A%2F%2Fhome%3Fnetwork%3D1g17o7tz%26campaign%3D1gl0zo0u&adj_redirect_android=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.microsoft.copilot&adj_redirect_ios=https%3A%2F%2Fapps.apple.com%2Fus%2Fapp%2Fmicrosoft-copilot%2Fid6472538445%3Fct%3DCMC_Copilot_ContinueChatting%26pt%3D80423";function z1e(){const t=eA(),e=xO(),n=AO(),r=h$(),o=m.useRef(null),[i,s]=m.useState(!1),a=L(Ib),c=L(il),u=L($O);m.useEffect(()=>{if(!u||!a||c||t||n||r||!e){s(!1);return}const f=Sn(Mk),g=Sn(SC),v=!Hv(f,3*Ig),y=Sw(g,3);v||y?(s(!0),vu({name:"system",status:"Shown",eventName:"copilotMobileCrossSelling"})):vu({name:"system",status:"TriggeredButSnoozed",eventName:"copilotMobileCrossSelling"})},[c,t,n,r,a,u,e]);const h=()=>{ar(Mk,Date.now().toString());const f=Sn(SC);ar(SC,`${parseInt(f??"0",10)+1}`),s(!1),vu({name:"interaction",status:"Dismissed",eventName:"copilotMobileCrossSelling"})},p=()=>{pl(H1e),s(!1),vu({name:"interaction",status:"Clicked",eventName:"copilotMobileCrossSelling"})};return i?d.jsx(Fn,{mode:"sync",className:q("relative",Xt.modal),children:d.jsx("div",{className:"fixed inset-0 grid bg-stone-850/30 dark:bg-midnight-850/70",children:d.jsx("div",{ref:o,className:"mb-0 h-fit w-full self-end justify-self-center rounded-t-3xl border border-white/10 bg-background-200 p-2 contrast-more:border-2 md:mb-5 md:w-fit md:rounded-3xl",children:d.jsxs("div",{className:"mx-3 mb-6 mt-3 flex flex-col gap-4",children:[d.jsx("div",{className:"text-md md:text-center",children:X("crossSelling.header")}),d.jsx(CP,{icon:d.jsx(Rp,{}),text:X("crossSelling.copilotApp"),buttonText:X("common.open"),buttonColor:"strong",buttonOnClick:p,className:"gap-14"}),d.jsx(CP,{icon:d.jsx(p8,{}),text:X("crossSelling.browser"),buttonText:X("common.continue"),buttonColor:"subtle-bright",buttonOnClick:h,className:"gap-14"})]})})})}):null}function V1e({pixelUrl:t,onComplete:e}){return m.useEffect(()=>{const n=setTimeout(()=>{e()},3e3);return()=>{clearTimeout(n)}},[t,e]),d.jsx("img",{className:"hidden",src:t,width:"1",height:"1",alt:"",referrerPolicy:"no-referrer-when-downgrade",onLoad:e,onError:e})}function $1e(){const t=le("ads-pixels"),[e,n]=it(YO),r=L(ZI),o=L(Or),i=(o&&db.includes(o))===!0,s=m.useMemo(()=>bd(),[r]),a=!i||s.advertising;if(!t||!a)return null;const c=Object.values(e).filter(u=>u.isMounted).map(u=>u.url);return d.jsx("div",{className:"absolute start-[-9999px] top-[-9999px] size-px overflow-hidden",children:c.map(u=>d.jsx(V1e,{pixelUrl:u,onComplete:()=>n(h=>h[u]?{...h,[u]:{...h[u],isMounted:!1}}:h)},u))})}function G1e({onClick:t}){return d.jsx("div",{className:"absolute end-0 top-0 z-10 p-1 rtl:right-auto",children:d.jsx(Me,{title:X("product.dismiss"),"aria-label":X("product.dismiss"),variant:"rect",color:"subtle-bright-inverted",size:"32-xs",onClick:t,children:d.jsx(fo,{className:"size-4"})})})}const K1e=["overflow-hidden","rounded-[20px]","border","border-solid","border-white/20","shadow-[0px_6px_12px_0px_rgba(0,0,0,0.08)]","backdrop-blur-[30px]","bg-acrylic-default-tint-light/95","dark:bg-acrylic-default-tint-dark/95"];function q1e(t){const{title:e,subtitle:n,dismiss:r,link:o,dismissable:i=!0,className:s,Icon:a,iconClassName:c,isRTL:u,onClick:h,onActiveChange:p,customColorTheme:f}=t,g=L(Ns),v=f??g,[y,b]=m.useState(!1),[C,S]=m.useState(!1),E=y||C;m.useEffect(()=>{p==null||p(E)},[E,p]);const I=n??o?d.jsxs(d.Fragment,{children:[typeof n=="string"?`${n} `:n,o&&d.jsx("span",{className:"font-sans font-normal leading-5 text-accent-450 underline text-sm dark:text-accent-600",role:"button",tabIndex:0,"aria-label":o,children:o})]}):null;return d.jsx("div",{"data-theme":v,className:q("pointer-events-none absolute start-1/2 top-5 -translate-x-1/2",Xt.toastNotification,s),onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1),onFocus:()=>S(!0),onBlur:()=>S(!1),children:d.jsx(Pn,{children:d.jsxs(Re.div,{className:q("pointer-events-auto","relative",K1e,h&&"cursor-pointer"),initial:{opacity:0,y:-40,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-40,scale:.98},transition:{type:"spring",stiffness:400,damping:30},onClick:h,children:[i&&d.jsx(G1e,{onClick:r}),d.jsx("div",{className:q("flex","flex-col","items-center","justify-center","py-2","ps-2","pe-1.5",{"w-[min(381px,100vw)]":!!I}),children:d.jsxs("div",{className:q("relative flex w-full items-center p-0",{"gap-x-3":a,"flex-row-reverse":a&&u}),children:[a&&d.jsx("div",{className:"flex size-16 shrink-0 items-center justify-center rounded-xl border border-black/10 dark:border-white/10",children:d.jsx(a,{className:c})}),d.jsxs("div",{className:q("flex flex-1 flex-col justify-center py-1",{"ps-4":!a&&I,"pe-10":i&&I,"px-4":!I}),children:[d.jsx("header",{className:q("flex w-full overflow-hidden",{"items-center":!!I,"items-center justify-center":!I}),children:d.jsx("h2",{className:q("font-sans text-foreground-750",{"text-base-strong":!!I,"text-sm":!I}),children:e})}),I&&d.jsx("p",{className:"w-full font-sans font-normal leading-5 text-foreground-700 text-sm",children:I}),d.jsx(hd,{msg:`${e??""} ${typeof n=="string"?n:""}`,type:"assertive"})]})]})})]})},e)})}function W1e(){const[t,e]=it(Os),n=Sy(),[r,o]=m.useState(!1),[i,s]=m.useState(!1),a=m.useCallback(()=>{t!=null&&t.trackingArgs&&ht({source:"toastNotification",scenario:t.trackingArgs.scenario,customData:t.trackingArgs.customData})},[t]),c=m.useCallback(()=>{e(null)},[e]),u=m.useCallback(()=>{var p;if(!(t!=null&&t.action))return;a();const{action:h}=t;h(),c(),(p=t.onClick)==null||p.call(t)},[t,a,c]);return m.useEffect(()=>{let h;return s(!1),o(!1),t!=null&&t.dismissAfter&&(h=window.setTimeout(()=>s(!0),t.dismissAfter)),()=>clearTimeout(h)},[t]),m.useEffect(()=>{i&&!r&&c()},[i,r,c]),t?d.jsx(q1e,{title:t.title,subtitle:t.subtitle,link:t.link,dismissable:t.dismissable,className:t.className,Icon:t.iconProvider,dismiss:h=>{h==null||h.stopPropagation(),c()},isRTL:n,onClick:t.action?u:void 0,onActiveChange:o,customColorTheme:t.customColorTheme}):null}function Y1e(){var o;const t=le("top-banner-upgrade-surface-app"),e=(o=be.instance().config().uiOverrides)==null?void 0:o.showUpgradeAppTopBanner,n=t&&e;m.useEffect(()=>{n&&z.trackEvent({name:"system",data:{eventName:"upgradeSurfaceApp",eventInfo_status:"Shown"}})},[n]);const r=()=>{z.trackEvent({name:"interaction",data:{eventName:"upgradeSurfaceApp",eventInfo_status:"Clicked"}}),pl("macappstore://apps.apple.com/app/id6738511300")};return n?d.jsxs("div",{className:"pointer-events-none absolute inset-x-0 top-0 flex w-full justify-center p-3",children:[d.jsx("div",{className:"absolute top-0 h-3.5 w-full bg-stone-150 opacity-90 dark:bg-midnight-850"}),d.jsx("div",{className:q("relative w-full max-w-cookie-banner rounded-xl border border-black/5 shadow-xl dark:border-black/40",Ji,Xt.modal),children:d.jsx("div",{className:"pointer-events-auto relative max-h-[90vh] overflow-auto p-5",id:"cookie-banner",children:d.jsxs("div",{className:"flex flex-col gap-4",children:[d.jsx("h3",{className:"text-md",children:X("upgradeSurface.heading")}),d.jsxs("div",{className:"flex flex-col gap-x-8 gap-y-6 text-2xs sm:flex-row",children:[d.jsxs("div",{className:"flex flex-col gap-x-5 gap-y-4 text-2xs sm:flex-row",children:[d.jsx("p",{children:X("upgradeSurface.primaryDescription")}),d.jsx("p",{children:X("upgradeSurface.secondaryDescription")})]}),d.jsx("div",{className:"flex min-w-44 shrink-0 grow flex-col justify-center gap-2",children:d.jsx(Me,{variant:"rect",size:"32-xs",onClick:r,title:X("upgradeSurface.buttonText"),children:X("upgradeSurface.buttonText")})})]})]})})})]}):null}function Q1e(t,e){if(!(e!=null&&e.next)&&t>0)return null;const n={url:"/pages",isFirstPage:t===0};return e!=null&&e.next&&(n.args={cursor:e.next}),n}function J1e(t={}){const{disabled:e=!1}=t,n=Fo("kill-shared-page"),r=m.useCallback(async({url:o,args:i})=>{const s={...i,...n?{}:{"api-version":"2"}};return await qn(o,DY,{query:s,analytics:{anonymousPath:"/pages"}}).then(c=>c.data)},[n]);return lA(r,e?()=>null:Q1e)}function Z1e(){const t=le("pages"),e=le("pages-anonymous"),n=Lr();return{canCreatePageForSignedOut:e&&t,canCreatePage:(n||e)&&t}}function iNe(){ht({pageName:"chatPage",sectionName:"chatResponse",source:"addToPage"})}function sNe(t){ht({pageName:"addToPage",source:t})}function X1e(){ht({sectionName:"actionMenu",source:"createNewPage"})}function eEe(t){ht({pageName:t,source:"openPage"})}function aNe(){ht({pageName:"pages",sectionName:"editBar",source:"askCopilot"})}function cNe(t,e,n){ht({pageName:"pages",sectionName:"suggestions",source:t==="accept"?"applyRevision":"reject",conversationId:n,customData:JSON.stringify({eventInfo_pageId:e})})}function lNe(t){const{reaction:e,pageId:n,suggestionId:r,messageId:o,startIndex:i,endIndex:s,oldText:a,replacement:c,conversationId:u}=t;ht({pageName:"pages",sectionName:"suggestions",source:"pagesFeedback",scenario:e,conversationId:u,customData:JSON.stringify({eventInfo_pageId:n,eventInfo_reaction:e,eventInfo_suggestionId:r,eventInfo_messageId:o,eventInfo_startIndex:i,eventInfo_endIndex:s,eventInfo_oldText:a,eventInfo_replacement:c})})}function uNe(t){xr({feature:"page",...t})}const dNe=["createPage","addToExistingPage","openPageOnChat","openPageOnHistory","copyPage"];function hNe(t,e,n){ga({feature:"page",scenario:t,duration:Math.round(e),customData:JSON.stringify({eventInfo_pageId:n})})}function fNe(){ht({pageName:"pages",source:"hyperlinkInPages"})}function pNe({sectionName:t,pageId:e}){ht({sectionName:t,source:"deletePage",customData:JSON.stringify({eventInfo_pageId:e})})}function mNe({sectionName:t,pageId:e}){ht({sectionName:t,source:"renamePage",customData:JSON.stringify({eventInfo_pageId:e})})}function gNe(t){z.trackEvent({name:"interaction",data:{eventName:"copilotPagesEdited",eventInfo_customData:JSON.stringify({eventInfo_pageId:t})}})}function vNe(t){const{pageName:e,sectionName:n,pageId:r}=t;ht({pageName:e,sectionName:n,source:"pagesSharing",customData:JSON.stringify({eventInfo_pageId:r})})}function bNe(t){const{sectionName:e,pageId:n}=t;ht({sectionName:e,source:"removePagesSharing",customData:JSON.stringify({eventInfo_pageId:n})})}const yNe=["pagesHistory","direct"];function CNe(t){z.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"pagesSharing",eventInfo_impressionScenario:t}})}const SNe=["responsePreviewedPage","chatCreateNewPage","chatAddToExistingPage","chatDirectToNewPage","pagesHistory","actionMenuCreateNewPage","makeACopyViewerPage","makeACopyOwnerPage","makeACopyViewOnly","makeACopyPagesHistory"];function ENe(t){z.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"pages",eventInfo_impressionScenario:t}})}function INe(t){const{pageName:e,sectionName:n,pageId:r}=t;ht({pageName:e,sectionName:n,source:"makePagesCopy",customData:JSON.stringify({eventInfo_pageId:r})})}function TNe(){ht({pageName:"pages",source:"printPage"})}function tEe(t){z.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"3-Pages",eventInfo_impressionScenario:t}})}function nEe(){const t=pi(),e=Zv(),n=Ee(Oa);return m.useCallback(async({pageId:r,closeSidebar:o,sourcePage:i,impressionScenario:s,featureLatencyInfo:a})=>{eEe(i),o&&n(!1),await t({to:"/pages/$pageId",params:{pageId:r},from:e.state.location.pathname,state:{...a,impressionScenario:s}})},[t,e.state.location.pathname,n])}const SP="/pages";async function rEe(t,e){const n=await Wr({path:"/pages",args:{body:{title:t,content:e},analytics:{anonymousPath:SP}}}),r=await n.json(),o=UY.safeParse(r);if(!n.ok&&o.success)throw new Error(o.data.errorCode);try{return MY.parse(r)}catch(i){throw i instanceof vg&&Tf(i,SP,!1),i}}function oEe(){const{canCreatePage:t,canCreatePageForSignedOut:e}=Z1e(),{t:n}=Oe(),[r,o]=m.useState(!1),i=Qc(),s=Ee(Yr),a=Ee(ml),c=nEe();return{creatingPage:r,createPage:t?async({content:h,sourcePage:p,impressionScenario:f,featureLatencyInfo:g})=>{o(!0);try{const{id:v}=await rEe("",h);await c({pageId:v,closeSidebar:!0,sourcePage:p,impressionScenario:f,featureLatencyInfo:g})}catch(v){v instanceof Error&&v.message==="page-count-exceeded"&&e?(tEe(p),s(i?"prompt-3p-sign-in":"prompt-sign-in"),a({isOpen:!0,scenario:"sidebarActionCreatePage",reason:"pageLimitReached"})):Zs({title:n("common.somethingWrong"),message:n("pages.errorCreatingMessage")})}finally{o(!1)}}:null}}function iEe(t){const{callback:e,signInScenario:n,onShowSignIn:r,signInReason:o}=t,i=Lr(),s=Ee(ml);return(...a)=>{if(!i){s({isOpen:!0,scenario:n,reason:o}),r&&typeof r=="function"&&r();return}e(...a)}}function fA(){const{createConversation:t}=my(),e=Ee(Ep);return{startNewConversation:()=>{t(),e("center")}}}function m8(t){const{buttonSize:e}=t,{t:n}=Oe(),{startNewConversation:r}=fA(),{createPage:o}=oEe(),i=Lr(),s=le("pages-anonymous"),{refetch:a}=J1e({disabled:!i&&!s}),c=async()=>{X1e(),await(o==null?void 0:o({content:"",sourcePage:"createNewPage",impressionScenario:"actionMenuCreateNewPage",featureLatencyInfo:{scenario:"createPage",startTimestamp:Date.now()}})),await a()},u=iEe({callback:c,signInScenario:"sidebarActionCreatePage",signInReason:"createPage"}),h=async()=>{!i&&s?c():u()};return d.jsx(qw,{options:{placement:"bottom-end",hideOnMenuClick:!0,roleType:"menu"},className:Ji,renderTrigger:({onClick:p,...f})=>d.jsx(Me,{...f,title:n("sidebar.actions.menuTitle"),color:"subtle-dimmed-inverted",variant:"rect",size:e,className:"!min-w-7 !px-0",onClick:g=>{ht({source:"sidebarActionsMenu",customData:JSON.stringify({buttonSize:e})}),p(g)},children:d.jsx(Hd,{className:"size-3.5 rotate-90"})}),children:d.jsxs("div",{className:"flex flex-col gap-2",children:[d.jsx(Me,{color:"subtle-dimmed-inverted",size:"40-base",variant:"rect",alignment:"start",title:n("sidebar.actions.newChat"),onClick:r,children:n("sidebar.actions.newChat")}),d.jsx(Me,{color:"subtle-dimmed-inverted",size:"40-base",alignment:"start",variant:"rect",title:n("sidebar.actions.newPage"),onClick:()=>{setTimeout(()=>{h()},0)},children:n("sidebar.actions.newPage")})]})})}const g8=t=>m.createElement("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M9.15898 16.8666C9.36292 17.0528 9.67918 17.0384 9.86536 16.8345C10.0515 16.6305 10.0371 16.3143 9.8332 16.1281L3.66535 10.4974H17.4961C17.7722 10.4974 17.9961 10.2735 17.9961 9.99736C17.9961 9.72122 17.7722 9.49736 17.4961 9.49736H3.66824L9.8332 3.86927C10.0371 3.68309 10.0515 3.36684 9.86536 3.16289C9.67918 2.95895 9.36292 2.94456 9.15898 3.13074L2.24263 9.44478C2.10268 9.57254 2.02285 9.74008 2.00314 9.91323C1.99851 9.94058 1.99609 9.96869 1.99609 9.99736C1.99609 10.0242 1.99821 10.0506 2.00229 10.0763C2.02047 10.2522 2.10058 10.4229 2.24263 10.5526L9.15898 16.8666Z",fill:"currentColor"})),_Ne=Object.freeze(Object.defineProperty({__proto__:null,default:g8},Symbol.toStringTag,{value:"Module"})),v8=t=>m.createElement("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M2 4.5C2 4.22386 2.22386 4 2.5 4H13.5C13.7761 4 14 4.22386 14 4.5C14 4.77614 13.7761 5 13.5 5H2.5C2.22386 5 2 4.77614 2 4.5ZM2 14.5C2 14.2239 2.22386 14 2.5 14H12.5C12.7761 14 13 14.2239 13 14.5C13 14.7761 12.7761 15 12.5 15H2.5C2.22386 15 2 14.7761 2 14.5ZM2.5 9C2.22386 9 2 9.22386 2 9.5C2 9.77614 2.22386 10 2.5 10H17.5C17.7761 10 18 9.77614 18 9.5C18 9.22386 17.7761 9 17.5 9H2.5Z",fill:"currentColor"})),wNe=Object.freeze(Object.defineProperty({__proto__:null,default:v8},Symbol.toStringTag,{value:"Module"}));function sEe(){const[t,e]=m.useState(!1);return m.useEffect(()=>{async function n(){const o=await(be.instance().config().isConversationHistoryHidden??(()=>Promise.resolve(!1)))();e(o)}n().catch(()=>{})},[]),t}function aEe(t){const{open:e,toggle:n}=t,{startNewConversation:r}=fA(),[o]=it(kr),i=L(Zc),{t:s}=Oe(),a=le("pages"),c=Ft(),u=Ry(),h=o==="chat-only"||e,p=!sEe(),f=!e&&(c.startsWith("/daily")||c.endsWith("/talk")||u||c.startsWith("/labs/experiments/3d-generations"));return d.jsx("div",{className:q("pointer-events-none absolute start-0 top-0 w-full p-1 pe-3.5",Xt.sidebar),children:d.jsx("div",{className:"relative",children:d.jsxs("div",{className:"absolute flex min-w-full items-center justify-between gap-1 p-1",children:[d.jsx(Pn,{children:f&&d.jsx(Re.div,{className:q("pointer-events-auto absolute inset-0 rounded-2xl border border-stroke-100 shadow-md dark:border-stroke-300",Ji),initial:"initial",animate:"animate",exit:"exit",variants:{initial:dt,animate:Ot,exit:dt},transition:jo})}),d.jsxs("div",{className:"pointer-events-auto flex shrink-0 items-center gap-1","data-theme":i&&!e?i.theme:void 0,children:[(p||h&&e)&&d.jsx(Me,{title:s(e?"sidebar.close":"sidebar.open"),className:"after:absolute after:inset-0 after:rounded-lg hover:after:bg-black/3 dark:hover:after:bg-white/5",color:"subtle-dimmed-inverted",variant:"square",size:"28-xxs",onClick:()=>{ht({source:"sidebarToggle",pageName:c,customData:JSON.stringify({isOpen:e})}),n()},testId:"sidebar-toggle-button",children:e?d.jsx(g8,{className:"size-4"}):d.jsx(v8,{className:"size-4"})}),h&&(p||!e)&&d.jsxs("div",{className:"flex rounded-lg hover:bg-black/3 dark:hover:bg-white/5",children:[d.jsx(Me,{title:s("composer.startNewChat"),color:"subtle-dimmed-inverted",variant:"square",size:"28-xxs",onClick:()=>{ht({source:"sidebarNewConversation",destination:"/chat",pageName:c,customData:JSON.stringify({isOpen:e})}),r()},children:d.jsx(Ly,{className:"size-4"})}),a&&d.jsx(m8,{buttonSize:"28-xxs"})]})]})]})})})}const EP=65,cEe=100;function IP({count:t=1}){const e=m.useMemo(()=>Array.from({length:t},()=>`${Math.floor(Math.random()*(cEe-EP+1))+EP}%`),[t]);return d.jsx("div",{className:"flex flex-col gap-5 px-3 py-1",children:e.map((n,r)=>d.jsx("div",{style:{width:n},className:q("relative h-5 overflow-hidden rounded-lg bg-background-300 opacity-30 dark:bg-background-250 dark:opacity-40","border border-background-300 dark:border-background-250","after:absolute after:-start-[300%] after:end-0 after:start-0 after:h-full","after:opacity-50 dark:after:opacity-5","after:bg-gradient-to-r after:from-transparent after:via-white after:to-transparent","after:bg-[length:80%_100%] after:bg-no-repeat","after:animate-[shimmer-translate_2s_infinite]")},r))})}const lEe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/labs-entry-BqXQ5OEs.png",b8=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"none",...t},m.createElement("path",{d:"M3 11.75C3 11.0596 3.55964 10.5 4.25 10.5H8.25C8.94036 10.5 9.5 11.0596 9.5 11.75V13.75C9.5 14.4404 8.94036 15 8.25 15H4.25C3.55964 15 3 14.4404 3 13.75V11.75ZM4.5 12V13.5H8V12H4.5ZM11.75 10.5C11.0596 10.5 10.5 11.0596 10.5 11.75V13.75C10.5 14.4404 11.0596 15 11.75 15H15.75C16.4404 15 17 14.4404 17 13.75V11.75C17 11.0596 16.4404 10.5 15.75 10.5H11.75ZM12 13.5V12H15.5V13.5H12ZM3 6.25C3 5.55964 3.55964 5 4.25 5H8.25C8.94036 5 9.5 5.55964 9.5 6.25V8.25C9.5 8.94036 8.94036 9.5 8.25 9.5H4.25C3.55964 9.5 3 8.94036 3 8.25V6.25ZM4.5 6.5V8H8V6.5H4.5ZM11.75 5C11.0596 5 10.5 5.55964 10.5 6.25V8.25C10.5 8.94036 11.0596 9.5 11.75 9.5H15.75C16.4404 9.5 17 8.94036 17 8.25V6.25C17 5.55964 16.4404 5 15.75 5H11.75ZM12 8V6.5H15.5V8H12ZM0 4.75C0 3.23122 1.23122 2 2.75 2H17.25C18.7688 2 20 3.23122 20 4.75V15.25C20 16.7688 18.7688 18 17.25 18H2.75C1.23122 18 0 16.7688 0 15.25V4.75ZM2.75 3.5C2.05964 3.5 1.5 4.05964 1.5 4.75V15.25C1.5 15.9404 2.05964 16.5 2.75 16.5H17.25C17.9404 16.5 18.5 15.9404 18.5 15.25V4.75C18.5 4.05964 17.9404 3.5 17.25 3.5H2.75Z",fill:"currentColor"})),ANe=Object.freeze(Object.defineProperty({__proto__:null,default:b8},Symbol.toStringTag,{value:"Module"})),y8=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M19.2501 11.0017C20.2166 11.0017 21.0001 11.7852 21.0001 12.7517V19.2517C21.0001 20.2182 20.2166 21.0017 19.2501 21.0017H14.7501C13.7836 21.0017 13.0001 20.2182 13.0001 19.2517V12.7517C13.0001 11.7852 13.7836 11.0017 14.7501 11.0017H19.2501ZM9.26831 15.0141C10.2348 15.0141 11.0183 15.7976 11.0183 16.7641V19.2517C11.0183 20.2182 10.2348 21.0017 9.26831 21.0017H4.75391C3.78741 21.0017 3.00391 20.2182 3.00391 19.2517V16.7641C3.00391 15.7976 3.78741 15.0141 4.75391 15.0141H9.26831ZM19.2501 12.5017H14.7501C14.612 12.5017 14.5001 12.6136 14.5001 12.7517V19.2517C14.5001 19.3898 14.612 19.5017 14.7501 19.5017H19.2501C19.3882 19.5017 19.5001 19.3898 19.5001 19.2517V12.7517C19.5001 12.6136 19.3882 12.5017 19.2501 12.5017ZM9.26831 16.5141H4.75391C4.61584 16.5141 4.50391 16.626 4.50391 16.7641V19.2517C4.50391 19.3898 4.61584 19.5017 4.75391 19.5017H9.26831C9.40639 19.5017 9.51831 19.3898 9.51831 19.2517V16.7641C9.51831 16.626 9.40639 16.5141 9.26831 16.5141ZM9.25391 3C10.2204 3 11.0039 3.7835 11.0039 4.75V11.25C11.0039 12.1682 10.2968 12.9212 9.39743 12.9942L9.25391 13H4.75391C3.78741 13 3.00391 12.2165 3.00391 11.25V4.75C3.00391 3.7835 3.78741 3 4.75391 3H9.25391ZM9.25391 4.5H4.75391C4.61584 4.5 4.50391 4.61193 4.50391 4.75V11.25C4.50391 11.3881 4.61584 11.5 4.75391 11.5H9.25391L9.31123 11.4934C9.42167 11.4675 9.50391 11.3683 9.50391 11.25V4.75C9.50391 4.61193 9.39198 4.5 9.25391 4.5ZM19.2501 3C20.2166 3 21.0001 3.7835 21.0001 4.75V7.25C21.0001 8.2165 20.2166 9 19.2501 9H14.7501C13.7836 9 13.0001 8.2165 13.0001 7.25V4.75C13.0001 3.7835 13.7836 3 14.7501 3H19.2501ZM14.7501 4.5C14.612 4.5 14.5001 4.61193 14.5001 4.75V7.25C14.5001 7.38807 14.612 7.5 14.7501 7.5H19.2501C19.3882 7.5 19.5001 7.38807 19.5001 7.25V4.75C19.5001 4.61193 19.3882 4.5 19.2501 4.5H14.7501Z",fill:"currentColor"})),kNe=Object.freeze(Object.defineProperty({__proto__:null,default:y8},Symbol.toStringTag,{value:"Module"})),C8=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",...t},m.createElement("path",{fill:"currentColor",d:"M4 3h1c1 0 2 .8 2 1.9V19c0 1-.8 2-1.9 2H4c-1 0-2-.8-2-1.9V5c0-1 .8-2 1.9-2H5 4Zm6 0h1c1 0 2 .8 2 1.9V19c0 1-.8 2-1.9 2H10c-1 0-2-.8-2-1.9V5c0-1 .8-2 1.9-2H11h-1Zm7 2a2 2 0 0 1 1.9 1.3v.2l3 11.7c.3 1-.3 2.1-1.3 2.4h-.1l-1 .3a2 2 0 0 1-2.4-1.3v-.1L14 7.7a2 2 0 0 1 1.3-2.3h.1l1-.3.5-.1ZM5 4.5H4c-.2 0-.4.2-.5.4V19c0 .2.2.4.4.5H5c.2 0 .4-.2.5-.4V5c0-.2-.2-.4-.4-.5H5Zm6 0h-1c-.2 0-.4.2-.5.4V19c0 .2.2.4.4.5H11c.2 0 .4-.2.5-.4V5c0-.2-.2-.4-.4-.5H11Zm6 2h-.2l-1 .3a.5.5 0 0 0-.3.5l3 11.8c.1.3.3.4.5.4h.1l1-.3c.3 0 .4-.3.4-.5l-3-11.8c-.1-.3-.3-.4-.5-.4Z"})),xNe=Object.freeze(Object.defineProperty({__proto__:null,default:C8},Symbol.toStringTag,{value:"Module"}));function TP(t){return t?{x:t.scrollLeft,y:t.scrollTop}:{x:0,y:0}}function uEe(t,e={}){const{checkIsScrolling:n=!0,scrollEndDelay:r=150}=e,[o,i]=m.useState(TP(t.current)),[s,a]=m.useState(!1),c=m.useRef(void 0);return m.useEffect(()=>{const u=t.current;let h=null;if(u===null)return()=>{};function p(){h===null&&(h=window.requestAnimationFrame(()=>{i(TP(u)),n&&(a(!0),c.current&&window.clearTimeout(c.current),c.current=window.setTimeout(()=>{a(!1)},r)),h=null}))}return u.addEventListener("scroll",p),()=>{u.removeEventListener("scroll",p),c.current&&clearTimeout(c.current)}},[n,t,r]),e.checkIsScrolling?{...o,isScrolling:s}:o}function dEe(t,e){let n=!1;return(...r)=>{n||(t(...r),n=!0,setTimeout(()=>{n=!1},e))}}function _P(t,e=1e3){const n=m.useRef();return m.useEffect(()=>{n.current=t},[t]),m.useMemo(()=>dEe((...i)=>{var s;(s=n.current)==null||s.call(n,...i)},e),[e])}function hEe({onScrollStart:t,onScrollEnd:e,scrollRefs:n}){const r=m.useRef({}),o=_P(s=>{const{target:a}=s;a instanceof Window?r.current={scrollSource:"window",scrollStartTime:Date.now(),scrollStartX:a.scrollX,scrollStartY:a.scrollY}:a instanceof HTMLElement&&(r.current={scrollSource:a.id,scrollStartTime:Date.now(),scrollStartX:a.scrollLeft,scrollStartY:a.scrollTop}),t==null||t(r.current)}),i=_P(s=>{const{target:a}=s;a instanceof Window?(r.current={...r.current,scrollEndX:a.scrollX,scrollEndY:a.scrollY,scrollDuration:Date.now()-(r.current.scrollStartTime??0)},e==null||e(r.current)):a instanceof HTMLElement?(r.current={...r.current,scrollEndX:a.scrollLeft,scrollEndY:a.scrollTop,scrollDuration:Date.now()-(r.current.scrollStartTime??0)},e==null||e(r.current)):r.current={}});m.useEffect(()=>{var a,c;const s={passive:!0};for(const u of n)(a=u.current)==null||a.addEventListener("scroll",o,s),(c=u.current)==null||c.addEventListener("scrollend",i,s);return()=>{var u,h;for(const p of n)(u=p.current)==null||u.removeEventListener("scroll",o),(h=p.current)==null||h.removeEventListener("scrollend",i)}},[n,o,i])}function S8(t){const{scrollableRef:e,customData:n}=t,r=m.useCallback(o=>{window.requestAnimationFrame(()=>{_X({...o,scrollSource:t.source??o.scrollSource,customData:JSON.stringify(n)})})},[n,t.source]);hEe({onScrollEnd:r,scrollRefs:[e]})}const wP="sticky bg-sidebar-light dark:bg-sidebar-dark",AP="before:pointer-events-none before:absolute before:h-10 before:w-full before:from-sidebar-light before:to-transparent dark:before:from-sidebar-dark",fEe="bg-labs-light dark:bg-labs-dark",pEe=m.lazy(()=>H(()=>import("./sidebar-pages-DwHNepil.js"),__vite__mapDeps([289,1,2,290])).then(t=>({default:t.SidebarPages}))),mEe=m.lazy(()=>H(()=>import("./conversations-BH4ZIfCj.js"),__vite__mapDeps([291,1,2,292,293,294,290,295])));function gEe(){const{t}=Oe(),e=Ft(),n=pi(),r=Lr(),o=le("pages"),i=le("pages-sidebar-empty-cta"),s=le("pages-anonymous"),a=(r||i||s)&&o,c=le("labs-landing"),u=le("share-campaign-gallery"),h=Ey(),p=h||e==="/daily",f=e.startsWith("/library"),g=le("library"),v=e.startsWith("/labs"),y=e.startsWith("/campaigns/gallery"),b=L(Ib),C=m.useRef(null),{y:S}=uEe(C),E=S>0,I=Xw(),T=Ee(Oa);return S8({scrollableRef:C,source:"sidebar"}),d.jsx("div",{className:q("h-screen px-1 py-2",I?"w-full":"w-sidebar"),children:d.jsx("div",{className:"t-custom-scrollbar h-full overflow-y-auto overflow-x-hidden",ref:C,children:d.jsxs("div",{className:"flex min-h-full w-full flex-col px-2",children:[d.jsxs("div",{className:q(wP,AP,"top-0 z-10 flex flex-col gap-px pb-3 pt-[72px]","before:bottom-0 before:top-full before:bg-gradient-to-b before:opacity-90",E&&"after:absolute after:bottom-0 after:mx-1 after:w-[calc(100%-8px)] after:border-b after:border-black/8 dark:after:border-white/10",I&&"whitespace-nowrap"),children:[d.jsx(Me,{className:q("flex-col px-2.5 py-2",p&&"!bg-black/5 dark:!bg-white/8"),title:t("composer.goToHome"),color:"subtle-dimmed-inverted",onClick:async()=>{h?I&&T(!1):(ht({source:"sidebarDiscoverButton",destination:"/",pageName:e}),await n({to:"/",from:e}))},testId:"sidebar-discover-button",children:d.jsxs("span",{className:"flex w-full items-center gap-3",children:[d.jsx("span",{className:"relative flex size-10 shrink-0 items-center justify-center bg-caramel-350/40 text-caramel-600 squircle-16 dark:bg-slate-650/60 dark:text-slate-250",children:d.jsx(y8,{className:"size-6"})}),d.jsxs("span",{className:"flex flex-1 flex-col",children:[d.jsx("span",{className:"h-6 w-full text-start text-base-strong",children:t("sidebar.discover")}),d.jsx("span",{className:"w-full text-start text-foreground-650 text-xs",children:t("sidebar.discoverDescription")})]})]})}),g&&d.jsx(Me,{color:"subtle-dimmed-inverted",className:q("flex-col px-2.5 py-2",f&&"!bg-black/5 dark:!bg-white/8"),title:t("sidebar.library"),onClick:()=>{n({to:"/library",from:e})},children:d.jsxs("span",{className:"flex w-full items-center gap-3",children:[d.jsx("span",{className:"relative flex size-10 shrink-0 items-center justify-center bg-spot-green-300/40 text-spot-green-600 squircle-16 dark:bg-spot-green-600/60 dark:text-slate-250",children:d.jsx(C8,{className:"size-6"})}),d.jsxs("span",{className:"flex flex-1 flex-col",children:[d.jsx("span",{className:"h-6 w-full text-start text-base-strong",children:t("sidebar.library")}),d.jsx("span",{className:"w-full text-start text-foreground-650 text-xs",children:t("sidebar.libraryDescription")})]})]})}),c&&d.jsx(Me,{className:q("flex-col px-2.5 py-2",v&&"!bg-black/5 dark:!bg-white/8"),title:t("sidebar.labsDescription"),color:"subtle-dimmed-inverted",onClick:async()=>{ht({source:"sidebarLabsButton",destination:"/labs",pageName:e}),await n({to:"/labs",from:e}),I&&v&&T(!1)},children:d.jsxs("span",{className:"flex w-full items-center gap-3",children:[d.jsx("span",{className:q("relative flex size-10 shrink-0 items-center justify-center squircle-16",fEe),children:d.jsx("img",{src:lEe,alt:t("sidebar.labs"),className:"size-6"})}),d.jsxs("span",{className:"flex flex-1 flex-col",children:[d.jsx("span",{className:"h-6 w-full text-start text-base-strong",children:t("sidebar.labs")}),d.jsx("span",{className:"w-full text-start text-foreground-650 text-xs",children:t("sidebar.labsDescription")})]})]})}),u&&d.jsx(Me,{className:q("flex-col px-2.5 py-2",y&&"!bg-black/5 dark:!bg-white/8"),title:t("sidebar.gallery.title"),color:"subtle-dimmed-inverted",onClick:async()=>{await n({to:"/campaigns/gallery",from:e}),I&&y&&T(!1)},children:d.jsx("span",{className:"flex w-full items-center justify-between",children:d.jsxs("span",{className:"flex items-center gap-3",children:[d.jsx("span",{className:"relative flex size-10 shrink-0 items-center justify-center bg-midnight-350/50 text-midnight-600 squircle-16 dark:bg-midnight-600/50 dark:text-midnight-350",children:d.jsx(b8,{className:"size-5"})}),d.jsxs("span",{className:"flex flex-1 flex-col",children:[d.jsxs("span",{className:"flex h-6 w-full items-center gap-1 text-start text-base-strong",children:[t("sidebar.gallery.title"),d.jsx(cf,{color:"accent",children:t("sidebar.gallery.badge")})]}),d.jsx("span",{className:"w-full text-start text-foreground-650 text-xs",children:t("sidebar.gallery.description")})]})]})})})]}),d.jsxs("div",{className:"relative flex grow flex-col py-5",children:[a&&d.jsx(m.Suspense,{fallback:null,children:d.jsx(pEe,{})}),d.jsx("h2",{className:"mb-5 flex gap-2 px-3 align-middle text-base-strong",children:t("sidebar.conversations")}),b?d.jsx(m.Suspense,{fallback:d.jsx(IP,{count:16}),children:d.jsx(mEe,{inSidebar:!0})}):d.jsx(IP,{count:16})]}),d.jsx("div",{className:q(wP,AP,"bottom-0 before:bottom-full before:bg-gradient-to-t")})]})})})}function kP(t){const{className:e,text:n}=t;return d.jsx("p",{className:nt("inline h-min flex-none rounded border px-0.5 uppercase text-3xs",e),children:n})}const vEe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-wordmark-DvWA6bVb.svg",E8=t=>m.createElement("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M3.75 8.5C3.75 8.08579 4.08579 7.75 4.5 7.75H5.75C6.16421 7.75 6.5 8.08579 6.5 8.5C6.5 8.91421 6.16421 9.25 5.75 9.25H4.5C4.08579 9.25 3.75 8.91421 3.75 8.5ZM3.75 12C3.75 11.5858 4.08579 11.25 4.5 11.25H5.75C6.16421 11.25 6.5 11.5858 6.5 12C6.5 12.4142 6.16421 12.75 5.75 12.75H4.5C4.08579 12.75 3.75 12.4142 3.75 12ZM3.75 15.5C3.75 15.0858 4.08579 14.75 4.5 14.75H5.75C6.16421 14.75 6.5 15.0858 6.5 15.5C6.5 15.9142 6.16421 16.25 5.75 16.25H4.5C4.08579 16.25 3.75 15.9142 3.75 15.5ZM4.25 3C2.45507 3 1 4.45507 1 6.25V17.75C1 19.5449 2.45508 21 4.25 21H19.75C21.5449 21 23 19.5449 23 17.75V6.25C23 4.45507 21.5449 3 19.75 3H4.25ZM19.75 19.5H9V4.5H19.75C20.7165 4.5 21.5 5.2835 21.5 6.25V17.75C21.5 18.7165 20.7165 19.5 19.75 19.5ZM4.25 4.5H7.5V19.5H4.25C3.2835 19.5 2.5 18.7165 2.5 17.75V6.25C2.5 5.2835 3.2835 4.5 4.25 4.5Z",fill:"currentColor"})),RNe=Object.freeze(Object.defineProperty({__proto__:null,default:E8},Symbol.toStringTag,{value:"Module"}));function bEe(){const t=L(zI),e=L(qu);return t&&!!e}function yEe(t){const{open:e,toggle:n}=t,{startNewConversation:r}=fA(),[o]=it(kr),i=L(Zc),{t:s}=Oe(),a=le("pages"),c=Ft(),u=Ry(),h=o==="chat-only"||e,p=bEe(),f=!e&&(c.startsWith("/daily")||c.endsWith("/talk")||u||c.startsWith("/labs/experiments/3d-generations"));return d.jsx("div",{className:q("pointer-events-none absolute start-0 top-0 w-full p-2.5 pe-3.5",Xt.sidebar),children:d.jsx("div",{className:"relative",children:d.jsxs("div",{className:"absolute flex min-w-full items-center justify-between gap-1 p-1",children:[d.jsx(Pn,{children:f&&d.jsx(Re.div,{className:q("pointer-events-auto absolute inset-0 rounded-2xl border border-stroke-100 shadow-md dark:border-stroke-300",Ji),initial:"initial",animate:"animate",exit:"exit",variants:{initial:dt,animate:Ot,exit:dt},transition:jo})}),d.jsx(Fn,{className:"flex items-center",delay:Oo.default,duration:Oo.slow,children:e&&d.jsxs(Me,{role:"link",title:s("sidebar.homepageLink"),className:"pointer-events-auto absolute start-0 flex items-center gap-2.5 px-3.5",color:"subtle-dimmed-inverted",testId:"sidebar-copilot-brand-button",onClick:()=>{ht({source:"sidebarBrandButton",destination:"/chat",pageName:c}),r()},children:[d.jsx(Rp,{className:"size-6"}),d.jsxs("span",{className:"flex items-center text-md-strong",children:[d.jsx(rr,{url:vEe,className:"h-[18px] w-[58px]"}),p&&d.jsx(kP,{text:s("settings.copilotBeta.beta"),className:"ms-2 uppercase"})]})]})}),d.jsxs("div",{className:"pointer-events-auto flex shrink-0 items-center gap-1","data-theme":i&&!e?i.theme:void 0,children:[d.jsx(Me,{title:s(e?"sidebar.close":"sidebar.open"),className:"after:absolute after:inset-0 after:rounded-xl hover:after:bg-black/3 dark:hover:after:bg-white/5",color:"subtle-dimmed-inverted",variant:"square",size:"36-sm",onClick:()=>{ht({source:"sidebarToggle",pageName:c,customData:JSON.stringify({isOpen:e})}),n()},testId:"sidebar-toggle-button",children:d.jsx(E8,{className:"size-6"})}),h&&d.jsxs("div",{className:"flex rounded-xl hover:bg-black/3 dark:hover:bg-white/5",children:[d.jsx(Me,{title:s("composer.startNewChat"),color:"subtle-dimmed-inverted",variant:"square",size:"36-sm",onClick:()=>{ht({source:"sidebarNewConversation",destination:"/chat",pageName:c,customData:JSON.stringify({isOpen:e})}),r()},children:d.jsx(Ly,{className:"size-5"})}),a&&d.jsx(m8,{buttonSize:"36-sm"})]}),!e&&p&&d.jsx(kP,{text:s("settings.copilotBeta.beta"),className:"relative m-2 uppercase"})]})]})})})}function CEe(){const[t,e]=it(Oa),n=pr({breakpoint:"md"}),r=m.useRef(n),o=be.instance().config().useCompactSidebarHeader??!1;hw(()=>{n&&e(!1)}),m.useEffect(()=>{r.current===!1&&n&&e(!1),r.current===!0&&!n&&e(YU()==="open"),r.current=n},[n,e]);const i=()=>{e(s=>!s),n||s0e(t?"close":"open")};return d.jsxs(d.Fragment,{children:[d.jsx(Pn,{children:n&&t&&d.jsx(Re.div,{className:"fixed inset-0 bg-black/30",onClick:()=>e(!1),initial:"initial",animate:"animate",exit:"exit",variants:{initial:dt,animate:Ot,exit:dt},transition:jo})}),d.jsxs(Re.div,{className:q("relative w-full bg-sidebar-light dark:bg-sidebar-dark",t&&"h-full"),layout:"position",children:[o?d.jsx(aEe,{open:t,toggle:i}):d.jsx(yEe,{open:t,toggle:i}),d.jsx(Pn,{children:t&&d.jsx(Re.div,{className:"overflow-hidden",initial:"initial",animate:"animate",exit:"exit",variants:{initial:dt,animate:Ot,exit:dt},transition:jo,children:d.jsx(gEe,{})})})]})]})}const SEe=324,xP="bg-sidebar-light dark:bg-sidebar-dark";function EEe(t){const{children:e,sidebar:n}=t,r=document.getElementById("app"),o=Sy(),i=pr({breakpoint:"md"}),s=yo(),c=L(Oa)&&s,[u,h]=m.useState(!1),p=L(kr),f=L($h),g=L(vb),v=Xw();m.useEffect(()=>{r&&r.style.setProperty("--layout-offset-y",s&&c&&!i?`${Si}px`:"0px")},[r,s,c,i]);const y=c&&!i,b=p==="side-by-side",C=v?"100%":SEe,S=f||!!g;return d.jsxs("div",{className:q("flex h-full overflow-hidden",xP),inert:S?"":void 0,children:[n??(s&&d.jsx(Re.div,{className:q("h-full will-change-auto",i?"absolute":"relative",i&&xP,i&&Xt.sidebar),initial:{width:c?C:0},animate:{width:c?C:0},transition:jo,onAnimationStart:()=>h(!0),onAnimationComplete:()=>h(!1),children:d.jsx(CEe,{})})),d.jsx(Re.main,{className:q("relative flex w-full min-w-0 will-change-auto","after:pointer-events-none after:fixed after:inset-2 after:start-[324px] after:rounded-container after:border after:border-transparent after:transition-opacity dark:after:border-white/12 dark:after:border-s-white/8",y&&!u?"after:opacity-100 after:duration-1000":"after:opacity-0 after:duration-0"),initial:{paddingTop:y||b?Si:0,paddingBottom:!b&&y?Si:0,paddingLeft:y&&o?Si:0,paddingRight:y&&!o?Si:0},animate:{paddingTop:y||b?Si:0,paddingBottom:!b&&y?Si:0,paddingLeft:y&&o||!y&&b?Si:0,paddingRight:y&&!o||!y&&b?Si:0},transition:i?{duration:0}:jo,children:e})]})}function IEe(t){const{children:e,className:n,clipPathBreakpoint:r="md",backgroundColor:o}=t,i=pr({breakpoint:r}),s=yo(),c=Ft().endsWith("/talk");return d.jsxs("div",{className:nt("relative h-full overflow-hidden",n),children:[d.jsx("div",{className:q("absolute size-full",s&&!i&&"t-main-clip-path"),children:d.jsx(fl,{customColor:o,isFixed:!0})}),d.jsx("div",{className:q("relative size-full",!c&&"overflow-hidden",s&&!i&&"rounded-container"),children:e})]})}var S0={exports:{}},RP;function TEe(){return RP||(RP=1,function(t){var e=function(){function n(f,g){return g!=null&&f instanceof g}var r;try{r=Map}catch{r=function(){}}var o;try{o=Set}catch{o=function(){}}var i;try{i=Promise}catch{i=function(){}}function s(f,g,v,y,b){typeof g=="object"&&(v=g.depth,y=g.prototype,b=g.includeNonEnumerable,g=g.circular);var C=[],S=[],E=typeof Buffer<"u";typeof g>"u"&&(g=!0),typeof v>"u"&&(v=1/0);function I(T,_){if(T===null)return null;if(_===0)return T;var w,A;if(typeof T!="object")return T;if(n(T,r))w=new r;else if(n(T,o))w=new o;else if(n(T,i))w=new i(function(j,U){T.then(function(te){j(I(te,_-1))},function(te){U(I(te,_-1))})});else if(s.__isArray(T))w=[];else if(s.__isRegExp(T))w=new RegExp(T.source,p(T)),T.lastIndex&&(w.lastIndex=T.lastIndex);else if(s.__isDate(T))w=new Date(T.getTime());else{if(E&&Buffer.isBuffer(T))return Buffer.allocUnsafe?w=Buffer.allocUnsafe(T.length):w=new Buffer(T.length),T.copy(w),w;n(T,Error)?w=Object.create(T):typeof y>"u"?(A=Object.getPrototypeOf(T),w=Object.create(A)):(w=Object.create(y),A=y)}if(g){var M=C.indexOf(T);if(M!=-1)return S[M];C.push(T),S.push(w)}n(T,r)&&T.forEach(function(j,U){var te=I(U,_-1),Q=I(j,_-1);w.set(te,Q)}),n(T,o)&&T.forEach(function(j){var U=I(j,_-1);w.add(U)});for(var R in T){var $;A&&($=Object.getOwnPropertyDescriptor(A,R)),!($&&$.set==null)&&(w[R]=I(T[R],_-1))}if(Object.getOwnPropertySymbols)for(var V=Object.getOwnPropertySymbols(T),R=0;R<V.length;R++){var ie=V[R],N=Object.getOwnPropertyDescriptor(T,ie);N&&!N.enumerable&&!b||(w[ie]=I(T[ie],_-1),N.enumerable||Object.defineProperty(w,ie,{enumerable:!1}))}if(b)for(var Y=Object.getOwnPropertyNames(T),R=0;R<Y.length;R++){var ue=Y[R],N=Object.getOwnPropertyDescriptor(T,ue);N&&N.enumerable||(w[ue]=I(T[ue],_-1),Object.defineProperty(w,ue,{enumerable:!1}))}return w}return I(f,v)}s.clonePrototype=function(g){if(g===null)return null;var v=function(){};return v.prototype=g,new v};function a(f){return Object.prototype.toString.call(f)}s.__objToStr=a;function c(f){return typeof f=="object"&&a(f)==="[object Date]"}s.__isDate=c;function u(f){return typeof f=="object"&&a(f)==="[object Array]"}s.__isArray=u;function h(f){return typeof f=="object"&&a(f)==="[object RegExp]"}s.__isRegExp=h;function p(f){var g="";return f.global&&(g+="g"),f.ignoreCase&&(g+="i"),f.multiline&&(g+="m"),g}return s.__getRegExpFlags=p,s}();t.exports&&(t.exports=e)}(S0)),S0.exports}var _Ee=TEe();const NP=LM(_Ee);function wEe(){const t=L(sL),e=m.useRef(!1);m.useEffect(()=>{t&&!e.current&&(z.trackEvent({name:"system",data:{eventName:"copilotStart",eventInfo_duration:window.appEnd-window.appStart,eventInfo_landingPage:z.getLandingPage()}}),e.current=!0)},[t])}const AEe=10*1024*1024,kEe=5*1024*1024,xEe=50*1024*1024,REe=3,E0={"image/png":["png"],"image/jpeg":["jpg","jpeg"],"image/webp":["webp"],"image/svg+xml":["svg"],"application/pdf":["pdf"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/json":["json"],"text/csv":["csv"],"text/markdown":["md"],"text/plain":["txt"]},NEe={"image/png":["png"],"image/jpeg":["jpg","jpeg"]},PEe={"application/pdf":["pdf"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/json":["json"],"text/csv":["csv"],"text/markdown":["md"],"text/plain":["txt"]},PP=D(null),I8=D(t=>{const e=t(Aa("fileasyncprocessing"));return{maxFilesPerMessage:REe,image:{maxBytes:AEe,mimeTypes:NEe},document:{maxBytes:e?xEe:kEe,mimeTypes:PEe}}}),T8=D(t=>t(PP)??t(I8),(t,e,n)=>{e(PP,n)});D(t=>{const e=t(T8);return{...e.image.mimeTypes,...e.document.mimeTypes}});const MEe={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1,refreshInterval:tA};function OEe(t){return function(n){return qn(n,XY,t?{query:{"api-version":"2"}}:void 0).then(r=>r.data)}}function ss(t){return Array.isArray(t)?df(t):{positive:df(t.positive),negative:df(t.negative)}}function df(t){const e=t,n=e.slice(0,-1),r=e.slice(-1);return[...Kve(n),...r]}function LEe(){const t=le("adspositivefeedbacksurvey"),e=le("file-upload-config"),n=OEe(t),{data:r,mutate:o}=hl("/config",n,MEe),i=Ee(gb),s=Ee(HO),a=Ee(GO),c=Ee(khe),u=Ee(xhe),h=Ee(Rhe),p=Ee(qI),f=Ee(WI),g=Ee(zO),v=Ee(T8),y=Ee($$);jU(o),m.useEffect(()=>{if(r){if(i(r.voices),s(r.signInPrompts),a(r.maxTextMessageLength),c(r.maxPageContentLength),h(r.pageLimit),u(r.maxPageTitleLength),r.characters&&f(r.characters),r.feedbackOptions.text=df(r.feedbackOptions.text),r.feedbackOptions.image=df(r.feedbackOptions.image),r.feedbackOptions.card.local=ss(r.feedbackOptions.card.local),r.feedbackOptions.card.ads=ss(r.feedbackOptions.card.ads),r.feedbackOptions.card.video=ss(r.feedbackOptions.card.video),r.feedbackOptions.card.image=ss(r.feedbackOptions.card.image),r.feedbackOptions.card.shopping=ss(r.feedbackOptions.card.shopping),r.feedbackOptions.card.sports=ss(r.feedbackOptions.card.sports),r.feedbackOptions.card.finance=ss(r.feedbackOptions.card.finance),r.feedbackOptions.card.quiz=ss(r.feedbackOptions.card.quiz),r.feedbackOptions.card.weather=ss(r.feedbackOptions.card.weather),p(r.feedbackOptions),g(r.messagePreview),e){const b=I=>{const T={};for(const _ of I)_ in E0&&E0[_]&&(T[_]=E0[_]);return T},C=b(r.attachments.image.mimeTypes),S=b(r.attachments.document.mimeTypes),E=Ge(I8);v({maxFilesPerMessage:r.attachments.maxFilesPerMessage||E.maxFilesPerMessage,image:{maxBytes:r.attachments.image.maxBytes||E.image.maxBytes,mimeTypes:Object.keys(C).length?C:E.image.mimeTypes},document:{maxBytes:r.attachments.document.maxBytes||E.document.maxBytes,mimeTypes:Object.keys(S).length?S:E.document.mimeTypes}})}y(r.portraits??[])}},[r,s,i,a,c,u,p,f,h,g,v,e,y])}function DEe(){const t=rp(En);return m.useCallback(n=>{t(r=>{for(const{id:o,title:i,updatedAt:s,characterId:a,continuedAt:c}of n){const u=r.get(o);u?(u.title=i,u.updatedAt=s,u.characterId=a??null,u.continuedAt=c):r.set(o,{id:o,title:i,updatedAt:s,characterId:a??null,streamingState:"idle",history:[],continuedAt:null})}})},[t])}function jEe(t,e){if(!(e!=null&&e.next)&&t>0)return null;const n={url:"/conversations",isFirstPage:t===0};return e!=null&&e.next&&(n.args={cursor:e.next}),n}function UEe(){const t=DEe(),e=Ee(mb),n=m.useCallback(async({url:r,args:o,isFirstPage:i})=>{const s=await qn(r,mQ,{query:o}).then(a=>a.data);if(s.results.length>0){const a=s.results.map(c=>({...c,history:[],streamingState:"idle"}));t(a),e(!0)}else i&&e(!1);return s},[t,e]);return lA(n,jEe)}function FEe(){const t=Ee(Or),e=Ee(jJ);return m.useCallback(async()=>{const n=await qn("/user",V5,{parseOptions:{safe:!0},query:{"api-version":"2"}}).then(s=>s.data),{id:r,anid:o,isHistoryMigrationPending:i}=n;return z.setAnid(o),z.setPicassoId(r),e(i),t(n.regionCode),n},[e,t])}function BEe(){const t=L(An),e=L(il),{refetch:n}=UEe(),r=FEe(),o=Ee(gr),i=Ee(Ac),s=Ee(lp),a=Ee(cL),c=Ee(uL),u=Ee(yT),h=Ee(CT),p=Ee(MJ),f=Ee(Z$),g=Ee(dL),v=Ee(OJ),y=Ee(oL),b=Ee(ST),C=Ee(Tb),S=Ee(LJ),E=le("multiplecharacters"),I=le("account-change-chat-reset"),T=gy()[0]==="audioCall";m.useEffect(()=>{(async()=>{const w=Promise.all([r(),qn("/user/settings",hQ).then($e=>$e.data),n()]),A=ks.instance().getUserInfo(),[{id:M,firstName:R,isPro:$,inEeaPlusRegion:V,isEligibleForFreeTrial:ie,phoneLink:N,ageGroup:Y,allowedToggles:ue,remainingCalls:j,subscriptions:U,accountTier:te},{preferredVoice:Q,preferredCharacter:re,optOutOfTraining:Z,optInToVoiceTraining:_e,optOutOfPersonalization:ye,optOutOfPhoneConnection:Se,optInToGenerativeUI:Ne,allowBiometricDataUse:we,allowOneDriveAccess:Ke,features:de}]=await w;if(z.setIsAad(e),o({id:M,firstName:R,isPro:$&&!e,inEeaPlusRegion:V,isEligibleForFreeTrial:ie,phoneLink:N,ageGroup:Y,allowedToggles:ue,subscriptions:U,accountTier:te,isStudent:void 0}),y(R??void 0),!I&&!T&&await Tw(),Q&&s(Q),E&&re){const $e=jO(re);a($e)}c(Z),u(_e),h(ye),p(!!Se),f(!!Ne),g(!!we),v(!!Ke),S((de==null?void 0:de.suggestedFollowups)??!0),j&&(b(j.podcastGeneration),C(j.research)),z.setSettings({userSettingVoiceType:Q??void 0,userConsentPersonalization:!ye,userConsentModelTraining:!Z,userSubscription:$?"pro":"free",accountTier:te??void 0,activeSubscriptions:(U==null?void 0:U.map($e=>$e.tier).join(","))??void 0});const ge=await A;if(ge){const{mail:$e,givenName:P,imgSrc:J,isStudent:Te}=ge;o(O=>O&&{...O,givenName:P,email:$e,imgSrc:J,isStudent:Te}),P&&!R&&y(P),e||i(null)}})().catch(console.error)},[t,I,o,i,n,c,s,E,p,f,u,h,g,v,r,e,a,T,y,b,C,S])}const HEe=l.object({isMobileAppInstalled:l.boolean()}),zEe="/user/install-status";async function VEe(){try{return(await qn(zEe,HEe,{options:{method:"GET"}})).data.isMobileAppInstalled}catch(t){throw console.error("Failed to fetch mobile app install status:",t),t}}function $Ee(){const t=Ee(QI),{data:e,error:n,isLoading:r,mutate:o}=hl("mobileAppInstallStatus",VEe,{revalidateOnFocus:!1,revalidateOnReconnect:!1,dedupingInterval:6e4});return m.useEffect(()=>{e!==void 0&&t(e)},[e,t]),{isMobileAppInstalled:e,isLoading:r,error:n||null,refetch:o}}const GEe="/user/narrative";function MP(t,e){var n;return(n=t.filter(r=>r.name===e)[0])==null?void 0:n.url}function NNe(t){const{background1:e,background2:n,background3:r}=t,i=[n,e,r].filter(a=>typeof a=="object"&&"light"in a&&"dark"in a);if(i.length===0)return[];const s=[];for(let a=0;a<i.length;a+=1){const c=i[a],u=i[(a+1)%i.length];!c||!u||(s.push({type:"gradient",from:c,to:u}),s.push({type:"solid",color:u}))}return s}function PNe(t,e,n){const r=t[e%t.length];return r?r.type==="gradient"?`linear-gradient(to bottom, ${n?`#${r.from.dark}`:`#${r.from.light}`}, ${n?`#${r.to.dark}`:`#${r.to.light}`})`:n?`#${r.color.dark}`:`#${r.color.light}`:"var(--background-color)"}function MNe(t,e){return e==="wavy-shape"?MP(t,"hero-image-wavy-tablet"):MP(t,`hero-image-${e}-tablet`)}const KEe=l.object({from:l.string()});function qEe(t){return KEe.safeParse(t).success}function ONe(t){return qEe(t)?t.from:"/"}const LNe={start:{...dt,y:300},end:{...Ot,y:0}},DNe={duration:Yue,ease:Que},WEe={revalidateOnFocus:!1,shouldRetryOnError:!1,refreshInterval:tA};async function YEe(t){const{data:e,response:n}=await qn(t,kY,{options:{method:"GET",headers:{"Content-Type":"application/json"}},query:{"api-version":"2"}});if(!n.ok)return null;const{id:r,sections:o,theme:i,masks:s,font:a,fontHandwriting:c}=e;return{id:r,sections:o.filter(u=>u.type!=="shareDefault"),config:{theme:i,masks:s,font:a,...c?{fontHandwriting:c}:{}}}}function QEe(){const t=Lr(),e=le("memory-narrative"),n=t&&e,{data:r,error:o,isLoading:i}=hl(n?GEe:null,YEe,WEe);return{isLoading:i,error:o,data:i||!r?null:r}}const _8=m.forwardRef((t,e)=>{var b;const{children:n}=t,r=rB(),o=!yy(),i=MM(),s=m.useRef(i),a=oB(),c=m.useContext(a);let u=c;const h=Ft(),p=m.useRef(h),f=m.useRef((b=window.history.state)==null?void 0:b.from),g=yo();r?s.current=NP(i):(u=NP(c),u.__store.state.matches=[...i.map((C,S)=>({...s.current[S]??C,id:C.id})),...s.current.slice(i.length)]);const v=ZEe(h,f.current,g)&&o;return be.instance().config().disableRouteAnimation??!1?d.jsx("div",{ref:e,className:"relative size-full max-h-dvh",children:d.jsx(a.Provider,{value:u,children:n})}):d.jsx(Re.div,{ref:e,className:"relative size-full max-h-dvh overflow-hidden",initial:f.current&&o?"enter":!1,animate:o?"animate":!1,exit:"exit",variants:{enter:{opacity:0,scale:OP(h,f.current,"enter",g)},animate:{opacity:1,scale:1},exit:{scale:OP(h,p.current,"exit",g),opacity:0,transition:{duration:v?void 0:0}}},layout:!0,transition:Cy,style:{willChange:"transform"},children:d.jsx(a.Provider,{value:u,children:n})})});_8.displayName="AnimatedOutlet";function JEe(t){const{children:e}=t;BEe(),$Ee(),QEe(),LEe(),Lye(),wEe();const n=MM(),r=iB({strict:!1}),o=n.findIndex(s=>s.id===r.id)+1,i=n[o];return d.jsx(Pn,{mode:"popLayout",children:d.jsx(_8,{children:e},i==null?void 0:i.id)})}function OP(t,e,n,r){const o=["/talk","/pages","/chats","/daily","/podcasts","/discover","/"],i=r&&t.startsWith("/chats")&&(e==null?void 0:e.startsWith("/chats")),s=t.startsWith("/pages")||t.startsWith("/chats")&&(e==null?void 0:e.startsWith("/pages")),a=t.endsWith("/talk")||(e==null?void 0:e.endsWith("/talk")),c=t.startsWith("/memory")||(e==null?void 0:e.startsWith("/memory")),u=s===!0||i===!0||a===!0||c===!0?1:.75,h=s===!0||i===!0||c===!0?1:1.5,p=o.findIndex(f=>f==="/talk"?t.endsWith(f):t.startsWith(f))<o.findIndex(f=>f==="/talk"?e==null?void 0:e.endsWith(f):e==null?void 0:e.startsWith(f));return n==="enter"?p?u:h:p?h:u}function ZEe(t,e,n){return!(t.startsWith("/chats")&&(e!=null&&e.startsWith("/chats"))&&n)}const XEe=m.lazy(()=>H(()=>Promise.resolve().then(()=>ww),void 0)),eIe=m.lazy(()=>H(()=>import("./settings-wrapper-CbHEKPR7.js"),__vite__mapDeps([296,1,2,294]))),tIe=m.lazy(()=>H(()=>import("./media-viewer-BmhEDv3R.js"),__vite__mapDeps([297,1,2,298,299,300])).then(t=>({default:t.MediaViewer}))),nIe=m.lazy(()=>H(()=>import("./picture-in-picture-22eL3ANe.js"),__vite__mapDeps([301,1,2,271,272,302,303,304,305,306])).then(t=>({default:t.PictureInPicture}))),rIe=m.lazy(()=>H(()=>import("./composer-large-screen-D6QYra2T.js"),__vite__mapDeps([307,1,2,308,309])));function oIe(t){const{children:e,sidebar:n,customLayout:r}=t,o=Ft(),{isMediaViewerOpen:i}=Na(),{isPictureInPictureOpen:s}=Bj(),a=yo(),c=_fe(),u=wfe(),h=be.instance().config().appLayout,p=Afe({showSettings:h.showSettings,showSettingsRelyOnChatDetailLayout:h.showSettingsRelyOnChatDetailLayout}),f=L(fs),g=(f==null?void 0:f.type)==="card";return d.jsxs(d.Fragment,{children:[d.jsx(EEe,{sidebar:n,children:r?e:d.jsxs(IEe,{className:"flex-1",children:[d.jsx(W1e,{}),d.jsx(JEe,{children:e}),i&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"pointer-events-auto absolute inset-0 flex items-center justify-center",children:d.jsx(XEe,{type:"spinnerThemed",className:"size-12"})}),children:d.jsx(tIe,{})}),s&&d.jsx(m.Suspense,{fallback:d.jsx(Ofe,{}),children:d.jsx(nIe,{})}),c&&d.jsx(j1e,{}),u&&d.jsx(m.Suspense,{fallback:null,children:d.jsx(rIe,{})}),p&&d.jsx(m.Suspense,{fallback:null,children:d.jsx(eIe,{className:q("top-6",a&&"-me-1 -mt-3")})})]})}),h.showMobileCrossSelling&&o.startsWith("/chats")&&!o.endsWith("/talk")&&d.jsx(z1e,{}),g&&d.jsx(B1e,{}),h.showCookieBanner&&d.jsx(F1e,{}),d.jsx(Y1e,{}),d.jsx(kve,{}),d.jsx("div",{id:"inAppFeedbackOcv"}),d.jsx("div",{id:"popoverPortal"}),d.jsx($1e,{})]})}function iIe(){const{t}=Oe(),e=L(fL);let n="main";Sn(Y0)&&e==="permanent"&&(n="confirm-submission");const[r,o]=m.useState(n),[i,s]=m.useState(""),[a,c]=m.useState(!1),u=!i||i.trim().length===0||a,h=async()=>{if(!u){Tn({source:"submitBanAppeal"}),c(!0);try{await Wr({path:"/user/bans/appeal",args:{body:{appealText:`APPEAL: ${i}`}}}),o("confirm-submission"),ar(Y0,new Date().toISOString())}catch(p){z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitBanAppeal",eventInfo_errorMessage:`${p}`,eventInfo_details:"Error submitting ban appeal"}})}c(!1)}};return d.jsxs("main",{className:"relative size-full",children:[d.jsx(fl,{forceGradient:!0}),d.jsxs(Fn,{id:r,className:"relative z-10 m-auto flex h-dvh max-w-[540px] flex-col items-center justify-center gap-3 p-12 text-center",children:[r==="main"&&d.jsxs(d.Fragment,{children:[d.jsx("h1",{className:"text-3xl",children:e==="permanent"?t("composer.userBan.permanent"):t("composer.userBan.temporary",{duration:t(e==="1-hr"?"composer.userBan.duration1Hr":"composer.userBan.duration24Hr")})}),d.jsx("p",{children:t(e==="permanent"?"composer.userBan.banMessagePermanent":"composer.userBan.banMessageTemporary")}),e==="permanent"&&d.jsx(Me,{color:"strong",size:"56-xl",className:"mt-6 w-full",title:t("composer.userBan.submitAppeal"),onClick:()=>o("submit-appeal"),children:t("composer.userBan.submitAppeal")})]}),r==="submit-appeal"&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex w-full items-center pb-4",children:[d.jsx(Me,{variant:"square",color:"subtle-dimmed-inverted",size:"32-xs",title:t("common.backText"),onClick:()=>o("main"),children:d.jsx(wp,{className:"size-5 -rotate-90"})}),d.jsx("h2",{className:"grow pe-8",children:t("composer.userBan.submitAppeal")})]}),d.jsx("textarea",{className:"h-[240px] w-full resize-none rounded-xl bg-background-100 p-4 placeholder:text-foreground-650 contrast-more:border-2 dark:text-white",onChange:p=>s(p.target.value),disabled:a,placeholder:t("composer.userBan.submitAppealPlaceholder")}),d.jsx(Me,{color:"strong",className:"w-full",size:"56-xl",title:t("common.submitText"),onClick:h,disabled:u,children:t("common.submitText")})]}),r==="confirm-submission"&&d.jsxs(d.Fragment,{children:[d.jsx("h1",{className:"text-3xl",children:t("composer.userBan.appealSubmitted")}),d.jsx("p",{children:t("composer.userBan.appealSubmittedDescription")}),d.jsx(hd,{msg:`${t("composer.userBan.appealSubmitted")}, ${t("composer.userBan.appealSubmittedDescription")}`})]})]})]})}const sIe=.05,aIe=.1;function cIe(){return be.instance().config().sentryDsnOverride??"https://323dd84fb4f632ccd95493debe9312e0@o4508134825000960.ingest.us.sentry.io/4508799962644480"}async function lIe(){const t=await H(()=>import("./vendor-BoLDEgyJ.js").then(o=>o.ai),__vite__mapDeps([1,2]));if(zi("kill-sentry"))return;const n=[t.browserTracingIntegration(),t.tanstackRouterBrowserTracingIntegration(El)],r=[];t.init({dsn:cIe(),release:GV(),sampleRate:aIe,environment:"production",integrations:[...n,...r],tracesSampleRate:sIe,profilesSampleRate:0}),t.setTag("surface","cmc")}function uIe(t){const e=L(Or);m.useEffect(()=>{z.ensureInitialized(),t&&(window.appEnd=performance.now(),performance.mark("startupTime-begin",{startTime:window.appStart}),performance.mark("startupTime-end",{startTime:window.appEnd}),performance.measure("startupTime","startupTime-begin","startupTime-end"),lIe().catch(console.error))},[t]),m.useEffect(()=>{t&&e&&setTimeout(()=>{mu("onPageLoad")},1e3)},[t,e])}function dIe(t){m.useEffect(()=>(document.addEventListener("visibilitychange",t),()=>{document.removeEventListener("visibilitychange",t)}),[t])}function hIe(){dIe(()=>{document.visibilityState==="visible"?z.trackEvent({name:"system",data:{eventName:"copilotVisible",eventInfo_landingPage:z.getLandingPage()}}):z.trackEvent({name:"system",data:{eventName:"copilotBackground"}})})}const jNe={Pageseditor:"pageseditor-supported-features"},w8=l.discriminatedUnion("eventName",[l.object({eventName:l.literal("auth0.accountAdded")}),l.object({eventName:l.literal("auth0.accountRemoved")})]);function A8(){return Bo(Z0,l.boolean().nullable())===!0}function fIe(){return Bo(NO,l.boolean().nullable())===!0}function pIe(){return Bo(Tg,l.boolean().nullable())===!0}function mIe(){return El.state.location.pathname==="/login"}function k8(t){for(const e of t)if(e.tenantId===Eg)return e;return t[0]}function hf(t){return Xo(t)?"AAD":"MSA"}function gIe(){const[t,e]=m.useState(!1),n=Ee(An),r=Ee(Zo),o=L(WL);return m.useEffect(()=>{if(t||A8())return;function s(c){var u;if(c===null){n(null),z.setUserAccountType(void 0);return}n({id:((u=c.idTokenClaims)==null?void 0:u.oid)??"",tenantId:c.tenantId,provider:"microsoft",accountType:hf(c.tenantId)}),z.setUserAccountType(hf(c.tenantId))}async function a(){try{const{msal:c}=await hr.get();z.trackEvent({name:"system",data:{eventName:"copilotMsalInit",eventInfo_initTrigger:"hook",eventInfo_timing:performance.now()-window.appStart}}),e(!0);const{monitorAccountChangesAcrossTabs:u,enableAuth0:h}=be.instance().config();u&&c.enableAccountStorageEvents(),c.addEventCallback(async p=>{if(cj(p),(p.eventType===ae.LOGIN_SUCCESS||p.eventType===ae.ACQUIRE_TOKEN_SUCCESS)&&p.payload&&"account"in p.payload&&p.payload.account){const{account:f}=p.payload,g=c.getActiveAccount();(!g||g.homeAccountId!==f.homeAccountId)&&(c.setActiveAccount(f),s(f))}else if(p.eventType===ae.LOGOUT_SUCCESS){const f=k8(c.getAllAccounts());c.setActiveAccount(f??null),s(f??null)}else p.eventType===ae.ACCOUNT_ADDED?r({reason:"login"}):p.eventType===ae.ACCOUNT_REMOVED&&r({reason:"logout"})}),h&&u&&Kh.addEventListener("message",p=>{const f=w8.safeParse(p.data);if(!f.success)return;const{eventName:g}=f.data;g==="auth0.accountAdded"?r({reason:"login"}):g==="auth0.accountRemoved"&&r({reason:"logout"})})}catch(c){z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"MsalInitError",eventInfo_details:"hook",eventInfo_errorMessage:c instanceof Error?c.message:""}})}}a().catch(console.error)},[t,r,n]),o===!0?o:t}async function vIe(){const t=st();async function e(){return await ks.instance().getAccountFromProviders()!==null}function n(){return fIe()?!pIe():!1}function r(i){var s;if(i===null){t.set(An,null),z.setUserAccountType(void 0);return}t.set(An,{id:((s=i.idTokenClaims)==null?void 0:s.oid)??"",tenantId:i.tenantId,provider:"microsoft",accountType:hf(i.tenantId)}),z.setUserAccountType(hf(i.tenantId))}async function o(){try{be.instance().config().enableAuth0&&await wo.get();const{msal:i}=await hr.get();z.trackEvent({name:"system",data:{eventName:"copilotMsalInit",eventInfo_initTrigger:"DCL",eventInfo_timing:performance.now()-window.appStart}});const s=LX();i.addEventCallback(async p=>{if(cj(p),s){p.eventType===ae.ACCOUNT_ADDED?t.set(Zo,{reason:"login"}):p.eventType===ae.ACCOUNT_REMOVED&&t.set(Zo,{reason:"logout"});return}if((p.eventType===ae.LOGIN_SUCCESS||p.eventType===ae.ACQUIRE_TOKEN_SUCCESS)&&p.payload&&"account"in p.payload&&p.payload.account){const{account:f}=p.payload,g=i.getActiveAccount();(!g||g.homeAccountId!==f.homeAccountId)&&(ca({authWorkflowAccountType:"microsoft",apiName:"msal:differentAccountLogin",extraInfo:{eventInfo_currentAccountId:g==null?void 0:g.homeAccountId,eventInfo_newAccountId:f.homeAccountId,eventInfo_eventType:p.eventType}}),i.setActiveAccount(f),r(f))}else if(p.eventType===ae.LOGOUT_SUCCESS){const f=k8(i.getAllAccounts());i.setActiveAccount(f??null),r(f??null)}else p.eventType===ae.ACCOUNT_ADDED?t.set(Zo,{reason:"login"}):p.eventType===ae.ACCOUNT_REMOVED&&t.set(Zo,{reason:"logout"})});let a=!1;if(b1()){const p=ks.instance();await p.initAuthAccount(),a=!!await p.getAccountFromProviders()}else a=await e();t.set(WL,!0);const{monitorAccountChangesAcrossTabs:u,enableAuth0:h}=be.instance().config();if(u&&i.enableAccountStorageEvents(),!a&&n()){const p=performance.now();try{const f=await i.ssoSilent(Rz),g=performance.now()-p,v=hf(f.account.tenantId)==="MSA";v||qS({message:"SSO Silent returned an AAD account",errorCode:"unexpected_account_type"}),ei(Tg,l.boolean(),!0),mIe()&&qS({message:"User is on login page, skipping account update",errorCode:"sso_on_login_page"}),v?(i.setActiveAccount(f.account),r(f.account),Ile({accountUpdate:!0,accountType:"MSA",message:"Account set by MSAL silent SSO",duration:g}),Mt.emit("auth:account-set-by-msal-sso")):await i.logoutRedirect({account:f.account,onRedirectNavigate:()=>!1})}catch(f){qS({message:f instanceof Error?f.message:"Unknown error",errorCode:f instanceof _t?f.errorCode:""})}}h&&u&&Kh.addEventListener("message",p=>{const f=w8.safeParse(p.data);if(!f.success)return;const{eventName:g}=f.data;g==="auth0.accountAdded"?t.set(Zo,{reason:"login"}):g==="auth0.accountRemoved"&&t.set(Zo,{reason:"logout"})})}catch(i){z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"MsalInitError",eventInfo_details:"DCL",eventInfo_errorMessage:i instanceof Error?i.message:""}})}}return o()}function bIe(){const t=a$(),e=Ee(up);t&&(r=>U$.includes(r))(t)&&e(t)}function yIe(){const t=L(An),e=le("account-change-chat-reset");m.useEffect(()=>{e&&Tw()},[t,e])}function CIe(){const t=Fo("kill-clarity");UU({onStartComplete:()=>{e()}});const e=()=>{try{if(t)return()=>{};window.clarity||(window.clarity=function(...o){window.clarity&&(window.clarity.q=window.clarity.q??[]).push(o)});const n=document.createElement("script");return n.type="text/javascript",n.async=!0,n.src="/cl/tag/n59ae4ieqq",document.body.appendChild(n),window.clarity("signal",async r=>{if(r.type==="cl_dtrs"&&r.value){const{sendChallengeResponse:o}=await es();o({method:"clarity",token:r.value})}}),window.clarity("metadata",()=>{AE({surface:"cmc"});const r=Ge(mL);r!==null&&AE({isNewUser:r.toString()})},!1,!0),()=>{delete window.clarity,n.remove()}}catch(n){return z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"useClarity",eventInfo_details:"Error loading Clarity",eventInfo_errorMessage:`${n}`}}),()=>{}}}}function I0(t){if(be.instance().config().persistThemeChoice){const n=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";t!==n?ar(_g,t):$r(_g)}document.documentElement.setAttribute("data-theme",t),Mt.emit("theme:color-applied",t)}function SIe(){const{persistThemeChoice:t,enforceTheme:e}=be.instance().config(),[n,r]=it(Ns);m.useEffect(()=>{const o=window.matchMedia("(prefers-color-scheme: dark)"),i=a=>{const c=a.matches?"dark":"light";r(c),I0(c),t&&$r(_g)};let s=t?Sn(_g):"";return s!=="dark"&&s!=="light"&&(s=o.matches?"dark":"light"),e&&(s=e),r(s),I0(s),o.addEventListener("change",i),()=>{o.removeEventListener("change",i)}},[r,t,e]),m.useEffect(()=>{n&&I0(n)},[n])}function EIe(){m.useEffect(()=>{if(window.ReportingObserver===void 0)return()=>{};const t=new ReportingObserver(e=>{for(const n of e){if(n.type!=="csp-violation"||!n.body)continue;const{body:r}=n,{blockedURL:o,documentURL:i,effectiveDirective:s,disposition:a}=r;console.error("Reporting CSP violation",{blockedURL:o,documentURL:i,effectiveDirective:s,disposition:a}),z.trackEvent({name:"system",data:{eventName:"copilotCSPViolation",eventInfo_blockedURL:o,eventInfo_documentURL:i,eventInfo_effectiveDirective:s,eventInfo_disposition:a}})}},{buffered:!0,types:["csp-violation"]});return t.observe(),()=>{t.disconnect()}},[])}function IIe(){const t=le("custom-1ds"),e=L(Or);m.useEffect(()=>{if(!t||!be.instance().config().enableCustom1DS)return wO(),()=>{};if(!e)return()=>{};const n=()=>{if(window.oneDS){const{ApplicationInsights:i}=window.oneDS;return new i}},r=()=>{var c;window.OneDsAzureAnalytics=window.OneDsAzureAnalytics??n();function i(){var h;return!!!((h=window.OneDsAzureAnalytics)!=null&&h.getCookieMgr().get("MSCC"))}const s={adobe:i(),google:i()},a={instrumentationKey:"c72e6b24df604532a6282edd268b4ba4-9cdee1fe-5d2f-4626-9620-dbad9b53a8e5-8065",channelConfiguration:{eventsLimitInMem:50,autoFlushEventsLimit:1},propertyConfiguration:{userConsentCookieName:pb.name,gpcDataSharingOptIn:TO(),callback:{userConsentDetails:()=>{if(!db.includes(e))return{Required:!0,Analytics:!0,SocialMedia:!0,Advertising:!0};const u=bd();return{Required:Object.values(u).includes(!0),Analytics:u.analytics,SocialMedia:u.socialMedia,Advertising:u.advertising}}}},webAnalyticsConfiguration:{coreData:{appId:"JS:Copilot_microsoft_com"},cookiesToCollect:["_mkto_trk"],urlCollectQuery:!0,syncMuid:i()},extensionConfig:{IdSyncPlugin:s}};window.postConsAzure1DSInit||((c=window.OneDsAzureAnalytics)==null||c.initialize(a,[]),window.postConsAzure1DSInit=!0)},o=document.createElement("script");return o.src="https://az416426.vo.msecnd.net/scripts/c/ms.analytics-web-4.min.js",o.async=!0,o.onload=r,document.head.appendChild(o),()=>{document.head.removeChild(o)}},[t,e])}function TIe(t){const{handler:e}=Vj({deferred:!0}),{handler:n}=p9({deferred:!0}),{passthroughType:r,prompt:o}=m9(),i=m.useCallback(c=>{z.setLandingPage("chatWithPartialPromptPassthrough"),e(c)},[e]),s=m.useCallback(c=>{z.setLandingPage("chatWithFullPromptPassthrough"),n(c)},[n]),a=m.useCallback(()=>{if(o&&r)switch(r){case"partial":i(o);break;case"full":s(o);break}},[s,i,r,o]);m.useEffect(()=>{t&&a()},[t,a])}function _Ie(){const t=Ft(),e=m.useRef(!1),n=L(gr),[r,o]=it(Qu),i=RT();m.useEffect(()=>{t.startsWith("/chats")&&yn("appearance-talk")==="1"&&(e.current=!0)},[t]),m.useEffect(()=>{i&&n&&e.current&&(e.current=!1,o(XI))},[n,e,r,o,i])}function wIe(){const t=L(pt),e=L(sL),n=le("adsidsync"),r=L(Or),o=Lr(),i=_w(r),s=L(ZI),a=Fd();m.useEffect(()=>{const{adsEnabled:c,enforceAdsOptOutOfPersonalization:u}=be.instance().config(),h=c&&!a;if(t&&e&&n){const p=FI(),g=bd().advertising;if(z.trackEvent({name:"system",data:{eventName:"copilotAdsSignal",eventInfo_scenario:"syncAdvertisingId",eventInfo_conversationId:t,eventInfo_additionalData:JSON.stringify({isAdsEnabled:h,isAdPersonalizationEnabled:g,isAuthenticated:o,isGdprPlusRegion:i,isChoiceCookieEmpty:!p})}}),!h)return;const v=new URLSearchParams;if(v.append("cpid",e),v.append("cvid",t),o&&v.append("cp","1"),p){if(i&&!g)return;g&&!u?v.append("ps","1"):v.append("ps","0")}else{if(i)return;v.append("ps","1")}const y=`https://c.bing.com/cp?${v}`,b=performance.now();fetch(y,{method:"GET",mode:"no-cors",credentials:"include"}).then(C=>{const S=performance.now();tD(y,"GET",S-b,C.clone())}).catch(C=>{z.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"adsError",eventInfo_errorMessage:"Ads Id Sync failed with error",eventInfo_details:`Ads Id Sync failed: ${C}`}})})}},[s,t,r,i,n,e,o,a])}function AIe(t){const e=L(An),n=L(Ib),r=L(wb),o=L(wd),i=L(_b),{upsellFromAuth0:s}=be.instance().config().proSubscription,{handleProSubscription:a}=Gv({payflowEntryPoint:"RedirectFromAuth0Account",skuType:i?"FreeTrial":"1Mo-Paid",upsellReason:"",entryStyle:"Redirect"}),u=Lr()&&(e==null?void 0:e.provider)==="microsoft",h=le("cmc-m365-sku"),p=ci("pff"),f=QV("needsStartSubscription"),g=Ft(),v=m.useRef(!1);m.useEffect(()=>{if(f&&h&&u&&!g.startsWith("/subscription/start")&&(p==="WinNative"||p==="EdgeSidepane")){_O("needsStartSubscription"),setTimeout(()=>{a()},0);return}if(!(s!=null&&s.navigateToProSubPageAfterLogin))return;const y=sessionStorage.getItem(D0);if(!y)return;async function b(C){const[,S]=C.split("-");if(S==="link"){const E=performance.now(),{getAuth0AccessToken:I,auth0:T}=await wo.get(),_=await I(gf);if(!_){xr({feature:"accountLinkAuth0WithMSA",errorType:"LinkStartedWithoutAuth0Token"});return}try{await Wr({path:"/user/link",args:{body:{token:_}}})}catch(w){w instanceof Error&&xr({feature:"accountLinkAuth0WithMSA",errorType:w.name,errorMessage:w.message,exception:w.stack})}finally{T.logout({openUrl:!1}),ga({feature:"accountLinkAuth0WithMSA",duration:performance.now()-E}),o||await a()}}}if(t&&!v.current&&n){if(v.current=!0,sessionStorage.removeItem(D0),(e==null?void 0:e.accountType)!=="MSA"||r)return;b(y)}},[t,a,s,e,o,r,n,g,u,p,h,f])}function kIe(t){const e=Ee(vb);m.useEffect(()=>{if(!t)return()=>{};const n=i=>Ej(i)?(e(i.toString()),!0):!1,r=i=>{const s=i.target.closest("a");s&&s instanceof HTMLAnchorElement&&n(s.href)&&i.preventDefault()},o=window.open;return window.open=function(...s){return s.length>0&&typeof s[0]=="string"&&!n(s[0])?o.apply(window,s):null},document.addEventListener("click",r),()=>{window.open=o,document.removeEventListener("click",r)}},[t,e])}function xIe(){m.useEffect(()=>{const t=Sn(Q0),e=Date.now();t||ar(Q0,e.toString())},[])}function RIe(){m.useEffect(()=>{},[])}function NIe(t){const[e,n]=m.useState(!1),r=Pj();return m.useEffect(()=>{e||!t||r({enablePageRedirect:!0,overwriteData:!1}).then(o=>{o&&n(!0)}).catch(console.error)},[r,e,t]),m.useEffect(()=>{const o=()=>{r({enablePageRedirect:!1,overwriteData:!0,eventDriven:!0}).catch(console.error)};return Mt.on("auth:account-set-by-msal-sso",o),()=>{Mt.off("auth:account-set-by-msal-sso",o)}},[r]),{appInitialized:e}}let x8=-1;const Mp=t=>{addEventListener("pageshow",e=>{e.persisted&&(x8=e.timeStamp,t(e))},!0)},_a=(t,e,n,r)=>{let o,i;return s=>{e.value>=0&&(s||r)&&(i=e.value-(o??0),(i||o===void 0)&&(o=e.value,e.delta=i,e.rating=((a,c)=>a>c[1]?"poor":a>c[0]?"needs-improvement":"good")(e.value,n),t(e)))}},R8=t=>{requestAnimationFrame(()=>requestAnimationFrame(()=>t()))},pA=()=>{const t=performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},Dy=()=>{const t=pA();return(t==null?void 0:t.activationStart)??0},wa=(t,e=-1)=>{const n=pA();let r="navigate";return x8>=0?r="back-forward-cache":n&&(document.prerendering||Dy()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},T0=new WeakMap;function N8(t,e){return T0.get(t)||T0.set(t,new e),T0.get(t)}const jy=(t,e,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver(o=>{Promise.resolve().then(()=>{e(o.getEntries())})});return r.observe({type:t,buffered:!0,...n}),r}}catch{}},P8=t=>{let e=!1;return()=>{e||(t(),e=!0)}};let yu=-1;const LP=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,Qv=t=>{document.visibilityState==="hidden"&&yu>-1&&(yu=t.type==="visibilitychange"?t.timeStamp:0,PIe())},DP=()=>{addEventListener("visibilitychange",Qv,!0),addEventListener("prerenderingchange",Qv,!0)},PIe=()=>{removeEventListener("visibilitychange",Qv,!0),removeEventListener("prerenderingchange",Qv,!0)},M8=()=>{var t;return yu<0&&(yu=(document.prerendering||(t=globalThis.performance.getEntriesByType("visibility-state").filter(n=>n.name==="hidden")[0])==null?void 0:t.startTime)??LP(),DP(),Mp(()=>{setTimeout(()=>{yu=LP(),DP()})})),{get firstHiddenTime(){return yu}}},Uy=t=>{document.prerendering?addEventListener("prerenderingchange",()=>t(),!0):t()},jP=[1800,3e3],MIe=(t,e={})=>{Uy(()=>{const n=M8();let r,o=wa("FCP");const i=jy("paint",s=>{for(const a of s)a.name==="first-contentful-paint"&&(i.disconnect(),a.startTime<n.firstHiddenTime&&(o.value=Math.max(a.startTime-Dy(),0),o.entries.push(a),r(!0)))});i&&(r=_a(t,o,jP,e.reportAllChanges),Mp(s=>{o=wa("FCP"),r=_a(t,o,jP,e.reportAllChanges),R8(()=>{o.value=performance.now()-s.timeStamp,r(!0)})}))})};let O8=0,_0=1/0,Fm=0;const OIe=t=>{for(const e of t)e.interactionId&&(_0=Math.min(_0,e.interactionId),Fm=Math.max(Fm,e.interactionId),O8=Fm?(Fm-_0)/7+1:0)};let QE;const UP=()=>QE?O8:performance.interactionCount??0,LIe=()=>{"interactionCount"in performance||QE||(QE=jy("event",OIe,{type:"event",buffered:!0,durationThreshold:0}))};let FP=0;class DIe{constructor(){W(this,"u",[]);W(this,"l",new Map);W(this,"m");W(this,"p")}v(){FP=UP(),this.u.length=0,this.l.clear()}P(){const e=Math.min(this.u.length-1,Math.floor((UP()-FP)/50));return this.u[e]}h(e){var o,i;if((o=this.m)==null||o.call(this,e),!e.interactionId&&e.entryType!=="first-input")return;const n=this.u.at(-1);let r=this.l.get(e.interactionId);if(r||this.u.length<10||e.duration>n.T){if(r?e.duration>r.T?(r.entries=[e],r.T=e.duration):e.duration===r.T&&e.startTime===r.entries[0].startTime&&r.entries.push(e):(r={id:e.interactionId,entries:[e],T:e.duration},this.l.set(r.id,r),this.u.push(r)),this.u.sort((s,a)=>a.T-s.T),this.u.length>10){const s=this.u.splice(10);for(const a of s)this.l.delete(a.id)}(i=this.p)==null||i.call(this,r)}}}const L8=t=>{const e=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?t():(e(t=P8(t)),document.addEventListener("visibilitychange",t,{once:!0}))},BP=[200,500],jIe=(t,e={})=>{globalThis.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype&&Uy(()=>{LIe();let n,r=wa("INP");const o=N8(e,DIe),i=a=>{L8(()=>{for(const u of a)o.h(u);const c=o.P();c&&c.T!==r.value&&(r.value=c.T,r.entries=c.entries,n())})},s=jy("event",i,{durationThreshold:e.durationThreshold??40});n=_a(t,r,BP,e.reportAllChanges),s&&(s.observe({type:"first-input",buffered:!0}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&(i(s.takeRecords()),n(!0))}),Mp(()=>{o.v(),r=wa("INP"),n=_a(t,r,BP,e.reportAllChanges)}))})};let UIe=class{constructor(){W(this,"m")}h(e){var n;(n=this.m)==null||n.call(this,e)}};const HP=[2500,4e3],FIe=(t,e={})=>{Uy(()=>{const n=M8();let r,o=wa("LCP");const i=N8(e,UIe),s=c=>{e.reportAllChanges||(c=c.slice(-1));for(const u of c)i.h(u),u.startTime<n.firstHiddenTime&&(o.value=Math.max(u.startTime-Dy(),0),o.entries=[u],r())},a=jy("largest-contentful-paint",s);if(a){r=_a(t,o,HP,e.reportAllChanges);const c=P8(()=>{s(a.takeRecords()),a.disconnect(),r(!0)});for(const u of["keydown","click","visibilitychange"])addEventListener(u,()=>L8(c),{capture:!0,once:!0});Mp(u=>{o=wa("LCP"),r=_a(t,o,HP,e.reportAllChanges),R8(()=>{o.value=performance.now()-u.timeStamp,r(!0)})})}})},zP=[800,1800],JE=t=>{document.prerendering?Uy(()=>JE(t)):document.readyState!=="complete"?addEventListener("load",()=>JE(t),!0):setTimeout(t)},BIe=(t,e={})=>{let n=wa("TTFB"),r=_a(t,n,zP,e.reportAllChanges);JE(()=>{const o=pA();o&&(n.value=Math.max(o.responseStart-Dy(),0),n.entries=[o],r(!0),Mp(()=>{n=wa("TTFB",0),r=_a(t,n,zP,e.reportAllChanges),r(!0)}))})},HIe=t=>{const n=performance.getEntriesByType("navigation")[0],r=n==null?void 0:n.type;let o;const i=navigator;i.connection&&typeof i.connection.effectiveType=="string"&&(o=i.connection.effectiveType);const s={eventName:t.name,eventInfo_duration:t.value,eventInfo_navigationType:r,eventInfo_connectionType:o};z.trackEvent({name:"system",data:s});try{const a=`web-vitals-${t.name}`;performance.mark(a),performance.measure(`web-vitals-measure-${t.name}`)}catch{}};let VP=!1;function zIe(){const t=Ee(ZO);if(typeof window>"u"||VP)return;VP=!0;let e=!1;const n=o=>{HIe(o),t(i=>({...i,[o.name.toLowerCase()]:o.value}))},r=o=>{e||(e=!0,n(o))};BIe(n),MIe(n),FIe(r,{reportAllChanges:!0}),jIe(n)}function VIe(){m.useEffect(()=>(window.addEventListener("unhandledrejection",Bk),()=>{window.removeEventListener("unhandledrejection",Bk)}),[])}function $Ie(t={}){const{isAppInitialized:e=!1}=t,n=window.appStart;return m.useEffect(()=>!e||!n?()=>{}:(window.addEventListener("beforeunload",Cx),()=>{window.removeEventListener("beforeunload",Cx)}),[e,n]),{startTime:n}}function GIe(){typeof window<"u"&&(Object.defineProperty(window,"APP_VERSION",{value:jI()}),Object.defineProperty(window,"APP_SURFACE",{value:"cmc"}))}const KIe=new sB({defaultOptions:{queries:{retry:0,refetchOnWindowFocus:!1}}});function qIe({sidebar:t,customLayout:e=!1}){xIe(),gy(),bIe(),Tde(),due();const n=gIe(),{appInitialized:r}=NIe(n);wCe(),TIe(r),SIe(),VIe();const o=Y9();kIe(o);const i=L(Zo);$Ie({isAppInitialized:r}),hIe(),sfe(),IIe(),_Ie();const s=L(_f);return uIe(r),zIe(),yIe(),AIe(r),RIe(),CIe(),EIe(),wIe(),s==="user-banned"?d.jsx(iIe,{}):s==="age-verification"?d.jsx(bde,{}):s?d.jsx(yw,{}):!r||!n?null:i?d.jsx(jj,{accountActionRequired:i}):d.jsx(aB,{client:KIe,children:d.jsx(PM,{reducedMotion:"user",children:d.jsx(oIe,{sidebar:t,customLayout:e,children:d.jsx(cB,{})})})})}function WIe(t){const{sidebar:e,customLayout:n,onError:r=MO}=t;return d.jsxs(jM,{fallback:d.jsx(yw,{}),onError:r,children:[d.jsx(Xfe,{}),d.jsx(qIe,{sidebar:e,customLayout:n,onError:r})]})}GIe();document.addEventListener("DOMContentLoaded",()=>{A8()&&setTimeout(()=>vIe(),0)});function YIe(){const t=Lr(),e=L(CT),n=Ee(pL);m.useEffect(()=>{t&&!e&&qle()&&n(!0)},[t,e,n])}function QIe(){const t=Fd(),[e,n]=it(VI),r=Fw();m.useEffect(()=>{!t&&e&&n(void 0),t&&!e&&r({isPrivate:!0})},[t,e,n,r])}xj();function JIe(){YIe(),QIe();const t=le("discover-with-pane-layout"),e=le("pages-layout-v2"),n=Ft();let r=!1;return(e&&n.startsWith("/pages")||t&&n.startsWith("/discover"))&&(r=!0),d.jsx(WIe,{customLayout:r})}const ZIe=l.object({"prompt-branch":l.string().optional(),branch:l.string().optional()}),xt=lB({component:JIe,validateSearch:bB(ZIe),search:{middlewares:[uB(["prompt-branch","branch"])]}}),D8=m.lazy(()=>H(()=>import("./discover-BUTbVgmA.js").then(t=>t.d),__vite__mapDeps([310,1,2,311,312,313,314,293,315,316,317,318,319,320,321,322,323,309,324,325,326,327,239,225,272,328,329,271,275,279,241]))),XIe=wt("/")({component:()=>d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-full items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(D8,{})})}),eTe=wt("/discover")({component:()=>d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-full items-center justify-center",children:d.jsx(Rt,{className:"size-12"})}),children:d.jsx(D8,{})})}),tTe=100,$P=.3,nTe=2*Si,rTe="bottom-[60px] sm:bottom-[120px] h-[50px]",j8="min-h-[60px] sm:min-h-[120px]",U8="min-h-[calc(100dvh-60px-var(--chat-details-container-height)-var(--composer-container-height)-(2*var(--layout-offset-y)))] sm:min-h-[calc(100dvh-120px-var(--composer-container-height)-(2*var(--layout-offset-y)))]",oTe="min-h-[calc(100dvh-48px-var(--chat-details-container-height)-var(--composer-container-height)-(2*var(--layout-offset-y)))] sm:min-h-[calc(100dvh-48px-var(--composer-container-height)-(2*var(--layout-offset-y)))]",iTe="min-h-[calc(100dvh-80px-var(--chat-details-container-height)-var(--composer-container-height)-(2*var(--layout-offset-y)))] sm:min-h-[calc(100dvh-80px-var(--composer-container-height)-(2*var(--layout-offset-y)))]",sTe="bottom-[var(--character-component-height)] h-[50px]",aTe="min-h-[calc(100dvh-var(--character-component-height)-var(--composer-container-height)-(2*var(--layout-offset-y)))]";function cTe(t,e,n,r,o){const[i,s]=it(FO),a=m.useCallback(()=>{s(I=>!I)},[s]),c=yo(),u=m.useMemo(()=>({variants:{start:{opacity:0},exiting:{opacity:0,y:-100,transition:{duration:.2,y:{duration:.3}}}},initial:"start",animate:i?"exiting":"default"}),[i]),h=m.useMemo(()=>({initial:{opacity:0,y:tTe},animate:{opacity:1,y:0,transition:{duration:.4,y:{duration:$P}}},exit:{opacity:0,y:-100,transition:{duration:.2,y:{duration:$P}}},onAnimationStart:I=>{typeof I=="object"&&!Array.isArray(I)&&I.opacity===1&&(setTimeout(()=>t(),10),s(!1))}}),[t,s]),p=n?sTe:rTe,f=n?`min-h-[${r}px]`:j8,{highlighted:g,backstage:v}=uTe(o,i),y=dTe(n,v,g),b=m.useRef(null),{scrollYProgress:C}=dB({target:b,container:e,offset:["end start","start start"]}),S=zu(C,[nTe/100,1],[0,1]);return{toggleMessagesAreExiting:a,backstageMessagesProps:u,highlightedMessagesProps:h,opacity:c?S:C,sentinelRef:b,sentinelClasses:p,backstageClasses:f,highlightedClasses:y,highlighted:g,backstage:v}}function lTe(t){const e=F8(t);if(!e)return[];const n=t.at(-2),r=[];ma(n)&&r.push(n),ma(e)&&r.push(e);const o=t.at(-3);if((o==null?void 0:o.author)==="human"&&r.length===2)return[o,...r];const i=e.author==="human",s=!i&&(n==null?void 0:n.author)==="ai";return i||s?[e]:t.slice(-2)}function F8(t){return t.at(-1)}function uTe(t,e){const n=lTe(t),r=t.slice(0,-(n.length+(e?2:0)));return{highlighted:n,backstage:r}}function dTe(t,e,n){return t?aTe:be.instance().config().smallAnochorTopWithoutHeader&&n.length>0?e.length===0?iTe:oTe:U8}function B8(){return q(Gf("pageContainer")??"px-6","mx-auto w-full max-w-chat")}function hTe(){var t=new Map;function e(n){var r=n.root,o=n.rootMargin,i=n.threshold,s=t.get(r);s||(s=new Map,t.set(r,s));var a=JSON.stringify({rootMargin:o,threshold:i}),c=s.get(a);if(!c){var u=new Map,h=new IntersectionObserver(function(p){p.forEach(function(f){var g=u.get(f.target);g==null||g(f)})},{root:r,rootMargin:o,threshold:i});c={observer:h,entryCallbacks:u},s.set(a,c)}return{observe:function(f,g){var v,y;(v=c)==null||v.entryCallbacks.set(f,g),(y=c)==null||y.observer.observe(f)},unobserve:function(f){var g,v;(g=c)==null||g.entryCallbacks.delete(f),(v=c)==null||v.observer.unobserve(f)}}}return{getObserver:e}}var fTe="0px",pTe=[0],mTe=hTe();function gTe(t){var e,n,r=(e=t==null?void 0:t.rootMargin)!=null?e:fTe,o=(n=t==null?void 0:t.threshold)!=null?n:pTe,i=m.useRef(null),s=m.useRef(null),a=m.useRef(null),c=m.useState(),u=c[0],h=c[1],p=m.useCallback(function(){var y=i.current;if(!y){h(void 0);return}var b=mTe.getObserver({root:s.current,rootMargin:r,threshold:o});b.observe(y,function(C){h(C)}),a.current=b},[r,o]),f=m.useCallback(function(){var y=a.current,b=i.current;b&&(y==null||y.unobserve(b)),a.current=null},[]),g=m.useCallback(function(y){f(),i.current=y,p()},[p,f]),v=m.useCallback(function(y){f(),s.current=y,p()},[p,f]);return[g,{entry:u,rootRef:v}]}function ZE(){return ZE=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ZE.apply(this,arguments)}function vTe(t){var e,n=gTe(t),r=n[0],o=n[1],i=!!((e=o.entry)!=null&&e.isIntersecting),s=m.useState(i),a=s[0],c=s[1];return i&&!a&&c(!0),[r,ZE({},o,{isVisible:i,wasEverVisible:a})]}var bTe=100;function yTe(t){var e=t.loading,n=t.hasNextPage,r=t.onLoadMore,o=t.rootMargin,i=t.disabled,s=t.delayInMs,a=s===void 0?bTe:s,c=vTe({rootMargin:o}),u=c[0],h=c[1],p=h.rootRef,f=h.isVisible,g=!i&&!e&&f&&n;return m.useEffect(function(){if(g){var v=setTimeout(function(){r()},a);return function(){clearTimeout(v)}}},[r,g,a]),[u,{rootRef:p}]}function CTe(t){const{children:e,onClick:n,title:r,className:o,spatialNavigationAutofocus:i=!0,disabled:s=!1,testId:a,hoverVariant:c=!1}=t,[u,h]=m.useState(!1),[p,f]=m.useState(!1),g=()=>h(!0),v=()=>h(!1),y=()=>f(!0),b=()=>f(!1),C=u||p&&c?"acrylic-thin-inverted":"acrylic-thin";return d.jsx(Me,{disabled:s,variant:"pill",color:C,size:"64-xxl",testId:a,className:q("w-conversations items-center justify-center",o),onClick:n,onFocus:g,onBlur:v,onMouseEnter:y,onMouseLeave:b,title:r,spatialNavigationAutofocus:i,children:e})}async function XE(t,e,n){try{await Wr({path:`/conversations/${t}/react`,args:{body:{[n]:e},analytics:{anonymousPath:"/conversations/*/react"}}})}catch{}}async function H8(t,e,n){try{await Wr({path:`/conversations/${t}/feedback`,args:{body:{types:Array.from(e),text:n},analytics:{anonymousPath:"/conversations/*/feedback"}}})}catch{}}const z8=t=>m.createElement("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M6 2C6.4075 2 6.77654 2.16302 7.04688 2.42676L7.05273 2.4248C7.70431 2.14511 8.40698 2 9.11816 2H14.7871C15.7302 2 16.5456 2.65891 16.7432 3.58105L17.9492 9.20801C17.9832 9.36686 18 9.52895 18 9.69141C18 10.9663 16.9663 12 15.6914 12H12.1904C12.3947 12.6629 12.5 13.3526 12.5 14.0469V14.668C12.5 15.6352 12.2133 16.581 11.6768 17.3857C11.4528 17.7215 11.0952 17.9399 10.7002 17.9893L10.5293 18H10.4775C9.66177 18 9 17.3382 9 16.5225V15.1719C8.9999 13.8855 8.54907 12.6397 7.72559 11.6514L6.91895 10.6836C6.66492 10.8811 6.34669 11 6 11H3.5C2.67157 11 2 10.3284 2 9.5V3.5C2 2.67157 2.67157 2 3.5 2H6ZM9.11816 3C8.55774 3 8.0038 3.11128 7.48828 3.32617C7.49488 3.38327 7.5 3.44114 7.5 3.5V9.5C7.5 9.59759 7.48948 9.69276 7.47168 9.78516L8.49316 11.0107C9.46653 12.1788 9.9999 13.6514 10 15.1719V16.5225C10 16.7859 10.2141 17 10.4775 17H10.5293L10.6221 16.9883C10.7122 16.9655 10.7919 16.9101 10.8447 16.8311C11.2717 16.1906 11.5 15.4377 11.5 14.668V14.0469C11.5 13.4073 11.3966 12.7718 11.1943 12.165L11.0254 11.6582C11.0223 11.6489 11.0211 11.6392 11.0186 11.6299C11.0142 11.6139 11.0105 11.5977 11.0078 11.5811C11.0046 11.5614 11.0028 11.542 11.002 11.5225C11.0016 11.515 11 11.5075 11 11.5C11 11.4948 11.0008 11.4896 11.001 11.4844C11.0016 11.4643 11.0038 11.4445 11.0068 11.4248C11.0089 11.4113 11.0106 11.3979 11.0137 11.3848C11.0179 11.3671 11.0242 11.3501 11.0303 11.333C11.0355 11.3184 11.0404 11.3039 11.0469 11.29C11.0531 11.2765 11.0609 11.2639 11.0684 11.251C11.077 11.236 11.0856 11.221 11.0957 11.207C11.1052 11.1939 11.1162 11.1821 11.127 11.1699C11.1369 11.1587 11.1463 11.147 11.1572 11.1367C11.17 11.1246 11.1841 11.1143 11.1982 11.1035C11.2105 11.0942 11.2223 11.0844 11.2354 11.0762C11.2399 11.0733 11.2443 11.0701 11.249 11.0674L11.3057 11.0391C11.3117 11.0365 11.318 11.0346 11.3242 11.0322C11.3301 11.03 11.3358 11.0274 11.3418 11.0254C11.3508 11.0224 11.3601 11.021 11.3691 11.0186C11.3852 11.0142 11.4014 11.0106 11.418 11.0078C11.4376 11.0045 11.457 11.0029 11.4766 11.002C11.4844 11.0016 11.4921 11 11.5 11H15.6914C16.414 11 17 10.414 17 9.69141C17 9.59931 16.99 9.50704 16.9707 9.41699L15.7656 3.79004C15.6667 3.32914 15.2585 3 14.7871 3H9.11816ZM3.5 3C3.22386 3 3 3.22386 3 3.5V9.5C3 9.77614 3.22386 10 3.5 10H6C6.27614 10 6.5 9.77614 6.5 9.5V3.5C6.5 3.22386 6.27614 3 6 3H3.5Z",fill:"currentColor"})),FNe=Object.freeze(Object.defineProperty({__proto__:null,default:z8},Symbol.toStringTag,{value:"Module"})),V8=t=>m.createElement("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M10.7002 2.01074C11.0952 2.06005 11.4528 2.2785 11.6768 2.61426C12.2133 3.41901 12.5 4.36484 12.5 5.33203V5.95312C12.5 6.64737 12.3947 7.33709 12.1904 8H15.6914C16.9663 8 18 9.03369 18 10.3086C18 10.471 17.9832 10.6331 17.9492 10.792L16.7432 16.4189C16.5456 17.3411 15.7302 18 14.7871 18H9.11816C8.40698 18 7.70431 17.8549 7.05273 17.5752L7.04688 17.5723C6.7765 17.8363 6.40775 18 6 18H3.5C2.67157 18 2 17.3284 2 16.5V10.5C2 9.67157 2.67157 9 3.5 9H6C6.34648 9 6.665 9.11814 6.91895 9.31543L7.72559 8.34863C8.54907 7.36035 8.9999 6.11453 9 4.82812V3.47754C9 2.66177 9.66177 2 10.4775 2H10.5293L10.7002 2.01074ZM3.5 10C3.22386 10 3 10.2239 3 10.5V16.5C3 16.7761 3.22386 17 3.5 17H6C6.27614 17 6.5 16.7761 6.5 16.5V10.5C6.5 10.2239 6.27614 10 6 10H3.5ZM10.4775 3C10.2141 3 10 3.21405 10 3.47754V4.82812C9.9999 6.34856 9.46653 7.82122 8.49316 8.98926L7.47168 10.2139C7.48959 10.3066 7.5 10.4021 7.5 10.5V16.5C7.5 16.5585 7.4948 16.6161 7.48828 16.6729C8.00389 16.8878 8.55762 17 9.11816 17H14.7871C15.2585 17 15.6667 16.6709 15.7656 16.21L16.9707 10.583C16.99 10.493 17 10.4007 17 10.3086C17 9.58598 16.414 9 15.6914 9H11.5C11.4921 9 11.4844 8.99743 11.4766 8.99707C11.457 8.99614 11.4376 8.99451 11.418 8.99121C11.4013 8.98845 11.3852 8.98483 11.3691 8.98047C11.3602 8.97803 11.3507 8.97757 11.3418 8.97461C11.3357 8.97258 11.3302 8.96904 11.3242 8.9668C11.307 8.96032 11.2906 8.95259 11.2744 8.94434C11.261 8.93755 11.2479 8.93071 11.2354 8.92285C11.2217 8.91426 11.2091 8.90437 11.1963 8.89453C11.1828 8.88414 11.1695 8.87392 11.1572 8.8623C11.146 8.85165 11.1362 8.83977 11.126 8.82812C11.1156 8.81623 11.1049 8.80477 11.0957 8.79199C11.0856 8.77799 11.077 8.76309 11.0684 8.74805C11.0609 8.73511 11.0531 8.72253 11.0469 8.70898C11.0393 8.69254 11.0331 8.67555 11.0273 8.6582C11.0225 8.64364 11.0172 8.62925 11.0137 8.61426C11.0106 8.60113 11.0089 8.58772 11.0068 8.57422C11.0038 8.55451 11.0016 8.53476 11.001 8.51465C11.0008 8.50978 11 8.50491 11 8.5C11 8.49212 11.0016 8.48435 11.002 8.47656C11.0029 8.45704 11.0045 8.43757 11.0078 8.41797C11.0106 8.40136 11.0142 8.38516 11.0186 8.36914C11.021 8.36013 11.0224 8.35077 11.0254 8.3418L11.1943 7.83496C11.3966 7.22817 11.5 6.59274 11.5 5.95312V5.33203C11.5 4.56227 11.2717 3.80943 10.8447 3.16895C10.7919 3.08985 10.7122 3.03448 10.6221 3.01172L10.5293 3H10.4775Z",fill:"currentColor"})),BNe=Object.freeze(Object.defineProperty({__proto__:null,default:V8},Symbol.toStringTag,{value:"Module"}));function $8(t){const{titleText:e,subtitleText:n,positiveButtonText:r,negativeButtonText:o,positiveButtonTitle:i,negativeButtonTitle:s,modalHeaderText:a,onPositiveClick:c,onNegativeClick:u,isModalOpen:h,onModalClose:p,modalContent:f,className:g="",isDebugAudioRecorderEnabled:v=!1}=t;return d.jsxs("div",{className:g,children:[d.jsx("div",{className:"relative w-full pb-6 after:absolute after:mt-3 after:w-full after:border-b after:border-stroke-300"}),d.jsx("h2",{className:"mt-5 text-foreground-600 text-xs",children:d.jsx("strong",{children:e})}),d.jsx("p",{className:"mt-1 text-foreground-600 text-xs",children:n}),d.jsxs("div",{className:q("mt-3.5 grid w-fit min-w-72 grid-rows-1 gap-2",v?"grid-cols-3":"grid-cols-2"),children:[d.jsxs(Me,{onClick:c,title:i,variant:"rect",size:"36-sm",children:[d.jsx(V8,{className:"size-5"})," ",r]}),d.jsxs(Me,{onClick:u,title:s,variant:"rect",size:"36-sm",children:[d.jsx(z8,{className:"size-5"})," ",o]}),v&&d.jsx(Me,{onClick:async()=>{const{AUDIO_RECORDER:y}=await H(async()=>{const{AUDIO_RECORDER:b}=await import("./audio-recorder-DAnrddnT.js");return{AUDIO_RECORDER:b}},__vite__mapDeps([330,1,2]));await y.download()},title:"Download audio debug",variant:"rect",size:"36-sm",children:"Download audio debug"})]}),h&&d.jsx(zd,{isOpen:!0,onClose:p,headerText:a,className:"w-full max-w-[400px]",children:f})]})}function STe(){}function ETe({inputValue:t,handleChange:e}){const[n,r]=m.useState(""),{t:o}=Oe();return Fo("kill-free-form-text")?null:d.jsx(rA,{disabled:!1,className:"max-h-[8rem] grow-0 basis-[8rem] !items-start overflow-auto rounded-xl border-2 border-stone-700 bg-black/5 px-0.5",inputValue:t,characterLimit:zV,autoFocus:!1,setInput:s=>{e(s)},placeholder:o("chat.feedback.placeholder"),errorMessage:n,setError:r,onEnter:STe,isMultiLines:!0})}function G8(t){const{feedbackOptions:e,onSubmit:n}=t,{t:r}=Oe(),[o,i]=m.useState(new Set),[s,a]=m.useState(""),c=o.size===0,u=p=>{i(f=>{const g=new Set(f);return o.has(p)?g.delete(p):g.add(p),g})},h=async()=>{n(o,s),i(new Set)};return e?d.jsxs("div",{className:"flex flex-col gap-2 pt-2",children:[d.jsx("ul",{role:"list",className:"mt-0 flex list-none flex-col gap-2",children:e.map(p=>d.jsx("li",{children:d.jsx(q9,{label:p.label,setChecked:()=>u(p.type),checked:o.has(p.type)})},p.type))}),c?null:d.jsx(ETe,{inputValue:s,handleChange:a}),d.jsx(Me,{title:r("chat.feedback.submitFeedbackButton"),size:"48-lg",color:"strong",className:"mt-4 max-h-12",disabled:c,onClick:h,children:r("chat.feedback.submitFeedbackButton")})]}):null}function ITe(t){var C,S;const{className:e}=t,n=L(qI),[r,o]=it(bb),[i,s]=m.useState(!1),[a,c]=m.useState(),u=le("ads-showroom-picasso-feedback"),{t:h}=Oe(),p=E=>{Tn({source:"feedback",scenario:k$[E],conversationId:r==null?void 0:r.conversationId,additionalData:{brandId:r==null?void 0:r.brandId,brandName:(r==null?void 0:r.brandName)??""}})},f=()=>{s(!1),o(void 0)},g=async E=>{r!=null&&r.conversationId&&u&&await XE(r.conversationId,E,"showroomReaction")},v=()=>{var E;p("thumbs-up"),c("thumbs-up"),(E=n==null?void 0:n.showroom)!=null&&E.positive?s(!0):f(),g("thumbs-up")},y=()=>{var E;p("thumbs-down"),c("thumbs-down"),(E=n==null?void 0:n.showroom)!=null&&E.negative?s(!0):f(),g("thumbs-down")},b=async(E,I)=>{f(),r&&z.trackEvent({name:"interaction",data:{eventName:"copilotSubmitFineConversationFeedback",eventInfo_fineFeedbackTypes:Array.from(E).join(","),eventInfo_conversationId:r.conversationId,eventInfo_additionalData:JSON.stringify({brandId:r.brandId,brandName:r.brandName,reactionType:a})}}),r!=null&&r.conversationId&&E.size>0&&H8(r.conversationId,E,I)};return d.jsx($8,{titleText:h("ads.showroomFeedbackTitle",{brand:r==null?void 0:r.brandName}),subtitleText:h("ads.showroomFeedbackDescription"),positiveButtonText:h("ads.showroomFeedbackPositive"),negativeButtonText:h("ads.showroomFeedbackNegative"),positiveButtonTitle:h("reviewPrompt.positive"),negativeButtonTitle:h("reviewPrompt.negative"),modalHeaderText:h("ads.showroomFeedbackModalTitle"),onPositiveClick:v,onNegativeClick:y,isModalOpen:i,onModalClose:f,modalContent:d.jsx(G8,{onSubmit:b,feedbackOptions:a==="thumbs-up"?((C=n==null?void 0:n.showroom)==null?void 0:C.positive)??void 0:(S=n==null?void 0:n.showroom)==null?void 0:S.negative}),className:e,isDebugAudioRecorderEnabled:!1})}function TTe(t){const{onSubmit:e}=t,{t:n}=Oe(),[r,o]=m.useState(!1),i=async s=>{o(!0),await e(s),o(!1)};return d.jsxs("div",{children:[d.jsx("p",{children:n("voice.feedback.reviewReason")}),d.jsx(Me,{title:n("voice.feedback.okay"),size:"48-lg",color:"strong",className:"mt-4 max-h-12 w-full",disabled:r,onClick:()=>i(!0),children:n("voice.feedback.okay")}),d.jsx(Me,{title:n("voice.feedback.noThanks"),size:"48-lg",color:"default",className:"mt-3 w-full",onClick:()=>i(!1),children:n("voice.feedback.noThanks")})]})}function _Te({className:t}){const e=L(pt),n=L(qI),r=Ee(Cd),[o,i]=it(yT),[s,a]=m.useState(),c=le("debug-audio-recorder")&&!1,u=gX(),{t:h}=Oe(),p=()=>{Tn({source:"voiceFeedback",scenario:"thumbsUp",conversationId:e,destination:u?"appearance":void 0}),e&&XE(e,"thumbs-up","audioReaction"),r(!1),Mt.emit("feedback:ai-message-reaction","positive")},f=()=>{Tn({source:"voiceFeedback",scenario:"thumbsDown",conversationId:e,destination:u?"appearance":void 0}),e&&XE(e,"thumbs-down","audioReaction"),a("feedback-options")},g=()=>{a(null),r(!1)},v=async(C,S)=>{e&&C.size>0&&H8(e,C,S),o?g():a("review-request")},y=async C=>{C&&(i(!0),await Fhe({optInToVoiceTraining:!0})),g()},b=()=>s==="feedback-options"?d.jsx(G8,{onSubmit:v,feedbackOptions:u?n==null?void 0:n.appearance:n==null?void 0:n.call}):s==="review-request"?d.jsx(TTe,{onSubmit:y}):null;return d.jsx($8,{titleText:h(u?"voice.feedback.howWasAppearanceChat":"voice.feedback.howWasVoiceChat"),subtitleText:h("voice.feedback.giveFeedback"),positiveButtonText:h("voice.feedback.good"),negativeButtonText:h("voice.feedback.bad"),positiveButtonTitle:h("reviewPrompt.positive"),negativeButtonTitle:h("reviewPrompt.negative"),modalHeaderText:h(s==="feedback-options"?"voice.feedback.chooseWhatHappened":"voice.feedback.canMicrosoftReview"),onPositiveClick:p,onNegativeClick:f,isModalOpen:!!s,onModalClose:g,modalContent:b(),className:t,isDebugAudioRecorderEnabled:c})}const wTe=m.lazy(()=>H(()=>import("./index.es-BjL6LrIc.js"),__vite__mapDeps([219,2,1]))),ATe=v9();function kTe({onAnimationClicked:t}){const e=m.useRef(null),{t:n}=Oe(),[r,o]=m.useState(null);m.useEffect(()=>{ATe.load("../../assets/lottie/character-thinking-cloud-animation.json").then(o).catch(()=>o(null))},[]),m.useEffect(()=>{const a=e.current;return a&&r&&a.playSegments([0,67],!0),()=>{a&&r&&a.playSegments([350,370],!0)}},[r]);const i=()=>{var c,u;(c=e.current)==null||c.playSegments([320,345],!0),(u=e.current)==null||u.pause(),t();const a=document.getElementById(nA);a==null||a.focus()},s=a=>{a.key==="Enter"&&i()};return d.jsx("div",{children:d.jsx(m.Suspense,{fallback:d.jsx("div",{}),children:d.jsx(wTe,{lottieRef:e,role:"button",tabIndex:0,"aria-label":n("characterAnimation.characterThinkingCloudAriaLabelText"),title:n("characterAnimation.characterThinkingCloudAriaLabelText"),animationData:r,loop:!1,onMouseDown:i,onMouseEnter:()=>{var a;return(a=e.current)==null?void 0:a.playSegments([275,295],!0)},onMouseLeave:()=>{var a;return(a=e.current)==null?void 0:a.playSegments([296,315],!0)},onKeyDown:s,onComplete:()=>{var a;return(a=e.current)==null?void 0:a.playSegments([68,274],!0)}})})})}const GP=1,xTe=m.lazy(()=>H(()=>import("./character-DZ-LFNRh.js"),__vite__mapDeps([229,1,2,230])).then(t=>({default:t.Character})));function RTe({animatingMessageId:t,isStreamingMessage:e,displayedCharacterId:n,setCharacterComponentHeight:r}){const o=le("characterspeech"),[i,s]=m.useState(0),[a,c]=m.useState(!1),[u,h]=it(fc),p=L(Zi),f=()=>{s(0),c(!1)};m.useEffect(()=>{let y;return o&&u==="idle"&&(y=setInterval(()=>{s(b=>b<GP?b+1:b),p.length>0&&i===GP&&!e&&(c(!0),z.trackEvent({name:"system",data:{eventName:"characterTalkToMeDisplayed",eventInfo_conversationId:Ge(pt),eventInfo_characterId:n}}))},1e3)),()=>clearInterval(y)},[u,n,p.length,o,i,e]),m.useEffect(()=>{o&&u!=="idle"&&u!=="hovering"&&f()},[u,o]);const g=async()=>{f(),h("responding"),await ps.submitMessage({command:{type:"promptCharacterSpeech"},inputMethod:"promptCharacterSpeech"}),z.trackEvent({name:"interaction",data:{eventName:"characterTalkToMeClicked",eventInfo_conversationId:Ge(pt),eventInfo_characterId:n}})};function v(){switch(n){case"aqua":return"translate-x-9";case"mica":return"translate-x-14";case"erin":return"translate-x-16";default:throw new Error("Invalid characterId provided to getTranslateXClass")}}return d.jsx(jM,{fallback:d.jsx(yw,{}),onError:B$(t,n),children:d.jsxs("div",{"data-testid":"character-div",className:q("sticky top-0 h-2/5 min-h-[40vh] w-full bg-gradient-chat-light-character dark:bg-midnight-850 dark:bg-none",Xt.babylonCharacter),style:{maskImage:"linear-gradient(to bottom, #000 95%, transparent 100%)"},children:[d.jsx(Pn,{children:a&&d.jsx(Re.div,{className:q("absolute start-1/2 top-12 size-36",v()),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:1},children:d.jsx(kTe,{onAnimationClicked:g})})}),d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-full items-center justify-center",children:d.jsx(Rt,{type:"spinnerThemed",className:"size-12"})}),children:d.jsx(xTe,{characterId:n,setCharacterComponentHeight:r})})]})})}function NTe({className:t}){const{t:e}=Oe();return d.jsxs("div",{className:nt("flex items-center gap-2",t),children:[d.jsx(Rt,{type:"reasoning",className:"size-11"}),d.jsxs("div",{className:"flex flex-col text-sm",children:[d.jsx("span",{children:e("chat.reasoningLoading.title")}),d.jsx("span",{className:"text-foreground-450 dark:text-foreground-600",children:e("chat.reasoningLoading.description")})]})]})}function K8(t){const{isActive:e,animationDuration:n="5s",children:r,className:o,...i}=t;return d.jsx("div",{className:nt(e&&"bg-gradient-to-l from-foreground-800 via-foreground-300 to-foreground-800 bg-[size:200%_100%] bg-clip-text text-transparent",o),style:{...e&&{animation:`shimmer-reverse ${n} linear infinite 0.5s`}},...i,children:r})}const q8=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",...t},m.createElement("path",{fill:"currentColor",d:"M12 1.999C17.523 1.999 22 6.477 22 12.001c0 5.523-4.478 10.001-10.001 10.001-5.524 0-10.002-4.478-10.002-10.001C1.998 6.477 6.476 1.998 12 1.998Zm0 1.5a8.502 8.502 0 1 0 0 17.003A8.502 8.502 0 0 0 12 3.5Zm-.004 7a.75.75 0 0 1 .743.648l.007.102.004 5.502a.75.75 0 0 1-1.493.102l-.007-.101-.004-5.502a.75.75 0 0 1 .75-.75ZM12 7.002a.999.999 0 1 1 0 1.997.999.999 0 0 1 0-1.997Z",opacity:.8})),HNe=Object.freeze(Object.defineProperty({__proto__:null,default:q8},Symbol.toStringTag,{value:"Module"}));function PTe(t){const{status:e}=t;let n=d.jsx("div",{className:"size-5 pe-1","aria-hidden":"true"});switch(e){case"running":n=d.jsx(Rt,{className:"size-5"});break;case"failed":n=d.jsx(q8,{className:"size-5"});break;case"completed":n=d.jsx(Bw,{className:"size-5"});break}return d.jsx("div",{className:"ps-0.5",children:n})}function MTe(t){const{activity:e}=t,{steps:n,status:r,title:o}=e;return d.jsxs("div",{className:"flex flex-col gap-3",children:[d.jsx("div",{className:"flex items-center gap-2",children:d.jsx(K8,{className:"text-base",isActive:r==="running",children:o})}),n.map((i,s)=>d.jsxs("div",{className:"flex flex-row gap-2 text-sm",children:[d.jsx(PTe,{status:i.status}),d.jsx("div",{className:"text-sm",children:i.title})]},s))]})}const W8="rounded-2xl border border-stroke-250 p-3";function Y8(t){const{title:e}=t,{t:n}=Oe(),r=n("chat.reasoningLoading.title"),o=e&&e.trim()!==""?e:r;return d.jsx("div",{className:"text-base",children:d.jsx(K8,{isActive:!0,children:o})})}function OTe(){return d.jsx(Re.div,{initial:dt,animate:Ot,className:q("w-max",W8),children:d.jsx(Y8,{})})}function zNe(t){var f,g;const{shouldAnimate:e,items:n,activities:r}=t,o=((f=n==null?void 0:n.at(-1))==null?void 0:f.text)??"",i=((g=n==null?void 0:n.at(-1))==null?void 0:g.title)??"",[s,a]=m.useState(0),c=G9(!0),{blocks:u}=m.useMemo(()=>{if(!o)return{blocks:[]};const v=c(),y=Dw(o);return{blocks:qf(y,v,()=>{a(s+1)})}},[c,o,s]),h=!!(o&&u.length>0),p=r&&r.length>0&&!h;return!h&&!p?null:d.jsx(Re.div,{initial:dt,animate:Ot,className:q("w-5/6",W8),children:p?d.jsx("div",{className:"flex flex-col gap-5",children:r.map((v,y)=>d.jsx(MTe,{activity:v},y))}):d.jsxs(d.Fragment,{children:[d.jsx(Y8,{title:i}),d.jsx("div",{className:"pt-3 text-foreground-600 text-sm",children:d.jsx(Kf,{blocks:u,shouldAnimate:e})})]})})}function mA(){const t=L(_n),e=L(aZ),n=le("think-deeper-cot");switch(t){case"chat":case"computerUse":case"research":return e?null:d.jsx(Rt,{type:"spinnerThemed",className:"absolute -ms-2.5 -mt-2 size-11"});case"reasoning":return n?d.jsx(OTe,{}):d.jsx(NTe,{className:"absolute -ms-2.5 -mt-2 w-max"});case"smart":return null;default:return null}}const LTe=m.lazy(()=>H(()=>import("./actions-chat-detail-CcsGdhrY.js"),__vite__mapDeps([331,1,2,332,333,334,335,336,322,277,298,299])).then(t=>({default:t.ActionsChatDetail}))),DTe=m.lazy(()=>H(()=>import("./showroom-chat-detail-Bzfwk2fZ.js"),__vite__mapDeps([337,1,2])).then(t=>({default:t.ShowroomChatDetail})));function jTe(){const t=L(Zc);return d.jsx("div",{className:"flex size-full items-center justify-center",children:t?d.jsx(m.Suspense,{fallback:d.jsx(KP,{}),children:d.jsx(DTe,{})}):d.jsx(m.Suspense,{fallback:d.jsx(KP,{}),children:d.jsx(LTe,{})})})}function KP(){return d.jsx("div",{className:"flex size-full items-center justify-center",children:d.jsx(Rt,{className:"size-12"})})}const Bm=376,w0="0.5rem";function Q8(t){const{children:e}=t,n=L(kr),r=yo(),o=n==="side-by-side",i=Ny(),s=n==="side-by-side"&&!i,a=r?"bg-stone-150":"bg-gradient-chat-light",c=Qf(u=>{const h=document.getElementById("app");h&&h.style.setProperty("--chat-details-container-height",i?`${u.height}px`:null)});return d.jsxs("div",{className:q("flex size-full max-h-[100vh] min-h-0",i&&"flex-col",o&&"bg-sidebar-light dark:bg-sidebar-dark",r&&o&&"pb-2"),style:s?{gap:w0}:void 0,children:[n!=="chat-only"&&d.jsx(Re.div,{ref:c,className:q("rounded-lg",i&&"h-fit",o&&"shadow-lg","dark:bg-midnight-850 dark:bg-none",a),initial:{width:s?`calc(100% - ${w0} - max(${Bm}px, 25%))`:"100%"},animate:{width:s?`calc(100% - ${w0} - max(${Bm}px, 25%))`:"100%"},transition:jo,children:d.jsx(jTe,{})}),d.jsx(Re.div,{className:q(n==="detail-only"&&"hidden",o&&a,i?"h-[calc(100vh-var(--chat-details-container-height))]":"h-full",o&&"rounded-lg pb-px shadow-lg dark:bg-midnight-850 dark:bg-none"),initial:{width:s?`max(${Bm}px, 25%)`:"100%"},animate:{width:s?`max(${Bm}px, 25%)`:"100%"},transition:jo,children:e})]})}function qP(t){const e=cn(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function hg(t,e){const n=qv(t),r=qv(e),o=+n-qP(n),i=+r-qP(r);return Math.round((o-i)/jue)}function ff(t,e){const n=cn(t),r=cn(e),o=n.getTime()-r.getTime();return o<0?-1:o>0?1:o}function UTe(t,e){const n=cn(t),r=cn(e),o=n.getFullYear()-r.getFullYear(),i=n.getMonth()-r.getMonth();return o*12+i}function FTe(t){const e=cn(t);return e.setHours(23,59,59,999),e}function BTe(t){const e=cn(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function HTe(t){const e=cn(t);return+FTe(e)==+BTe(e)}function zTe(t,e){const n=cn(t),r=cn(e),o=ff(n,r),i=Math.abs(UTe(n,r));let s;if(i<1)s=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-o*i);let a=ff(n,r)===-o;HTe(cn(t))&&i===1&&ff(t,r)===1&&(a=!1),s=o*(i-Number(a))}return s===0?0:s}function VTe(t,e){const n=cn(t),r=cn(e);return n.getFullYear()-r.getFullYear()}function $Te(t,e){const n=cn(t),r=cn(e),o=ff(n,r),i=Math.abs(VTe(n,r));n.setFullYear(1584),r.setFullYear(1584);const s=ff(n,r)===-o,a=o*(i-+s);return a===0?0:a}function GTe(t,e){const n=cn(t),r=cn(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function KTe(t,e){const n=e==null?void 0:e.weekStartsOn,r=cn(t),o=r.getDay(),i=(o<n?7:0)+o-n;return r.setDate(r.getDate()-i),r.setHours(0,0,0,0),r}function qTe(t,e,n){const r=hg(t,e),o=KTe(e,{weekStartsOn:1}),i=hg(o,e),s=hg(Wv(o,7),e),a=Ec(t,"EEEE"),c=n(`dates.weekdays.${a.toLowerCase()}`),u=n(`dates.months.${Ec(t,"MMMM").toLowerCase()}Abbr`),h=Ec(t,"d"),p=n("dates.dayMonthDate",{day:c,month:u,date:h});return r>=1?p:r>=0?`${n("dates.today")}`:r>=-1?`${n("dates.yesterday")}`:r>=i?c:r>=s?n("dates.previousDay",{day:c}):p}function WTe(t,e,n){const r=hg(e,t);if(r===0)return n("dates.today");if(r<=1)return n("dates.yesterday");if(r<7)return n("dates.weekThis");if(GTe(t,e))return n("dates.monthThis");if(zTe(e,t)<12){const s=Ec(t,"MMMM").toLowerCase();return n(`dates.months.${s}`)}const i=$Te(e,t);return i===1?n("dates.yearAgo"):n("dates.yearsAgoPlural",{count:i})}function YTe(t,e){return qTe(t,new Date,e)}function VNe(t,e){return WTe(t,new Date,e)}function $Ne(t){const e=Math.max(0,t),n=Math.floor(e/60),r=e%60;return`${n}:${r<10?"0":""}${r}`}function QTe(t){const{date:e,className:n}=t,{t:r}=Oe();return d.jsxs("div",{className:q("flex items-center",n),children:[d.jsx("span",{className:"opacity-70 text-xs-strong","data-testid":"date-divider",children:YTe(e,r)}),d.jsx(jw,{verticalMargin:!1,color:"accent",className:"mt-px grow"})]})}function JTe(t){const{content:e}=t;return d.jsx("div",{className:"text-center text-foreground-450 text-xs dark:text-foreground-600",children:e})}const ZTe="contrast-more:outline contrast-more:after:border-2 contrast-more:after:absolute contrast-more:after:pointer-events-none contrast-more:after:w-2/3 contrast-more:after:h-2/3",XTe="text-stone-550 active:text-stone-350 dark:text-slate-400 active:dark:text-slate-450",e_e="bg-white/3 safe-hover:bg-black/5 active:bg-black/3 dark:bg-black/3 dark:safe-hover:bg-white/5 dark:active:bg-white/3",t_e="border-[1px] border-black/8 dark:border-white/8",n_e=`${XTe} ${e_e} ${t_e}`;function r_e(t){const{children:e,isSelected:n,className:r,onClick:o,disabled:i,unselectedColorClass:s,variant:a="standard"}=t,{focusable:c}=gd({autoRestoreFocus:!0,forceFocus:!0});let u;return n?u=Ic.strong:a==="flat"?u=n_e:u=Ic[s??"overlay-dimmed-inverted"],d.jsx("button",{disabled:i,type:"button",ref:c.ref,className:q("shadow-none dark:shadow-none",mf,yI["40-base"],CI["40-base"],L0["40-base"],tb,u,r,n&&ZTe),onClick:o,"aria-pressed":n,"data-spatial-focus-key":c.focusKey,children:e})}function o_e(t){const{query:e,messageId:n,index:r,onClick:o}=t,i=L(pt),s=()=>{Tn({source:"suggestionChip",conversationId:i,messageId:n}),z.trackEvent({name:"interaction",data:{eventName:"copilotSuggestionFollowupSelection",eventInfo_messageId:n,eventInfo_conversationId:i??"",eventInfo_suggestionIndex:r}}),o()};return d.jsx(r_e,{isSelected:!1,variant:"flat",className:"max-w-[80%] text-start sm:max-w-fit",onClick:s,children:d.jsx("span",{className:"p-1",children:e})})}function i_e(t){const{mostRecentMessageId:e,className:n}=t,r=L(J$),o=r&&e===r.messageId;return m.useEffect(()=>{o&&sl({page:"chat",scenario:"suggestionReceived"})},[o]),d.jsx("div",{className:q("mt-auto",n),children:o&&d.jsx(s_e,{suggestions:r.suggestions,messageId:r.messageId})})}function s_e({suggestions:t,messageId:e}){const n=m.useRef(null),r=fI(n,{amount:"all",once:!0});return m.useEffect(()=>{r&&sl({page:"chat",scenario:"suggestionRender"})},[r]),d.jsx(Fn,{ref:n,duration:Oo.suggestions,className:"flex flex-col items-end gap-3 pb-8",children:t.map((o,i)=>d.jsx(o_e,{index:i,messageId:e,onClick:()=>ps.submitMessage({text:o,inputMethod:"suggestion"}),query:o},o))})}function WP(t){var e;return((e=be.instance().config().settingsOverrides)==null?void 0:e[t.key])??t.default}function a_e(){const t=Lr(),e=L(uL),n=L(yT),r=L(CT),o=L(Jc),i=L(UJ),s=!!L(FJ),a=!!L(BJ),c=!!(WP({key:"shouldShowTextModelTrainingSettings",default:!0})&&s),u=!!(WP({key:"shouldShowVoiceModelTrainingSettings",default:!0})&&a),h=le("view-settings-disclaimer"),p=c||u,f=!p||e&&!n,g=vj(),[v,y]=it(pL),[b,C]=m.useState(!1);m.useEffect(()=>{if((p||i)&&t&&!o){if(v){C(!0),y(!1);return}if(g<K0){C(!0);return}let I;try{I=Wle()}catch{I=new Date}const T=Uj(I,6),_=new Date;_>T&&(C(!0),ar(If,_.toISOString()))}},[t,p,o,g,i,v,y]);const S=()=>f===void 0||r===void 0||i===void 0?null:o||!t?"chat.unauthenticatedDisclaimer":!i||!b?"chat.firstTurnDisclaimerBase":!f&&!r?h?"chat.firstTurnDisclaimerPersonalizationTrainingViewSettings":"chat.firstTurnDisclaimerPersonalizationTraining":f&&!r?h?"chat.firstTurnPersonalizationDisclaimerViewSettings":"chat.firstTurnPersonalizationDisclaimer":r&&!f?h?"chat.firstTurnTrainingDisclaimerViewSettings":"chat.firstTurnTrainingDisclaimer":"chat.firstTurnDisclaimerBase";return(()=>{var T,_,w;let I=S();return I?(T=be.instance().config().uiOverrides)!=null&&T.hideTrainingDisclaimer?"chat.firstTurnDisclaimerBase":(I=((w=(_=be.instance().config()).textOverrides)==null?void 0:w.call(_,I))??I,I):null})()}const gA="text-foreground-450 text-xs dark:text-foreground-600",c_e="underline",YP={settingsLink:d.jsx(by,{pages:["menu","account","privacy"],className:q(gA,c_e),clickSource:"disclaimerSettingsLink"}),learnMoreLink:d.jsx(tI,{link:Bv})},QP={termsLink:d.jsx(tI,{link:Vf}),privacyLink:d.jsx(tI,{link:dd})},l_e={settingsLink:d.jsx(by,{pages:["menu","account","privacy"],className:q(gA),disableLink:!0})};function eI(t){const{forceVisible:e,disableDisclaimerSettingsLink:n,className:r,testId:o}=t,i=a_e(),s=L(go);if(!(s==null?void 0:s.isNew)&&!e||!i)return null;const c=u=>{switch(u){case"chat.unauthenticatedDisclaimer":return d.jsxs(d.Fragment,{children:[d.jsx(oo,{i18nKey:"chat.firstTurnDisclaimerBase"})," ",d.jsx(oo,{i18nKey:u,components:{termsLink:QP.termsLink,privacyLink:QP.privacyLink}})]});case"chat.firstTurnTrainingDisclaimer":case"chat.firstTurnPersonalizationDisclaimer":case"chat.firstTurnDisclaimerPersonalizationTraining":case"chat.firstTurnTrainingDisclaimerViewSettings":case"chat.firstTurnPersonalizationDisclaimerViewSettings":case"chat.firstTurnDisclaimerPersonalizationTrainingViewSettings":return d.jsxs(d.Fragment,{children:[d.jsx(oo,{i18nKey:"chat.firstTurnPersonalizationDisclaimerBase"})," ",d.jsx(oo,{i18nKey:u,components:{settingsLink:n?l_e.settingsLink:YP.settingsLink}})]});case"chat.edge.firstTurnPersonalizationDisclaimer":case"chat.edge.firstTurnPersonalizationSettingsDisclaimer":return d.jsxs(d.Fragment,{children:[d.jsx(oo,{i18nKey:"chat.firstTurnPersonalizationDisclaimerBase"})," ",d.jsx(oo,{i18nKey:u,components:{learnMoreLink:YP.learnMoreLink,bold:d.jsx("strong",{})}})]});case"chat.firstTurnDisclaimerBase":case"chat.firstTurnPersonalizationDisclaimerBase":case"chat.tv.firstTurnDisclaimer":return d.jsx(oo,{i18nKey:u});default:return null}};return d.jsx(Fn,{id:i,mode:"wait",className:q("space-y-8 pb-8",gA,r),"data-testid":o,children:c(i)})}function tI(t){const{children:e,link:n,className:r}=t;return d.jsx(aa,{className:q("underline",r),href:n,title:"",children:e})}function J8(t){const{customBottomDisclaimer:e}=t,n=le("async-disclaimer-text"),r=oA(),[o,i]=m.useState(!n);return m.useEffect(()=>{r&&r.length>0&&i(!0)},[r]),e||(o?d.jsx(Fn,{className:"absolute bottom-0 flex max-w-chat justify-center px-6 text-center","data-testid":"bottom-disclaimer",children:d.jsx(eI,{})}):null)}function u_e(){return d.jsx("div",{"aria-hidden":!0,className:"flex size-full flex-col items-center justify-center"})}const Kl="absolute animate-dot-ellipsis size-2 rounded-full bg-background-450";function d_e(t){const{className:e}=t;return d.jsxs("div",{className:nt("flex items-center justify-center gap-3",e),children:[d.jsxs("div",{className:"relative flex items-center justify-center",children:[d.jsx("div",{className:Kl,style:{animationDelay:"0ms"}}),d.jsx("div",{className:Kl,style:{animationDelay:"30ms"}})]}),d.jsxs("div",{className:"relative flex items-center justify-center",children:[d.jsx("div",{className:Kl,style:{animationDelay:"100ms"}}),d.jsx("div",{className:Kl,style:{animationDelay:"130ms"}})]}),d.jsxs("div",{className:"relative flex items-center justify-center",children:[d.jsx("div",{className:Kl,style:{animationDelay:"200ms"}}),d.jsx("div",{className:Kl,style:{animationDelay:"230ms"}})]})]})}function h_e(t){const{text:e,staggerChildren:n=.018,delayChildren:r=0,initialOpacity:o=0}=t;return d.jsx(Re.div,{variants:{show:{transition:{staggerChildren:n,delayChildren:r}}},initial:"hidden",animate:"show",children:Pw(e).map((i,s)=>d.jsx(Re.span,{variants:{hidden:{opacity:o},show:{opacity:1,transition:{duration:_9}}},children:i},s))})}function f_e(){const t=pr({breakpoint:"md"}),e=yo(),n=L(Oa);return e&&n&&!t}const p_e={sm:"text-md",md:"text-xl",lg:"text-3xl"},JP=25;function m_e(t){const{subheading:e}=t;return d.jsx("h2",{className:"mt-4 text-foreground-800 text-base",children:e})}function g_e(t){const{className:e,fontSize:n="lg"}=t,r=L(Ab),o=L(iL),{t:i}=Oe(),s=f_e(),{greetingKey:a,widgetGreeting:c,widgetSubheading:u}=CL(),h=aA(),p=t0e(),f=o&&o.length>JP?`${o.slice(0,JP)}…`:o,g=a?i(a,{name:f}):"";return h?d.jsx("div",{className:nt(e,"flex w-full flex-col items-start justify-start gap-2 sm:mb-6 sm:h-[100px] sm:justify-end"),children:d.jsx("div",{className:"flex justify-start sm:min-h-8",children:!p||r?d.jsx("div",{className:"ms-2 mt-6 flex size-full sm:mt-0",children:d.jsx(d_e,{className:"flex-1"})}):d.jsxs("div",{className:"flex flex-col items-start gap-2",children:[d.jsxs(Fn,{className:"flex items-center gap-2 text-foreground-550 dark:text-foreground-750",id:c??g,children:[d.jsx("p",{className:"text-xs-strong",children:i("common.copilotText")}),d.jsx("p",{className:"text-xs",children:Ec(new Date,"h:mm aa")})]}),d.jsx("h1",{className:"text-lg",children:d.jsx(Z8,{text:c??g},c)})]})})}):d.jsxs("div",{className:nt(e,"flex flex-col items-start text-pretty",p_e[n],s&&u&&"mb-8 bp-960:mb-0"),"data-testid":"launch-greeting",children:[d.jsx("h1",{children:g}),u&&d.jsx(m_e,{subheading:u})]})}const Z8=m.memo(t=>{const{text:e}=t;return d.jsx(h_e,{text:e,staggerChildren:.02,delayChildren:.1},e)});Z8.displayName="AnimatedTextMemo";function v_e(t){const{customLaunchGreeting:e,className:n}=t,r=pr({breakpoint:"sm"}),{showShoppingCardInNewChat:o}=kb();return e||d.jsx(g_e,{className:n,fontSize:r||o?"md":"lg"})}function b_e(t){const{className:e}=t,n=L(Jc),r="top-disclaimer";return n?d.jsx(eI,{forceVisible:!0,className:e,testId:r}):d.jsx(eI,{className:e,testId:r})}function y_e({characterId:t,className:e}){const n=L(go),[r,o]=it(BO),{t:i}=Oe();return m.useEffect(()=>{(n==null?void 0:n.isNew)===!1&&o(!1)},[o,n==null?void 0:n.isNew]),n!=null&&n.isNew?d.jsxs(Fn,{id:"character-disclaimer",mode:"wait",className:q("pb-2 text-stone-550/90 text-xs dark:text-slate-250/60",e),children:[i("characterAnimation.characterDisclaimerTextV2",{characterName:F$(t,i)})," ",r&&d.jsx(oo,{i18nKey:"characterAnimation.characterSettingDisclaimerText",components:{settingsLink:d.jsx(by,{pages:["menu","character-options"],className:"text-stone-550/90 underline text-xs dark:text-slate-250/60"})}})]}):null}function C_e(){return d.jsx(sA,{size:"sm",stroke:!0,className:"flex h-[172px] w-[324px] cursor-pointer flex-col p-4",children:d.jsx("div",{className:"flex flex-1",children:d.jsx(Oy,{className:"size-full",style:{clipPath:"var(--clip-path-squircle-36)"}})})})}const S_e=m.lazy(()=>H(()=>import("./contextual-shopping-card-B1RilgJe.js"),__vite__mapDeps([338,1,2,339,247,243,340,341,244,245,246,232,342,298,299,343,344,345,346,347,348,327,239,225])).then(t=>({default:t.AnimatedContextualShoppingCard})));function X8(t){const{customLaunchGreeting:e,chatItemClasses:n}=t,{isCentralComposerEnabled:r,isWidgetSectionEnabled:o,isAppearanceOnHomeEnabled:i}=Pp(),s=pr({breakpoint:"sm"}),a=Kv({breakpoint:"h760"}),c=Kv({breakpoint:"h600"}),u=le("appr-home-toggle"),h=L(PJ),p=i&&(!u||!h)&&!c,f=le("multiplecharacters"),g=dp(),v=L(KI),y=L(YJ),b=!yy(),C=f&&v!==null,S=g9(),{launchGreetingShown:E,widgetSubheading:I}=CL(),T=L(JO),{showShoppingCardInNewChat:_,shoppingProductMetadata:w,isCopilotOpenedViaNudge:A}=kb(),M=!A&&!y&&!C&&!E&&g&&!S,$=be.instance().config().smallScreenShowTopDisclaimerAfterSendingMessage??!1?!g:!M,V=C||s&&$,N=L(_n)==="computerUse",Y=o&&!N&&!s&&!a,ue=M&&"pb-2",j=m.lazy(()=>i?H(()=>import("./appearance-chat-C6hHNiiL.js"),__vite__mapDeps([349,1,2])).then(te=>({default:te.AppearanceChat})):Promise.resolve({default:()=>null})),U=d.jsxs(Fn,{delay:.2,initial:b?"initial":!1,className:nt(r?"mt-2 flex flex-col items-start text-pretty pe-0 sm:absolute sm:inset-x-0 sm:inset-y-0 sm:mx-auto sm:mt-0 sm:max-w-chat sm:px-4 sm:pb-[calc(var(--composer-container-height))]":ue,_&&"mx-auto mt-2 max-w-sm sm:relative sm:mt-6 sm:max-w-md sm:px-4",p&&s&&"grow",Y&&!I&&"sm:pb-[calc(var(--composer-container-height)-64px)]",Y&&I&&"sm:pb-[calc(var(--composer-container-height)-32px)]"),children:[p&&r&&d.jsx("div",{className:nt("order-2 flex w-full flex-col items-center justify-center sm:absolute sm:h-[calc(50%-60px-var(--composer-container-height)/2)]",s&&"grow"),children:d.jsx(m.Suspense,{fallback:d.jsx(u_e,{}),children:d.jsx(j,{voiceAppearanceId:XI})})}),d.jsxs("div",{className:nt("order-1 flex w-full flex-col gap-2 sm:top-0 sm:h-full sm:justify-center",i?"items-center":"items-start"),children:[M&&d.jsx(v_e,{customLaunchGreeting:e,className:nt(i?"text-center":"sm:ps-2")}),C&&d.jsx(y_e,{characterId:v}),_&&w&&!T&&d.jsx(m.Suspense,{fallback:d.jsx(C_e,{}),children:d.jsx(S_e,{content:w})}),V&&d.jsx(b_e,{})]})]},"chat-welcome");return n?d.jsx("div",{className:n,children:U}):U}const ZP=10,E_e=0,I_e=.2;function T_e({onClick:t,shouldShowScrollToBottomButton:e,bottomButtonClass:n=""}){const{t:r}=Oe(),o=L(kr),i=Ny(),s=o==="side-by-side"&&!i;return d.jsx(Pn,{children:e&&d.jsx(Re.div,{className:nt("pointer-events-none absolute flex justify-center",Xt.chatScrollToBottomButton,s?"end-0 w-1/4 min-w-chat-side-by-side justify-end":"inset-x-0",n),initial:{...dt,y:ZP},animate:{...Ot,y:E_e},exit:{...dt,y:ZP},transition:{duration:I_e},children:d.jsx(Me,{color:"acrylic",variant:"circle",size:"36-sm",title:r("chat.scrollToBottom"),onClick:t,className:"pointer-events-auto border-none shadow-xl",children:d.jsx("span",{className:nt("relative rounded-full bg-white/40 p-2 shadow-xl hover:bg-white hover:p-[9px] dark:bg-background-350/60","after:absolute after:inset-0 after:rounded-full after:shadow-xl","before:absolute before:-inset-px before:rounded-full before:border before:border-black/8"),children:d.jsx(wp,{className:"size-5 rotate-180 fill-foreground-900 dark:fill-white"})})})})})}function e7(t){const{delay:e,className:n}=t,{t:r}=Oe(),o=le("announce-loading"),i=m.useId(),s=L(_n);return d.jsxs(Re.div,{"aria-hidden":!0,className:nt("relative size-7",n),initial:"start",animate:"end",variants:{start:{...dt},end:{...Ot,transition:{delay:e}}},children:[o&&d.jsx(hd,{id:i,timeout:3e3,msg:r(s==="reasoning"?"chat.reasoning":"chat.loading"),type:"polite"}),d.jsx(mA,{})]})}const XP=m.lazy(()=>H(()=>import("./ai-message-PPiQ1Ful.js").then(t=>t.i),__vite__mapDeps([350,1,2,309,351,221,314,352,353,294,354,319,355,312,343])));function __e(t){const{message:e,animatingMessageIds:n,conversationId:r,sideBySideComparisonId:o,isStreamingComplete:i,shouldAnimate:s,reactionsToDisable:a,isLastMessage:c}=t,{t:u}=Oe(),h=Ee(Os);if(!r)return null;if(!_L(e))return d.jsx(Re.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.25},children:d.jsx(m.Suspense,{fallback:d.jsx(mA,{}),children:d.jsx(XP,{message:e,isStreamingComplete:i,shouldAnimate:!1,reactionsToDisable:a,isLastMessage:c})})});if(!o)return null;const{left:p,right:f}=e,g=b=>!i&&!(n!=null&&n.has(b)),v=(b,C)=>{Lhe({sideBySideComparisonId:o,isControlMessage:C}),ps.selectSideBySideMessage({selectedMessageId:b,sideBySideComparisonId:o}),hZ(r,b),h({title:u("chat.sideBySide.selectedResponseToastTitle"),subtitle:u("chat.sideBySide.selectedResponseToastSubtitle"),dismissAfter:2e3})},y=d.jsx(e7,{delay:.5,className:"mt-2"});return d.jsxs("div",{className:"flex w-full flex-col items-center gap-6 pb-4",children:[d.jsx("p",{children:u("chat.sideBySide.preambleMessage")}),d.jsx("div",{className:"grid grid-cols-1 gap-6 max-lg:grid-cols-[repeat(1,minmax(480px,600px))] lg:grid-cols-[repeat(2,minmax(480px,600px))]",children:[p,f].map(b=>d.jsxs("div",{className:"flex min-h-[100px] min-w-[480px] max-w-[600px] flex-col rounded-2xl border-[0.5px] border-black/12 bg-white/45 p-6 dark:bg-midnight-350/10",children:[d.jsx("div",{className:"flex-1",children:g(b.id)?y:d.jsx(m.Suspense,{fallback:y,children:d.jsx(XP,{message:b,isStreamingComplete:i,shouldAnimate:s,reactionsToDisable:"all",isLastMessage:!0,groupHasTopMargin:!1})})}),i&&d.jsx(Re.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.5},children:d.jsx(Me,{size:"36-sm",className:"mx-auto mt-6",title:u("chat.actions.selectResponse"),color:"strong",onClick:()=>v(b.id,b.sideBySideConfig.isDefault),children:u("chat.actions.selectResponse")})})]},b.id))})]})}const t7=t=>m.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("mask",{id:"mask0_12117_44960",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:0,y:0,width:20,height:20},m.createElement("path",{d:"M7.19253 7.24894C7.46962 6.94112 7.94384 6.91617 8.25172 7.1932L10.7517 9.44267C10.9098 9.58487 11 9.78745 11 10C11 10.2126 10.9098 10.4152 10.7517 10.5574L8.25172 12.8068C7.94384 13.0839 7.46962 13.0589 7.19253 12.7511C6.91543 12.4433 6.94039 11.9692 7.24827 11.6922L8.29553 10.7499H4.75C4.33579 10.7499 4 10.4141 4 10C4 9.58591 4.33579 9.2502 4.75 9.2502H8.29553L7.24828 8.30789C6.94039 8.03086 6.91543 7.55675 7.19253 7.24894ZM20 15.2506C20 16.7691 18.7688 18 17.25 18L2.75 18C1.23122 18 0 16.7691 0 15.2506V4.74937C0 3.23093 1.23122 2 2.75 2H17.25C18.7688 2 20 3.23094 20 4.74937L20 15.2506ZM17.25 16.5003C17.9404 16.5003 18.5 15.9408 18.5 15.2506L18.5 4.74937C18.5 4.05917 17.9404 3.49966 17.25 3.49966L13.9958 3.49966L13.9958 16.5003H17.25ZM12.4958 16.5003L12.4958 3.49966L2.75 3.49965C2.05965 3.49965 1.5 4.05917 1.5 4.74937L1.5 15.2506C1.5 15.9408 2.05964 16.5003 2.75 16.5003L12.4958 16.5003Z",fill:"currentColor"})),m.createElement("g",{mask:"url(#mask0_12117_44960)"},m.createElement("rect",{width:24,height:24,transform:"translate(-2 -2)",fill:"currentColor"}))),GNe=Object.freeze(Object.defineProperty({__proto__:null,default:t7},Symbol.toStringTag,{value:"Module"}));function w_e(){const t=!Fo("kill-share-c2"),e=Ft(),n=L(go),r=L(Jc),o=Fd();return!!(!r&&t&&e.startsWith("/chats")&&!e.endsWith("/talk")&&(n!=null&&n.history.length)&&!o)}function n7(){const{t}=Oe(),e=pr({breakpoint:"md"}),n=pr({breakpoint:"sm"}),r=pr({breakpoint:"xl"}),o=L(kr)==="side-by-side",i=L(Oa),s=Ft(),a=Ee(kr),c=Ny(),u=o&&!n&&s.startsWith("/chats"),h=w_e()&&r,p=(e||!i||u||h)&&!c,f=m.useCallback(()=>{a("detail-only")},[a]);return d.jsx("div",{className:q("sticky top-0 z-20 w-full"),children:d.jsx(Pn,{children:p&&d.jsx(Re.div,{className:"absolute h-16 w-full rounded-lg bg-stone-150/90 backdrop-blur-md dark:bg-midnight-850/80",initial:"initial",animate:"animate",exit:"exit",variants:{initial:dt,animate:Ot,exit:dt},transition:jo,"data-testid":"sticky-header",children:u&&d.jsx(Re.div,{initial:dt,animate:Ot,exit:{transition:{duration:0},...dt},transition:jo,children:d.jsx(Me,{title:t("actions.hideDetails"),color:"subtle-dimmed",variant:"square",size:"36-sm",className:"ms-3.5 mt-1.5",onClick:f,children:d.jsx(t7,{className:"size-5"})})})})})})}const A_e="answerCards.ariaLabel.numberOfLocalResultsSingle",k_e="answerCards.ariaLabel.numberOfLocalResultsPlural";function x_e(t){let e="";for(const r of t.entities){if(e+=r.name,r.category&&(e+=`, ${r.category}`),r.price&&(e+=`, ${R_e(r.price)}`),r.reviews[0]){const o=r.reviews[0];e+=", ",e+=X("answerCards.ariaLabel.ratedByReviewer",{rating:o.rating,reviewCount:o.count,reviewProvider:o.providerName})}r.phoneNumber&&(e+=", ",e+=X("answerCards.ariaLabel.phoneNumber",{phoneNumber:r.phoneNumber})),r.location.address&&(e+=", ",e+=X("answerCards.ariaLabel.address",{address:r.location.address})),e+=". "}const n=t.entities.length===1?A_e:k_e;return X(n,{count:t.entities.length,resultSummary:e})}function R_e(t){switch(t.length){case 1:return X("answerCards.ariaLabel.inexpensivePrices");case 2:return X("answerCards.ariaLabel.averagePrices");default:return X("answerCards.ariaLabel.expensivePrices")}}function N_e(t){const{content:e,announce:n}=t;let r;for(const o of e){switch(o.type){case"text":r=o.text;break;case"image":o.url?r=X("chat.imageGenerated",{prompt:o.prompt??""}):r=X("chat.imageGenerating");break;case"page":break;case"citation":break;case"card":r=P_e(o.card);break;case"error":r=o.text;break;case"task":break;case"deleted":break;case"chainOfThought":break;case"chainOfThoughtGroup":break;case"document":break;case"activity":break;case"memorySignal":r=o.text;break}r&&n({msg:r})}}function P_e(t){switch(t.type){case"localEntity":return x_e(t);case"ads":case"weather":case"weatherTemperatureHourly":case"weatherTemperatureDaily":case"weatherPrecipitationHourly":case"weatherPrecipitationDaily":case"image":case"phoneImages":case"phoneLinking":case"phoneAlarm":case"phoneTimer":case"phoneSendMessage":case"video":case"sportsSchedule":case"sportsGame":case"safetyHelpline":case"shopping":case"shoppingProducts":case"shoppingCurated":case"job":case"inlineVideo":case"quiz":case"financeChart":case"generativeUI":case"recipe":case"mediaSpotlight":case"inlineImage":case"m365":case"file":case"computerUseFeedback":case"document":return"";default:return""}}function M_e(t,e){const n=m.useRef();m.useEffect(()=>{var o;if(e==="streaming")return;const r=t.at(-1);r&&r.author==="ai"&&r.id!==((o=n.current)==null?void 0:o.id)&&(N_e({content:r.content,announce:Rw}),n.current=r)},[t,e])}function O_e(t){m.useEffect(()=>{if(t.current){const e=r=>{var i,s,a,c,u;if(r.target&&r.target instanceof Element&&r.target.closest('[data-formatless-copy="false"]'))return;const o=window.getSelection();if(o!=null&&o.rangeCount){let h=document.createElement("div");const p=o.getRangeAt(0),{startContainer:f,endContainer:g}=p;h.appendChild(p.cloneContents());const v=(i=f.parentElement)==null?void 0:i.closest("pre"),y=(s=g.parentElement)==null?void 0:s.closest("pre"),b=!!v&&!!y&&v===y,C=!!((a=f.parentElement)!=null&&a.closest("table"))&&!L_e(p),S=h.getElementsByTagName("*");for(const _ of S)_.getAttribute("data-copy")==="false"?_.remove():(_.removeAttribute("style"),_.removeAttribute("class"),_.removeAttribute("initial"),_.removeAttribute("animate"),_.removeAttribute("variants"),_.removeAttribute("custom"));if(b){const _=document.createElement("pre");_.appendChild(h),h=_}if(C){const _=document.createElement("table"),w=Array.from(h.children);for(const A of w)_.appendChild(A);h=_}h.style.position="absolute",h.style.left="-9999px",document.body.appendChild(h);const E=window.getSelection(),I=document.createRange();I.selectNodeContents(h),E==null||E.removeAllRanges(),E==null||E.addRange(I);const T=(E==null?void 0:E.toString())??"";E==null||E.removeAllRanges(),E==null||E.addRange(p),document.body.removeChild(h),h.removeAttribute("style"),(c=r.clipboardData)==null||c.setData("text/plain",T),(u=r.clipboardData)==null||u.setData("text/html",b||C?h.outerHTML:h.innerHTML)}r.preventDefault()},n=t.current;return n.addEventListener("copy",e),()=>{n.removeEventListener("copy",e)}}return()=>{}},[t])}function L_e(t){var i,s,a,c;const{startContainer:e,endContainer:n}=t,r=((i=e.parentElement)==null?void 0:i.closest("td"))??((s=e.parentElement)==null?void 0:s.closest("th")),o=((a=n.parentElement)==null?void 0:a.closest("td"))??((c=n.parentElement)==null?void 0:c.closest("th"));return!!(r&&o&&r===o)}const D_e=typeof document<"u"?m.useLayoutEffect:m.useEffect;function j_e(t,e){const n=m.useRef(0),r=m.useRef(0);m.useEffect(()=>{const{current:o}=e,i=()=>{if(o){const s=o.scrollHeight-o.scrollTop;r.current=s}};return o==null||o.addEventListener("scroll",i,{passive:!0}),i(),()=>{o==null||o.removeEventListener("scroll",i)}},[e]),D_e(()=>{const{current:o}=e;o&&o.scrollTop+r.current!==o.scrollHeight&&(n.current===0?setTimeout(()=>{o.scrollTop=o.scrollHeight},100):o.scrollTop=o.scrollHeight-r.current,n.current=t)},[t,e])}function U_e(t,e){const n=Fo("kill-review-prompt"),o=!!be.instance().config().promptForReviews&&!n,i=Ee(Yr),s=m.useCallback(async c=>{if(!o)return;const{shown:u}=await Ale.run({});if(u)return;const p=BSe()>=OSe,f=c>PSe;(p||f)&&!HSe()&&(i("prompt-review"),z.trackEvent({name:"system",data:{eventName:"inAppSurveyPopUp",eventInfo_triggerType:f?"longChat":"activeDays"}}))},[o,i]),a=m.useRef(!1);m.useEffect(()=>{e&&(a.current=!0)},[e]),m.useEffect(()=>{e||!a.current||s(t)},[t,e,s])}function F_e(t){return m.useCallback(({behavior:n="smooth",delay:r=0})=>{setTimeout(()=>{t.current&&t.current.scrollTo({top:t.current.scrollHeight,behavior:n})},r)},[t])}const B_e=.1;function H_e(t){const{chatRef:e,hasMessages:n=!0}=t,r=m.useRef(null),[o,i]=m.useState(!1),s=m.useCallback(a=>{const c=a[0];c&&i(!c.isIntersecting&&n)},[n]);return m.useEffect(()=>{if(!e.current||!r.current)return()=>{};const a=new IntersectionObserver(s,{root:e.current,threshold:B_e});return a.observe(r.current),()=>{a.disconnect()}},[e,s]),m.useEffect(()=>{n||i(!1)},[n]),{bottomRef:r,shouldShowScrollToBottomButton:o}}function z_e(){const t=L(up),e=rp(En),n=L($I);m.useEffect(()=>{e(r=>{if(n){const o=r.get(n);o&&(o.characterId=t)}})},[n,t,e])}async function V_e(t,e){const n=wT(e);if(n){const{message:r,part:o}=n;if(!o.task)return;const i=await es();i.setConversationIdByMessageId({messageId:r.id,conversationId:t}),i.setMessageIdByTaskId({taskId:o.task.id,messageId:r.id})}}const $_e=window.requestIdleCallback||function(e){const n=Date.now();return setTimeout(()=>{e({didTimeout:!1,timeRemaining(){return Math.max(0,50-(Date.now()-n))}})},1)},r7=t=>m.createElement("svg",{viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M2 6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v7a2 2 0 0 1-1.164 1.818 1.497 1.497 0 0 0-.275-.379l-.446-.446A1 1 0 0 0 17 13V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h5v1H4a2 2 0 0 1-2-2V6Zm8.854 4.146A.5.5 0 0 0 10 10.5v7a.5.5 0 0 0 .91.287l1.571-2.245 2.943.452a.5.5 0 0 0 .43-.848l-5-5ZM11 15.915v-4.207l3.066 3.067-1.74-.268a.5.5 0 0 0-.486.207l-.84 1.2Z"})),KNe=Object.freeze(Object.defineProperty({__proto__:null,default:r7},Symbol.toStringTag,{value:"Module"})),o7=t=>m.createElement("svg",{viewBox:"0 0 64 64",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M32.0007 5.33301C46.7282 5.33301 58.6673 17.2721 58.6673 31.9997C58.6673 46.7273 46.7282 58.6663 32.0007 58.6663C17.2731 58.6663 5.33398 46.7273 5.33398 31.9997C5.33398 17.2721 17.2731 5.33301 32.0007 5.33301ZM32.0007 8.66634C19.114 8.66634 8.66732 19.113 8.66732 31.9997C8.66732 44.8863 19.114 55.333 32.0007 55.333C44.8873 55.333 55.334 44.8863 55.334 31.9997C55.334 19.113 44.8873 8.66634 32.0007 8.66634ZM23.7105 21.3663L23.8458 21.4878L32.0007 29.6437L40.1555 21.4878C40.763 20.8803 41.7227 20.8398 42.3772 21.3663L42.5125 21.4878C43.12 22.0953 43.1605 23.0551 42.634 23.7095L42.5125 23.8449L34.3567 31.9997L42.5125 40.1545C43.12 40.762 43.1605 41.7217 42.634 42.3762L42.5125 42.5115C41.905 43.119 40.9453 43.1595 40.2908 42.633L40.1555 42.5115L32.0007 34.3557L23.8458 42.5115C23.2383 43.119 22.2786 43.1595 21.6241 42.633L21.4888 42.5115C20.8813 41.904 20.8408 40.9443 21.3673 40.2898L21.4888 40.1545L29.6447 31.9997L21.4888 23.8449C20.8813 23.2374 20.8408 22.2776 21.3673 21.6232L21.4888 21.4878C22.0963 20.8803 23.0561 20.8398 23.7105 21.3663Z"})),qNe=Object.freeze(Object.defineProperty({__proto__:null,default:o7},Symbol.toStringTag,{value:"Module"})),eM="size-5",tM="flex w-full items-center justify-end gap-1.5 text-foreground-450 dark:text-slate-400";function G_e({type:t}){const{t:e}=Oe();switch(t){case"takeTaskControl":return d.jsxs("div",{className:tM,children:[d.jsx(r7,{className:eM}),e("actions.tookControl")]});case"cancelTask":return d.jsxs("div",{className:tM,children:[d.jsx(o7,{className:eM}),e("actions.cancelledTask")]});case"createPage":case"appendToPage":case"promptCharacterSpeech":default:return null}}function K_e(t){const{fileName:e,fileType:n}=t,r=n!==""?n:xw(e);return kp(r)?d.jsx(Nw,{filename:e,fileType:r}):null}const q_e=[{canHandle:t=>t.startsWith("https://"),getImageSrc:t=>t,shouldReleaseOnLoad:!1},{canHandle:t=>t.startsWith("/attachments"),getImageSrc:t=>NSe(t),shouldReleaseOnLoad:!0}];function W_e(t){return q_e.find(e=>e.canHandle(t))??null}function Y_e({url:t}){const{t:e}=Oe(),[n,r]=m.useState(null),[o,i]=m.useState(!1);return m.useEffect(()=>{if(!t){r(null);return}const s=W_e(t);if(!s){r(null);return}(async()=>{const c=await s.getImageSrc(t);r(c),i(s.shouldReleaseOnLoad)})()},[t]),n?d.jsx("img",{className:"block h-full overflow-hidden rounded-2xl bg-background-static-250 object-cover object-center shadow-inner dark:bg-background-static-900",alt:e("chat.uploadedImageAltText"),src:n,onLoad:o?xSe:void 0}):null}function Q_e(t){const{text:e}=t;return d.jsx("div",{className:"flex w-full flex-col items-end","data-content":"user-message",children:d.jsx("div",{className:q("font-ligatures-none h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-accent-250/60 px-5 py-3 dark:bg-accent-200",Qi("userMessage")??"text-base"),children:e})})}const i7=m.forwardRef((t,e)=>{const{children:n,tabBehavior:r="limited-trap-focus",ignoreDefaultKeydown:o,...i}=t,s=OM({tabBehavior:r,ignoreDefaultKeydown:o});return le("a11y-keyboard-navigation")?d.jsx(Re.div,{ref:e,...s,...i,tabIndex:0,children:n}):d.jsx(Re.div,{...i,ref:e,children:n})});i7.displayName="FocusableGroupMotion";function J_e(t){const{children:e,tabBehavior:n="limited-trap-focus",ignoreDefaultKeydown:r,...o}=t,i=OM({tabBehavior:n,ignoreDefaultKeydown:r});return le("a11y-keyboard-navigation")?d.jsx("div",{...i,...o,tabIndex:0,role:"article",children:e}):d.jsx("div",{...o,children:e})}const s7=t=>d.jsx(J_e,{...t});s7.Motion=i7;function Z_e(){const{t}=Oe();return d.jsx("div",{className:"flex w-fit justify-end",children:d.jsx("div",{className:"flex h-32 w-44 items-center justify-center rounded-xl border border-stroke-250 bg-accent-200 px-4 py-2 dark:bg-accent-250",children:d.jsx("span",{className:"text-center text-foreground-450 text-sm",children:t("share.imagePlaceholder")})})})}function X_e({tabs:t=[]}){return t.length===0?null:d.jsx(Sl,{className:"flex min-h-[60px] flex-col gap-2",tabbable:!0,tabIndex:0,children:d.jsx(QU,{showRemoveIcon:!1,tabs:t})})}function ewe(t){const{message:e,className:n,isForSharing:r}=t,{t:o}=Oe(),s=!!L(Zc),a=Zw(),c=le("a11y-keyboard-navigation"),u=!Fo("kill-share-c2"),h=o(c?"chat.userSaid":"chat.user"),p=(g,v,y)=>g.type==="document"?d.jsx(K_e,{fileType:g.contentType,fileName:g.fileName},`${y}-${v}`):u&&r?d.jsx(Z_e,{},`${y}-${v}`):g.type==="image"?d.jsx("div",{className:"inline-block h-full max-w-[min(80%,256px)] align-top",children:d.jsx("div",{className:"h-full w-fit min-w-0",children:d.jsx(Y_e,{url:g.url})})},`${y}-${v}`):null,f=e.content.filter(g=>g.type==="document"||g.type==="image");return d.jsxs(s7,{className:q("space-y-1",n),id:`${e.id}-user-message`,"aria-labelledby":`${e.id}-user-message`,children:[d.jsxs("div",{className:"relative space-y-3",children:[d.jsx("h2",{className:"sr-only","aria-label":h,"data-copy":"false",children:h}),f.length>0&&d.jsx("div",{className:"flex h-32 w-full flex-row justify-end gap-2 overflow-hidden",children:f.map((g,v)=>p(g,v,"file"))}),e.content.map((g,v)=>g.type==="browserTabs"?a&&bU(g.tabs)?d.jsx(X_e,{tabs:g.tabs},v):null:g.type==="text"?d.jsx(Q_e,{text:g.text},v):g.type==="command"?d.jsx(G_e,{type:g.command.type},v):(g.type==="document",null)),e.emojiReaction&&d.jsx("div",{className:"absolute -bottom-3 end-3",children:e.emojiReaction})]}),!s&&e.brand&&d.jsx("div",{className:"w-full px-3 text-right text-foreground-600 text-xs",children:o("ads.aboutBrand",{brand:e.brand.brandLogo.businessName})})]},e.id)}const twe=m.lazy(()=>H(()=>import("./ai-message-PPiQ1Ful.js").then(t=>t.i),__vite__mapDeps([350,1,2,309,351,221,314,352,353,294,354,319,355,312,343]))),nwe=1.5,nM="inline-block w-full space-y-8",vA="max-w-chat w-full";function a7(t){var kn,F,me;const{className:e,conversationContainerClassName:n="mb-[var(--composer-container-height)]",bottomButtonClassName:r="bottom-[calc(var(--composer-container-height)+1rem)]",customLaunchGreeting:o,customBottomDisclaimer:i,enableHighlightedClasses:s=!0,enableBackstageClasses:a=!0,disableStickyHeader:c=!1,disableSuggestions:u=!1,reactionsToDisable:h}=t,{loader:p}=t8(),f=L(Zi),g=L(go),v=L(KI),y=L(bb),b=pr({breakpoint:"sm"}),S=le("multiplecharacters")&&v!==null,E=le("share-continue-v2"),I=!yy(),T=g==null?void 0:g.sideBySideComparisonId,_=!!T,[w,A]=m.useState(0);z_e();const M=m.useRef(null),R=F_e(M);j_e(f.length,M),O_e(M),S8({scrollableRef:M,source:"chat",customData:{conversationId:g==null?void 0:g.id}});const[$]=yTe({...p,disabled:!!p.error}),{backstageMessagesProps:V,highlightedMessagesProps:ie,sentinelRef:N,sentinelClasses:Y,backstageClasses:ue,highlightedClasses:j,opacity:U,highlighted:te,backstage:Q}=cTe(()=>R({behavior:"instant",delay:be.instance().config().scrollToBottomDelay}),M,S,w,f),re=zu(U,ve=>ve<.5?"none":"auto"),Z=()=>R({behavior:"smooth"}),{bottomRef:_e,shouldShowScrollToBottomButton:ye}=H_e({chatRef:M,hasMessages:f.length>0}),Ne=L(GI).get((g==null?void 0:g.id)??""),we=!!(Ne!=null&&Ne.size),Ke=Ne==null?void 0:Ne.values().next().value,de=L(Cd);m.useEffect(()=>{g!=null&&g.id&&(V_e(g.id,f),$_e(()=>{H(()=>import("./ai-message-PPiQ1Ful.js").then(ve=>ve.i),__vite__mapDeps([350,1,2,309,351,221,314,352,353,294,354,319,355,312,343]))}))},[g==null?void 0:g.id,f]),M_e(f,g==null?void 0:g.streamingState);const ge=F8(te),$e=(ge==null?void 0:ge.author)==="human"&&ge.id===""||(g==null?void 0:g.streamingState)==="streaming",P=!!L(Nh),J=L(Eu),Te=$e&&!we||P||J,{disableMultiturn:O}=be.instance().config(),ce=(F=(kn=be.instance().config().styleOverrides)==null?void 0:kn.width)==null?void 0:F.chat;U_e(f.length,$e);const se=yo(),ne=dp(),{showShoppingCardInNewChat:K}=kb(),pe=!S&&!b&&ne,He=a&&!(K&&!b),{isMediaViewerOpen:at}=Na(),ut=le("chat-refactor-max-width"),Le=ut?B8():void 0,Xe=ut?"w-full":vA,St=(g==null?void 0:g.streamingState)==="idle",Ut=!u&&!_,Gt=Te&&!_,Kt=(ve,je=!1,Ve,ct=!1)=>ve.map((Be,k)=>{const G=new Date(Be.createdAt),ee=k>0?ve[k-1]:Ve,Ce=ee&&new Date(ee.createdAt),De=!Ce||!iA(G,Ce),Qe=E&&kSe(g!=null&&g.continuedAt?new Date(g.continuedAt):null,G,Ce);let rt;return oZ(Be)?rt=d.jsx(__e,{message:Be,conversationId:g==null?void 0:g.id,animatingMessageIds:Ne,sideBySideComparisonId:T,isStreamingComplete:St,shouldAnimate:je,reactionsToDisable:h,isLastMessage:ct&&k===ve.length-1}):Be.author==="ai"?rt=d.jsx(m.Suspense,{fallback:d.jsx(mA,{}),children:d.jsx(twe,{message:Be,isStreamingComplete:St,shouldAnimate:je,reactionsToDisable:h,isLastMessage:ct&&k===ve.length-1})}):rt=d.jsx(ewe,{message:Be,className:Le}),d.jsxs(m.Fragment,{children:[Qe&&d.jsx(JTe,{content:X("chat.continuedConversationDisclaimer")}),De&&!O&&d.jsx(QTe,{date:G,className:Le}),rt]},Be.id)});return d.jsx(Q8,{children:d.jsxs("div",{className:q("scrollbar-stable flex size-full flex-col items-center overflow-y-auto overflow-x-hidden overscroll-contain text-foreground-800 sm:min-w-chat-side-by-side",(g==null?void 0:g.id)&&Zj(g.id)&&"t-custom-scrollbar",be.instance().config().showScrollbarOnHover&&"scrollbar-container",at&&"invisible",e),ref:M,"data-testid":"chat-page",children:[!c&&d.jsx(n7,{}),p.hasNextPage&&d.jsx("div",{ref:$}),S&&d.jsx(RTe,{animatingMessageId:Ke,isStreamingMessage:$e,displayedCharacterId:v,setCharacterComponentHeight:A}),d.jsx(Sl.Motion,{circular:!1,tabbable:!0,initial:I?"start":!1,animate:"end",variants:{start:dt,end:{...Ot,transition:{duration:.2,delay:.2}}},className:q(n,"grow",!ut&&(Gf("pageContainer")??"px-6"),Xe,ce),layout:"position",transition:jo,"data-content":"conversation","data-copy":"false",children:d.jsxs(m.Suspense,{fallback:d.jsx("div",{"aria-hidden":!0}),children:[d.jsxs(Re.div,{className:q("relative",se||!c?"pt-10":"pt-6",Q.length>0&&nM,He&&ue),variants:V.variants,initial:I?V.initial:!1,animate:V.animate,style:{opacity:f.length>0?U:0,pointerEvents:re},children:[d.jsx("div",{className:q("absolute -z-10 w-full",Y),ref:N}),Kt(Q)]}),d.jsxs("div",{className:q(s&&j,"flex flex-col"),"data-testid":"highlighted-chats",children:[d.jsx(Pn,{mode:"wait",initial:!1,children:d.jsxs(d.Fragment,{children:[d.jsx(X8,{customLaunchGreeting:o,chatItemClasses:Le}),te.length>0&&d.jsxs(Re.div,{className:q(O?"pb-24":"pb-6",nM),initial:ie.initial,animate:ie.animate,exit:ie.exit,onAnimationStart:ie.onAnimationStart,children:[Kt(_?rZ(te,T):te,we,Q[Q.length-1]??void 0,!0),d.jsx(m.Suspense,{fallback:d.jsx("div",{"aria-hidden":!0}),children:Gt&&d.jsx("div",{className:Le,children:d.jsx(e7,{delay:nwe})})}),d.jsx(Fn,{children:de&&d.jsx(_Te,{className:Le})}),d.jsx(Fn,{children:y&&y.visible&&d.jsx(ITe,{className:Le})})]},(me=te[0])==null?void 0:me.createdAt)]})}),Ut&&d.jsx(i_e,{mostRecentMessageId:ge==null?void 0:ge.id,className:Le}),d.jsx("div",{ref:_e,style:{height:0,overflow:"hidden"}}),d.jsx(T_e,{shouldShowScrollToBottomButton:ye,onClick:Z,bottomButtonClass:r}),O&&!Te&&d.jsx(CTe,{title:X("tv.chat.moveToMultiturn"),onClick:()=>{const ve=new URL(window.location.origin);ve.searchParams.set("wtv","1"),ve.searchParams.set("oem","lg-multiturn"),Tp(ve.toString())},hoverVariant:!0,className:q("fixed bottom-6 start-1/2 z-10 -translate-x-1/2 px-8 transition-opacity duration-300",ye?"pointer-events-none opacity-0":"opacity-100"),children:X("tv.chat.moveToMultiturn")})]})]})}),pe&&d.jsx(J8,{customBottomDisclaimer:i})]})})}const WNe=Object.freeze(Object.defineProperty({__proto__:null,CHAT_WIDTH_CLASSES:vA,default:a7},Symbol.toStringTag,{value:"Module"}));function c7(t){var y,b;const{className:e,conversationContainerClassName:n="mb-[var(--composer-container-height)]",customLaunchGreeting:r,customBottomDisclaimer:o,disableStickyHeader:i=!1,enableBackstageClasses:s=!0,enableHighlightedClasses:a=!0}=t,c=le("chat-refactor-max-width"),u=pr({breakpoint:"sm"}),h=yo(),p=!u,f=(b=(y=be.instance().config().styleOverrides)==null?void 0:y.width)==null?void 0:b.chat,g=c?B8():void 0,v=c?"w-full":vA;return d.jsx(Q8,{children:d.jsxs("div",{className:nt("scrollbar-stable flex size-full flex-col items-center overflow-y-auto overflow-x-hidden overscroll-contain text-foreground-800 sm:min-w-chat-side-by-side",be.instance().config().showScrollbarOnHover&&"scrollbar-container",e),"data-testid":"landing-page",children:[!i&&d.jsx(n7,{}),d.jsx(Sl.Motion,{circular:!1,tabbable:!0,initial:"start",animate:"end",variants:{start:dt,end:{...Ot,transition:{duration:.2,delay:.2}}},className:nt(n,"grow",!c&&(Gf("pageContainer")??"px-6"),v,f),layout:"position",transition:jo,children:d.jsxs(m.Suspense,{fallback:d.jsx("div",{"aria-hidden":!0}),children:[d.jsx("div",{className:nt("relative",h||!i?"pt-10":"pt-6",s&&j8)}),d.jsx("div",{className:nt("flex",a&&U8),children:d.jsx(Pn,{mode:"wait",initial:!1,children:d.jsx(X8,{customLaunchGreeting:r,chatItemClasses:g})})})]})}),p&&d.jsx(J8,{customBottomDisclaimer:o})]})})}const rwe=wt("/")({component:c7});wt("/w/landing")({component:c7});const owe=hB("/chats/$conversationId");function iwe(t){const{disableStickyHeader:e,reactionsToDisable:n}=t,{conversationId:r}=owe.useParams(),o=Ee(pt),i=le("conversation-id-sync");return m.useEffect(()=>{i&&o(r)},[r,o,i]),d.jsx(a7,{disableStickyHeader:e,reactionsToDisable:n})}const swe=wt("/chats/$conversationId")({component:iwe}),awe=wt("/topic-selection")(),cwe=wt("/login")(),lwe=wt("/library")(),uwe=wt("/gaming")(),dwe=wt("/gallery")(),hwe=wt("/discover")(),fwe=wt("/daily")(),pwe=wt("/agents")(),mwe=wt("/referrals/")(),gwe=wt("/labs_/")(),vwe=wt("/subscription/start")(),bwe=wt("/subscription/manage")(),ywe=wt("/shares/$conversationId")(),Cwe=wt("/referrals/rules")(),Swe=wt("/pro/subscribe")(),Ewe=wt("/pages/$pageId")(),Iwe=wt("/memory/narrative")(),Twe=wt("/gallery/$galleryItemId")(),_we=wt("/chats/private")(),wwe=wt("/campaigns/$campaignId")(),Awe=wt("/shares/podcasts/$shareId")(),kwe=wt("/shares/pages/$shareId")(),xwe=wt("/pro/redeem/$redeemCode")(),Rwe=wt("/pro/ewallet/return")(),Nwe=wt("/podcasts/$podcastType/$podcastId")(),Pwe=wt("/labs_/experiments/$experimentAlias")(),Mwe=wt("/chats_/$conversationId/talk")(),Owe=wt("/labs_/experiments/portrait/")(),Lwe=wt("/labs_/experiments/3d-generations/")(),Dwe=wt("/labs_/experiments/portrait/talk")(),jwe=wt("/labs_/experiments/3d-generations/my-creations")(),Uwe=wt("/labs_/experiments/3d-generations/shares/$shareId")(),Fwe=awe.update({id:"/topic-selection",path:"/topic-selection",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./topic-selection.lazy-BcEsgx3l.js"),__vite__mapDeps([356,1,2])).then(t=>t.Route)),Bwe=cwe.update({id:"/login",path:"/login",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./login.lazy-NW0M4Wp5.js"),__vite__mapDeps([357,1,2,287])).then(t=>t.Route)),Hwe=lwe.update({id:"/library",path:"/library",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./library.lazy-CfgvEpL9.js"),__vite__mapDeps([358,1,2])).then(t=>t.Route)),zwe=uwe.update({id:"/gaming",path:"/gaming",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./gaming.lazy-BNyM96te.js"),__vite__mapDeps([359,1,2,227,228])).then(t=>t.Route)),l7=dwe.update({id:"/gallery",path:"/gallery",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./gallery.lazy-DA5XLI0f.js"),__vite__mapDeps([360,1,2,361])).then(t=>t.Route)),Vwe=hwe.update({id:"/discover",path:"/discover",getParentRoute:()=>xt}).lazy(()=>H(()=>Promise.resolve().then(()=>bke),void 0).then(t=>t.Route)),$we=fwe.update({id:"/daily",path:"/daily",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./daily.lazy-CDudydWu.js"),__vite__mapDeps([362,1,2,363,364,365,324,366,367,368,369,370,273,355,312,311])).then(t=>t.Route)),Gwe=pwe.update({id:"/agents",path:"/agents",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./agents.lazy-DH-oy6sa.js"),__vite__mapDeps([371,1,2])).then(t=>t.Route)),Kwe=XIe.update({id:"/",path:"/",getParentRoute:()=>xt}),qwe=mwe.update({id:"/referrals/",path:"/referrals/",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./index.lazy-BRD9pJwy.js"),__vite__mapDeps([372,1,2,373,236,374,375,376,377,378,379,380,381])).then(t=>t.Route)),Wwe=gwe.update({id:"/labs_/",path:"/labs/",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./index.lazy-PEOE9gco.js"),__vite__mapDeps([382,1,2,383,384,385,386,387,388,389])).then(t=>t.Route)),Ywe=vwe.update({id:"/subscription/start",path:"/subscription/start",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./subscription.start.lazy-DUVBmlXN.js"),__vite__mapDeps([390,1,2])).then(t=>t.Route)),Qwe=bwe.update({id:"/subscription/manage",path:"/subscription/manage",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./subscription.manage.lazy-Cz5uCTdX.js"),__vite__mapDeps([391,1,2,334])).then(t=>t.Route)),Jwe=ywe.update({id:"/shares/$conversationId",path:"/shares/$conversationId",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./shares._conversationId.lazy-DnWHRYws.js"),__vite__mapDeps([392,1,2])).then(t=>t.Route)),Zwe=Cwe.update({id:"/referrals/rules",path:"/referrals/rules",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./rules.lazy-0Rya6oqK.js"),__vite__mapDeps([393,1,2,236,375,377,394,395])).then(t=>t.Route)),Xwe=Swe.update({id:"/pro/subscribe",path:"/pro/subscribe",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./pro.subscribe.lazy-BOhhqmaw.js"),__vite__mapDeps([396,1,2,237,238,239,225,397,398,274,399,400,401,402,403,232,404,405,406,407,408,409,410,411,412,413,235,236,414,415,416,417,418,227,228,419,420])).then(t=>t.Route)),eAe=Ewe.update({id:"/pages/$pageId",path:"/pages/$pageId",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./pages._pageId.lazy-CJ6tKie1.js"),__vite__mapDeps([421,1,2,422,352,423,424,425,426,427,428,295,429,430,284,431,314,366,290,432,433,292])).then(t=>t.Route)),tAe=Iwe.update({id:"/memory/narrative",path:"/memory/narrative",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./memory.narrative.lazy-D2ftwklV.js"),__vite__mapDeps([434,1,2,435])).then(t=>t.Route)),nAe=Twe.update({id:"/$galleryItemId",path:"/$galleryItemId",getParentRoute:()=>l7}).lazy(()=>H(()=>import("./gallery._galleryItemId.lazy-Bkf6NQLD.js"),__vite__mapDeps([436,1,2,437,438,439,298,299,302,303,304,305,306,361])).then(t=>t.Route)),rAe=_we.update({id:"/chats/private",path:"/chats/private",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./chats.private.lazy-DqrosmEZ.js"),__vite__mapDeps([440,1,2])).then(t=>t.Route)),oAe=wwe.update({id:"/campaigns/$campaignId",path:"/campaigns/$campaignId",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./campaigns._campaignId.lazy--FFdyuh5.js"),__vite__mapDeps([441,1,2,351,221,298,299,303])).then(t=>t.Route)),iAe=rwe.update({id:"/w/landing",path:"/w/landing",getParentRoute:()=>xt}),sAe=swe.update({id:"/chats/$conversationId",path:"/chats/$conversationId",getParentRoute:()=>xt}),aAe=Awe.update({id:"/shares/podcasts/$shareId",path:"/shares/podcasts/$shareId",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./shares.podcasts._shareId.lazy-CYypAaGY.js"),__vite__mapDeps([442,1,2,355,312,329,369,370])).then(t=>t.Route)),cAe=kwe.update({id:"/shares/pages/$shareId",path:"/shares/pages/$shareId",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./shares.pages._shareId.lazy-DxGa496K.js"),__vite__mapDeps([443,1,2,433,422,352,423,424,425,426,427,428,295,429,430,284,431,314,366,290,432,292,444])).then(t=>t.Route)),lAe=xwe.update({id:"/pro/redeem/$redeemCode",path:"/pro/redeem/$redeemCode",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./pro.redeem._redeemCode.lazy-Iv_B82GV.js"),__vite__mapDeps([445,1,2])).then(t=>t.Route)),uAe=Rwe.update({id:"/pro/ewallet/return",path:"/pro/ewallet/return",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./pro.ewallet.return.lazy-C-o4s2ne.js"),__vite__mapDeps([446,1,2,398,274])).then(t=>t.Route)),dAe=Nwe.update({id:"/podcasts/$podcastType/$podcastId",path:"/podcasts/$podcastType/$podcastId",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./podcasts._podcastType._podcastId.lazy-C2hwbejd.js"),__vite__mapDeps([447,1,2,363,364,365,324,366,367,368,369,370,273,355,312,311])).then(t=>t.Route)),hAe=Pwe.update({id:"/labs_/experiments/$experimentAlias",path:"/labs/experiments/$experimentAlias",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./experiments._experimentAlias.lazy-DEE2vvxE.js").then(t=>t.e),__vite__mapDeps([448,1,2,384,383,385,386,387,388,271,272])).then(t=>t.Route)),fAe=Mwe.update({id:"/chats_/$conversationId/talk",path:"/chats/$conversationId/talk",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./chats_._conversationId.talk.lazy-BtBSPNZ_.js"),__vite__mapDeps([449,1,2,450,451,452,453])).then(t=>t.Route)),pAe=Owe.update({id:"/labs_/experiments/portrait/",path:"/labs/experiments/portrait/",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./index.lazy-CMjzYEhb.js"),__vite__mapDeps([454,1,2])).then(t=>t.Route)),mAe=Lwe.update({id:"/labs_/experiments/3d-generations/",path:"/labs/experiments/3d-generations/",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./my-creations.lazy-CnL7LJc0.js").then(t=>t.i),__vite__mapDeps([455,1,2,383,410,282,364,365,324,292,293,228,456])).then(t=>t.Route)),gAe=Dwe.update({id:"/labs_/experiments/portrait/talk",path:"/labs/experiments/portrait/talk",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./talk.lazy-BHDMzjfO.js"),__vite__mapDeps([457,1,2,450,451,452,453])).then(t=>t.Route)),vAe=jwe.update({id:"/labs_/experiments/3d-generations/my-creations",path:"/labs/experiments/3d-generations/my-creations",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./my-creations.lazy-CnL7LJc0.js").then(t=>t.m),__vite__mapDeps([455,1,2,383,410,282,364,365,324,292,293,228,456])).then(t=>t.Route)),bAe=Uwe.update({id:"/labs_/experiments/3d-generations/shares/$shareId",path:"/labs/experiments/3d-generations/shares/$shareId",getParentRoute:()=>xt}).lazy(()=>H(()=>import("./shares._shareId.lazy-BaZ-EmHY.js"),__vite__mapDeps([458,1,2])).then(t=>t.Route)),yAe={GalleryGalleryItemIdLazyRoute:nAe},CAe=l7._addFileChildren(yAe),SAe={IndexRoute:Kwe,AgentsLazyRoute:Gwe,DailyLazyRoute:$we,DiscoverLazyRoute:Vwe,GalleryLazyRoute:CAe,GamingLazyRoute:zwe,LibraryLazyRoute:Hwe,LoginLazyRoute:Bwe,TopicSelectionLazyRoute:Fwe,ChatsConversationIdRoute:sAe,WLandingRoute:iAe,CampaignsCampaignIdLazyRoute:oAe,ChatsPrivateLazyRoute:rAe,MemoryNarrativeLazyRoute:tAe,PagesPageIdLazyRoute:eAe,ProSubscribeLazyRoute:Xwe,ReferralsRulesLazyRoute:Zwe,SharesConversationIdLazyRoute:Jwe,SubscriptionManageLazyRoute:Qwe,SubscriptionStartLazyRoute:Ywe,LabsIndexLazyRoute:Wwe,ReferralsIndexLazyRoute:qwe,ChatsConversationIdTalkLazyRoute:fAe,LabsExperimentsExperimentAliasLazyRoute:hAe,PodcastsPodcastTypePodcastIdLazyRoute:dAe,ProEwalletReturnLazyRoute:uAe,ProRedeemRedeemCodeLazyRoute:lAe,SharesPagesShareIdLazyRoute:cAe,SharesPodcastsShareIdLazyRoute:aAe,LabsExperiments3dGenerationsMyCreationsLazyRoute:vAe,LabsExperimentsPortraitTalkLazyRoute:gAe,LabsExperiments3dGenerationsIndexLazyRoute:mAe,LabsExperimentsPortraitIndexLazyRoute:pAe,LabsExperiments3dGenerationsSharesShareIdLazyRoute:bAe},EAe=xt._addFileChildren(SAe)._addFileTypes(),El=fB({routeTree:EAe});function IAe(){return d.jsx(pB,{router:El})}(function(){const t="onabort onactivate onactivateinvisible onafterprint onafterupdate onanimationcancel onanimationend onanimationiteration onanimationstart onariarequest onauxclick onbeforeactivate onbeforecopy onbeforecut onbeforedeactivate onbeforeeditfocus onbeforepaste onbeforeprint onbeforeunload onbegin onblur onbounce oncancel oncanplay oncanplaythrough oncellchange onchange onclick onclose oncommand oncontextmenu oncontrolselect oncopy oncuechange oncut ondataavailable ondatasetchanged ondatasetcomplete ondblclick ondeactivate ondrag ondragdrop ondragend ondragenter ondragexit ondragleave ondragover ondragstart ondrop ondurationchange onemptied onend onended onerror onerrorupdate onexit onfilterchange onfinish onfocus onfocusin onfocusout onformdata onfullscreenchange onfullscreenerror ongotpointercapture onhelp oninput oninvalid onkeydown onkeypress onkeyup onlayoutcomplete onload onloadeddata onloadedmetadata onloadend onloadstart onlosecapture onlostpointercapture onmediacomplete onmediaerror onmessage onmousedown onmouseenter onmouseleave onmousemove onmouseout onmouseover onmouseup onmousewheel onmove onmoveend onmovestart onmozfullscreenchange onmozfullscreenerror onmscontentzoom onmsgesturechange onmsgesturedoubletap onmsgestureend onmsgesturehold onmsgesturestart onmsgesturetap onmsgotpointercapture onmsinertiastart onmslostpointercapture onmsmanipulationstatechanged onmspointercancel onmspointerdown onmspointerenter onmspointerleave onmspointermove onmspointerout onmspointerover onmspointerup onoffline ononline onoutofsync onoverscroll onpaste onpause onplay onplaying onpointercancel onpointerdown onpointerenter onpointerleave onpointermove onpointerout onpointerover onpointerrawupdate onpointerup onprogress onpropertychange onratechange onreadystatechange onrepeat onreset onresize onresizeend onresizestart onresume onreverse onrowdelete onrowenter onrowexit onrowinserted onscroll onscrollend onsearch onseek onseeked onseeking onselect onselectionchange onselectstart onshow onstalled onstart onstop onstorage onsubmit onsuspend onsynchrestored ontimeerror ontimeupdate ontoggle ontrackchange ontransitioncancel ontransitionend ontransitionrun ontransitionstart onunload onurlflip onvolumechange onwaiting onwebkitanimationend onwebkitanimationiteration onwebkitanimationstart onwebkitfullscreenchange onwebkitfullscreenerror onwebkittransitionend onwheel".split(" ");function e(){if(typeof window<"u"){const p=[];for(const f in HTMLElement.prototype)f.slice(0,2)==="on"&&p.push(f);return p}return t}const n=typeof window<"u",r=()=>{throw new TypeError("undefined conversion")},o=()=>null,{toLowerCase:i,toUpperCase:s}=String.prototype;function a(){throw new TypeError("Illegal constructor")}function c(){throw new TypeError("Illegal constructor")}const{l:u}=function(){function p(de){let ge=ie.get(de);return ge===void 0&&(ge=E(null),ie.set(de,ge)),ge}function f(de){const ge=w(de);if(ge==null||w(ge)!==A)throw Error();for(const $e of _(ge))I(de,$e,{value:de[$e]});return de}function g(de,ge){T(de.prototype),delete de.name,I(de,"name",{value:ge})}function v(de){return ge=>ge instanceof de&&ie.has(ge)}function y(de,ge){function $e(J,Te){const O=ge[Te]||(de=="default"?o:r),ce=T(new J(V,de));return T({[Te](se,...ne){if(se=O(""+se,...ne),se==null){if(de=="default")return se;se=""}return se=""+se,ne=T(E(ce)),p(ne).v=se,ne}}[Te])}const P=E(a.prototype);for(const J of _(we))P[J]=$e(we[J],J);return I(P,"name",{value:de,writable:!1,configurable:!1,enumerable:!0}),T(P)}function b(de,ge,$e,P="",J=""){if(de=s.apply(String(de)),(P=J||P)||(P="http://www.w3.org/1999/xhtml"),P=M.apply(Se,[P])?Se[P]:null){if(M.apply(P,[de])&&P[de]&&M.apply(P[de][ge],[$e])&&P[de][ge][$e])return P[de][ge][$e];if(M.apply(P,["*"])&&M.apply(P["*"][ge],[$e])&&P["*"][ge][$e])return P["*"][ge][$e]}}function C(){return j}const{assign:S,create:E,defineProperty:I,freeze:T,getOwnPropertyNames:_,getPrototypeOf:w,prototype:A}=Object,{hasOwnProperty:M}=A,{forEach:R,push:$}=Array.prototype,V=Symbol(),ie=f(new WeakMap),N=f([]),Y=f([]);let ue=!0,j=null,U=!1;class te{constructor(ge,$e){if(ge!==V)throw Error("cannot call the constructor");I(this,"policyName",{value:$e,enumerable:!0})}toString(){return p(this).v}valueOf(){return p(this).v}}class Q extends te{}g(Q,"TrustedScriptURL");class re extends te{}g(re,"TrustedHTML");class Z extends te{}g(Z,"TrustedScript"),g(te,"TrustedType");const _e=T(E(new re(V,"")));p(_e).v="";const ye=T(E(new Z(V,"")));p(ye).v="";const Se={"http://www.w3.org/1999/xhtml":{EMBED:{attributes:{src:Q.name}},IFRAME:{attributes:{srcdoc:re.name}},OBJECT:{attributes:{data:Q.name,codebase:Q.name}},SCRIPT:{attributes:{src:Q.name,text:Z.name},properties:{innerText:Z.name,textContent:Z.name,text:Z.name}},"*":{attributes:{},properties:{innerHTML:re.name,outerHTML:re.name}}},"http://www.w3.org/2000/svg":{"*":{attributes:{},properties:{}}}};var Ne={codebase:"codeBase",formaction:"formAction"};!n||"srcdoc"in HTMLIFrameElement.prototype||delete Se["http://www.w3.org/1999/xhtml"].IFRAME.attributes.srcdoc;for(const de of Object.keys(Se["http://www.w3.org/1999/xhtml"])){Se["http://www.w3.org/1999/xhtml"][de].properties||(Se["http://www.w3.org/1999/xhtml"][de].properties={});for(const ge of Object.keys(Se["http://www.w3.org/1999/xhtml"][de].attributes))Se["http://www.w3.org/1999/xhtml"][de].properties[Ne[ge]?Ne[ge]:ge]=Se["http://www.w3.org/1999/xhtml"][de].attributes[ge]}for(const de of e())Se["http://www.w3.org/1999/xhtml"]["*"].attributes[de]="TrustedScript",Se["http://www.w3.org/2000/svg"]["*"].attributes[de]="TrustedScript";const we={createHTML:re,createScriptURL:Q,createScript:Z},Ke=we.hasOwnProperty;return Ne=E(c.prototype),S(Ne,{createPolicy:function(de,ge){if(!de.match(/^[-#a-zA-Z0-9=_/@.%]+$/g))throw new TypeError("Policy "+de+" contains invalid characters.");if(U&&Y.indexOf(de)===-1&&Y.indexOf("*")===-1)throw new TypeError("Policy "+de+" disallowed.");if(de==="default"&&j)throw new TypeError("Policy "+de+" already exists.");if(U&&!ue&&N.indexOf(de)!==-1)throw new TypeError("Policy "+de+" exists.");N.push(de);const $e=E(null);if(ge&&typeof ge=="object")for(const P of _(ge))Ke.call(we,P)&&($e[P]=ge[P]);else console.warn("trustedTypes.createPolicy "+de+" was given an empty policy");return T($e),ge=y(de,$e),de==="default"&&(j=ge),ge},h:v(re),j:v(Q),i:v(Z),c:function(de,ge,$e="",P=""){return ge=i.apply(String(ge)),b(de,"attributes",ge,$e,P)||null},f:function(de,ge,$e=""){return b(de,"properties",String(ge),$e)||null},g:function(de=""){if(!de)try{de=document.documentElement.namespaceURI}catch{de="http://www.w3.org/1999/xhtml"}return(de=Se[de])?JSON.parse(JSON.stringify(de)):{}},a:_e,b:ye,o:j,TrustedHTML:re,TrustedScriptURL:Q,TrustedScript:Z}),I(Ne,"defaultPolicy",{get:C,set:()=>{}}),{l:T(Ne),w:function(de,ge){U=!0,Y.length=0,R.call(de,$e=>{$.call(Y,""+$e)}),ue=ge,N.length=0},m:function(){U=!1},s:C,u:function(){j=null,N.splice(N.indexOf("default"),1)}}}();if(typeof window<"u"&&(window.TrustedTypes&&typeof window.trustedTypes>"u"&&(window.trustedTypes=Object.freeze(window.TrustedTypes)),typeof window.trustedTypes>"u")){var h=Object.create(c.prototype);Object.assign(h,{isHTML:u.h,isScriptURL:u.j,isScript:u.i,createPolicy:u.createPolicy,getAttributeType:u.c,getPropertyType:u.f,getTypeMapping:u.g,emptyHTML:u.a,emptyScript:u.b,_isPolyfill_:!0}),Object.defineProperty(h,"defaultPolicy",Object.getOwnPropertyDescriptor(u,"defaultPolicy")||{}),window.trustedTypes=Object.freeze(h),window.TrustedHTML=u.TrustedHTML,window.TrustedScriptURL=u.TrustedScriptURL,window.TrustedScript=u.TrustedScript,window.TrustedTypePolicy=a,window.TrustedTypePolicyFactory=c}}).call(void 0);/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */const{entries:u7,setPrototypeOf:rM,isFrozen:TAe,getPrototypeOf:_Ae,getOwnPropertyDescriptor:wAe}=Object;let{freeze:Nr,seal:Uo,create:d7}=Object,{apply:nI,construct:rI}=typeof Reflect<"u"&&Reflect;Nr||(Nr=function(e){return e});Uo||(Uo=function(e){return e});nI||(nI=function(e,n,r){return e.apply(n,r)});rI||(rI=function(e,n){return new e(...n)});const Hm=Pr(Array.prototype.forEach),AAe=Pr(Array.prototype.lastIndexOf),oM=Pr(Array.prototype.pop),_h=Pr(Array.prototype.push),kAe=Pr(Array.prototype.splice),fg=Pr(String.prototype.toLowerCase),A0=Pr(String.prototype.toString),iM=Pr(String.prototype.match),wh=Pr(String.prototype.replace),xAe=Pr(String.prototype.indexOf),RAe=Pr(String.prototype.trim),Wo=Pr(Object.prototype.hasOwnProperty),Sr=Pr(RegExp.prototype.test),Ah=NAe(TypeError);function Pr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return nI(t,e,r)}}function NAe(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rI(t,n)}}function Tt(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:fg;rM&&rM(t,null);let r=e.length;for(;r--;){let o=e[r];if(typeof o=="string"){const i=n(o);i!==o&&(TAe(e)||(e[r]=i),o=i)}t[o]=!0}return t}function PAe(t){for(let e=0;e<t.length;e++)Wo(t,e)||(t[e]=null);return t}function Qa(t){const e=d7(null);for(const[n,r]of u7(t))Wo(t,n)&&(Array.isArray(r)?e[n]=PAe(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Qa(r):e[n]=r);return e}function kh(t,e){for(;t!==null;){const r=wAe(t,e);if(r){if(r.get)return Pr(r.get);if(typeof r.value=="function")return Pr(r.value)}t=_Ae(t)}function n(){return null}return n}const sM=Nr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),k0=Nr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),x0=Nr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),MAe=Nr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),R0=Nr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),OAe=Nr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),aM=Nr(["#text"]),cM=Nr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),N0=Nr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),lM=Nr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),zm=Nr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),LAe=Uo(/\{\{[\w\W]*|[\w\W]*\}\}/gm),DAe=Uo(/<%[\w\W]*|[\w\W]*%>/gm),jAe=Uo(/\$\{[\w\W]*/gm),UAe=Uo(/^data-[\-\w.\u00B7-\uFFFF]+$/),FAe=Uo(/^aria-[\-\w]+$/),h7=Uo(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),BAe=Uo(/^(?:\w+script|data):/i),HAe=Uo(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),f7=Uo(/^html$/i),zAe=Uo(/^[a-z][.\w]*(-[.\w]+)+$/i);var uM=Object.freeze({__proto__:null,ARIA_ATTR:FAe,ATTR_WHITESPACE:HAe,CUSTOM_ELEMENT:zAe,DATA_ATTR:UAe,DOCTYPE_NAME:f7,ERB_EXPR:DAe,IS_ALLOWED_URI:h7,IS_SCRIPT_OR_DATA:BAe,MUSTACHE_EXPR:LAe,TMPLIT_EXPR:jAe});const xh={element:1,text:3,progressingInstruction:7,comment:8,document:9},VAe=function(){return typeof window>"u"?null:window},$Ae=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const o="data-tt-policy-suffix";n&&n.hasAttribute(o)&&(r=n.getAttribute(o));const i="dompurify"+(r?"#"+r:"");try{return e.createPolicy(i,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},dM=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function p7(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:VAe();const e=et=>p7(et);if(e.version="3.2.4",e.removed=[],!t||!t.document||t.document.nodeType!==xh.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,o=r.currentScript,{DocumentFragment:i,HTMLTemplateElement:s,Node:a,Element:c,NodeFilter:u,NamedNodeMap:h=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:p,DOMParser:f,trustedTypes:g}=t,v=c.prototype,y=kh(v,"cloneNode"),b=kh(v,"remove"),C=kh(v,"nextSibling"),S=kh(v,"childNodes"),E=kh(v,"parentNode");if(typeof s=="function"){const et=n.createElement("template");et.content&&et.content.ownerDocument&&(n=et.content.ownerDocument)}let I,T="";const{implementation:_,createNodeIterator:w,createDocumentFragment:A,getElementsByTagName:M}=n,{importNode:R}=r;let $=dM();e.isSupported=typeof u7=="function"&&typeof E=="function"&&_&&_.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:V,ERB_EXPR:ie,TMPLIT_EXPR:N,DATA_ATTR:Y,ARIA_ATTR:ue,IS_SCRIPT_OR_DATA:j,ATTR_WHITESPACE:U,CUSTOM_ELEMENT:te}=uM;let{IS_ALLOWED_URI:Q}=uM,re=null;const Z=Tt({},[...sM,...k0,...x0,...R0,...aM]);let _e=null;const ye=Tt({},[...cM,...N0,...lM,...zm]);let Se=Object.seal(d7(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ne=null,we=null,Ke=!0,de=!0,ge=!1,$e=!0,P=!1,J=!0,Te=!1,O=!1,ce=!1,se=!1,ne=!1,K=!1,pe=!0,He=!1;const at="user-content-";let ut=!0,Le=!1,Xe={},St=null;const Ut=Tt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Gt=null;const Kt=Tt({},["audio","video","img","source","image","track"]);let kn=null;const F=Tt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),me="http://www.w3.org/1998/Math/MathML",ve="http://www.w3.org/2000/svg",je="http://www.w3.org/1999/xhtml";let Ve=je,ct=!1,Be=null;const k=Tt({},[me,ve,je],A0);let G=Tt({},["mi","mo","mn","ms","mtext"]),ee=Tt({},["annotation-xml"]);const Ce=Tt({},["title","style","font","a","script"]);let De=null;const Qe=["application/xhtml+xml","text/html"],rt="text/html";let lt=null,yt=null;const Qt=n.createElement("form"),ot=function(B){return B instanceof RegExp||B instanceof Function},xn=function(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(yt&&yt===B)){if((!B||typeof B!="object")&&(B={}),B=Qa(B),De=Qe.indexOf(B.PARSER_MEDIA_TYPE)===-1?rt:B.PARSER_MEDIA_TYPE,lt=De==="application/xhtml+xml"?A0:fg,re=Wo(B,"ALLOWED_TAGS")?Tt({},B.ALLOWED_TAGS,lt):Z,_e=Wo(B,"ALLOWED_ATTR")?Tt({},B.ALLOWED_ATTR,lt):ye,Be=Wo(B,"ALLOWED_NAMESPACES")?Tt({},B.ALLOWED_NAMESPACES,A0):k,kn=Wo(B,"ADD_URI_SAFE_ATTR")?Tt(Qa(F),B.ADD_URI_SAFE_ATTR,lt):F,Gt=Wo(B,"ADD_DATA_URI_TAGS")?Tt(Qa(Kt),B.ADD_DATA_URI_TAGS,lt):Kt,St=Wo(B,"FORBID_CONTENTS")?Tt({},B.FORBID_CONTENTS,lt):Ut,Ne=Wo(B,"FORBID_TAGS")?Tt({},B.FORBID_TAGS,lt):{},we=Wo(B,"FORBID_ATTR")?Tt({},B.FORBID_ATTR,lt):{},Xe=Wo(B,"USE_PROFILES")?B.USE_PROFILES:!1,Ke=B.ALLOW_ARIA_ATTR!==!1,de=B.ALLOW_DATA_ATTR!==!1,ge=B.ALLOW_UNKNOWN_PROTOCOLS||!1,$e=B.ALLOW_SELF_CLOSE_IN_ATTR!==!1,P=B.SAFE_FOR_TEMPLATES||!1,J=B.SAFE_FOR_XML!==!1,Te=B.WHOLE_DOCUMENT||!1,se=B.RETURN_DOM||!1,ne=B.RETURN_DOM_FRAGMENT||!1,K=B.RETURN_TRUSTED_TYPE||!1,ce=B.FORCE_BODY||!1,pe=B.SANITIZE_DOM!==!1,He=B.SANITIZE_NAMED_PROPS||!1,ut=B.KEEP_CONTENT!==!1,Le=B.IN_PLACE||!1,Q=B.ALLOWED_URI_REGEXP||h7,Ve=B.NAMESPACE||je,G=B.MATHML_TEXT_INTEGRATION_POINTS||G,ee=B.HTML_INTEGRATION_POINTS||ee,Se=B.CUSTOM_ELEMENT_HANDLING||{},B.CUSTOM_ELEMENT_HANDLING&&ot(B.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Se.tagNameCheck=B.CUSTOM_ELEMENT_HANDLING.tagNameCheck),B.CUSTOM_ELEMENT_HANDLING&&ot(B.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Se.attributeNameCheck=B.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),B.CUSTOM_ELEMENT_HANDLING&&typeof B.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Se.allowCustomizedBuiltInElements=B.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),P&&(de=!1),ne&&(se=!0),Xe&&(re=Tt({},aM),_e=[],Xe.html===!0&&(Tt(re,sM),Tt(_e,cM)),Xe.svg===!0&&(Tt(re,k0),Tt(_e,N0),Tt(_e,zm)),Xe.svgFilters===!0&&(Tt(re,x0),Tt(_e,N0),Tt(_e,zm)),Xe.mathMl===!0&&(Tt(re,R0),Tt(_e,lM),Tt(_e,zm))),B.ADD_TAGS&&(re===Z&&(re=Qa(re)),Tt(re,B.ADD_TAGS,lt)),B.ADD_ATTR&&(_e===ye&&(_e=Qa(_e)),Tt(_e,B.ADD_ATTR,lt)),B.ADD_URI_SAFE_ATTR&&Tt(kn,B.ADD_URI_SAFE_ATTR,lt),B.FORBID_CONTENTS&&(St===Ut&&(St=Qa(St)),Tt(St,B.FORBID_CONTENTS,lt)),ut&&(re["#text"]=!0),Te&&Tt(re,["html","head","body"]),re.table&&(Tt(re,["tbody"]),delete Ne.tbody),B.TRUSTED_TYPES_POLICY){if(typeof B.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ah('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof B.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ah('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');I=B.TRUSTED_TYPES_POLICY,T=I.createHTML("")}else I===void 0&&(I=$Ae(g,o)),I!==null&&typeof T=="string"&&(T=I.createHTML(""));Nr&&Nr(B),yt=B}},br=Tt({},[...k0,...x0,...MAe]),$o=Tt({},[...R0,...OAe]),Il=function(B){let Pe=E(B);(!Pe||!Pe.tagName)&&(Pe={namespaceURI:Ve,tagName:"template"});const Je=fg(B.tagName),en=fg(Pe.tagName);return Be[B.namespaceURI]?B.namespaceURI===ve?Pe.namespaceURI===je?Je==="svg":Pe.namespaceURI===me?Je==="svg"&&(en==="annotation-xml"||G[en]):!!br[Je]:B.namespaceURI===me?Pe.namespaceURI===je?Je==="math":Pe.namespaceURI===ve?Je==="math"&&ee[en]:!!$o[Je]:B.namespaceURI===je?Pe.namespaceURI===ve&&!ee[en]||Pe.namespaceURI===me&&!G[en]?!1:!$o[Je]&&(Ce[Je]||!br[Je]):!!(De==="application/xhtml+xml"&&Be[B.namespaceURI]):!1},Co=function(B){_h(e.removed,{element:B});try{E(B).removeChild(B)}catch{b(B)}},or=function(B,Pe){try{_h(e.removed,{attribute:Pe.getAttributeNode(B),from:Pe})}catch{_h(e.removed,{attribute:null,from:Pe})}if(Pe.removeAttribute(B),B==="is")if(se||ne)try{Co(Pe)}catch{}else try{Pe.setAttribute(B,"")}catch{}},Op=function(B){let Pe=null,Je=null;if(ce)B="<remove></remove>"+B;else{const vn=iM(B,/^[\r\n\t ]+/);Je=vn&&vn[0]}De==="application/xhtml+xml"&&Ve===je&&(B='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+B+"</body></html>");const en=I?I.createHTML(B):B;if(Ve===je)try{Pe=new f().parseFromString(en,De)}catch{}if(!Pe||!Pe.documentElement){Pe=_.createDocument(Ve,"template",null);try{Pe.documentElement.innerHTML=ct?T:en}catch{}}const Wn=Pe.body||Pe.documentElement;return B&&Je&&Wn.insertBefore(n.createTextNode(Je),Wn.childNodes[0]||null),Ve===je?M.call(Pe,Te?"html":"body")[0]:Te?Pe.documentElement:Wn},Lp=function(B){return w.call(B.ownerDocument||B,B,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Tl=function(B){return B instanceof p&&(typeof B.nodeName!="string"||typeof B.textContent!="string"||typeof B.removeChild!="function"||!(B.attributes instanceof h)||typeof B.removeAttribute!="function"||typeof B.setAttribute!="function"||typeof B.namespaceURI!="string"||typeof B.insertBefore!="function"||typeof B.hasChildNodes!="function")},Ur=function(B){return typeof a=="function"&&B instanceof a};function an(et,B,Pe){Hm(et,Je=>{Je.call(e,B,Pe,yt)})}const _l=function(B){let Pe=null;if(an($.beforeSanitizeElements,B,null),Tl(B))return Co(B),!0;const Je=lt(B.nodeName);if(an($.uponSanitizeElement,B,{tagName:Je,allowedTags:re}),B.hasChildNodes()&&!Ur(B.firstElementChild)&&Sr(/<[/\w]/g,B.innerHTML)&&Sr(/<[/\w]/g,B.textContent)||B.nodeType===xh.progressingInstruction||J&&B.nodeType===xh.comment&&Sr(/<[/\w]/g,B.data))return Co(B),!0;if(!re[Je]||Ne[Je]){if(!Ne[Je]&&Jr(Je)&&(Se.tagNameCheck instanceof RegExp&&Sr(Se.tagNameCheck,Je)||Se.tagNameCheck instanceof Function&&Se.tagNameCheck(Je)))return!1;if(ut&&!St[Je]){const en=E(B)||B.parentNode,Wn=S(B)||B.childNodes;if(Wn&&en){const vn=Wn.length;for(let Yn=vn-1;Yn>=0;--Yn){const So=y(Wn[Yn],!0);So.__removalCount=(B.__removalCount||0)+1,en.insertBefore(So,C(B))}}}return Co(B),!0}return B instanceof c&&!Il(B)||(Je==="noscript"||Je==="noembed"||Je==="noframes")&&Sr(/<\/no(script|embed|frames)/i,B.innerHTML)?(Co(B),!0):(P&&B.nodeType===xh.text&&(Pe=B.textContent,Hm([V,ie,N],en=>{Pe=wh(Pe,en," ")}),B.textContent!==Pe&&(_h(e.removed,{element:B.cloneNode()}),B.textContent=Pe)),an($.afterSanitizeElements,B,null),!1)},Dp=function(B,Pe,Je){if(pe&&(Pe==="id"||Pe==="name")&&(Je in n||Je in Qt))return!1;if(!(de&&!we[Pe]&&Sr(Y,Pe))){if(!(Ke&&Sr(ue,Pe))){if(!_e[Pe]||we[Pe]){if(!(Jr(B)&&(Se.tagNameCheck instanceof RegExp&&Sr(Se.tagNameCheck,B)||Se.tagNameCheck instanceof Function&&Se.tagNameCheck(B))&&(Se.attributeNameCheck instanceof RegExp&&Sr(Se.attributeNameCheck,Pe)||Se.attributeNameCheck instanceof Function&&Se.attributeNameCheck(Pe))||Pe==="is"&&Se.allowCustomizedBuiltInElements&&(Se.tagNameCheck instanceof RegExp&&Sr(Se.tagNameCheck,Je)||Se.tagNameCheck instanceof Function&&Se.tagNameCheck(Je))))return!1}else if(!kn[Pe]){if(!Sr(Q,wh(Je,U,""))){if(!((Pe==="src"||Pe==="xlink:href"||Pe==="href")&&B!=="script"&&xAe(Je,"data:")===0&&Gt[B])){if(!(ge&&!Sr(j,wh(Je,U,"")))){if(Je)return!1}}}}}}return!0},Jr=function(B){return B!=="annotation-xml"&&iM(B,te)},qd=function(B){an($.beforeSanitizeAttributes,B,null);const{attributes:Pe}=B;if(!Pe||Tl(B))return;const Je={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:_e,forceKeepAttr:void 0};let en=Pe.length;for(;en--;){const Wn=Pe[en],{name:vn,namespaceURI:Yn,value:So}=Wn,Mn=lt(vn);let ir=vn==="value"?So:RAe(So);if(Je.attrName=Mn,Je.attrValue=ir,Je.keepAttr=!0,Je.forceKeepAttr=void 0,an($.uponSanitizeAttribute,B,Je),ir=Je.attrValue,He&&(Mn==="id"||Mn==="name")&&(or(vn,B),ir=at+ir),J&&Sr(/((--!?|])>)|<\/(style|title)/i,ir)){or(vn,B);continue}if(Je.forceKeepAttr||(or(vn,B),!Je.keepAttr))continue;if(!$e&&Sr(/\/>/i,ir)){or(vn,B);continue}P&&Hm([V,ie,N],Fp=>{ir=wh(ir,Fp," ")});const Up=lt(B.nodeName);if(Dp(Up,Mn,ir)){if(I&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!Yn)switch(g.getAttributeType(Up,Mn)){case"TrustedHTML":{ir=I.createHTML(ir);break}case"TrustedScriptURL":{ir=I.createScriptURL(ir);break}}try{Yn?B.setAttributeNS(Yn,vn,ir):B.setAttribute(vn,ir),Tl(B)?Co(B):oM(e.removed)}catch{}}}an($.afterSanitizeAttributes,B,null)},jp=function et(B){let Pe=null;const Je=Lp(B);for(an($.beforeSanitizeShadowDOM,B,null);Pe=Je.nextNode();)an($.uponSanitizeShadowNode,Pe,null),_l(Pe),qd(Pe),Pe.content instanceof i&&et(Pe.content);an($.afterSanitizeShadowDOM,B,null)};return e.sanitize=function(et){let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Pe=null,Je=null,en=null,Wn=null;if(ct=!et,ct&&(et="<!-->"),typeof et!="string"&&!Ur(et))if(typeof et.toString=="function"){if(et=et.toString(),typeof et!="string")throw Ah("dirty is not a string, aborting")}else throw Ah("toString is not a function");if(!e.isSupported)return et;if(O||xn(B),e.removed=[],typeof et=="string"&&(Le=!1),Le){if(et.nodeName){const So=lt(et.nodeName);if(!re[So]||Ne[So])throw Ah("root node is forbidden and cannot be sanitized in-place")}}else if(et instanceof a)Pe=Op("<!---->"),Je=Pe.ownerDocument.importNode(et,!0),Je.nodeType===xh.element&&Je.nodeName==="BODY"||Je.nodeName==="HTML"?Pe=Je:Pe.appendChild(Je);else{if(!se&&!P&&!Te&&et.indexOf("<")===-1)return I&&K?I.createHTML(et):et;if(Pe=Op(et),!Pe)return se?null:K?T:""}Pe&&ce&&Co(Pe.firstChild);const vn=Lp(Le?et:Pe);for(;en=vn.nextNode();)_l(en),qd(en),en.content instanceof i&&jp(en.content);if(Le)return et;if(se){if(ne)for(Wn=A.call(Pe.ownerDocument);Pe.firstChild;)Wn.appendChild(Pe.firstChild);else Wn=Pe;return(_e.shadowroot||_e.shadowrootmode)&&(Wn=R.call(r,Wn,!0)),Wn}let Yn=Te?Pe.outerHTML:Pe.innerHTML;return Te&&re["!doctype"]&&Pe.ownerDocument&&Pe.ownerDocument.doctype&&Pe.ownerDocument.doctype.name&&Sr(f7,Pe.ownerDocument.doctype.name)&&(Yn="<!DOCTYPE "+Pe.ownerDocument.doctype.name+`>
`+Yn),P&&Hm([V,ie,N],So=>{Yn=wh(Yn,So," ")}),I&&K?I.createHTML(Yn):Yn},e.setConfig=function(){let et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};xn(et),O=!0},e.clearConfig=function(){yt=null,O=!1},e.isValidAttribute=function(et,B,Pe){yt||xn({});const Je=lt(et),en=lt(B);return Dp(Je,en,Pe)},e.addHook=function(et,B){typeof B=="function"&&_h($[et],B)},e.removeHook=function(et,B){if(B!==void 0){const Pe=AAe($[et],B);return Pe===-1?void 0:kAe($[et],Pe,1)[0]}return oM($[et])},e.removeHooks=function(et){$[et]=[]},e.removeAllHooks=function(){$=dM()},e}var hM=p7(),pf=class{constructor(t,e,n,r,o,i){W(this,"type",3);W(this,"name","");W(this,"prefix","");W(this,"value","");W(this,"suffix","");W(this,"modifier",3);this.type=t,this.name=e,this.prefix=n,this.value=r,this.suffix=o,this.modifier=i}hasCustomName(){return this.name!==""&&typeof this.name!="number"}},GAe=/[$_\p{ID_Start}]/u,KAe=/[$_\u200C\u200D\p{ID_Continue}]/u,oI=".*";function qAe(t,e){return/^[\x00-\x7F]*$/.test(t)}function m7(t,e=!1){let n=[],r=0;for(;r<t.length;){let o=t[r],i=function(s){if(!e)throw new TypeError(s);n.push({type:"INVALID_CHAR",index:r,value:t[r++]})};if(o==="*"){n.push({type:"ASTERISK",index:r,value:t[r++]});continue}if(o==="+"||o==="?"){n.push({type:"OTHER_MODIFIER",index:r,value:t[r++]});continue}if(o==="\\"){n.push({type:"ESCAPED_CHAR",index:r++,value:t[r++]});continue}if(o==="{"){n.push({type:"OPEN",index:r,value:t[r++]});continue}if(o==="}"){n.push({type:"CLOSE",index:r,value:t[r++]});continue}if(o===":"){let s="",a=r+1;for(;a<t.length;){let c=t.substr(a,1);if(a===r+1&&GAe.test(c)||a!==r+1&&KAe.test(c)){s+=t[a++];continue}break}if(!s){i(`Missing parameter name at ${r}`);continue}n.push({type:"NAME",index:r,value:s}),r=a;continue}if(o==="("){let s=1,a="",c=r+1,u=!1;if(t[c]==="?"){i(`Pattern cannot start with "?" at ${c}`);continue}for(;c<t.length;){if(!qAe(t[c])){i(`Invalid character '${t[c]}' at ${c}.`),u=!0;break}if(t[c]==="\\"){a+=t[c++]+t[c++];continue}if(t[c]===")"){if(s--,s===0){c++;break}}else if(t[c]==="("&&(s++,t[c+1]!=="?")){i(`Capturing groups are not allowed at ${c}`),u=!0;break}a+=t[c++]}if(u)continue;if(s){i(`Unbalanced pattern at ${r}`);continue}if(!a){i(`Missing pattern at ${r}`);continue}n.push({type:"REGEX",index:r,value:a}),r=c;continue}n.push({type:"CHAR",index:r,value:t[r++]})}return n.push({type:"END",index:r,value:""}),n}function g7(t,e={}){let n=m7(t);e.delimiter??(e.delimiter="/#?"),e.prefixes??(e.prefixes="./");let r=`[^${Io(e.delimiter)}]+?`,o=[],i=0,s=0,a=new Set,c=S=>{if(s<n.length&&n[s].type===S)return n[s++].value},u=()=>c("OTHER_MODIFIER")??c("ASTERISK"),h=S=>{let E=c(S);if(E!==void 0)return E;let{type:I,index:T}=n[s];throw new TypeError(`Unexpected ${I} at ${T}, expected ${S}`)},p=()=>{let S="",E;for(;E=c("CHAR")??c("ESCAPED_CHAR");)S+=E;return S},f=S=>S,g=e.encodePart||f,v="",y=S=>{v+=S},b=()=>{v.length&&(o.push(new pf(3,"","",g(v),"",3)),v="")},C=(S,E,I,T,_)=>{let w=3;switch(_){case"?":w=1;break;case"*":w=0;break;case"+":w=2;break}if(!E&&!I&&w===3){y(S);return}if(b(),!E&&!I){if(!S)return;o.push(new pf(3,"","",g(S),"",w));return}let A;I?I==="*"?A=oI:A=I:A=r;let M=2;A===r?(M=1,A=""):A===oI&&(M=0,A="");let R;if(E?R=E:I&&(R=i++),a.has(R))throw new TypeError(`Duplicate name '${R}'.`);a.add(R),o.push(new pf(M,R,g(S),A,g(T),w))};for(;s<n.length;){let S=c("CHAR"),E=c("NAME"),I=c("REGEX");if(!E&&!I&&(I=c("ASTERISK")),E||I){let _=S??"";e.prefixes.indexOf(_)===-1&&(y(_),_=""),b();let w=u();C(_,E,I,"",w);continue}let T=S??c("ESCAPED_CHAR");if(T){y(T);continue}if(c("OPEN")){let _=p(),w=c("NAME"),A=c("REGEX");!w&&!A&&(A=c("ASTERISK"));let M=p();h("CLOSE");let R=u();C(_,w,A,M,R);continue}b(),h("END")}return o}function Io(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}function fM(t){return t&&t.ignoreCase?"ui":"u"}function WAe(t,e,n){return v7(g7(t,n),e,n)}function Cu(t){switch(t){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}function v7(t,e,n={}){n.delimiter??(n.delimiter="/#?"),n.prefixes??(n.prefixes="./"),n.sensitive??(n.sensitive=!1),n.strict??(n.strict=!1),n.end??(n.end=!0),n.start??(n.start=!0),n.endsWith="";let r=n.start?"^":"";for(let a of t){if(a.type===3){a.modifier===3?r+=Io(a.value):r+=`(?:${Io(a.value)})${Cu(a.modifier)}`;continue}e&&e.push(a.name);let c=`[^${Io(n.delimiter)}]+?`,u=a.value;if(a.type===1?u=c:a.type===0&&(u=oI),!a.prefix.length&&!a.suffix.length){a.modifier===3||a.modifier===1?r+=`(${u})${Cu(a.modifier)}`:r+=`((?:${u})${Cu(a.modifier)})`;continue}if(a.modifier===3||a.modifier===1){r+=`(?:${Io(a.prefix)}(${u})${Io(a.suffix)})`,r+=Cu(a.modifier);continue}r+=`(?:${Io(a.prefix)}`,r+=`((?:${u})(?:`,r+=Io(a.suffix),r+=Io(a.prefix),r+=`(?:${u}))*)${Io(a.suffix)})`,a.modifier===0&&(r+="?")}let o=`[${Io(n.endsWith)}]|$`,i=`[${Io(n.delimiter)}]`;if(n.end)return n.strict||(r+=`${i}?`),n.endsWith.length?r+=`(?=${o})`:r+="$",new RegExp(r,fM(n));n.strict||(r+=`(?:${i}(?=${o}))?`);let s=!1;if(t.length){let a=t[t.length-1];a.type===3&&a.modifier===3&&(s=n.delimiter.indexOf(a)>-1)}return s||(r+=`(?=${i}|${o})`),new RegExp(r,fM(n))}var Qs={delimiter:"",prefixes:"",sensitive:!0,strict:!0},YAe={delimiter:".",prefixes:"",sensitive:!0,strict:!0},QAe={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function JAe(t,e){return t.length?t[0]==="/"?!0:!e||t.length<2?!1:(t[0]=="\\"||t[0]=="{")&&t[1]=="/":!1}function b7(t,e){return t.startsWith(e)?t.substring(e.length,t.length):t}function ZAe(t,e){return t.endsWith(e)?t.substr(0,t.length-e.length):t}function y7(t){return!t||t.length<2?!1:t[0]==="["||(t[0]==="\\"||t[0]==="{")&&t[1]==="["}var C7=["ftp","file","http","https","ws","wss"];function S7(t){if(!t)return!0;for(let e of C7)if(t.test(e))return!0;return!1}function XAe(t,e){if(t=b7(t,"#"),e||t==="")return t;let n=new URL("https://example.com");return n.hash=t,n.hash?n.hash.substring(1,n.hash.length):""}function eke(t,e){if(t=b7(t,"?"),e||t==="")return t;let n=new URL("https://example.com");return n.search=t,n.search?n.search.substring(1,n.search.length):""}function tke(t,e){return e||t===""?t:y7(t)?T7(t):I7(t)}function nke(t,e){if(e||t==="")return t;let n=new URL("https://example.com");return n.password=t,n.password}function rke(t,e){if(e||t==="")return t;let n=new URL("https://example.com");return n.username=t,n.username}function oke(t,e,n){if(n||t==="")return t;if(e&&!C7.includes(e))return new URL(`${e}:${t}`).pathname;let r=t[0]=="/";return t=new URL(r?t:"/-"+t,"https://example.com").pathname,r||(t=t.substring(2,t.length)),t}function ike(t,e,n){return E7(e)===t&&(t=""),n||t===""?t:_7(t)}function ske(t,e){return t=ZAe(t,":"),e||t===""?t:bA(t)}function E7(t){switch(t){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}function bA(t){if(t==="")return t;if(/^[-+.A-Za-z0-9]*$/.test(t))return t.toLowerCase();throw new TypeError(`Invalid protocol '${t}'.`)}function ake(t){if(t==="")return t;let e=new URL("https://example.com");return e.username=t,e.username}function cke(t){if(t==="")return t;let e=new URL("https://example.com");return e.password=t,e.password}function I7(t){if(t==="")return t;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(t))throw new TypeError(`Invalid hostname '${t}'`);let e=new URL("https://example.com");return e.hostname=t,e.hostname}function T7(t){if(t==="")return t;if(/[^0-9a-fA-F[\]:]/g.test(t))throw new TypeError(`Invalid IPv6 hostname '${t}'`);return t.toLowerCase()}function _7(t){if(t===""||/^[0-9]*$/.test(t)&&parseInt(t)<=65535)return t;throw new TypeError(`Invalid port '${t}'.`)}function lke(t){if(t==="")return t;let e=new URL("https://example.com");return e.pathname=t[0]!=="/"?"/-"+t:t,t[0]!=="/"?e.pathname.substring(2,e.pathname.length):e.pathname}function uke(t){return t===""?t:new URL(`data:${t}`).pathname}function dke(t){if(t==="")return t;let e=new URL("https://example.com");return e.search=t,e.search.substring(1,e.search.length)}function hke(t){if(t==="")return t;let e=new URL("https://example.com");return e.hash=t,e.hash.substring(1,e.hash.length)}var Lu,Er,Zn,dn,dc,Du,ro,ju,Uu,Fu,xe,Bn,w7,iI,Hh,pg,To,sI,A7,mg,k7,x7,gg,iu,Ja,R7,N7,P7,M7,Ei,O7,SM,fke=(SM=class{constructor(t){ln(this,xe);ln(this,Lu);ln(this,Er,[]);ln(this,Zn,{});ln(this,dn,0);ln(this,dc,1);ln(this,Du,0);ln(this,ro,0);ln(this,ju,0);ln(this,Uu,0);ln(this,Fu,!1);Bt(this,Lu,t)}get result(){return he(this,Zn)}parse(){for(Bt(this,Er,m7(he(this,Lu),!0));he(this,dn)<he(this,Er).length;Bt(this,dn,he(this,dn)+he(this,dc))){if(Bt(this,dc,1),he(this,Er)[he(this,dn)].type==="END"){if(he(this,ro)===0){ze(this,xe,iI).call(this),ze(this,xe,Ja).call(this)?ze(this,xe,Bn).call(this,9,1):ze(this,xe,iu).call(this)?ze(this,xe,Bn).call(this,8,1):ze(this,xe,Bn).call(this,7,0);continue}else if(he(this,ro)===2){ze(this,xe,Hh).call(this,5);continue}ze(this,xe,Bn).call(this,10,0);break}if(he(this,ju)>0)if(ze(this,xe,N7).call(this))Bt(this,ju,he(this,ju)-1);else continue;if(ze(this,xe,R7).call(this)){Bt(this,ju,he(this,ju)+1);continue}switch(he(this,ro)){case 0:ze(this,xe,sI).call(this)&&ze(this,xe,Hh).call(this,1);break;case 1:if(ze(this,xe,sI).call(this)){ze(this,xe,O7).call(this);let t=7,e=1;ze(this,xe,A7).call(this)?(t=2,e=3):he(this,Fu)&&(t=2),ze(this,xe,Bn).call(this,t,e)}break;case 2:ze(this,xe,mg).call(this)?ze(this,xe,Hh).call(this,3):(ze(this,xe,gg).call(this)||ze(this,xe,iu).call(this)||ze(this,xe,Ja).call(this))&&ze(this,xe,Hh).call(this,5);break;case 3:ze(this,xe,k7).call(this)?ze(this,xe,Bn).call(this,4,1):ze(this,xe,mg).call(this)&&ze(this,xe,Bn).call(this,5,1);break;case 4:ze(this,xe,mg).call(this)&&ze(this,xe,Bn).call(this,5,1);break;case 5:ze(this,xe,P7).call(this)?Bt(this,Uu,he(this,Uu)+1):ze(this,xe,M7).call(this)&&Bt(this,Uu,he(this,Uu)-1),ze(this,xe,x7).call(this)&&!he(this,Uu)?ze(this,xe,Bn).call(this,6,1):ze(this,xe,gg).call(this)?ze(this,xe,Bn).call(this,7,0):ze(this,xe,iu).call(this)?ze(this,xe,Bn).call(this,8,1):ze(this,xe,Ja).call(this)&&ze(this,xe,Bn).call(this,9,1);break;case 6:ze(this,xe,gg).call(this)?ze(this,xe,Bn).call(this,7,0):ze(this,xe,iu).call(this)?ze(this,xe,Bn).call(this,8,1):ze(this,xe,Ja).call(this)&&ze(this,xe,Bn).call(this,9,1);break;case 7:ze(this,xe,iu).call(this)?ze(this,xe,Bn).call(this,8,1):ze(this,xe,Ja).call(this)&&ze(this,xe,Bn).call(this,9,1);break;case 8:ze(this,xe,Ja).call(this)&&ze(this,xe,Bn).call(this,9,1);break}}he(this,Zn).hostname!==void 0&&he(this,Zn).port===void 0&&(he(this,Zn).port="")}},Lu=new WeakMap,Er=new WeakMap,Zn=new WeakMap,dn=new WeakMap,dc=new WeakMap,Du=new WeakMap,ro=new WeakMap,ju=new WeakMap,Uu=new WeakMap,Fu=new WeakMap,xe=new WeakSet,Bn=function(t,e){var n,r,o;switch(he(this,ro)){case 0:break;case 1:he(this,Zn).protocol=ze(this,xe,Ei).call(this);break;case 2:break;case 3:he(this,Zn).username=ze(this,xe,Ei).call(this);break;case 4:he(this,Zn).password=ze(this,xe,Ei).call(this);break;case 5:he(this,Zn).hostname=ze(this,xe,Ei).call(this);break;case 6:he(this,Zn).port=ze(this,xe,Ei).call(this);break;case 7:he(this,Zn).pathname=ze(this,xe,Ei).call(this);break;case 8:he(this,Zn).search=ze(this,xe,Ei).call(this);break;case 9:he(this,Zn).hash=ze(this,xe,Ei).call(this);break}he(this,ro)!==0&&t!==10&&([1,2,3,4].includes(he(this,ro))&&[6,7,8,9].includes(t)&&((n=he(this,Zn)).hostname??(n.hostname="")),[1,2,3,4,5,6].includes(he(this,ro))&&[8,9].includes(t)&&((r=he(this,Zn)).pathname??(r.pathname=he(this,Fu)?"/":"")),[1,2,3,4,5,6,7].includes(he(this,ro))&&t===9&&((o=he(this,Zn)).search??(o.search=""))),ze(this,xe,w7).call(this,t,e)},w7=function(t,e){Bt(this,ro,t),Bt(this,Du,he(this,dn)+e),Bt(this,dn,he(this,dn)+e),Bt(this,dc,0)},iI=function(){Bt(this,dn,he(this,Du)),Bt(this,dc,0)},Hh=function(t){ze(this,xe,iI).call(this),Bt(this,ro,t)},pg=function(t){return t<0&&(t=he(this,Er).length-t),t<he(this,Er).length?he(this,Er)[t]:he(this,Er)[he(this,Er).length-1]},To=function(t,e){let n=ze(this,xe,pg).call(this,t);return n.value===e&&(n.type==="CHAR"||n.type==="ESCAPED_CHAR"||n.type==="INVALID_CHAR")},sI=function(){return ze(this,xe,To).call(this,he(this,dn),":")},A7=function(){return ze(this,xe,To).call(this,he(this,dn)+1,"/")&&ze(this,xe,To).call(this,he(this,dn)+2,"/")},mg=function(){return ze(this,xe,To).call(this,he(this,dn),"@")},k7=function(){return ze(this,xe,To).call(this,he(this,dn),":")},x7=function(){return ze(this,xe,To).call(this,he(this,dn),":")},gg=function(){return ze(this,xe,To).call(this,he(this,dn),"/")},iu=function(){if(ze(this,xe,To).call(this,he(this,dn),"?"))return!0;if(he(this,Er)[he(this,dn)].value!=="?")return!1;let t=ze(this,xe,pg).call(this,he(this,dn)-1);return t.type!=="NAME"&&t.type!=="REGEX"&&t.type!=="CLOSE"&&t.type!=="ASTERISK"},Ja=function(){return ze(this,xe,To).call(this,he(this,dn),"#")},R7=function(){return he(this,Er)[he(this,dn)].type=="OPEN"},N7=function(){return he(this,Er)[he(this,dn)].type=="CLOSE"},P7=function(){return ze(this,xe,To).call(this,he(this,dn),"[")},M7=function(){return ze(this,xe,To).call(this,he(this,dn),"]")},Ei=function(){let t=he(this,Er)[he(this,dn)],e=ze(this,xe,pg).call(this,he(this,Du)).index;return he(this,Lu).substring(e,t.index)},O7=function(){let t={};Object.assign(t,Qs),t.encodePart=bA;let e=WAe(ze(this,xe,Ei).call(this),void 0,t);Bt(this,Fu,S7(e))},SM),P0=["protocol","username","password","hostname","port","pathname","search","hash"],qs="*";function pM(t,e){if(typeof t!="string")throw new TypeError("parameter 1 is not of type 'string'.");let n=new URL(t,e);return{protocol:n.protocol.substring(0,n.protocol.length-1),username:n.username,password:n.password,hostname:n.hostname,port:n.port,pathname:n.pathname,search:n.search!==""?n.search.substring(1,n.search.length):void 0,hash:n.hash!==""?n.hash.substring(1,n.hash.length):void 0}}function as(t,e){return e?zh(t):t}function Rh(t,e,n){let r;if(typeof e.baseURL=="string")try{r=new URL(e.baseURL),e.protocol===void 0&&(t.protocol=as(r.protocol.substring(0,r.protocol.length-1),n)),!n&&e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.username===void 0&&(t.username=as(r.username,n)),!n&&e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.username===void 0&&e.password===void 0&&(t.password=as(r.password,n)),e.protocol===void 0&&e.hostname===void 0&&(t.hostname=as(r.hostname,n)),e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&(t.port=as(r.port,n)),e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.pathname===void 0&&(t.pathname=as(r.pathname,n)),e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.pathname===void 0&&e.search===void 0&&(t.search=as(r.search.substring(1,r.search.length),n)),e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.pathname===void 0&&e.search===void 0&&e.hash===void 0&&(t.hash=as(r.hash.substring(1,r.hash.length),n))}catch{throw new TypeError(`invalid baseURL '${e.baseURL}'.`)}if(typeof e.protocol=="string"&&(t.protocol=ske(e.protocol,n)),typeof e.username=="string"&&(t.username=rke(e.username,n)),typeof e.password=="string"&&(t.password=nke(e.password,n)),typeof e.hostname=="string"&&(t.hostname=tke(e.hostname,n)),typeof e.port=="string"&&(t.port=ike(e.port,t.protocol,n)),typeof e.pathname=="string"){if(t.pathname=e.pathname,r&&!JAe(t.pathname,n)){let o=r.pathname.lastIndexOf("/");o>=0&&(t.pathname=as(r.pathname.substring(0,o+1),n)+t.pathname)}t.pathname=oke(t.pathname,t.protocol,n)}return typeof e.search=="string"&&(t.search=eke(e.search,n)),typeof e.hash=="string"&&(t.hash=XAe(e.hash,n)),t}function zh(t){return t.replace(/([+*?:{}()\\])/g,"\\$1")}function pke(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}function mke(t,e){e.delimiter??(e.delimiter="/#?"),e.prefixes??(e.prefixes="./"),e.sensitive??(e.sensitive=!1),e.strict??(e.strict=!1),e.end??(e.end=!0),e.start??(e.start=!0),e.endsWith="";let n=".*",r=`[^${pke(e.delimiter)}]+?`,o=/[$_\u200C\u200D\p{ID_Continue}]/u,i="";for(let s=0;s<t.length;++s){let a=t[s];if(a.type===3){if(a.modifier===3){i+=zh(a.value);continue}i+=`{${zh(a.value)}}${Cu(a.modifier)}`;continue}let c=a.hasCustomName(),u=!!a.suffix.length||!!a.prefix.length&&(a.prefix.length!==1||!e.prefixes.includes(a.prefix)),h=s>0?t[s-1]:null,p=s<t.length-1?t[s+1]:null;if(!u&&c&&a.type===1&&a.modifier===3&&p&&!p.prefix.length&&!p.suffix.length)if(p.type===3){let f=p.value.length>0?p.value[0]:"";u=o.test(f)}else u=!p.hasCustomName();if(!u&&!a.prefix.length&&h&&h.type===3){let f=h.value[h.value.length-1];u=e.prefixes.includes(f)}u&&(i+="{"),i+=zh(a.prefix),c&&(i+=`:${a.name}`),a.type===2?i+=`(${a.value})`:a.type===1?c||(i+=`(${r})`):a.type===0&&(!c&&(!h||h.type===3||h.modifier!==3||u||a.prefix!=="")?i+="*":i+=`(${n})`),a.type===1&&c&&a.suffix.length&&o.test(a.suffix[0])&&(i+="\\"),i+=zh(a.suffix),u&&(i+="}"),a.modifier!==3&&(i+=Cu(a.modifier))}return i}var ki,hc,Bu,Xn,Yo,Hu,EM,gke=(EM=class{constructor(t={},e,n){ln(this,ki);ln(this,hc,{});ln(this,Bu,{});ln(this,Xn,{});ln(this,Yo,{});ln(this,Hu,!1);try{let r;if(typeof e=="string"?r=e:n=e,typeof t=="string"){let a=new fke(t);if(a.parse(),t=a.result,r===void 0&&typeof t.protocol!="string")throw new TypeError("A base URL must be provided for a relative constructor string.");t.baseURL=r}else{if(!t||typeof t!="object")throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(r)throw new TypeError("parameter 1 is not of type 'string'.")}typeof n>"u"&&(n={ignoreCase:!1});let o={ignoreCase:n.ignoreCase===!0};Bt(this,ki,Rh({pathname:qs,protocol:qs,username:qs,password:qs,hostname:qs,port:qs,search:qs,hash:qs},t,!0)),E7(he(this,ki).protocol)===he(this,ki).port&&(he(this,ki).port="");let s;for(s of P0){if(!(s in he(this,ki)))continue;let a={},c=he(this,ki)[s];switch(he(this,Bu)[s]=[],s){case"protocol":Object.assign(a,Qs),a.encodePart=bA;break;case"username":Object.assign(a,Qs),a.encodePart=ake;break;case"password":Object.assign(a,Qs),a.encodePart=cke;break;case"hostname":Object.assign(a,YAe),y7(c)?a.encodePart=T7:a.encodePart=I7;break;case"port":Object.assign(a,Qs),a.encodePart=_7;break;case"pathname":S7(he(this,hc).protocol)?(Object.assign(a,QAe,o),a.encodePart=lke):(Object.assign(a,Qs,o),a.encodePart=uke);break;case"search":Object.assign(a,Qs,o),a.encodePart=dke;break;case"hash":Object.assign(a,Qs,o),a.encodePart=hke;break}try{he(this,Yo)[s]=g7(c,a),he(this,hc)[s]=v7(he(this,Yo)[s],he(this,Bu)[s],a),he(this,Xn)[s]=mke(he(this,Yo)[s],a),Bt(this,Hu,he(this,Hu)||he(this,Yo)[s].some(u=>u.type===2))}catch{throw new TypeError(`invalid ${s} pattern '${he(this,ki)[s]}'.`)}}}catch(r){throw new TypeError(`Failed to construct 'URLPattern': ${r.message}`)}}test(t={},e){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&e)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return!1;try{typeof t=="object"?n=Rh(n,t,!1):n=Rh(n,pM(t,e),!1)}catch{return!1}let r;for(r of P0)if(!he(this,hc)[r].exec(n[r]))return!1;return!0}exec(t={},e){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&e)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return;try{typeof t=="object"?n=Rh(n,t,!1):n=Rh(n,pM(t,e),!1)}catch{return null}let r={};e?r.inputs=[t,e]:r.inputs=[t];let o;for(o of P0){let i=he(this,hc)[o].exec(n[o]);if(!i)return null;let s={};for(let[a,c]of he(this,Bu)[o].entries())if(typeof c=="string"||typeof c=="number"){let u=i[a+1];s[c]=u}r[o]={input:n[o]??"",groups:s}}return r}static compareComponent(t,e,n){let r=(a,c)=>{for(let u of["type","modifier","prefix","value","suffix"]){if(a[u]<c[u])return-1;if(a[u]!==c[u])return 1}return 0},o=new pf(3,"","","","",3),i=new pf(0,"","","","",3),s=(a,c)=>{let u=0;for(;u<Math.min(a.length,c.length);++u){let h=r(a[u],c[u]);if(h)return h}return a.length===c.length?0:r(a[u]??o,c[u]??o)};return!he(e,Xn)[t]&&!he(n,Xn)[t]?0:he(e,Xn)[t]&&!he(n,Xn)[t]?s(he(e,Yo)[t],[i]):!he(e,Xn)[t]&&he(n,Xn)[t]?s([i],he(n,Yo)[t]):s(he(e,Yo)[t],he(n,Yo)[t])}get protocol(){return he(this,Xn).protocol}get username(){return he(this,Xn).username}get password(){return he(this,Xn).password}get hostname(){return he(this,Xn).hostname}get port(){return he(this,Xn).port}get pathname(){return he(this,Xn).pathname}get search(){return he(this,Xn).search}get hash(){return he(this,Xn).hash}get hasRegExpGroups(){return he(this,Hu)}},ki=new WeakMap,hc=new WeakMap,Bu=new WeakMap,Xn=new WeakMap,Yo=new WeakMap,Hu=new WeakMap,EM);globalThis.URLPattern||(globalThis.URLPattern=gke);let L7;function YNe(t){L7=t}function vke(){var t,e;typeof window<"u"&&(window.copilotTrustedTypesPolicy=(t=window.trustedTypes)==null?void 0:t.createPolicy("copilotPolicy",{createHTML:n=>hM.sanitize(n)}),(e=window.trustedTypes)==null||e.createPolicy("default",{createScriptURL:n=>{const r=/^\/cl\//,o=new URLPattern({protocol:"https",hostname:"www.clarity.ms",pathname:"/s/*"}),i=new URLPattern({protocol:"https",hostname:"*.cloudflare.com"}),s=new URLPattern({protocol:"https",hostname:"bat.bing.com"}),a=new URLPattern({protocol:"https",hostname:"az416426.vo.msecnd.net"}),c=new URLPattern({protocol:"https",hostname:"fpt.dfp.microsoft.com"}),u=new URLPattern({protocol:"https",hostname:"assets.msn.com"}),h=new URLPattern({protocol:"https",hostname:"content.lifecycle.office.net"});if(r.test(n)||o.test(n)||i.test(n)||s.test(n)||a.test(n)||c.test(n)||u.test(n)||h.test(n)||n===L7)return n;throw new Error(`Unsafe script URL "${n}" blocked by CSP.`)},createHTML:n=>hM.sanitize(n)}))}vke();mB.createRoot(document.getElementById("app")).render(d.jsx(Yc.StrictMode,{children:d.jsx(IAe,{})}));const bke=Object.freeze(Object.defineProperty({__proto__:null,Route:eTe},Symbol.toStringTag,{value:"Module"}));export{AE as $,Sn as A,Me as B,q9 as C,zd as D,wg as E,Fn as F,HI as G,dt as H,DU as I,vu as J,pl as K,aa as L,ar as M,Gke as N,X as O,Sw as P,Hv as Q,Ig as R,hd as S,oo as T,Ns as U,ky as V,Ge as W,pt as X,z as Y,s9 as Z,ORe as _,uRe as a,nb as a$,jM as a0,B$ as a1,nt as a2,Xt as a3,yw as a4,H as a5,sl as a6,ht as a7,Nt as a8,pr as a9,Mt as aA,Qc as aB,Lr as aC,ml as aD,tEe as aE,Pke as aF,Nke as aG,my as aH,AU as aI,go as aJ,E2e as aK,CL as aL,Nue as aM,fZ as aN,UE as aO,$d as aP,eI as aQ,oU as aR,rU as aS,tbe as aT,rbe as aU,ibe as aV,t2e as aW,sbe as aX,abe as aY,Bd as aZ,Ft as a_,Kv as aa,Ji as ab,Y$ as ac,_b as ad,An as ae,wb as af,Gv as ag,Jw as ah,BV as ai,Q$ as aj,wd as ak,Tve as al,_ve as am,jde as an,xle as ao,aN as ap,AT as aq,ps as ar,xRe as as,nEe as at,J1e as au,yTe as av,NRe as aw,Rhe as ax,kI as ay,sNe as az,fRe as b,Fge as b$,SI as b0,EI as b1,oEe as b2,iEe as b3,IP as b4,Pa as b5,CO as b6,Tn as b7,ts as b8,hue as b9,VI as bA,a7 as bB,IO as bC,jle as bD,xr as bE,Os as bF,bve as bG,qn as bH,ci as bI,Ixe as bJ,Exe as bK,Wr as bL,ei as bM,Txe as bN,Kke as bO,Bo as bP,QV as bQ,dd as bR,Vf as bS,Sy as bT,vU as bU,Qbe as bV,B2e as bW,ou as bX,KO as bY,_y as bZ,nve as b_,Ih as ba,gr as bb,qge as bc,Ec as bd,Na as be,es as bf,wp as bg,npe as bh,$Se as bi,Bw as bj,V9 as bk,Zu as bl,lh as bm,qxe as bn,ra as bo,sa as bp,Hke as bq,zke as br,Vke as bs,HJ as bt,Or as bu,Eye as bv,pa as bw,fi as bx,W9 as by,m2e as bz,q as c,oce as c$,Vu as c0,Mxe as c1,Fo as c2,NI as c3,Lke as c4,iA as c5,Gc as c6,Xke as c7,MO as c8,Kve as c9,_2e as cA,R2e as cB,A2e as cC,k2e as cD,vxe as cE,I4 as cF,rj as cG,nce as cH,qie as cI,Ua as cJ,xv as cK,ta as cL,kt as cM,H4 as cN,jc as cO,Use as cP,ba as cQ,q1 as cR,mr as cS,sRe as cT,K1 as cU,UR as cV,ew as cW,qse as cX,J1 as cY,bse as cZ,Qce as c_,V8 as ca,z8 as cb,zSe as cc,Tp as cd,sL as ce,fc as cf,U$ as cg,v$ as ch,WI as ci,Jbe as cj,Qf as ck,Kxe as cl,WO as cm,Bye as cn,SX as co,C$ as cp,y$ as cq,JU as cr,f8 as cs,$xe as ct,hl as cu,KM as cv,Uye as cw,x2e as cx,e2e as cy,w2e as cz,q0 as d,JRe as d$,rce as d0,Cm as d1,Zae as d2,P6 as d3,Eae as d4,Sae as d5,wae as d6,kz as d7,M2e as d8,N_e as d9,Ey as dA,hCe as dB,Kc as dC,OI as dD,kE as dE,vRe as dF,lz as dG,dRe as dH,rp as dI,vw as dJ,hw as dK,fl as dL,mxe as dM,fxe as dN,zj as dO,U1e as dP,Y2 as dQ,uz as dR,HN as dS,$Ne as dT,Cd as dU,bb as dV,aL as dW,eA as dX,PU as dY,I2e as dZ,hb as d_,K8 as da,bRe as db,_U as dc,z2e as dd,Aw as de,Fv as df,Rw as dg,qI as dh,G8 as di,lA as dj,uEe as dk,n7 as dl,Zle as dm,Wue as dn,Ew as dp,hD as dq,rr as dr,Nye as ds,Jc as dt,WP as du,dw as dv,iL as dw,q8 as dx,Oa as dy,w_e as dz,Oy as e,yo as e$,Dm as e0,Jo as e1,uf as e2,Ka as e3,Ks as e4,jw as e5,Sl as e6,Rp as e7,f_e as e8,Gf as e9,Fke as eA,Bke as eB,f$ as eC,QP as eD,pNe as eE,hNe as eF,ENe as eG,SNe as eH,dNe as eI,En as eJ,Ube as eK,INe as eL,vNe as eM,yO as eN,tA as eO,Bj as eP,cde as eQ,Pp as eR,gve as eS,Cxe as eT,she as eU,UEe as eV,TU as eW,li as eX,$I as eY,jJ as eZ,Jke as e_,vA as ea,ewe as eb,Cy as ec,y1e as ed,b1e as ee,U2e as ef,O_e as eg,sCe as eh,rCe as ei,t8 as ej,j2e as ek,iCe as el,Yj as em,jye as en,KJ as eo,gU as ep,kb as eq,TT as er,We as es,SEe as et,dEe as eu,jo as ev,Zi as ew,vEe as ex,P2e as ey,p$ as ez,Rt as f,YN as f$,m$ as f0,Xw as f1,Cw as f2,IL as f3,AL as f4,vve as f5,TL as f6,VNe as f7,YTe as f8,bxe as f9,Z5 as fA,Ht as fB,Fde as fC,Ude as fD,GG as fE,fA as fF,kRe as fG,mI as fH,SH as fI,$u as fJ,Vye as fK,T2e as fL,tb as fM,kU as fN,Ry as fO,_P as fP,yI as fQ,CI as fR,L0 as fS,Wv as fT,Xxe as fU,hg as fV,Nge as fW,Ar as fX,hRe as fY,GO as fZ,rA as f_,bNe as fa,CNe as fb,yNe as fc,Z1e as fd,fbe as fe,Ju as ff,Qu as fg,EL as fh,XI as fi,xb as fj,dve as fk,rNe as fl,d1e as fm,h1e as fn,uve as fo,O2e as fp,yve as fq,Sxe as fr,H2e as fs,L2e as ft,TSe as fu,D2e as fv,MU as fw,X5 as fx,ISe as fy,qX as fz,Hd as g,p8 as g$,eSe as g0,uxe as g1,kr as g2,Ag as g3,Ny as g4,Vde as g5,Hde as g6,o7 as g7,r7 as g8,Jj as g9,cxe as gA,lxe as gB,axe as gC,cG as gD,v2e as gE,Fue as gF,Due as gG,ff as gH,cn as gI,qP as gJ,mRe as gK,pRe as gL,zTe as gM,Vh as gN,q0e as gO,HRe as gP,CTe as gQ,zve as gR,WN as gS,mbe as gT,J9 as gU,bI as gV,jve as gW,kle as gX,ape as gY,G9 as gZ,qw as g_,xSe as ga,RSe as gb,B2 as gc,Zke as gd,TRe as ge,hM as gf,az as gg,wH as gh,Uge as gi,cRe as gj,aRe as gk,gb as gl,wxe as gm,lp as gn,r_e as go,IX as gp,CC as gq,RT as gr,cf as gs,b2e as gt,lG as gu,XO as gv,g2e as gw,C2e as gx,gL as gy,Wke as gz,Oo as h,DNe as h$,rxe as h0,dxe as h1,fn as h2,Hye as h3,HE as h4,ZRe as h5,FE as h6,f0 as h7,Yke as h8,Jxe as h9,Oxe as hA,hxe as hB,gxe as hC,Lxe as hD,zi as hE,_n as hF,_Re as hG,wRe as hH,Zc as hI,Qde as hJ,wde as hK,Ade as hL,YNe as hM,gw as hN,R_e as hO,tn as hP,nRe as hQ,rRe as hR,Sx as hS,oRe as hT,iRe as hU,RG as hV,Tf as hW,VSe as hX,_f as hY,h_e as hZ,s7 as h_,Zxe as ha,Yxe as hb,Qxe as hc,F0e as hd,Q2e as he,Wxe as hf,X$ as hg,jg as hh,fO as hi,xI as hj,ko as hk,Es as hl,xi as hm,Fe as hn,rb as ho,_c as hp,mn as hq,Tr as hr,_r as hs,ib as ht,Mo as hu,RI as hv,Ss as hw,wI as hx,Tc as hy,ho as hz,Ot as i,nP as i$,LNe as i0,Que as i1,Yue as i2,QEe as i3,NNe as i4,PNe as i5,MNe as i6,MP as i7,ONe as i8,km as i9,V2e as iA,N2e as iB,Mde as iC,iN as iD,Ode as iE,eve as iF,Mm as iG,sve as iH,K9 as iI,Dw as iJ,qf as iK,Kf as iL,Lde as iM,Qj as iN,Zs as iO,S9 as iP,xbe as iQ,nCe as iR,_he as iS,She as iT,ohe as iU,Yde as iV,B8 as iW,Ave as iX,Qi as iY,tP as iZ,eG as i_,y2e as ia,Gxe as ib,GE as ic,tue as id,mU as ie,pU as ig,uK as ih,Oge as ii,RRe as ij,zNe as ik,tD as il,ETe as im,iU as io,n2e as ip,iNe as iq,I9 as ir,Dke as is,k$ as it,e9 as iu,Ma as iv,F2e as iw,Dxe as ix,ARe as iy,fP as iz,fo as j,FJ as j$,jke as j0,Uke as j1,Ef as j2,SU as j3,V$ as j4,Axe as j5,DE as j6,Hve as j7,Jf as j8,nU as j9,qu as jA,Oke as jB,_p as jC,bEe as jD,kP as jE,up as jF,$ve as jG,cL as jH,F$ as jI,OJ as jJ,Aj as jK,Aue as jL,Gue as jM,CT as jN,GEe as jO,oL as jP,sSe as jQ,Ake as jR,rye as jS,c2e as jT,u2e as jU,d2e as jV,uL as jW,yT as jX,xxe as jY,Rxe as jZ,qO as j_,XRe as ja,JI as jb,yP as jc,J2e as jd,S$ as je,GI as jf,z$ as jg,fCe as jh,gX as ji,kke as jj,Rke as jk,xke as jl,jxe as jm,MJ as jn,LJ as jo,kxe as jp,Mke as jq,PJ as jr,pxe as js,QL as jt,exe as ju,Z$ as jv,txe as jw,oxe as jx,sxe as jy,ixe as jz,Ic as k,gNe as k$,BJ as k0,UJ as k1,lRe as k2,jRe as k3,qke as k4,Ib as k5,Pxe as k6,f2e as k7,h2e as k8,$v as k9,fNe as kA,TNe as kB,aSe as kC,aNe as kD,Iy as kE,eCe as kF,zfe as kG,Hfe as kH,xs as kI,fa as kJ,Qke as kK,khe as kL,DRe as kM,ZSe as kN,E8 as kO,W1e as kP,JEe as kQ,$ke as kR,jNe as kS,F8 as kT,uNe as kU,lNe as kV,cNe as kW,PRe as kX,MRe as kY,xhe as kZ,mNe as k_,jE as ka,Qw as kb,l2e as kc,_xe as kd,Nxe as ke,QI as kf,UV as kg,zI as kh,ERe as ki,nxe as kj,ga as kk,Uw as kl,gRe as km,mf as kn,zye as ko,Sle as kp,pCe as kq,jU as kr,_fe as ks,Afe as kt,IEe as ku,j1e as kv,Ike as kw,qM as kx,a2e as ky,yCe as kz,vl as l,yxe as l0,MY as l1,pre as l2,eRe as l3,tRe as l4,fw as l5,Tke as l6,_ke as l7,wke as l8,yRe as l9,Z2e as lA,X2e as lB,eNe as lC,tNe as lD,nNe as lE,oNe as lF,_Ne as lG,wNe as lH,ANe as lI,kNe as lJ,xNe as lK,RNe as lL,FNe as lM,BNe as lN,HNe as lO,GNe as lP,KNe as lQ,qNe as lR,WNe as lS,CRe as la,SRe as lb,IRe as lc,ww as ld,LRe as le,zRe as lf,VRe as lg,$Re as lh,GRe as li,KRe as lj,qRe as lk,WRe as ll,YRe as lm,QRe as ln,r2e as lo,o2e as lp,i2e as lq,s2e as lr,p2e as ls,S2e as lt,$2e as lu,G2e as lv,K2e as lw,q2e as lx,W2e as ly,Y2e as lz,Uue as m,sA as n,Yr as o,xU as p,pi as q,dL as r,tI as s,Bv as t,Oe as u,Fhe as v,be as w,xO as x,le as y,fs as z};
